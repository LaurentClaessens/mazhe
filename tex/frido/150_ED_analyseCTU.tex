% This is part of Analyse Starter CTU
% Copyright (c) 2014,2017, 2019
%   Laurent Claessens,Carlotta Donadello
% See the file fdl-1.3.txt for copying conditions.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Équations différentielles du premier ordre}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{definition}[Équation différentielle du premier ordre]
Une  \defe{équation différentielle du premier ordre}{équation différentielle!premier ordre} est une équation qui, sur un intervalle donné, \(I\), décrit la relation entre une variable réelle, notée \(x\) ou \(t\) dans \(I\), une fonction \(y \,:\,I\to\eR \), et la dérivée première de \(y\) qui on note \(y'\).
\end{definition}
Souvent on écrit <<\(y'(x) = \text{une formule contenante }x \text{ et }y(x)\)>>, c'est \`a dire
\begin{equation}\label{ed_generale}
  y'(x) = f(x,y(x)),\quad\text{pour }x\in I,
\end{equation}
où \(f\) est une fonction de deux variables réelles.
\begin{remark}
  La théorie des fonctions de deux variables ne sera pas abordée dans ce cours, nous allons nous contenter de prendre \(f\) dans \eqref{ed_generale} comme une simple notation.
\end{remark}
On peut presque toujours omettre d'écrire la dépendance de \(y\) en \(x\) et écrire simplement \eqref{ed_generale} sous la forme \(y' = f(x,y)\).
\begin{definition}[Solution particulière d'une équation différentielle du premier ordre]
  Une \defe{solution particulière}{solution!particulière} de l'équation \eqref{ed_generale} sur l'intervalle \(I\) est une fonction \(z\,:\, I\to\eR\) telle que :
  \begin{enumerate}
  \item \(z\) est dérivable sur \(I\) ;
  \item \(z'(x) = f(x, z(x)), \) pour tout \(x\in I\).
  \end{enumerate}
\end{definition}
\begin{definition}[Solution générale d'une équation différentielle du premier ordre]
  Résoudre une équation différentielle veut dire trouver l'ensemble qui contient toutes ses solutions particulières. Cet ensemble s'appelle \defe{solution générale}{solution!générale} de l'équation.
\end{definition}
\begin{example}
    \begin{enumerate}
        \item
        Résoudre une équation du type \( y'(x)=f(x)\)<++> revient à trouver l'ensemble des primitives de la fonction \(f\), qui est donc la solution générale de cette équation. Il y a donc une infinité de solutions particulières, déterminées par une constante additive.

        Si \(f (x) = \sin(x)\) alors la solution générale sera \(\mathcal{Y} = \{-\cos(x) + C\, : \, C\in\eR\}\).
        \item
        L'équation
        \begin{equation}\label{equation_exponentielle}
          y'= y, \qquad x \in\eR,
        \end{equation}
        a peut-être été abordée dans votre cours de terminale lors de la définition de la fonction exponentielle. Sa solution générale est \(\mathcal{Y} = \{Ce^x\, : \, C\in\eR\}\). Ici aussi il y a une infinité de solutions particulières.
    \end{enumerate}
\end{example}
\begin{remark}
  La solution générale d'une équation différentielle du premier ordre est une famille à un paramètre de fonctions.
\end{remark}
\begin{definition}[Équation differentielle du second ordre]
Une  \defe{équation différentielle du second ordre}{équation différentielle!second ordre} est une équation qui, sur un intervalle donne, \(I\), décrit la relation entre une variable réelle, notée \(x\) ou \(t\) dans \(I\), une fonction \(y \,:\,I\to\eR \), et les dérivées première et seconde de \(y\) qui on note \(y'\) et \(y''\) respectivement.

On utilise la forme générale
\begin{equation}\label{ed_generale_second_ordre}
  y'' = f(x,y, y'),\quad\text{pour }x\in I.
\end{equation}
o\`u \(f\) est une fonction de trois variables réelles.
\end{definition}
On peut définir de manière analogue les équations différentielles d'ordre supérieur. Les définitions de solution particulière et de solution générale se généralisent aux équations différentielles d'ordre supérieur à un.
\vspace{0.5cm}
\begin{definition}[Trajectoire]
  La trajectoire tracée par une solution particulière $y$ de l'équation \eqref{ed_generale} est le graphe de $y$ en tant que fonction de $x$.
\end{definition}
\begin{example}
  Nous allons regarder de plus près l'équation \eqref{equation_exponentielle}, $y'=y$, pour tout $x\in\eR$. Soient $y_1$ et $y_2$ deux solutions distinctes de cette équation. S'il existe un point $\bar x$ tel que $y_1(\bar x) = y_2 (\bar x)$ alors forcement $y_1(\bar x)/y_2 (\bar x)=1$. Or, la solution générale de l'équation est \(\mathcal{Y} = \{Ce^x\, : \, C\in\eR\}\), donc $y_i(x) = C_ie^x$, $i= 1,2$, o\`u les $C_i$ sont des constantes. Le rapport $y_1(\bar x)/y_2 (\bar x)$ vaut $C_1/C_2$ et par conséquent $C_1 = C_2$. Ce résultat contredit l'hypothèse que les deux solutions soient distinctes. On a donc montré que \emph{deux trajectoires distinctes de cette équations ne se croisent jamais}.

\newcommand{\CaptionFigSBTooEasQsT}{Quelques trajectoires de l'équation \( y'=y\).}
\input{auto/pictures_tex/Fig_SBTooEasQsT.pstricks}

La figure~\ref{LabelFigSBTooEasQsT} représente quelques trajectoires de l'équation. Si on les avait tracées toutes elles recouvriraient tout le plan $x$-$y$. Cela veut dire que \emph{par tout point $(x,y)$ passe une et une seule trajectoire de l'équation \eqref{equation_exponentielle}}.

\end{example}
\begin{definition}[Condition initiale]
  Une \defe{condition initiale}{condition initiale} pour l'équation \eqref{ed_generale} sur l'intervalle \(I\) est un point \((\bar x, \bar y)\in I\times\eR\).

On dit que la solution particulière \(z\) de \eqref{ed_generale} satisfait la condition initiale \((\bar x, \bar y)\in I\times\eR\) si \(z(\bar x) =\bar y\).
\end{definition}
\begin{definition}[Problème de Cauchy]
  L'association d'une équation différentielle et d'une condition initiale est appelée \defe{problème de Cauchy}{problème de Cauchy}
  \begin{equation}\label{plme_cauchy}
    \begin{cases}
      y'= f(x,y), \quad x\in I, \\
      y(\bar x) = \bar y.
    \end{cases}
  \end{equation}
\end{definition}
\begin{remark}
  Sous des conditions assez générales qui seront toujours vérifiées dans ce cours, tout problème de Cauchy admet une et une seule solution.
\end{remark}
Pour passer de la solution générale d'une équation différentielle de premier ordre \`a une solution particulière il faut choisir une valeur du paramètre. Comme il y a un seul paramètre une seule condition (la trajectoire de la solution doit passer par un point fixe du plan) peut suffire. Pour une équation différentielle de second ordre comme \eqref{ed_generale_second_ordre}, nous aurons besoin de plus de conditions. Sans rentrer dans les détails, nous allons constater ce fait dans l'exemple suivant.

\begin{example}
  La solution générale de l'équation
    \begin{equation}\label{eq_expcompl}
      y'' = -y,
    \end{equation}
    est \(\mathcal{Y}= \{C_1\cos(x) + C_2\sin(x) \, :\, C_1,\, C_2\in\eR\}\). Remarquez que l'équation est du second ordre et que sa solution générale est une famille d'équations \`a deux paramètres réels. Ce sera toujours les cas pour les équations abordées dans la section~\ref{Secordredeux}.
    Pour déterminer une solution particulière de \eqref{eq_expcompl} il faut fixer les valeurs des deux paramètres et donc, en général, il sera nécessaire de donner deux conditions.
\end{example}

    \begin{remark}
      Une condition comme \(y(0)=4\) nous dit que la constante $C_1 = 4$ mais elle ne nous permet pas de trouver $C_2$. Il y a donc une infinité de solutions de \eqref{eq_expcompl} qui satisfont \`a la condition \(y(0)=4\).
    \end{remark}

On peut fixer les deux conditions de deux manières différentes.
\begin{enumerate}
\item{Problème  de Cauchy :} on fixe une terne de valeurs réels \(\bar x, \bar y, \bar y'\) et on cherche la solution telle que \(y(\bar x) = \bar y\), \(y'(\bar x) = \bar y'\).

  \begin{example}
    Les conditions \(y(0)=4\), \(y'(0)=15\) permettent de trouver la solution \(z(x) = 4\cos(x) + 15\sin(x)\).
  \end{example}
\item{Problème aux bords :} on fixe deux points dans le plan $x$-$y$, \(A=(\bar x, \bar y\)) et \(B=(\tilde x, \tilde y)\), et on cherche la solution dont la trajectoire passe par $A$ et $B$, c'est \`a dire, on impose \(y(\bar x) = \bar y\), \(y(\tilde x) = \tilde y\).

\begin{example}
    Les conditions \(y(0)=4\), \(y(\pi/2)=15\) permettent de trouver la solution \(z(x) = 4\cos(x) + 15\sin(x)\).
  \end{example}
\end{enumerate}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Premier ordre, variables séparables}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Pour certaines équations différentielles la recherche d'une solution particulière se réduit à une recherche de primitive moyennant un changement de variables.
\begin{definition}[Équation différentielle du premier ordre \`a variables separables]
Une  \defe{équation différentielle du premier ordre à variables séparables}{équation différentielle!variables séparables} est une équation qui, pour tout les \(x\) dans un intervalle donné, \(I\), peut se mettre sous la forme
\begin{equation}\label{eq_var_sep}
  f(y)y' = g(x),
\end{equation}
o\`u \(f\) et \(g\) sont deux fonctions de \(\eR\) dans \(\eR\).
\end{definition}
Nous pouvons intégrer les deux côtés de l'égalité par rapport à \(x\) et obtenir
\[
  \int f(y(x))y'(x)\, dx = G(x)+C,
\]
o\`u $G$ est une primitive de $g$ et $C$ une constante réelle. Il est facile \`a ce point d'effectuer une changement de variable dans le membre de gauche de l'équation en posant (sans surprise) \(y= y(x)\) et donc \(y'(x)\,dx = dy\).
\[
  \int f(y(x))y'(x)\, dx =  \int f(y)\, dy  = F(y(x)) + C ,
\]
o\`u $F$ est une primitive de $f$ et $C$ une constante réelle. En somme nous avons
\[
  F(y(x)) = G(x) + C ,
\]
et, si $F$ admet une fonction réciproque, alors
\begin{equation}
  y(x) = F^{-1} (G(x)+C).
\end{equation}
\begin{remark}
  L'expression de $F^{-1} $ peut être difficile à calculer. Il sera alors préférable de garder $y$ dans la forme implicite.
\end{remark}

\begin{example}
  L'équation
  \begin{equation}\label{ex_un_var_sep}
    3y^2 y' = x, \qquad\text{pour tout } x\in\eR,
  \end{equation}
est une équation à variables séparables. Pour reprendre les notations du début du chapitre, ici \(f(y) = 3y^2\) et \(g(x) = x\). En intégrant de deux côtés on trouve
\[
y^3 = \frac{x^2}{2} + C .
\]
La fonction $F(y) = y^3$ est une bijection de $\eR$ dans $\eR$, donc nous pouvons écrire la solution générale de l'équation \eqref{ex_un_var_sep} dans la forme
\[
\mathcal{Y} =\left\{ \left(\frac{x^2}{2} + C \right)^{1/3} \:\text{tel que } C\in\eR\right\}.
\]
\end{example}

\begin{example}
  En intégrant de deux côtés l'équation à variables séparables
  \begin{equation}
    2y y' = x, \text{pour tout } x\in\eR,
  \end{equation}
  on trouve
  \[
  y^2 = \frac{x^2}{2} + C .
  \]
La fonction $F(y) = y^2$ est \emph{n'est pas inversible} sur tout $\eR$, et on sait que \(\sqrt{y^2} = |y|\).  Au moment de rendre $y$ explicite on doit choisir entre
\[
y = \left(\frac{x^2}{2} + C \right)^{1/2}\qquad \text{ou}\qquad y = -\left(\frac{x^2}{2} + C \right)^{1/2} .
\]
Ce choix se fait suivant la condition initiale, si elle est donnée. S'il n'y a pas de condition initiale nous pouvons écrire que la solution générale est l'ensemble
\[
\mathcal{Y} =\left\{ y \,:\, \eR \to \eR\:\text{tels que }  y^2 = \frac{x^2}{2} + C \:\text{et } C\in\eR\right\}.
\]
\end{example}

\begin{example}
  On considère le problème de Cauchy
  \begin{equation}
    \begin{cases}
      e^y y' = \frac{1}{x+3}, \quad x\in ]-\infty, -3[,\\
      y(-4) = 0.
    \end{cases}
  \end{equation}
En intégrant des deux côtés nous trouvons
\[
e^y = \ln(|x+3|) +C.
\]
Nous pouvons alors imposer la condition initiale et obtenir $e^{0} =\ln(|-4+3|) +C $, c'est \`a dire $C = 1- \ln(1) = 1$.
\begin{remark}
  L'énoncé du problème de Cauchy dit que $x$ peut varier dans \(]-\infty, -3[\), mais nous voyons maintenant que la solution n'est pas définie sur toute la demi-droite, parce que $e^y$ est toujours positif  et $\ln(|x+3|) +1$ est positif seulement pour $x < -(1/e + 3)\approx -3,3679$.
\end{remark}
Donc la solution du problème de Cauchy est \(y(x) = \ln(|x+3|) +1\) pour tout $x\in ]-\infty, -(1/e +3)[$.
\end{example}

\begin{example}\label{exemple_eq_hom}
  \textbf{Attention, cet exemple est le plus important de la section !}

On considère l'équation à variables séparables
\begin{equation}    \label{EqYNXooFzYeZS}
  y' = \sin(x) y , \qquad x\in\eR.
\end{equation}
Dans ce cas, pour pouvoir écrire l'équation dans la forme \eqref{eq_var_sep} il faut pouvoir multiplier les deux c\^otés par $1/y$. Il faut donc éliminer tout de suite le cas o\`u $y = 0$.

Si $y= 0$ alors $y' =0$ et on a une solution constante (on dit souvent : une solution stationnaire) de l'équation. Par ailleurs les trajectoires des solutions ne peuvent pas se croiser; donc si \( y_G\) est une solution non nulle de l'équation \eqref{EqYNXooFzYeZS} alors \( y_G(x)\neq 0\) pour tout \( x\)\footnote{Ça vaut la peine de prendre un peu de temps pour bien comprendre cela.}. Il n'y a donc aucun danger à diviser par \( y\) dans la recherche d'une solution non identiquement nulle.

Supposons maintenant que $y\neq 0$ et écrivons $y'/y = \sin(x)$. En intégrant des deux côtés on trouve
\[
  \ln(|y|) =- \cos(x) +C,
\]
d'où
\[
|y| = e^{- \cos(x) +C}= e^{C}e^{- \cos(x)}.
\]
Si on avait impose une condition initiale alors on pourrait déterminer une solution particulière de l'équation en choisissant une valeur de la constante $C$. Nous pouvons observer cependant que la fonction exponentielle est bijective de $\eR$ dans $\eR^{+,\star}$ et par conséquent il n'y a pas de perte de généralité en disant que la solution générale de l'équation est
\begin{equation*}
  \mathcal{Y} = \left\{ y \,:\, |y| = Ke^{- \cos(x)}, \:\text{pour } K\in\eR^{+,\star}\right\}\cup\{y\equiv 0\}.
\end{equation*}
Il n'empêche qu'il serait plus élégant d'écrire la solution générale de l'équation sous une forme plus explicite, sans valeur absolue. Nous pouvons le faire en nous nous rappelant que
\begin{equation*}
 |x| =  \begin{cases}
    x & \quad\text{si } x \geq 0 ,\\
    -x & \quad\text{si } x <0 ,
  \end{cases}
\end{equation*}
Il suffit alors d'autoriser $K$ dans $\eR^{\star}$ pour éliminer la valeur absolue.

Pour écrire la solution générale de façon encore plus compacte nous observons que si $K=0$ alors $y \equiv 0$, c'est \`a dire, on retrouve la solution constante nulle.

Finalement, la solution générale de cette équation sera toujours écrite sous la forme suivante
\begin{equation}
  \mathcal{Y} = \left\{ y = Ke^{- \cos(x)}, \:\text{pour } K\in\eR\right\}.
\end{equation}
\end{example}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Équations différentielles linéaires du premier ordre}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{definition}[Équation différentielle linéaire du premier ordre]
Soit $I\subset\eR$ un intervalle .

Une  \defe{équation différentielle linéaire du premier ordre}{équation différentielle!linéaire du premier ordre} est une équation différentielle de la forme
\begin{equation}\label{eq_lin_ordre_un}
  a(x)y' + b(x) y = c(x), \quad\text{pour } x\in I,
\end{equation}
o\`u $a$, $b$, $c$ sont des fonctions de $\eR$ dans $\eR$ et $a\neq 0$ pour tout $x\in I$ .

On dit que $a$, $b$, $c$ sont les coefficients de l'équation \eqref{eq_lin_ordre_un}.
\end{definition}
\begin{remark}\label{remarque_lineaire}
  Une fonction $f: \eR\to\eR$ est dite \emph{linéaire} si pour tout $x_1$, $x_2$ dans $\eR$ et pour tout couple de constantes $\lambda$ et $\mu$ on a
  \begin{equation}\label{eq_linearite}
    f(\lambda x_1 + \mu x_2) = \lambda f(x_1) +\mu f (x_2).
  \end{equation}
Ces équations différentielles sont dites linéaires parce que la partie de l'équation qui contient $y$ (le membre de gauche) satisfait la propriété \eqref{eq_linearite} par rapport à $y$. En effet par les propriétés de la dérivée nous avons que
\[
 a(x)(\lambda y_1 + \mu y_2 )' + b(x) (\lambda y_1 + \mu y_2 ) =\lambda ( a(x)y'_1 + b(x) y_1 ) + \mu( a(x)y'_2 + b(x) y_2 ).
\]
\end{remark}
\begin{definition}
  L'équation \eqref{eq_lin_ordre_un} est dite \defe{homogène}{équation différentielle!linéaire du premier ordre, homogène} quand $c$ est la fonction nulle.
Si \eqref{eq_lin_ordre_un} n'est pas homogène on dit que l'équation
\begin{equation}\label{eq_lin_ordre_un_hom}
  a(x)y' + b(x) y =0,
\end{equation}
est son \defe{équation homogène associée}{équation homogène associée}.
\end{definition}
Toute équation linéaire du premier ordre homogène est une équation du premier ordre à variables séparables, comme nous en avons vu l'exemple \ref{exemple_eq_hom}. Nous n'allons pas répéter les détails du procédé pour trouver sa solution générale, qui aura la forme suivante
\begin{Aretenir}
  \begin{equation}\label{solgeneqlinordre1}
    \mathcal{Y}_h=\left\{Ke^{-\int\frac{b(x)}{a(x)}\, dx}\,:\, K\in\eR\right\}.
  \end{equation}
\end{Aretenir}
\begin{proposition}
  \begin{enumerate}
  \item Soit $y_p$ une solution particulière de l'équation \eqref{eq_lin_ordre_un} et $y_h$ une solution particulière de l'équation homogène associé \eqref{eq_lin_ordre_un_hom}. Alors la fonction somme $z= y_p+y_h$ est encore une solution particulière de l'équation \eqref{eq_lin_ordre_un}.
  \item Soient $y_1$ et $y_2$ deux solutions particulières de \eqref{eq_lin_ordre_un}. Alors la fonction différence $w = y_1-y_2$ est un solution particulière de \eqref{eq_lin_ordre_un_hom}.
  \end{enumerate}
\end{proposition}
\begin{proof}
  \begin{enumerate}
  \item
    \begin{equation}
      a(x)\left(y_p+y_h\right)' + b(x)\left(y_p+y_h\right)-c(x)  =\left( a(x)y'_p+ b(x)y_p-c(x)\right) + \left( a(x)y'_h+ b(x)y_h\right) = 0.
    \end{equation}
  \item
    \begin{equation}
      a(x)\left(y_1-y_2\right)' + b(x)\left(y_1-y_2\right) =\left( a(x)y'_1+ b(x)y_1-c(x)\right) -\left( a(x)y'_2+ b(x)y_2-c(x)\right) = 0.
    \end{equation}
  \end{enumerate}
\end{proof}
Cette proposition permet de démontrer le théorème suivant, qui est le plus important de cette section.
\begin{theorem}
  Soit $y_p$ une solution particulière de l'équation \eqref{eq_lin_ordre_un} et $\mathcal{Y}_h$ la solution générale de l'équation \eqref{eq_lin_ordre_un_hom}, alors la solution générale de l'équation \eqref{eq_lin_ordre_un} est l'ensemble
  \begin{equation}
    \mathcal{Y} = \mathcal{Y}_h +y_p = \left\{z= y_h + y_p\,:\, y=h \in\mathcal{Y}_h \right\}.
  \end{equation}
\end{theorem}
\begin{Aretenir}
  La résolution d'une équation différentielle linéaire du premier ordre comporte trois étapes :
  \begin{enumerate}
  \item résolution de l'équation homogène associée ;
  \item recherche d'une solution particulière de l'équation non homogène ;
  \item somme de la solution générale de l'équation homogène et de la solution particulière trouvée au point précédent.
  \end{enumerate}
\end{Aretenir}
La partie qui nous manque encore est de savoir comment trouver une solution particulière de l'équation non homogène \eqref{eq_lin_ordre_un}. Si la fonction $c$ dans \eqref{eq_lin_ordre_un} est une constante ou un polynôme simple, ou une exponentielle alors on peut essayer de deviner. Cette méthode cependant n'est pas la plus sure pour des débutants.

\begin{example}
  On considère l'équation
  \begin{equation}
    y'-5y = 10, \qquad x\in\eR.
  \end{equation}
Comme tous les coefficients de l'équation sont constants on peut essayer de trouver une solution constante.

Toutes les fonctions constantes ont une dérivée nulle, par conséquent, si une solution constante existe elle doit satisfaire $-5y = 10$, ce qui veut dire que la solution constante est $y(x)\equiv -2$.
\end{example}

\begin{example}
  On considère l'équation
  \begin{equation}
    xy'+y = x+1, \qquad x\in\eR^{+,\star}.
  \end{equation}
Comme le membre de droite de l'équation est un polynôme de degré un on cherche une solution de la forme $y(x) = Ax + B$ avec $A$ et $B$ dans $\eR$.

Par substitution on obtient $Ax + (Ax +B) = x+1$, c'est-à-dire que une solution particulière de l'équation est $y(x) = x/2+1$.
\end{example}

\begin{example}
   L'équation
  \begin{equation}
    xy'-y = x+1, \qquad x\in\eR^{+,\star}.
  \end{equation}
ressemble beaucoup à celle de l'exemple précédent, cependant il n'existe pas un polynôme de degré un qui en soit solution.

Dans un cas comme celui-ci, il faut rapidement abandonner la divination et replier sur la méthode, plus technique mais plus sure, dite  \emph{variation de la constante}.
\end{example}


\subsection{Méthode de variation de la constante}

\begin{itemize}
\item Soit $\mathcal{Y}_h$ la solution générale de l'équation homogène associé à \eqref{eq_lin_ordre_un}. Il s'agit d'une famille à un paramètre de fonctions. La première étape de cette méthode consiste à construire un candidat solution particulière $y_p$ en remplaçant le paramètre dans  $\mathcal{Y}_h$ par une fonction $C: \eR \to\eR$ à déterminer.

  \begin{example}
    L'équation homogène associée à $y'-y = \cos(x)$ est $y' - y = 0$, dont la solution générale est $\mathcal{Y}_h = \{Ce^x \,:\, C\in\eR\}$. Le candidat solution sera alors $y_p = C(x)e^x$, avec $C$ fonction à déterminer.
  \end{example}

 \item  La deuxième étape de cette méthode consiste à injecter $y_p$ dans l'équation. Cela permet de trouver une équation différentielle  à variables séparables pour $C$, en principe plus facile à résoudre que l'équation de départ.

  \begin{example}
    On continue avec l'exemple précédent. On a $y_p' = C'(x) e^x + C(x) e^x$, d'où
    \[
    (C'(x) e^x + C(x) e^x) - C(x) e^x = \cos(x),
    \]
    c'est-à-dire
    \[
    C'(x)  = \cos(x)e^{-x}.
    \]
  \end{example}
\item  La troisième étape de la méthode consiste à trouver une solution particulière de l'équation différentielle pour $C$ et, par conséquent déterminer une $y_p$.

  \begin{example}
    La solution générale de
    \[
    C'(x)  = \cos(x)e^{-x}.
    \]
    est $\mathcal{C} = \left\{e^{-1}\frac{(\sin(x)-\cos(x))}{2} +K \,:\, K\in\eR\right\}$. Il nous suffit une solution particulière, nous pouvons donc choisir $K=0$ et alors la solution particulière de \eqref{eq_lin_ordre_un} sera $y_p (x)= \frac{\sin(x)-\cos(x)}{2} $.
  \end{example}
\end{itemize}
\begin{remark}
  Le plus souvent en intégrant l'équation pour $C$ on en trouvera la solution générale. Dans ce cas on peut remplacer $C$ par cette solution générale et obtenir d'un seul coup la solution générale de l'équation \eqref{eq_lin_ordre_un} , c'est-à-dire sans faire la somme entre la solution générale de l'homogène associée et la solution particulière.

  \begin{example}
    Dans l'exemple qu'on vient de voir la solution générale de \eqref{eq_lin_ordre_un} est
    \begin{equation}
      \mathcal{Y} = \mathcal{Y}_h + y_p = \left\{Ce^x + \frac{(\sin(x)-\cos(x))}{2} \,:\, C\in\eR\right\}.
    \end{equation}
On obtient le m\^eme résultat est écrivant $\mathcal{Y} = \left\{e^{-x}\left(e^{-1}\frac{(\sin(x)-\cos(x))}{2} +K \right) \,:\, K\in\eR\right\}$. Notez qu'on a changé le nom du paramètre de $C$ à $K$ seulement pour souligner qu'on obtient de m\^eme résultat par deux chemins différents, sinon les deux expressions sont équivalentes !
  \end{example}
\end{remark}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Équations différentielles linéaires du second ordre}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\label{Secordredeux}

\begin{definition}[Équation différentielle linéaire du second ordre]
Une  \defe{équation différentielle linéaire du second ordre}{équation différentielle!linéaire du second ordre} est une équation différentielle de la forme
\begin{equation}\label{eq_lin_ordre_deux}
  a(x)y'' + b(x) y' + c(x)y = d(x), \quad\text{pour } x\in I,
\end{equation}
o\`u $a$, $b$, $c$ et $d$ sont des fonctions de $\eR$ dans $\eR$ et $a\neq 0$ pour tout $x\in I$ .

On dit que $a$, $b$, $c$ et $d$ sont les coefficients de l'équation \eqref{eq_lin_ordre_deux}.
\end{definition}
Dans ce cours nous allons étudier exclusivement le cas où $a$, $b$ et $c$ sont des fonctions constantes.
\begin{definition}[Équation différentielle linéaire du second ordre homogène]
Une  \defe{équation différentielle linéaire du second ordre homogène}{équation différentielle!linéaire du second ordre, homogène} est une équation différentielle de la forme \eqref{eq_lin_ordre_deux}, telle que le coefficient $d$ est nul.
\end{definition}
À toute équation de la forme \eqref{eq_lin_ordre_deux} on peut associer une équation homogène exactement comme on a fait dans la section précédente pour les équations linéaires du premier ordre.

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Équations différentielles linéaires du second ordre homogènes à coefficients constants}
%---------------------------------------------------------------------------------------------------------------------------

\begin{remark}
 L'application qui à la fonction $y$ fait correspondre $a(x)y'' + b(x) y' + c(x)y$ est linéaire, au sens de la remarque~\ref{remarque_lineaire}.

Cela nous dit en particulier, que si $y_1$ et $y_2$ sont deux solutions de l'équation homogène alors toute leur combinaison de la forme $z = \lambda y_1 + \mu y_2$, avec $\lambda$ et $\mu$ dans $\eR$, est encore une solution.
 \end{remark}

\begin{framed}
  Jusqu'ici nous avons toujours travaillé avec des fonctions définies sur $\eR$ et à valeurs dans $\eR$. Dans cette section nous nous autorisons à passer par des fonctions définies sur $\eR$ et à valeurs dans $\eC$, mais cela sera uniquement une étape dans nos calculs. Au final toutes les solutions que nous allons considérer sont des fonctions à valeurs dans $\eR$.
\end{framed}

La solution générale \textbf{à valeurs dans les complexes} d'une équation de ce type a la forme
\begin{equation}\label{sol_gen_ordre_deux_hom}
  \mathcal{Y}_h^\eC  = \left\{C_1 e^{r_1x} +C_2 e^{r_2x} \,:\, C_1,\, C_2 \in \eC, \: x\in I \right\},
\end{equation}
où $r_1$ et $r_2$ sont aussi des nombres complexes. Remarquez que la solution générale est une famille à deux paramètres. Il faut aussi observer que en tout cas l'intervalle $I$ dans lequel varie $x$ est un intervalle dans $\eR$, parce que $I$ est une des données du problème.

À partir de cette information nous pouvons, pour toute équation donnée, chercher la solution générale \textbf{complexe} par substitution. Il suffit de remplacer $y$ dans l'équation par $e^{rx}$ et chercher les valeurs de $r$ qui nous conviennent.

Si notre équation de départ est
\begin{equation}\label{eq_lin_ordre_deux_hom}
  ay'' + by' + cy = 0, \quad\text{pour } x\in I,
\end{equation}
alors la substitution nous donne
\[
e^{rx}\left(ar^2+br+c\right)=0.
\]
Il est connu que la fonction exponentielle ne prend pas la valeur $0$, par consequent ce qui s'annule est le polynôme de degré deux $ar^2+br+c$. Il est donc très facile de trouver les valeurs de $r$ qu'on pourra utiliser comme $r_1$ et $r_2$ dans la solution générale \textbf{complexe}.
\begin{description}
  \item[Si $b^2 - 4ac >0$ :] le polynôme admet deux solutions réelles et distinctes, $r_1$ et $r_2$ ;
  \item[Si $b^2 - 4ac <0$ :] le polynôme admet deux solutions complexes conjuguées, $r_1 = \alpha + i \beta$ et $r_2 = \alpha - i \beta$ ;
  \item[Si $b^2 - 4ac =0$ :] le polynôme admet une solution réelle double $r=r_1 = r_2$.
\end{description}
Il faut maintenant écrire la solution générale \textbf{réelle} de l'équation, qui est celle que nous intéresse vraiment. La façon de l'obtenir est différente dans les trois cas.
\begin{description}
  \item[Si $b^2 - 4ac >0$ :] la solution générale réelle a la m\^eme forme que la solution complexe, \eqref{sol_gen_ordre_deux_hom}, il suffit de prendre les paramètres $C_1$ et $C_2$ dans $\eR$ plut\^ot que dans $\eC$.
\begin{equation}\label{sol_gen_reelle_ordre_deux_hom}
  \mathcal{Y}_h  = \left\{C_1 e^{r_1x} +C_2 e^{r_2x} \,:\, C_1,\, C_2 \in \eR, \: x\in I\right\},
\end{equation}
  \item[Si $b^2 - 4ac <0$ :] le polynôme admet deux solutions complexes conjuguées, $r_1 = \alpha + i \beta$ et $r_2 = \alpha - i \beta$ ; Il faut alors utiliser les formules suivantes
    \begin{equation}
      \begin{array}{l}
        e^{\alpha + i \beta} =e^{\alpha}(\cos(\beta) + i \sin(\beta))\\
        e^{\alpha - i \beta} =e^{\alpha}(\cos(\beta) - i \sin(\beta)).
      \end{array}
    \end{equation}
    La somme $e^{r_1x} +e^{r_2x}$, où $x$ est dans $I\in\eR$, vaut
    \[
    e^{(\alpha + i \beta)x} + e^{(\alpha - i \beta)x}=e^{\alpha x}(\cos(\beta x) + i \sin(\beta x )) + e^{\alpha x}(\cos(\beta x) - i \sin(\beta x)) =2 e^{\alpha x}\cos(\beta x)
    \]
    et la différence $e^{r_1x} -e^{r_2x}$ vaut
    \[
    e^{(\alpha + i \beta)x} - e^{(\alpha - i \beta)x}=e^{\alpha x}(\cos(\beta x) + i \sin(\beta x )) - e^{\alpha x}(\cos(\beta x) - i \sin(\beta x)) =2 e^{\alpha x}\sin(\beta x).
    \]
    Par ces deux calculs élémentaires nous avons trouvé deux fonctions à valeurs dans $\eR$ qui n'ont pas de zéros en commun. Elles sont les génératrices de la famille des solutions réelles de l'équation différentielle (la solution générale)
    \begin{equation}\label{sol_gen_reelle_ordre_deux_hom_complconj}
      \mathcal{Y}_h  = \left\{ e^{\alpha x}\left(C_1\cos(\beta x) +C_2\sin(\beta x)\right)  \,:\, C_1,\, C_2 \in \eR, \: x\in I\right\},
    \end{equation}
  \item[Si $b^2 - 4ac =0$ :] le polynôme admet une solution réelle double $r=r_1 = r_2$. Dans ce cas la solution générale de l'équation est la famille
    \begin{equation}\label{sol_gen_reelle_ordre_deux_hom_doublerac}
      \mathcal{Y}_h  = \left\{(C_1  +C_2x) e^{r x} \,:\, C_1,\, C_2 \in \eR, \: x\in I\right\}.
    \end{equation}
    Pour justifier cette formule nous observons d'abord que toute fonction $x\mapsto Ce^{rx}$, pour $C\in\eR$ est une solution de l'équation différentielle (par construction). Ensuite nous utilisons la méthode de variation de la constante. On trouve rapidement que si une fonction de la forme $x\mapsto C(x)e^{rx}$ est une solution alors $C(x)$ est un polynôme de degré au plus 1, c'est-à-dire $C(x) = C_1 + C_2 x$ avec $C_1$ et $C_2$ dans $\eR$.
\end{description}

\subsection{Linéaires du second ordre à coefficients constants, non homogènes}

Nous ne présentons pas une méthode générale pour la résolution de ces équations. Comme dans le cas des équations différentielles linéaires du premier ordre non homogènes, la solution générale de \eqref{eq_lin_ordre_deux} est donnée par la somme d'une solution particulière et de la solution générale de l'équation homogène associée. La recherche d'une solution particulière est facilitée par le fait que les coefficients de \eqref{eq_lin_ordre_deux} sont supposés constants, c'est-à-dire que $a$, $b$ et $c$ sont des fonctions constantes. Il faut essayer de deviner la forme d'une solution particulière à partir de la forme du second membre de l'équation, la fonction $d$. Si $d$ est un polynôme il faut essayer avec un polynôme du même degré, si $d$ est une exponentielle, par exemple $d(x) = e^{5x}$, on pourra essayer avec un multiple de la m\^eme fonction exponentielle, dans l'exemple $f(x) = k e^{5x}$, avec $k$ à determiner. Si $d$ est une combinaison linéaire de sinus et cosinus, comme par exemple $12\cos(x) + 2\sin(x)$, on peut essayer avec $k_1\cos(x) + k_2\sin(x)$.

\begin{example}
  On considère l'équation différentielle
  \begin{equation}\label{exemple_non_hom}
    y'' + 12y' + 36 y = -192 e^{2x}, \quad x\in\eR.
  \end{equation}
  Son équation homogène associée est
\begin{equation}\label{exemple_hom_ass}
    y'' + 12y' + 36 y = 0,
  \end{equation}
dont le polynôme caractéristique est $r^2 + 12 r + 36$. Ce polynôme admet une racine double, qui est $-6$, par conséquent la solution générale de \eqref{exemple_hom_ass} est
\begin{equation*}
      \mathcal{Y}_h  = \left\{(C_1  +C_2x) e^{-6 x} \,:\, C_1,\, C_2 \in \eR, \: x\in \eR\right\}.
    \end{equation*}
Le membre de droite de \eqref{exemple_non_hom} est une fonction exponentielle, nous allons donc chercher une solution particulière de \eqref{exemple_non_hom} de la forme $f(x) = ke^{2x}$. Par substitution nous trouvons
\[
  ke^{2x}(4 + 12 \times 2 +36) = -192 e^{2x},
\]
ce qui veut dire que $k$ doit \^etre $-3$.

La solution générale de l'équation \eqref{exemple_non_hom} est donc
\begin{equation*}
      \mathcal{Y}  = \left\{(C_1  +C_2x) e^{-6 x} -3e^{2x} \,:\, C_1,\, C_2 \in \eR, \: x\in \eR\right\}.
    \end{equation*}
\end{example}

\begin{example}
  Nous allons résoudre l'équation
  \begin{equation}
    y'' + 12y' + 36 y = 12\cos(x) + 2\sin(x), \quad x\in\eR.
  \end{equation}

Cette équation a comme homogène associée l'équation \eqref{exemple_hom_ass}, comme dans l'exemple précédent. Il nous suffit donc de trouver une solution particulière de \eqref{exemple_non_hom}.

Nous pouvons essayer avec $f(x)= k_1\cos(x) + k_2\sin(x)$. Par substitution on trouve
\begin{equation*}
  \begin{aligned}
    -\left(k_1\cos(x) + k_2\sin(x)\right) & +12 \left(-k_1\sin(x) + k_2\cos(x)\right) + 36\left(k_1\cos(x) + k_2\sin(x)\right)\\
    &= 12\cos(x) + 2\sin(x)
  \end{aligned}
\end{equation*}

Cette équation doit \^etre satisfaite pour tout valeur de $x$, en particulier pour $x= 0$ et $x = \pi/2$. Cela revient à considère séparément les coefficients des fonctions sinus et cosinus. Il faut alors que $k_1$ et $k_2$ soient solutions du système
\begin{equation*}
  \begin{cases}
    -k_1 + 12 k_2 + 36 k_1& = 12, \\
    -k_2 - 12 k_1 + 36 k_2& = 2.
  \end{cases}
\end{equation*}
On trouve $k_1= 396/1369$ et $k_2 = 214/1369$, et la solution générale de notre équation est
\begin{equation*}
   \mathcal{Y}  = \left\{(C_1  +C_2x) e^{-6 x} +\frac{396}{1369}\cos(x) + \frac{214}{1369}\sin(x) \,:\, C_1,\, C_2 \in \eR, \: x\in \eR\right\}.
\end{equation*}
\end{example}

\begin{example}
   Nous allons résoudre l'équation
  \begin{equation}
    y'' + 12y' + 36 y = 10x^2+3, \quad x\in\eR.
  \end{equation}

Cette équation a comme homogène associée l'équation \eqref{exemple_hom_ass}, comme dans l'exemple précédent. Il nous suffit donc de trouver une solution particulière de \eqref{exemple_non_hom}.

Nous pouvons essayer avec $f(x)= k_1x^2+ k_2x + k_3$. Par substitution on trouve
\begin{equation*}
    \left(2k_1\right)  +12 \left(2k_1x+ k_2\right) + 36\left(k_1x^2+ k_2x + k_3\right)=  10x^2+3.
\end{equation*}

Pour trouver les bonnes valeurs des coefficients nous devons résoudre le système \begin{equation*}
  \begin{cases}
    36 k_1& = 10, \\
    24k_1 + 36 k_2& = 0,\\
    2k_1 + 12 k_2 + 36 k_3& = 3,
  \end{cases}
\end{equation*}
ce qui donne $k_1= 5/18$, $k_2 = -5/27$ et $k_3 = 7/54$. La solution générale de notre équation est
\begin{equation*}
   \mathcal{Y}  = \left\{(C_1  +C_2x) e^{-6 x} +\frac{5}{18}x^2 - \frac{5}{27}x + \frac{7}{54} \,:\, C_1,\, C_2 \in \eR, \: x\in \eR\right\}.
\end{equation*}
\end{example}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Fonction de Green}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Soit l'équation différentielle
\begin{subequations}
    \begin{numcases}{}
        y''(x)=g(x)\\
        y(0)=y(1)=0
    \end{numcases}
\end{subequations}
pour \( x\in\mathopen] 0 , 1 \mathclose[\) et où \( g\) est continue sur \( \mathopen] 0 , 1 \mathclose[\).

Nous définissons la fonction de Green
\begin{equation}
    G(x,t)=\begin{cases}
        t(x-1)    &   \text{si }  0\leq t\leq x\leq 1  \\
        x(t-1)    &    \text{si }0\leq x\leq t\leq 1,
    \end{cases}
\end{equation}
et nous allons montrer que
\begin{equation}        \label{EQooCOFDooERUIhe}
    y(x)=\int_0^1G(x,t)g(t)dt
\end{equation}
est l'unique solution.

\begin{subproof}
    \item[Unicité]

        Si \( y_1\) et \( y_2\) sont des solutions, alors \( y_1''=y_2''\) et donc \( y_1(x)=y_2(x)+ax+b\). Les conditions aux bords donnent alors \( 0=y_1(0)=y_2(0)+b=b\). D'où \( b=0\). En imposant \( y_1(1)=0\) nous trouvons alors immédiatement \( a=0\), ce qui donne \( y_1=y_2\).

    \item[Existence]

    Il est vite vérifié qu'avec \eqref{EQooCOFDooERUIhe} nous avons \( y(0)=y(1)=0\) parce que \( G(0,t)=G(1,t)=0\) pour tout \( t\). Nous fixons une valeur pour \( x\in \mathopen] 0 , 1 \mathclose[\) et nous découpons l'intégrale :
        \begin{equation}
            y(x)=\int_0^xG(x,t)g(t)dt+\int_x^1G(x,t)g(t)dt.
        \end{equation}
        Pour calculer \( y'(x)\), il faut dériver à la fois à travers l'intégrale et dans la borne. Si vous connaissez une formule pour faire cela, c'est bien pour vous. Nous allons faire ça à la main et poser
        \begin{equation}
            I(x,y)=\int_0^yt(x-1)g(t)dt.
        \end{equation}
        La dérivation de \( I\) par rapport à \( x\) se fait en utilisant le théorème~\ref{PropDerrSSIntegraleDSD} :
        \begin{equation}
            \frac{ \partial I }{ \partial x }(x,y)=\int_0^ytg(t)dt.
        \end{equation}
        Pour la dérivation par rapport à \( y\), il s'agit du théorème fondamental de l'analyse, plus précisément le lien primitive et intégrale de la proposition~\ref{PropEZFRsMj} :
        \begin{equation}
            \frac{ \partial I }{ \partial y }(x,y)=y(x-1)g(y).
        \end{equation}
        Maintenant nous considérons la fonction \( \varphi_I(x)=I(x,x)\). Elle satisfait à
        \begin{equation}
            \varphi_I'(x)=\frac{ \partial I }{ \partial x }(x,x)+\frac{ \partial I }{ \partial y }(x,x)=\int_0^xtg(t)+x(x-1)g(x).
        \end{equation}
        Le même jeu avec \( J(x,y)=\int_y^1x(t-1)g(t)dt\) donne
        \begin{equation}
                \varphi_J'(x)=\int_0^xfg(t)dt+x(x-1)g(x).
        \end{equation}
        En remettant les bouts ensemble,
        \begin{equation}
            y(x)=\int_0^xtg(t)dt+\int_1^x(1-t)g(t)dt.
        \end{equation}
        Le calcul de la dérivée seconde donne alors
        \begin{equation}
            y''(x)=xg(x)+(1-x)g(x)=g(x).
        \end{equation}
\end{subproof}

Nous pouvons aussi, sur cette équation, estimer la variation de la solution en termes d'une variation de \( g\). Soit donc une fonction continue \( \delta_g\) sur \( \mathopen[ 0 , 1 \mathclose]\) et \( \tilde g=g+\delta_g\). Nous considérons l'équation différentielle
\begin{subequations}
    \begin{numcases}{}
        \tilde y''(x)=\tilde g(x)\\
        \tilde y(0)=\tilde y(1)=0.
    \end{numcases}
\end{subequations}
Par ce que nous venons de faire, l'unique solution est
\begin{equation}
    \tilde y(x)=\int_0^1G(x,t)\tilde g(t)dt=\int_0^1G(x,t)g(t)dt+\int_0^1G(x,t)\delta_g(t)dt=y(x)+\delta_y(x)
\end{equation}
où \( \delta_y\) est une fonction continue ainsi définie :
\begin{equation}
    \delta_y(x)=\int_0^1G(x,t)\delta_g(t)dt.
\end{equation}

Supposons que \( \| \delta_g \|_{\infty}=\epsilon\). Alors des majorations donnent
\begin{equation}        \label{EQooRJZPooCSlUGi}
    | \delta_y(x) |\leq \epsilon\int_0^1| G(x,t) |dt=\epsilon(1-x)\int_0^xtdt+\epsilon x\int_x^1(1-t)dt=\frac{ \epsilon }{2}x(1-x).
\end{equation}
Mais la fonction \( x\mapsto x(1-x)\) a son maximum en \( x=\frac{ 1 }{2}\), donc nous pouvons donner une majoration indépendante de \( x\):
\begin{equation}        \label{EQooTWQHooUPYRuc}
    \| \delta_y \|_{\infty}\leq \frac{1}{ 8 }\| \delta_g \|_{\infty}.
\end{equation}
Notons que la majoration \eqref{EQooTWQHooUPYRuc} en norme uniforme a l'air plus impressionnante, mais la majoration \eqref{EQooRJZPooCSlUGi} donnant une majoration séparée pour chaque \( x\) est en réalité plus précise.
