% This is part of Mes notes de mathématique
% Copyright (c) 2011-2025
%   Laurent Claessens, Carlotta Donadello
% See the file fdl-1.3.txt for copying conditions.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Propriétés de l'intégrale de Lebesgue}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Un lemme qui a l'air de rien, mais qui au final est souvent utilisé; tellement qu'on l'oublie un peu.
\begin{lemma}[\cite{MonCerveau}]       \label{LEMooWKSWooPptdEm}
	Soit un compact \( K\) de \( \eR\) et une fonction continue \( f\colon \eR\to \eR\). Alors l'intégrale
	\begin{equation}
		\int_Kf
	\end{equation}
	existe et est finie.
\end{lemma}

\begin{proof}
	Vu que \( f\) est continue sur le compact \( K\), elle y atteint une borne supérieure\footnote{Nous ne nous lasserons jamais de citer le théorème de Weierstrass \ref{ThoWeirstrassRn}.} que nous nommons \( M\).

	Soit \( R\) tel que \( B(0,R)\) contienne \( K\). La fonction \( (M+1)\mtu_{B(0,R)}\) majore strictement \( f\) sur le mesurable \( B(0,R)\). L'ensemble sur lequel nous prenons le supremum dans la définition \eqref{EqDefintYfdmu} de l'intégrale de \( f\) est majoré par le nombre fini \( (M+1)\mu(K)\). Le supremum existe et est fini (proposition \ref{DefSupeA}).
\end{proof}

Le lemme suivant est la contrepartie du côté des intégrales de l'invariance par translation de la mesure de Lebesgue démontrée dans le théorème \ref{THOooTMWHooThsDHj}.
\begin{lemma}[Invariance par translation]       \label{LEMooGKOGooPLYaUO}
	Soient \( f\) intégrable sur \( \eR^d\) et \( a\in \eR^d\). Alors en posant
	\begin{equation}
		\begin{aligned}
			g\colon \eR^d & \to \eC        \\
			x             & \mapsto f(x+a)
		\end{aligned}
	\end{equation}
	nous avons
	\begin{equation}
		\int_{\eR^d}fd\lambda = \int_{\eR^d}gd\lambda.
	\end{equation}
	Nous pouvons aussi écrire
	\begin{equation}
		\int_{\eR^d}f(x+a)d\lambda(x)=\int_{\eR^d}f(x)d\lambda(x).
	\end{equation}
\end{lemma}

\begin{proof}
	En plusieurs parties, en suivant les niveaux de généralité de la définition \ref{DefTVOooleEst} et \ref{NORMooRDHAooKRniYt}.
	\begin{subproof}
		\spitem[Si \( f\) est étagée et positive]
		%-----------------------------------------------------------
		Nous supposons que \(f \colon \eR^n\to \mathopen[ 0,\omega\mathclose[  \) est étagée. Nous notons \( \sum_i\alpha_i\mtu_{A_i}\) sa forme canonique. La fonction \( g\) est également étagée et sa forme canonique est \( g=\sum_i\alpha_i\mtu_{B_i}\) où \( B_i=A_i-a\). Nous avons alors
		\begin{equation}
			\int_{\eR^n}g=\sum_i\alpha_i\lambda(B_i)=\sum_i\alpha_i\lambda(A_i)=\int_{\eR^n}f
		\end{equation}
		parce que le théorème \ref{THOooTMWHooThsDHj} dit que \( \lambda(A_i)=\lambda(B_i)\).

		\spitem[Si \( f\) est mesurable à valeurs positives]
		%-----------------------------------------------------------
		Nous posons
		\begin{equation}
			E=\{  \psi\text{ étagée finie telle que }  0\leq\psi\leq f \}
		\end{equation}
		et
		\begin{equation}
			F=\{  \psi\text{ étagée finie telle que }  0\leq\psi\leq g \}
		\end{equation}
		L'application
		\begin{equation}
			\begin{aligned}
				s\colon E & \to F                                  \\
				\psi      & \mapsto \big[ x\mapsto \psi(x-a) \big]
			\end{aligned}
		\end{equation}
		est une bijection et par la première partie nous avons \( \int_{\eR^n}s(\psi)=\int_{\eR^n}\psi\). Donc
		\begin{subequations}
			\begin{align}
				\int_{\eR^n}f & =\sup\{ \int\psi\tq\psi\in E \}          \\
				              & =\sup\{  \int_{\eR^n}\psi\tq \psi\in F\} \\
				              & =\int_{\eR^n}g.
			\end{align}
		\end{subequations}

		\spitem[Si \( f\) est à valeurs dans \( \eR\)]
		%-----------------------------------------------------------
		Alors en posant \( f=f^++f^-\) et \( g=g^++g^-\), nous avons \( \int_{\eR^n}f^+=\int_{\eR^n}g^+\) et \( \int_{\eR^n}f^-=\int_{\eR^n}g^-\).
	\end{subproof}
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Quelques limites dans les bornes}
%---------------------------------------------------------------------------------------------------------------------------

\begin{normaltext}
	Si vous voulez savoir que \( \lim_{h\to 0}\int_a^{a+h}f=0\), c'est le corolaire \ref{CORooSGMXooCNfGNk}. La proposition \ref{PROPooPTZRooCBkZvr} est plus générale et dit que dans \( L^p\), il existe \( \delta\) tel que si \( \mu(A)<\delta\), alors \( \int_A| f |^p<\epsilon\).
\end{normaltext}

Dans le cas de l'intégrale de Lebesgue définie par \ref{DefTVOooleEst}, si \( f\) est une fonction sur \( \eR\) et si \( \lambda\) est la mesure de Lebesgue, nous avons une définition directe de
\begin{equation}
	\int_{0}^{\infty}fd\lambda.
\end{equation}
Nous sommes cependant en droit de nous demander si nous n'aurions pas également ceci :
\begin{equation}        \label{EQooDVKKooCiFzmA}
	\lim_{x\to \infty} \int_0^xf\lambda=\int_0^{\infty}fd\lambda.
\end{equation}
Lorsque l'intégrale considérée est celle de Riemann, l'égalité \eqref{EQooDVKKooCiFzmA} est une définition. Ici, ça va être une propriété, voir le lemme \ref{LEMooKGZDooWiKiHR}.

\begin{normaltext}
	Tant que nous sommes à parler de limites dans les bornes, nous aurions pu vouloir, pour les séries, suivre le chemin suivant :
	\begin{itemize}
		\item Définir l'intégrale de Lebesgue sur un espace mesuré.
		\item Prendre au passage le cas particulier \( \sum_{k=0}^{\infty}a_k=\int_\eN a\) où \( a\colon \eN\to \eR\) est une fonction mesurable pour la mesure de comptage.
		\item Démontrer qu'avec ces définitions, \( \sum_{k=0}^{\infty}a_k=\lim_{N\to \infty} \sum_{k=0}^Na_k\).
	\end{itemize}
	Or le dernier point est pris comme définition et son égalité avec l'intégrale pour la mesure de comptage est une propriété\footnote{Proposition \ref{PROPooPNQAooDRLcCm}.}. Pourquoi ? Parce que la définition \ref{DefBTsgznn} de mesure positive demande déjà d'avoir défini les sommes sur \( \eN\).
\end{normaltext}

\begin{lemma}		\label{LEMooOPKLooGucWjb}
	Soit une partie mesurable \( A\subset \eR^+\) de mesure finie. Alors
	\begin{equation}
		\lim_{M\to \infty} \lambda\big( A\cap\mathopen[ M , \infty \mathclose[ \big)=0.
	\end{equation}
\end{lemma}

\begin{proof}
	La fonction
	\begin{equation}
		\begin{aligned}
			f\colon \eR^+ & \to \eR^+                                                                     \\
			x             & \mapsto \lambda\big( A\cap\mathopen\lbrack x , \infty \mathclose\lbrack \big)
		\end{aligned}
	\end{equation}
	est décroissante et bornée vers le bas par \( 0\). Elle possède dont une limite \( \ell\geq 0\) (corolaire \ref{CorFHbMqGGyi}). Nous allons prouver que \( \ell=0\) en calculant la limite sur les entiers.

	Nous posons \( J_k=\mathopen[ k , k+1 \mathclose[\). Pour \( n\in \eN\) nous avons :
	\begin{subequations}
		\begin{align}
			f(n) & =\lambda\big( A\cap\mathopen\lbrack n , \infty \mathclose\lbrack \big) \\
			     & =\lambda\big( \bigcup_{k=n}^{\infty}(A\cap J_k) \big)                  \\
			     & =\sum_{k=n}^{\infty}\lambda(A\cap J_k).
		\end{align}
	\end{subequations}

	Mais nous savons par hypothèse sur la mesure de \( A\) que
	\begin{equation}
		\lambda(A)=\sum_{k=0}^{\infty}\lambda(A\cap J_k)<\infty.
	\end{equation}
	Donc \( f(n)\) est une queue de série convergente. Elle tend donc vers zéro par le lemme \ref{LEMooFUCOooCOqLRj}. C'est-à-dire que
	\begin{equation}
		\lim_{n\to \infty} f(n)=0.
	\end{equation}
	Et comme \( \lim_{x\to \infty}f(x) \) existe et vaut \( \ell\), la seule possibilité est \( \ell=0\).
\end{proof}

\begin{lemma}       \label{LEMooMUHWooZPbMDb}
	Soit une fonction mesurable \( f\colon \eR\to \eR^+\). Alors
	\begin{equation}
		\lim_{x\to \infty} \int_x^{\infty}fd\lambda=0.
	\end{equation}
\end{lemma}

\begin{proof}
	Nous posons
	\begin{equation}
		F(x)= \int_x^{\infty}fd\lambda.
	\end{equation}
	Nous commençons par prouver que c'est une fonction décroissante. En effet,
	\begin{equation}
		F(x)-F(x+a)=\int_{x}^{\infty}f-\int_{x+a}^{\infty}f=\int_{x}^{x+a}f+\int_{x+a}^{\infty}f-\int_{x+a}^{\infty}=\int_x^{x+a}f\geq 0.
	\end{equation}
	Nous avons utilisé \ref{PropOPSCooVpzaBt}.

	Vu que \( f\) prend ses valeurs dans \( \eR^+\), nous avons \( F(x)\geq 0\) pour tout \( x\). La fonction \( F\) est décroissante et bornée vers le bas. Donc elle a une limite :
	\begin{equation}
		\lim_{x\to \infty} F(x)=\ell\geq 0.
	\end{equation}

	Supposons \( \ell >0\) et posons \( 0<\epsilon<\ell\). Soit \( M\) tel que pour tout \( x>M\) nous ayons
	\begin{equation}        \label{EQooZVKQooQDxHXp}
		\int_x^{\infty}f>m.
	\end{equation}
	Soit \( a\in \eR^+\) tel que
	\begin{equation}
		| \int_a^{\infty}f(t)-\ell\,dt |<\epsilon.
	\end{equation}
	En vertu de \eqref{EQooZVKQooQDxHXp} nous considérons \( a_0>a\) tel que
	\begin{equation}
		\int_{a_0}^{\infty}f=I_0>m.
	\end{equation}
	Nous construisons la suite strictement croissante \( (a_k)\) de la façon suivante :
	\begin{equation}
		\int_{a_k}^{\infty}f=I_k>m
	\end{equation}
	et
	\begin{equation}
		| \int_{a_k}^{a_{k+1}}f-I_k |<\epsilon.
	\end{equation}
	Donc pour \( k\) nous avons
	\begin{equation}
		\int_{a_k}^{a_{k+1}}f\geq I_k-\epsilon\geq m-\epsilon.
	\end{equation}
	Mais
	\begin{equation}
		\int_{a_0}^{\infty}=\sum_{k=0}^{\infty}\int_{a_k}^{a_{k+1}}f\geq \sum_k(m-\epsilon)=\infty.
	\end{equation}
	Nous avons une contradiction.
\end{proof}

\begin{lemma}[\cite{MonCerveau}]        \label{LEMooKGZDooWiKiHR}
	Soit \( f\colon \eR\to \eR\) intégrable sur \( \mathopen[ a , \infty \mathclose]\) pour la mesure de Lebesgue. Alors la limite
	\begin{equation}
		\lim_{b\to \infty}\int_{\mathopen[ a , b \mathclose]}f
	\end{equation}
	existe et vaut
	\begin{equation}
		\lim_{b\to \infty}\int_{\mathopen[ a , b \mathclose]}f =\int_{\mathopen[ a , \infty \mathclose]}f.
	\end{equation}
	De même nous avons
	\begin{equation}		\label{EQooNRHDooVzAEFD}
		\lim_{a\to-\infty}\int_{\mathopen[ a,b\mathclose]}f=\int_{\mathopen] -\infty,b\mathclose]}f
	\end{equation}
\end{lemma}

\begin{proof}
	Vu qu'on a le droit de découper les domaines d'intégration en domaines disjoints, et que l'ajout d'un point ne change rien à la mesure de Lebesgue, nous avons pour tout \( b\in \mathopen[ a , \infty \mathclose[\) que
	\begin{equation}
		\int_{\mathopen[ a , \infty \mathclose]}f=\int_{\mathopen[ a , b \mathclose]}f+\int_{\mathopen[ b , \infty \mathclose]}f.
	\end{equation}
	Nous avons l'intention de prendre la limite \( b\to \infty\).  Le lemme \ref{LEMooMUHWooZPbMDb} nous assure que la limite de la dernière intégrale existe et vaut zéro. Donc la limite de l'intégrale du milieu existe et vaut celle à gauche.

	En ce qui concerne la formule \eqref{EQooNRHDooVzAEFD}, nous posons \( g(x)=f(-x)\), et nous considérons \( -a<b\). Et nous avons, en utilisant la première partie sur la fonction \( g\) :
	\begin{subequations}
		\begin{align}
			\lim_{a\to \infty}\int_{\mathopen[ -a,b\mathclose]}f & =\lim_{a\to \infty}\int_{\mathopen[ -b,a\mathclose]g} \\
			                                                     & =\int_{\mathopen[ -b,\infty\mathclose[}g              \\
			                                                     & =\int_{\mathopen] -\infty,b\mathclose]}f.
		\end{align}
	\end{subequations}
\end{proof}

\begin{proposition}[\cite{MonCerveau}]	\label{PROPooSBKEooOlxqRk}
	Soit une fonction \(f \colon \eR\to \eR  \) intégrable sur \( \eR\). Alors
	\begin{equation}
		\lim_{R\to \infty}\int_{-R}^Rf=\int_{\eR}f
	\end{equation}
	au sens où la limite de gauche existe et vaut celle de droite.
	%TODOooOSDBooRKjDCz. Prouver ça.
\end{proposition}


%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Mesure de comptage et série}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}[mesure de comptage]      \label{DEFooILJRooByDzhs}
	Soit \( (S,\tribF)\) un ensemble mesurable. La \defe{mesure de comptage}{mesure!de comptage} sur \( (S,\tribF)\) est la mesure définie par
	\begin{equation}
		m(A)=\begin{cases}
			\Card(A) & \text{si } A\text{ est fini} \\
			+\infty  & \text{sinon}.
		\end{cases}
	\end{equation}
\end{definition}
Cette mesure est utilisée pour voir des séries comme des intégrales sur \( (\eN,\partP(\eN),m)\).

\begin{lemma}       \label{LEMooDTFHooLVsvAw}
	Si \( m\) est la mesure de comptage sur \( \eN\) et si \( \partP(\eN)\) est l'ensemble des parties de \( \eN\), alors le triple \( \big( \eN,\partP(\eN), m \big)\) est un espace mesuré\footnote{Définition \ref{DefBTsgznn}.} \( \sigma\)-fini.

\end{lemma}

\begin{proof}
	Bien entendu l'ensemble des parties de \( \eN\) est une tribu sur \( \eN\). Nous devons donc seulement vérifier les conditions de la définition \ref{DefBTsgznn}.

	Si \( A\) est une partie de \( \eN\), alors \( m(A)\in \mathopen[ 0 , \infty \mathclose]\) parce que c'est soit le cardinal de \( A\) soit \( \infty\).

	Le cardinal de l'ensemble vide est zéro (ça fait partie de la définition du cardinal \ref{PROPooJLGKooDCcnWi}).

	Soient des parties deux à deux disjointes \( \{ A_i \}_{i\in I}\) de \( \eN\). Posons \( A=\bigcup_{i\in I}A_i\). Si \( I\) est infini dénombrable, alors l'union est infinie : prendre par exemple la partie \( S=\{ \min(A_i) \}_{i\in I}\) qui est en bijection avec \( I\). Nous avons alors d'une part
	\begin{equation}
		m\big( \bigcup_iA_i \big)\geq m(S)=\infty,
	\end{equation}
	et d'autre part
	\begin{equation}
		\sum_{i\in I}m(A_i)\geq \sum_{i\in I}1=\infty.
	\end{equation}

	Si par contre \( I\) est fini, alors le lemme \ref{LEMooVFPNooVmdUXY}\ref{ITEMooJDUUooVMvAOn} dit que
	\begin{equation}
		m\big( \bigcup_{i\in I}A_i \big)=\Card\big( \bigcup_{i\in I}A_i \big)=\sum_{i\in I}m(A_i).
	\end{equation}

	Le fait que notre espace soi \( \sigma\)-fini se voit par exemple en posant \( E_n=\{ 0,\ldots, n \}\). Chaque \( E_n\) est de mesure finie, et leur union est \( \bigcup_{n\in \eN}E_n=\eN\).
\end{proof}


\begin{proposition}[\cite{MonCerveau}]     \label{PROPooPNQAooDRLcCm}
	Soit l'espace mesuré \( \big( \eN,\partP(\eN), m \big)\)\footnote{La mesure de comptage sur \( \eN\) est donnée en la définition \ref{DEFooILJRooByDzhs}.}. Nous considérons une application \( a\colon \eN\to \eR^+\) (c'est-à-dire une suite de nombres réels positifs).

	\begin{enumerate}
		\item
		      L'intégrale \( \int_{\eN}a\,dm<\infty\)  si et seulement si la série aussi : \( \sum_{n=0}^{\infty}a_n<\infty\).
		\item
		      Si \( \int_{\eN}a\,dm\) existe, alors
		      \begin{equation}      \label{EQooFIRMooKOEsAn}
			      \int_{\eN}a\,dm=\sum_{n=0}^{\infty}a_n.
		      \end{equation}
	\end{enumerate}
\end{proposition}

\begin{proof}
	Nous allons travailler avec la définition \ref{DefTVOooleEst} de l'intégrale et \ref{DefBPCxdel} pour les fonctions étagées.

	\begin{subproof}
		\spitem[Si l'intégrale est \( <\infty\)]
		% -------------------------------------------------------------------------------------------- 
		Nous supposons que \( \int_{\eN}adm<\infty\). La proposition \ref{PROPooTFOAooJBwmCV} nous permet de découper \( \eN\) en parties disjointes. Nous choisissons de voir \( \eN=\bigcup_{i\in \eN}\{ i \}\) et donc de considérer l'égalité
		\begin{equation}
			\int_{\eN}adm=\sum_{i=0}^{\infty}\int_{\{ i \}}adm.
		\end{equation}
		Vu que \( m\big( \{ i \} \big)=1\) et que \( a\) est constante sur \( \{ i \}\), nous avons \( \int_{\{ i \}}adm=a_i\), et donc
		\begin{equation}
			\int_{\eN}adm=\sum_{i=0}^{\infty}a_i.
		\end{equation}
		\spitem[Si la somme est \( <\infty\)]
		% -------------------------------------------------------------------------------------------- 
		Le terme général \( a_n\) tend vers zéro\footnote{Proposition \ref{PROPooYDFUooTGnYQg}.}. En particulier, pour chaque \( r\in \eR\), il n'existe qu'un nombre fini d'éléments de la suite \( a\) plus grands que \( r\).

		Soit une fonction étagée \( \psi\colon \eN\to \eR^+\) minorant \( a\). Vu qu'elle est étagée, elle ne prend qu'un nombre fini de valeurs différentes que nous nommons \( \{ \alpha_i \}\), et les parties \( A_i=\psi^{-1}(\alpha_i)\) sont finies parce que \( \psi\) minore \( a\).

		Avant de faire un petit calcul, posons quelque notations. D'abord \( Z=\psi^{-1}(0)\). Nous avons \( \eN=\bigcup_{i}A_i \cup Z\). Nous posons aussi \( A=\bigcup_iA_i\); c'est le support de \( \psi\).

		Nous pouvons maintenant faire un calcul pour l'intégrale de \( \psi\) sur \( \eN\) :
		\begin{subequations}        \label{SUBEQSooPMCHooIdtHqG}
			\begin{align}
				\int_{\eN}\psi dm & =\sum_i\alpha_i\Card(A_i)                                                  & \text{def. \eqref{EqooGAFMooZLzjPs}} \\
				                  & =\sum_i\big( \sum_{k\in A_i}\psi(k)\big)       \label{SUBEQooIJMMooPKLHVk}                                        \\
				                  & =\sum_{k\in \bigcup_iA_i}\psi(k)           \label{SUBEQooGOBRooYhAufP}                                            \\
				                  & =\sum_{k\in A}\psi(k)+\sum_{k\in Z}\psi(k)                                                                        \\
				                  & =\sum_{k\in \eN}\psi(k).
			\end{align}
		\end{subequations}
		Justifications.
		\begin{itemize}
			\item Pour \eqref{SUBEQooIJMMooPKLHVk}. Pour tout \( k\) dans \( A_i\) nous avons \( \psi(k)=\alpha_i\).
			\item Pour \eqref{SUBEQooGOBRooYhAufP}. Les \( A_i\) sont disjoints et chacun est fini. La proposition \ref{PROPooJLQAooAEbIvZ} fait le boulot.
		\end{itemize}
		Étant donné que \( \psi\) minore \( a\), nous avons donc montré que
		\begin{equation}
			\int_{\eN}\psi dm=\sum_{k\in \eN}\psi(k)\leq\sum_{k\in \eN}a_n.
		\end{equation}
		Donc l'intégrale de toutes les fonctions étagées minorant \( a\) est majorée par la série de \( a\). Donc l'intégrale de \( a\) existe et est majorée par cette somme.

		\spitem[Valeur de l'intégrale]
		% -------------------------------------------------------------------------------------------- 
		Nous supposons encore que la série est finie. Nous avons déjà prouvé que
		\begin{equation}            \label{EQooNCMCooYMaASZ}
			\int_{\eN}adm\leq \sum_{n\in \eN}a_n.
		\end{equation}
		Nous allons prouver l'inégalité inverse en trouvant une bonne suite de fonctions étagées. Soit, pour chaque \( N\in \eN\),
		\begin{equation}
			\begin{aligned}
				\psi_N\colon \eN & \to \eR^+                        \\
				k                & \mapsto \begin{cases}
					                           a_k & \text{si } k\leq N \\
					                           0   & \text{sinon. }
				                           \end{cases}
			\end{aligned}
		\end{equation}
		Cela est une fonction étagée qui minore \( a\). Nous pouvons donc reprendre le calcul \eqref{SUBEQSooPMCHooIdtHqG} :
		\begin{equation}
			\int_{\eN}\psi dm=\sum_{k\in \eN}\psi_N(k)=\sum_{k=0}^Na_k.
		\end{equation}
		Par définition de la série, nous avons
		\begin{equation}
			\lim_{N\to \infty} \int_{\eN}\psi_N dm=\sum_{k=0}^{\infty}a_k.
		\end{equation}
		Donc le supremum des intégrales de fonctions étagées est au moins égal à \( \sum_{k=0}^{\infty}a_k\). Nous avons prouvé l'inégalité inverse de \eqref{EQooNCMCooYMaASZ}, et donc l'égalité \eqref{EQooFIRMooKOEsAn}.
	\end{subproof}
\end{proof}

\begin{example}     \label{EXooDMAUooWWVZbq}
	L'intervalle \( I=\mathopen[ 0 , 1 \mathclose]\) muni de la tribu de toutes ses parties et de la mesure de comptage est un espace mesuré non \( \sigma\)-fini.
\end{example}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Théorème de la moyenne}
%---------------------------------------------------------------------------------------------------------------------------

\begin{lemma}[\cite{MonCerveau}]        \label{LEMooOXNPooXpTxtx}
	Soit \( A\) connexe par arcs\footnote{Définition \ref{DEFooOXVCooBizpgK}.}, soit \( f\colon A\to \eR\) continue ainsi que \( \alpha,\beta\in f(A)\) avec \( \alpha<\beta\). Pour tout \( y\in \mathopen[ \alpha , \beta \mathclose]\), il existe \( x\in A\) tel que \( f(x)=y\).
\end{lemma}

\begin{proof}
	Soient \( a,b\in A\) avec \( f(a)=\alpha\) et \( f(b)=\beta\). Vu que \( A\) est connexe par arcs, il existe une application continue \( \gamma\colon \mathopen[ 0 , 1 \mathclose]\to A\) telle que \( \gamma(0)=a\) et \( \gamma(1)=b\). Le théorème des valeurs intermédiaires appliqué à la composée \( f\circ\gamma\) dit qu'il existe \( t_0\in \mathopen[ 0 , 1 \mathclose]\) tel que \( (f\circ \gamma)(t_0)=y\). Nous avons donc le résultat avec \( x=\gamma(t_0)\).
\end{proof}

\begin{theorem}[\cite{MonCerveau,BIBooRTZNooZBNRXG}]      \label{ThoooEZLGooMChwLT}
	Soit \( Q\) un compact connexe par arcs et une fonction continue \( f\colon Q\to \eR\). Si \( \lambda\) est la mesure de Lebesgue, alors il existe \( a\in Q\) tel que
	\begin{equation}
		f(a)=\frac{1}{ \lambda(Q) }\int_Qfd\lambda
	\end{equation}
\end{theorem}

\begin{proof}
	En posant \( I=\int_Qfd\lambda\) nous avons immédiatement
	\begin{equation}        \label{EqooTYQCooVxdazW}
		\min(f)\lambda(Q)\leq I\leq \max(f)\lambda(Q)
	\end{equation}
	où le minimum et le maximum existent parce que \( f\) est continue sur un compact. Si une des deux inégalités est une égalité alors la fonction est constante. En effet supposons que la première inégalité soit une égalité; si la fonction n'était pas constante, il existerait une boule sur laquelle \( f\) serait strictement supérieure à \( \min(f)\). En intégrant d'abord sur cette boule et ensuite sur le complémentaire nous obtenons une intégrale plus grande que \( \min(f)\lambda(Q)\).

	Vu que \( f\) est continue sur le compact \( Q\), il existe \( \alpha,\beta\in Q\) tels que \( f(\alpha)=\min(f)\) et \( f(\beta)=\max(f)\). Vu que \( \min(f)\leq I/\lambda(Q)\leq \max(f)\), le lemme \ref{LEMooOXNPooXpTxtx} montre qu'il existe \( a\in Q\) tel que \( f(a)=I/\lambda(Q)\). Autrement dit,
	\begin{equation}
		f(a)=\frac{1}{ \lambda(Q) }\int_Qfd\lambda.
	\end{equation}
\end{proof}




%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Changement de variables dans une intégrale multiple}
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Dans ce qui suit, \( U\) et \( V\) sont des ouverts de \( \eR^N\) et \( \phi\colon U\to V\) est un \( C^1\)-difféomorphisme. Nous notons \( \mQ\) l'ensemble des cubes fermés dans \( U\) dont les côtés sont parallèles aux axes.

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Des lemmes}
%---------------------------------------------------------------------------------------------------------------------------

\begin{lemma}[\cite{PMTIooJjAmWR}]      \label{LemooJYCGooIkkDVn}
	Soient \( \mu\) et \( \nu\) deux mesures de Borel sur l'ouvert \( U\) de \( \eR^N\). Si \( \mu(Q)\leq \nu(Q)\) pour tout \( Q\in \mQ\) alors \( \mu(B)\leq \nu(B)\) pour tout borélien \( B\).
\end{lemma}

\begin{proof}
	Si \( Q\) est un cube semi-ouvert, c'est-à-dire de la forme
	\begin{equation}
		Q=\prod_{n=1}^N\mathopen[ a_n , a_n+h \mathclose[\subset U
	\end{equation}
	alors \( Q\) est une réunion croissante de cubes fermés du type \( \mathopen[ a_n+\epsilon , a_n+h-\epsilon \mathclose]\), et donc \( \mu(Q)\leq \nu(Q)\) par le lemme~\ref{LemAZGByEs}\ref{ItemJWUooRXNPci}. La propriété est donc vraie pour les cubes semi-ouverts.

	Si \( \Omega\) est un ouvert, alors il est réunion disjointe dénombrable de cubes semi-ouverts par la proposition~\ref{PropSKXGooRFHQst}. Donc pour tout ouvert \( \Omega\subset U\) nous avons \( \mu(\Omega)\leq\nu(\Omega)\). En vertu de la proposition~\ref{PropNCASooBnbFrc} et de la remarque~\ref{RemooOAGCooRHpjxd}, les mesures \( \mu\) et \( \nu\) sont régulières, et l'inégalité au niveau des ouverts se répercute en inégalité pour tout boréliens de \( U\) :
	\begin{equation}
		\mu(B)\leq \nu(B)
	\end{equation}
	pour tout \( B\in\Borelien(U)\). Notons que \( U\) étant ouvert dans \( \eR^N\), les boréliens de \( U\) sont exactement les boréliens de \( \eR^N\) inclus dans \( U\) par le corolaire~\ref{CorooMJQYooFfwoTd}.
\end{proof}

\begin{lemma}[\cite{PMTIooJjAmWR}]      \label{LemooJCEDooBRyjRg}
	Soit une application \( \theta\colon U\to \eR^N\) de classe \( C^1\) où \( U\) est ouvert dans \( \eR^N\). Pour tout \( Q\in\mQ\) nous avons
	\begin{equation}
		\lambda_N\big( \theta(Q) \big)\leq\sup_{s\in Q}\| d\theta_s \|^N\lambda_N(Q).
	\end{equation}
\end{lemma}

\begin{proof}
	Nous notons \( h\) la longueur du côté du cube. Le théorème des accroissements finis~\ref{val_medio_2}, pour la composante \( \theta_i\) donne, pour \( u,v\in Q\) :
	\begin{equation}        \label{EqooFZMAooKWdzxJ}
		\big|  \theta_i(u)-\theta_i(v) \big|\leq\sup_{s\in Q}\| (d\theta_i)_s \|\| u-v \|\leq \sup_{s\in Q}\| (d\theta_i)_s \|h.
	\end{equation}
	D'autre part nous avons (nous écrivons pour \( N=2\) pour être plus court) :
	\begin{equation}
		d\theta_s(u)=\Dsdd{ \theta_1(s+tu)e_1+\theta_2(s+tu)e_2 }{t}{0}=(d\theta_1)_s(u)e_1+(d\theta_2)_s(u)e_2.
	\end{equation}
	Donc pour chaque \( i\) : \( \| d\theta_s \|\geq \| (d\theta_i)_s \|\), et nous continuons la majoration \eqref{EqooFZMAooKWdzxJ} :
	\begin{equation}
		\big|  \theta_i(u)-\theta_i(v) \big|\leq \sup_{s\in Q}\| (d\theta_i)_s \|h\leq \sup_{s\in Q}\| d\theta_s \|h.
	\end{equation}

	Les points \( \theta(u)\) et \( \theta(v)\) sont donc dans un cube de côté \( \sup_{s\in Q}\| d\theta_s \|h\), ce qui permet de majorer \( \lambda_N\big( \theta(Q) \big)\) par
	\begin{equation}
		\lambda_N\big( \theta(Q) \big)\leq \left( \sup_{s\in Q}\| d\theta_s \|h \right)^N=\left( \sup_{s\in Q}\| d\theta_s \| \right)^N\lambda_N(Q)
	\end{equation}
	où le dernier facteur provient de l'égalité \( h^N=\lambda_N(Q)\).
\end{proof}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Déterminant et mesure de Lebesgue}
%---------------------------------------------------------------------------------------------------------------------------

Dans la suite, \( Q_0\) désigne le cube unité : \( Q_0=\big( \mathopen[ 0 , 1 \mathclose[ \big)^N\).

\begin{theorem}[Interprétation géométrique du déterminant\cite{PMTIooJjAmWR}]    \label{ThoBVIJooMkifod}
	Soit une application linéaire \( T\colon \eR^N\to \eR^N\). Alors pour tout borélien \( B\) de \( \eR^N\),
	\begin{equation}
		\lambda_N\big( T(B) \big)=| \det(T) |\lambda_N(B).
	\end{equation}
\end{theorem}
\index{déterminant!interprétation géométrique}

\begin{proof}
	Nous considérons la mesure positive \( \mu\) donnée par \( \mu(B)=\lambda_N\big( T(B) \big)\), qui est bien une mesure par la proposition~\ref{PropJCJQooAdqrGA}. Cette mesure est invariante par translation parce que \( \lambda_N\) l'est :
	\begin{equation}
		\mu(B+a)=\lambda_N\big( T(B)+a \big)=\lambda_N\big( T(B) \big)=\mu(B).
	\end{equation}
	De plus, \( T(Q_0)\) est borné et nous notons \( \mu(Q_0)=C\). Nous avons \( \mu=C\lambda_N\) par le corolaire~\ref{CorKGMRooHWOQGP}.

	\begin{subproof}
		\spitem[\( C(T_1T_2)=C(T_1)C(T_2)\)]
		Par définition,
		\begin{subequations}
			\begin{align}
				C(T_1T_2)\lambda_N(B) & =\lambda_N\big( (T_1T_2)(B) \big)                                                           \\
				                      & =\lambda_N\big( T_1(T_2B) \big)=C(T_1)\lambda_N\big( T_2(B) \big)=C(T_1)C(T_2)\lambda_N(B).
			\end{align}
		\end{subequations}
		Par conséquent la fonction \( C\) est multiplicative :
		\begin{equation}
			C(T_1T_2)=C(T_1)C(T_2).
		\end{equation}
		Et en plus, \( C(\id)=1\).
		\spitem[Matrice diagonale]
		En guise de \( T\), nous considérons l'application linéaire diagonale donnée par \( De_i=d_ie_i\), ou, sous forme matricielle, \( D=\diag(d_1,\ldots, d_N)\) qui fait
		\begin{equation}
			T(Q_0)=\mathopen[ 0 , d_1 \mathclose[\times \ldots\times \mathopen[  0, d_N \mathclose[
		\end{equation}
		La mesure de cela est \( |d_1\cdots d_N|\), ce qui nous donne
		\begin{equation}
			C(D)=| d_1\ldots d_N |=| \det(D) |.
		\end{equation}
		\spitem[Matrice orthogonale]
		Nous considérons maintenant \( T=U\) où \( U\) est une matrice orthogonale (\( UU^t=1\)). Une matrice orthogonale est une isométrie\footnote{Proposition~\ref{PropKBCXooOuEZcS}.} qui conserve donc la boule unité : \( UB(0,1)=B(0,1)\). Nous avons
		\begin{equation}
			\lambda_N\big( B(0,1) \big)=\lambda_N\big( UB(0,1) \big)=C(U)\lambda_N\big( B(0,1) \big)
		\end{equation}
		par conséquent \( C(U)=1\), et \( 1\) est justement le déterminant de \( U\).
		\spitem[Matrice quelconque]
		Nous savons par le corolaire~\ref{CorAWYBooNCCQSf} de la décomposition polaire que toute matrice peut être écrite sous la forme \( T=U_1DU_2\) où \( U_i\) sont orthogonales et \( D\) est diagonale. Donc \( C(T)=C(U_1)C(D)C(U_2)=\det(U_1)\det(D)\det(U_2)=\det(U_2DU_2)=\det(T)\) parce que le déterminant est multiplicatif (proposition~\ref{PropYQNMooZjlYlA}\ref{ItemUPLNooYZMRJy}).
	\end{subproof}
\end{proof}

Ce théorème donne une interprétation géométrique du déterminant en tant que facteur de dilatation des volumes lors de l'utilisation d'une application linéaire. Si \( T\) est une application linéaire quelconque,
\begin{equation}
	\lambda_N\big( T(Q_0) \big)=| \det(T) |\lambda_N(Q_0)=| \det(T) |.
\end{equation}
Le déterminant de \( T\) est le volume de l'image du cube unité par l'application \( T\).

De la même façon, en utilisant l'application linéaire \( T(x)=ax\) nous avons pour tout borélien \( B\) :
\begin{equation}
	\lambda_N(aB)=a^N\lambda_N(B).
\end{equation}
Une dilatation d'un facteur \( a\) des longueurs provoque une multiplication par \( a^N\) des volumes.

\begin{lemma}       \label{LEMooOLSMooCimcIT}
	Tout hyperplan\footnote{Définition \ref{DEFooEWDTooQbUQws}.} de \( \eR^n\) est de mesure de Lebesgue nulle.
\end{lemma}

\begin{proof}
	Dans le cas d'un hyperplan vectoriel, il s'agit de prendre le théorème \ref{ThoBVIJooMkifod}. En posant \( B=\eR^n\), et en considérant l'application linéaire de projection de \( \eR^n\) vers l'hyperplan, on a le résultat parce que le déterminant d'une telle application est nul.

	Si l'hyperplan n'est pas vectoriel, alors nous utilisons l'invariance par translation\footnote{Théorème \ref{THOooTMWHooThsDHj}.} et nous nous ramenons au cas vectoriel.
\end{proof}

\begin{corollary}[\cite{ooRCYWooNAeaTA}]     \label{CorTHDQooWMSbJe}
	Tout ouvert de \( \eR^n\) est une union dénombrable de cubes presque disjoints\footnote{«presque» au sens où les intersections éventuelles sont de mesure de Lebesgue nulle.}.
\end{corollary}

\begin{proof}
	Il suffit de prendre les cubes de la proposition~\ref{PropSKXGooRFHQst} et de les fermer. Ce que l'on ajoute est de mesure nulle\footnote{Voir le lemme \ref{LEMooOLSMooCimcIT}.}.
\end{proof}

\begin{remark}
	La proposition~\ref{PropSKXGooRFHQst} est une propriété seulement de la topologie de \( \eR^n\) alors que le corolaire \ref{CorTHDQooWMSbJe} fait intervenir la mesure de Lebesgue parce qu'il faut bien dire que les intersections sont de mesure (de Lebesgue) nulle.
\end{remark}


%---------------------------------------------------------------------------------------------------------------------------
\subsection{Ensembles négligeables}
%---------------------------------------------------------------------------------------------------------------------------

\begin{lemma}[\cite{VSMEooLwNLHd}]      \label{LemWHKJooGPuxEN}
	L'image d'une partie négligeable de \( \eR^d\) par une application lipschitzienne est négligeable.
\end{lemma}

\begin{proof}
	Soit \( N\) une partie négligeable de \( \eR^d\) et une application lipschitzienne \( f\colon N\to \eR^d\). Soit \( Q\subset \eR^d\) un cube borné de côté \( r\). Pour tout \( x,x'\in N\cap Q\) nous avons
	\begin{equation}
		\| f(x)-f(x') \|\leq C\| x-x' \|\leq Cr.
	\end{equation}
	Donc \( f(N\cap Q)\) est dans une boule de rayon \( Cr\). Mais comme toutes les normes sont équivalentes\footnote{Proposition~\ref{PropLJEJooMOWPNi}} sur \( \eR^d\) nous pouvons tout aussi bien prendre la norme \( \| . \|_1\) au lieu de la norme \( \| . \|_2\) (qui est toujours la norme prise implicitement lorsqu'on parle de \( \eR^n\)), de telle sorte que les boules soient des cubes. Quoi qu'il en soit, \( f(N\cap Q)\) est contenu dans un cube de côté \( 2Cr\) et au niveau de la mesure extérieure,
	\begin{equation}
		m^*\big( f(N\cap Q) \big)\leq (2Cr)^d=(2C)^dr^d,
	\end{equation}
	ou encore
	\begin{equation}
		m\big(f(N\cap Q)\big)\leq (2C)^dm(Q)
	\end{equation}
	parce que \( r^d\) est la mesure du cube \( Q\).

	Soit maintenant \( \epsilon>0\); vu que \( N\) est négligeable, il existe un ouvert \( U\) contenant \( N\) et tel que \( m(U)<\epsilon\). Ce \( U\) est une union presque disjointe de cubes dyadiques \( (Q_n)\) par le corolaire~\ref{CorTHDQooWMSbJe}. Nous avons alors
	\begin{subequations}
		\begin{align}
			m^*\big( f(N) \big) & =m^*\big( f(\bigcup_nN\cap Q_n) \big) \\
			                    & =m^*\big( \bigcup_nf(N\cap Q_n) \big) \\
			                    & \leq \sum_nm^*(f(N\cap Q_n))          \\
			                    & \leq \sum_n(2C)^dm(Q_n)               \\
			                    & =(2C)^dm(U)                           \\
			                    & <(2C)^d\epsilon.
		\end{align}
	\end{subequations}
	Au final, \( m^*\big( f(N) \big)\leq (2C)^d\epsilon\).  L'ensemble \( N\) est donc négligeable parce que le lemme~\ref{LemXOUNooUbtpxm} le dit : \( m^*(N)=0\).
\end{proof}

\begin{corollary}
	Un sous-espace vectoriel strict de \( \eR^N\) est négligeable.
\end{corollary}

\begin{proof}
	Un sous-espace vectoriel strict de \( \eR^N\) de dimension \( k<N\) est l'image de
	\begin{equation}
		A=\{ t_1e_1+\cdots +t_ke_k\tq t_i\in \eR \}
	\end{equation}
	par une application linéaire. Ce \( A\) est un pavé de mesure de Lebesgue nulle. Donc l'image est négligeable par le lemme~\ref{LemWHKJooGPuxEN}.
\end{proof}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Parties et fonctions mesurables}
%---------------------------------------------------------------------------------------------------------------------------

Pour rappel, la notion d'application de classe \( C^1\) est donnée par la définition \ref{DefPNjMGqy}.

\begin{proposition}     \label{PropRDRNooFnZSKt}
	Soient \( U\) et \( V\) des ouverts de \( \eR^d\) et \( \phi\colon U\to V\) un \( C^1\)-difféomorphisme. Si \( E\subset U\) est mesurable, alors \( \phi(E)\) est mesurable\footnote{Ici «mesurable» parle de mesurabilité au sens de la tribu de Lebesgue, c'est-à-dire pas seulement les boréliens.}.
\end{proposition}

\begin{proof}
	Si \( E\) est mesurable, il existe un borélien \( B\) et un ensemble négligeable \( N\) tels que \( E=B\cup N\). Vu que \( \phi\) est un homéomorphisme, l'application \( \phi^{-1}\) est borélienne parce que continue (théorème~\ref{ThoJDOKooKaaiJh}). Nous avons
	\begin{equation}
		\phi(B)=(\phi^{-1})^{-1}(B),
	\end{equation}
	c'est-à-dire que \( \phi(B)\) est l'image inverse de \( B\) par \( \phi^{-1}\). L'ensemble \( \phi(B)\) est donc borélien.

	Il reste à voir que \( \phi(N)\) est négligeable. Soit \( Q\subset U\) un cube compact. L'application \( d\phi\colon Q\to \aL(\eR^d,\eR^d)\) est continue et donc bornée (par la remarque~\ref{RemATQVooDnZBbs}) sur le compact \( Q\). Par les accroissements finis (théorème~\ref{ThoNAKKght}), l'application \( \phi\) est donc lipschitzienne sur \( Q\). La partie \( \phi(N\cap Q)\) est alors négligeable par le lemme~\ref{LemWHKJooGPuxEN}. Pour conclure,
	\begin{equation}
		\phi(N)=\bigcup_i\phi(N\cap Q_i)
	\end{equation}
	où les \( Q_i\) sont tous des cubes compacts. Donc \( \phi(N)\) est une union dénombrable d'ensembles négligeables; ergo négligeable lui-même par le lemme~\ref{LemVKNooOCOQw}.
\end{proof}

\begin{proposition}
	Soient \( U\) et \( V\) des ouverts de \( \eR^N\) et \( \phi\colon U\to V\) un \( C^1\)-difféomorphisme. Si \( f\colon V\to \eC\) est mesurable, alors \(f\circ \phi\colon U\to \eC\) l'est.
\end{proposition}

\begin{proof}
	Soit \( A\) une partie mesurable de \( \eC\). Il nous faut prouver que
	\begin{equation}
		(f\circ\phi)^{-1}(A)=\phi^{-1}\big( f^{-1}(A) \big)
	\end{equation}
	soit mesurable. Par hypothèse , \( f^{-1}(A)\) est mesurable. Vu que \( \phi\) est un \( C^1\)-difféomorphisme, elle et son inverse sont mesurables par la proposition~\ref{PropRDRNooFnZSKt}. Donc l'image du mesurable \( f^{-1}(A)\) par \( \phi^{-1}\) est encore mesurable.
\end{proof}

\begin{proposition}		\label{PROPooSEJJooIfGUkW}
	Si \(f \colon \eR^n\to \eR^n  \) est de classe \( C^{\infty}\) et si \( N\) est une partie de mesure (de Lebesgue) nulle dans \( \eR^n\), alors \( f(N)\) est également de mesure nulle.
\end{proposition}

\begin{proposition}		\label{PROPooIESAooBsThho}
	Soit une application \(f \colon \eR^n\to \eR  \) qui s'annule une quantité dénombrable de fois. Soit \( N\) de mesure nulle dans \( \eR^n\). Pour tout \( \epsilon>0\), il existe \( \delta\in \eR^n\) tel que  \( \| \delta \|<\epsilon\) et tel que la fonction \( x\mapsto f(x+\delta)\) ne s'annule pas sur \( N\).
\end{proposition}

\begin{proof}
	Soient \( \{ x_i \}_{i\in \eN}\) les racines de \( f\). Pour chaque \( i\), nous notons
	\begin{equation}
		F_i=\{ \delta\in \eR^n\tq x_i+\delta\in N \}.
	\end{equation}
	Chacun de \( F_i\) est de mesure nulle, et donc \( \bigcup_{i=1}^{\infty} F_i\) est de mesure nulle. Il suffit de prendre \( \delta\in B(0,\epsilon)\setminus \bigcup_iF_i\), et nous avons \( x_i+\delta\) hors de \( N\) pour tout \( i\).
\end{proof}


%---------------------------------------------------------------------------------------------------------------------------
\subsection{Le théorème et sa démonstration}
%---------------------------------------------------------------------------------------------------------------------------

\begin{theorem}[Changement de variable\cite{VSMEooLwNLHd,PMTIooJjAmWR}]         \label{THOooUMIWooZUtUSg}
	Soient \( U\) et \( V\) des ouverts de \( \eR^N\) ainsi qu'un \( C^1\)-difféomorphisme \(\phi\colon U\to V\). Nous notons \( J_{\phi}\) la fonction
	\begin{equation}
		\begin{aligned}
			J_{\phi}\colon \eR^N & \to \eR                \\
			a                    & \mapsto \det(d\phi_a).
		\end{aligned}
	\end{equation}
	Alors :
	\begin{enumerate}
		\item   \label{ItemVWYDooOzwnyfi}
		      Si \( E\subset U\) est borélien, alors \( \phi(E)\) est borélien et
		      \begin{equation}
			      \lambda_N\big( \phi(E) \big)=\int_E| J_{\phi} |d\lambda_N,
		      \end{equation}
		      c'est-à-dire \( \phi^{-1}(\lambda_N)=| J_{\phi} |\cdot \lambda_N\).
		\item       \label{ITEMooEZUBooGBuDOS}
		      Si \( f\colon V\to \mathopen[ 0 , +\infty \mathclose]\) est mesurable alors la fonction
		      \begin{equation}
			      \begin{aligned}
				      (f\circ\phi)\times | J_{\phi} |\colon U & \to \mathopen[ 0 , \infty \mathclose]                \\
				      x                                       & \mapsto  (f\circ\phi)(x)| J_{\phi}(x) |d\lambda_N(x)
			      \end{aligned}
		      \end{equation}
		      l'est également et\footnote{L'intégrabilité d'une fonction est la définition~\ref{DefTCXooAstMYl} qui stipule que l'intégrale de \( | f(x) |\) est finie. L'égalité proposée a un sens si les deux membres sont infinis. Il n'y a donc pas d'hypothèses d'intégrabilité obligatoire pour écrire une intégrale lorsque la fonction a des valeurs positives.}
		      \begin{equation}        \label{EqRANEooQsFhbC}
			      \int_{\phi(U)}fd\lambda_N=\int_U(f\circ\phi)(x)| J_{\phi}(x) |d\lambda_N(x).
		      \end{equation}
		\item       \label{ITEMooAJGDooGHKnvj}
		      Si \( f\colon V\to \eC\) est mesurable alors elle est intégrable si et seulement si \( (f\circ \phi)\times | J_{\phi} |\colon U\to \eC\) est intégrable. Si c'est le cas, alors nous avons encore la formule de changement de variables :
		      \begin{equation}        \label{EQooLYAWooTArAZR}
			      \int_{V}fd\lambda_N=\int_{\phi^{-1}(V)} (f\circ \phi)| J_{\phi} |d\lambda_N.
		      \end{equation}
	\end{enumerate}
\end{theorem}


\begin{proof}
	Attention : la preuve va être longue.
	\begin{enumerate}
		\item
		      Le fait que \( \phi(E)\) soit borélien lorsque \( E\) l'est est la proposition~\ref{PropRDRNooFnZSKt}. En ce qui concerne la formule annoncée, il faut travailler.
		      \begin{subproof}
			      \spitem[Inégalité dans un sens (cubes)]
			      Nous commençons par prouver l'inégalité
			      \begin{equation}        \label{EqooQCXXooSjGzks}
				      \lambda_N\big( \phi(Q) \big)\leq \int_Q| J_{\phi}(x) |dx
			      \end{equation}
			      pour tout \( Q\in \mQ\). On peut diviser le côté du cube \( Q\) en \( k\) éléments de longueurs égales. Le cube est alors divisé en \( k^N\) petits cubes d'intérieurs disjoints. Nous les nommons \( Q_i\) (\( i=1,\ldots, k^N\)) Nous avons alors
			      \begin{equation}
				      \sum_i\lambda_N(Q_i)=\sum_i\lambda_N\big( \Int(Q_i) \big)=\lambda_N\big( \bigcup_i\Int(Q_i) \big)\leq \lambda_N(Q)\leq \sum_i\lambda_N(Q_i).
			      \end{equation}
			      La dernière inégalité est le fait que les intersections ne sont pas disjointes. Toutes ces inégalités sont en réalité des égalités et en particulier : \( \lambda_N(Q)=\sum_i\lambda_N(Q_i)\).

			      Soit \( a\in Q_i\). Posons
			      \begin{equation}
				      \begin{aligned}
					      \theta & \colon U                    \to U \\
					      \theta & =(d\phi_{a})^{-1}\circ\phi
				      \end{aligned}
			      \end{equation}
			      Cela appelle deux commentaires. D'abord l'application \( d\phi_{a}\colon U\to V\) est inversible parce que \( \phi\) est un difféomorphisme (lemme~\ref{LemooTJSZooWkuSzv}). Ensuite, l'application \( \theta\) est la composée de \( (d\phi_{a})\) (qui est linéaire) et de \( \phi\) qui est de classe \( C^1\); donc \( \theta\) est de classe \( C^1\). Donc le lemme~\ref{LemooJCEDooBRyjRg} s'applique. La différentielle de \( \theta\) n'est pas trop compliquée à écrire parce que nous avons la formule de différentielle d'une composée (théorème~\ref{ThoAGXGuEt}) et le fait que \( (d\phi_{a})^{-1}\) qui est linéaire et donc sa propre différentielle (lemme~\ref{LemooXXUGooUqCjmp}). Nous avons donc \( d\theta=(d\phi_a)^{-1}\circ d\phi\), et le lemme donne
			      \begin{equation}
				      \lambda_N\left( (d\phi_a)^{-1}\phi(a) \right)\leq \sup_{s\in Q_i}\|    (d\phi_a)^{-1}\circ d\phi_s  \|^N\lambda_N(Q_i)
			      \end{equation}
			      Étant donné que \( (d\phi_a)^{-1}\) est une application linéaire, la proposition~\ref{ThoBVIJooMkifod} s'applique, et donc
			      \begin{equation}
				      \lambda_N\left( (d\phi_a)^{-1}\phi(a) \right)=| \det(d\phi_a)^{-1} |\lambda_N\big( \phi(a) \big).
			      \end{equation}
			      Le déterminant d'une application réciproque est donné par la proposition~\ref{PropYQNMooZjlYlA}\ref{ItemooPJVYooYSwqaE} :
			      \begin{equation}
				      \det\big( (d\phi_a)^{-1} \big)=\frac{1}{ \det\big( d\phi_a \big) }=\frac{1}{ J_{\phi}(a) }.
			      \end{equation}
			      Recollant les morceaux,
			      \begin{equation}
				      \lambda_N\big( \phi(Q_i) \big)\frac{1}{ J_{\phi}(a) }\leq \sup_{s\in Q_i}\| (d\phi_a)^{-1}\circ d\phi_s \|^N\lambda_N(Q_i),
			      \end{equation}
			      ou encore :
			      \begin{equation}
				      \lambda_N\big( \phi(Q_i) \big)\leq | J_{\phi}(a) |\sup_{s\in Q_i}\| (d\phi_a)^{-1}\circ d\phi_s \|^N\lambda_N(Q_i).
			      \end{equation}
			      Vu que \( a\) et \( s\) sont proches l'un de l'autre (on peut choisir encore la taille du cube), nous pouvons espérer que \( (d\phi_a)^{-1}\) ne soit pas loin d'être l'inverse de \( d\phi_s\). Et c'est en effet le cas. Pour s'en assurer, remarquons que l'application
			      \begin{equation}
				      d\phi\colon Q_i\to \aL(\eR^N,\eR^N)
			      \end{equation}
			      est continue et même uniformément continue parce que \( Q_i\) est compact. De plus la composition de différentielles étant un produit de matrices nous pouvons permuter la limite dans le calcul suivant :
			      \begin{equation}
				      \lim_{s\to a}(d\phi_a)^{-1}\circ d\phi_s=(d\phi_a)^{-1}\circ\lim_{s\to a}d\phi_s=\mtu.
			      \end{equation}
			      Donc si \( \epsilon>0\) est donné, il existe \( \delta\) tel que pour tout \( s\in B(a,\delta)\), \( \| (d\phi_a)^{-1}\circ d\phi_s-\mtu \|\leq \epsilon\). En ce qui concerne les  normes, si \( \| A-\mtu \|\leq \epsilon\) alors \( \| A \|\leq \| A-\mtu \|+\| \mtu \|\leq \epsilon+1\).

			      Cela étant dit, nous nous souvenons que nous avions découpé \( U\) en un nombre fini de cubes \( Q_i\) d'égales dimensions; il suffit de prendre \( k\) suffisamment grand pour que la diagonale des cubes sot plus petite que le minimum des \( \delta_i\). Avec un tel découpage,
			      \begin{equation}
				      \sup_{s\in Q_i}\| (d\phi_a)^{-1}\circ d\phi_s \|\leq 1+\epsilon
			      \end{equation}
			      et par conséquent
			      \begin{equation}        \label{EqooQRMNooZduAkX}
				      \lambda_N\big( \phi(Q_i) \big)\leq (1+\epsilon)^N| J_{\phi}(a_i) |\lambda_N(Q_i)
			      \end{equation}
			      où nous avons ajouté un indice \( i\) au point \( a\) pour nous rappeler que nous avons choisi \( a\in Q_i\).

			      Le théorème de la moyenne~\ref{ThoooEZLGooMChwLT} appliqué à l'intégrale \( \int_{Q_i}| J_{\phi}(t) |d\lambda_N(t)\) donne l'existence d'un \( a_i\in Q_i\) tel que
			      \begin{equation}
				      | J_{\phi}(a_i) |=\frac{1}{ \lambda_N(Q_i) }\int_{Q_i}| J_{\phi} |d\lambda_N.
			      \end{equation}
			      Ce point \( a_i\) vérifie l'inégalité \eqref{EqooQRMNooZduAkX} comme tout point de \( Q_i\). Nous sommons ces inégalités sur tous les \( i\) :
			      \begin{subequations}
				      \begin{align}
					      \lambda_N\big( \phi(Q) \big) & \leq\sum_i\lambda_N\big( \phi(Q_i) \big)                                                                         \\
					                                   & \leq (1+\epsilon)^N\sum_i\left( \frac{1}{ \lambda_N(Q_i)\int_{Q_i}| J_{\phi} |d\lambda_N } \right)\lambda_N(Q_i) \\
					                                   & =(1+\epsilon)^N\sum_i\int_{Q_i}| J_{\phi} |d\lambda_N                                                            \\
					                                   & =(1+\epsilon)^N\int_Q| J_{\phi} |d\lambda_N
				      \end{align}
			      \end{subequations}
			      où nous avons utilisé le fait que \( \mtu_Q=\sum_i\mtu_{Q_i}\) presque partout. En prenant le limite \( \epsilon\to 0\) nous trouvons
			      \begin{equation}
				      \lambda_N\big( \phi(Q) \big)\leq \int_Q| J_{\phi} |d\lambda_N.
			      \end{equation}
			      L'inégalité \eqref{EqooQCXXooSjGzks} est prouvée.
			      \spitem[Inégalité pour les boréliens]

			      Soit \( B\) un borélien de \( U\). Vu que \( U\) et \( V\) sont des ouverts de \( \eR^N\), les mesures de Lebesgue sur \( U\) et sur \( V\) sont les mêmes que celles sur \( \eR^N\)  par le corolaire~\ref{CorooMJQYooFfwoTd}.

			      Par les définitions~\ref{PropooVXPMooGSkyBo} et~\ref{PropJCJQooAdqrGA}, les applications \( \mu\) et \( \nu\) définies par \( \mu=\phi^{-1}(\lambda_N)\) et \( \nu=| J_{\phi} |\lambda_N\) sont des mesures positives sur \( U\) (de Borel, qui plus est). L'inégalité \eqref{EqooQCXXooSjGzks} à peine prouvée s'écrit \( \mu(Q)\leq \nu(Q)\) pour tout cube \( Q\). Le lemme~\ref{LemooJYCGooIkkDVn} nous dit alors que l'inégalité tient pour tout borélien.

			      \spitem[Inégalité dans l'autre sens]

			      En utilisant la notation de la mesure image et du produit d'une mesure par une fonction\footnote{Définition~\ref{PropJCJQooAdqrGA} et~\ref{PropooVXPMooGSkyBo}}, nous pouvons écrire l'inégalité prouvée sous la forme \( \phi^{-1}(\lambda_N)\leq | J_{\phi} |\lambda_N\). En inversant les rôles de \( U\) et \( V\) (et donc de \( \phi\) et \( \phi^{-1}\)) nous avons aussi
			      \begin{equation}
				      \phi(\lambda_N)\leq| J_{\phi^{-1}} |\lambda_N.
			      \end{equation}
			      En y appliquant \( \phi^{-1}\) et le lemme~\ref{PropJCJQooAdqrGA},
			      \begin{equation}        \label{EqooHJCHooVIaheI}
				      \lambda_N\leq \phi^{-1}\big( | J_{\phi^{-1}} |\lambda_N \big).
			      \end{equation}
			      Nous prouvons à présent que \( \phi^{-1}\big( | J_{\phi^{-1}} |\cdot \lambda_N \big)=\Big( | J_{\phi^{-1}} |\circ\phi \Big)\cdot \phi^{-1}(\lambda_N)\) en appliquant à un borélien \( B\) de \(U\).
			      D'une part
			      \begin{subequations}
				      \begin{align}
					      \phi^{-1}\big( | J_{\phi^{-1}} |\cdot\lambda_N \big)(B) & =\big( | J_{\phi^{-1}} |\cdot\lambda_N \big)\phi(B) \\
					                                                              & =\int_{\phi(B)}| J_{\phi^{-1}} |d\lambda_N,
				      \end{align}
			      \end{subequations}
			      et d'autre part,
			      \begin{subequations}
				      \begin{align}
					      \big( | J_{\phi^{-1}} |\circ\phi \big)\cdot\phi^{-1}(\lambda_N)B & =\int_{\eR^N}\mtu_B(x)\big( | J_{\phi^{-1}} |\circ\phi \big)(x)d\big( \phi^{-1}(\lambda_N) \big)(x)                                                    \\
					                                                                       & =   \int_{\eR^N}\mtu_B\big( \phi^{-1}(x) \big)\big( | J_{\phi^{-1}} |\circ\phi \big)\big( \phi^{-1}(x) \big)d\lambda_N(x)       \label{ooDKSWooXwQwgO} \\
					                                                                       & =\int_{\eR^N}\mtu_{\phi(B)}| J_{\phi^{-1}} |                                                                                                           \\
					                                                                       & =\int_B| J_{\phi^{-1}} |d\lambda_N.
				      \end{align}
			      \end{subequations}
			      Justification :
			      \begin{itemize}
				      \item Pour \eqref{ooDKSWooXwQwgO}, le théorème~\ref{THOooVADUooLiRfGK}\ref{ItemooLAPYooUreDEl}.
			      \end{itemize}

			      L'équation \eqref{EqooHJCHooVIaheI} devient alors
			      \begin{equation}
				      \lambda_N\leq \big( | J_{\phi^{-1}} |\circ\phi \big)\cdot \phi^{-1}(\lambda_N).
			      \end{equation}
			      Nous allons faire le produit de cette mesure par \( | J_{\phi} |\) en nous souvenant que \( J_{\phi}(x)=\det\big( d\phi_x \big)\). Par le lemme~\ref{LemooTJSZooWkuSzv} nous avons aussi \(   (d\phi_x)^{-1}=d\phi^{-1}_{\phi(x)} \) et donc, par la propriété~\ref{PropYQNMooZjlYlA}\ref{ITEMooZMVXooLGjvCy} du déterminant,
			      \begin{equation}
				      J_{\phi}(x)=\frac{1}{ \det\big( d\phi^{-1}_{\phi(x)} \big) }=\frac{1}{ J_{\phi^{-1}}\big( \phi(x) \big) }.
			      \end{equation}
			      Nous avons
			      \begin{equation}
				      | J_{\phi} |\cdot\lambda_N\leq | J_{\phi} |\cdot\big( | J_{\phi^{-1}} |\circ\phi \big)\cdot\phi^{-1}(\lambda_N).
			      \end{equation}
			      En utilisant la proposition~\ref{PropooJMWAooDzfpmB}, il s'agit de multiplier la mesure \( \phi^{-1}(\lambda_N)\) par la fonction
			      \begin{equation}
				      x\mapsto | J_{\phi}(x)J_{\phi^{-1}}\big( \phi(x) \big) |=1.
			      \end{equation}
			      Nous avons donc bien
			      \begin{equation}
				      | J_{\phi} |\cdot \lambda_N\leq \phi^{-1}(\lambda_N),
			      \end{equation}
			      et donc l'égalité
			      \begin{equation}
				      | J_{\phi} |\cdot\lambda_N=\phi^{-1}(\lambda_N),
			      \end{equation}
			      c'est-à-dire le point~\ref{ItemVWYDooOzwnyfi}.
		      \end{subproof}
		\item
		      Le fait que la fonction proposée soit mesurable est le fait que la mesurabilité n'est pas affectée par produit et composition (propositions~\ref{PROPooODDVooEEmmTX} et~\ref{PROPooEFHKooARJBwW}), et le fait que pour les mêmes raisons, l'application \( J_{\phi}\colon U\to \eR\) est également mesurable. En ce qui concerne la formule nous allons la démontrer dans le cas de fonctions de plus en plus générales.
		      \begin{subproof}
			      \spitem[Pour les fonctions indicatrices]
			      Soit \( B\) un borélien de \( U\). Considérons la fonction \( f=\mtu_{\phi(B)}\). Alors
			      \begin{equation}    \label{EqYXRFooJEqVBH}
				      \int_V fd\lambda_N=\int_{\eR^N}\mtu_{\phi(B)}(y)\mtu_V(y)d\lambda_N(y)
				      =\int_{\eR^N}\mtu_{\phi(B)}d\lambda_N
				      =\lambda_N\big( \phi(B) \big).
			      \end{equation}
			      parce que \( V=\phi(U)\) et \( B\subset U\), donc \( \mtu_{\phi(B)}\mtu_{\phi(U)}=\mtu_{\phi(B)}\). D'autre part, pour calculer l'autre membre de \eqref{EqRANEooQsFhbC} nous remarquons que \( f=\mtu_{\phi(B)}=\mtu_B\circ\phi^{-1}\), ce qui donne
			      \begin{equation}        \label{EqHWRQooKIfPTu}
				      \int_Uf\big( \phi(x) \big)| J_{\phi}(x) |d\lambda_N(x)=\int_U\mtu_B| J_{\phi} |d\lambda_N=\int_B| J_{\phi} |d\lambda_N.
			      \end{equation}
			      L'ensemble \( B\) étant borélien, il est extrêmement mesurable, ce qui fait que le point~\ref{ItemVWYDooOzwnyfi} s'applique : les expressions \eqref{EqYXRFooJEqVBH} et \eqref{EqHWRQooKIfPTu} sont égales.

			      \spitem[Pour les fonctions étagées]

			      Soit \( f\colon V\to \eR^+\) une fonction étagée :
			      \begin{equation}
				      f(x)=\sum_{i=1}^na_i\mtu_{A_i}(x)
			      \end{equation}
			      Nous pouvons faire le calcul suivant :
			      \begin{subequations}
				      \begin{align}
					      \int_Vfd\lambda_N & =\int_V\sum_ia_i\mtu_{A_i}d\lambda_N                                                                 \\
					                        & =\sum_ia_i\int_{V}\mtu_{A_i}d\lambda_N      \label{ooNESRooDuNUYF}                                   \\
					                        & =\sum_i\int_U(\mtu_{A_i}\circ\phi)(x)| J_{\phi}(x) |d\lambda_N(x)   \label{ooYXHSooKMPrIT}           \\
					                        & =\sum_ia_i\int_U\mtu_{\phi^{-1}(A_i)}| J_{\phi}(x) |d\lambda_N(x)                                    \\
					                        & =\int_V\underbrace{\sum_ia_i\mtu_{\phi^{-1}(A_i)}(x)}_{=(f\circ\phi)(x)}| J_{\phi}(x) |d\lambda_N(x) \\
					                        & =\int_V(f\circ\phi)| J_{\phi} |d\lambda_N.
				      \end{align}
			      \end{subequations}
			      Justifications :
			      \begin{itemize}
				      \item Pour \eqref{ooNESRooDuNUYF} : linéarité de l'intégrale, théorème~\ref{ThoooCZCXooVvNcFD}\ref{ITEMooBLEVooDznQTY}\footnote{Il est remarquable que nous n'utilisons cette linéarité que pour les fonctions étagées.}
				      \item Pour \eqref{ooYXHSooKMPrIT} : le cas des fonctions indicatrices est utilisé pour chaque \( i\) entre \( 1\) et \( n\).
			      \end{itemize}

			      \spitem[Fonction mesurable positive]
			      Soit \( f\colon V\to \mathopen[ 0 , \infty \mathclose]\). Par le théorème fondamental d'approximation~\ref{THOooXHIVooKUddLi}, il existe une suite croissante de fonctions étagées et mesurables \( \varphi_n\colon V\to \mathopen[ 0 , \infty \mathclose[\) dont la limite ponctuelle est \( f\).  Nous avons alors le calcul suivant :
			      \begin{subequations}
				      \begin{align}
					      \int_Vfd\lambda_N & =\lim_{n\to \infty} \int_V\varphi_nd\lambda_N  \label{ooGMMFooXLHijj}                       \\
					                        & =\lim_{n\to \infty} \int_U(\varphi_n\circ\phi)| J_{\phi} |d\lambda_N \label{ooWIFWooXELNUs} \\
					                        & =\int_U\lim_{n\to \infty} (\varphi_n\circ\phi)| J_{\phi} |d\lambda_N \label{ooNKXNooUYeWKo} \\
					                        & =\int_U(f\circ\phi)| J_{\phi} |d\lambda_N       \label{ooOAIDooAILHIB}.
				      \end{align}
			      \end{subequations}
			      Justifications :
			      \begin{itemize}
				      \item Pour \eqref{ooGMMFooXLHijj}, c'est le théorème de la convergence monotone~\ref{ThoRRDooFUvEAN}.
				      \item Pour \eqref{ooWIFWooXELNUs}, c'est le présent théorème pour la fonction étagée \( \varphi_n\).
				      \item Pour \eqref{ooNKXNooUYeWKo}, c'est encore la convergence dominée, justifiée par le fait que \(  \varphi_n\circ\phi    \) est également une suite croissante : si \( x\in U\) alors \( \varphi_{n+1}\big( \phi(x) \big)\geq \varphi_n\big( \phi(x) \big)   \).\
				      \item Pour \eqref{ooOAIDooAILHIB}, c'est la limite ponctuelle \( \varphi_n\big( \phi(x) \big)\to f\big( \phi(x) \big)\).
			      \end{itemize}
		      \end{subproof}
		\item
		      La partie sur l'intégrabilité repose sur le fait que  \( | f |\circ\phi=| f\circ\phi |\). Ici \( | . |\) est le module et non une valeur absolue. Les faits suivants sont équivalents :
		      \begin{itemize}
			      \item la fonction \( f\colon V\to \eC\) est intégrable
			      \item la fonction \( | f |\colon V\to \eR\) est intégrable.
			      \item la fonction \( (| f |\circ\phi)| J_{\phi} |\colon U\to \eR\) est intégrable (par le point~\ref{ITEMooEZUBooGBuDOS}).
			      \item la fonction \( (f\circ\phi)| J_{\phi} |\colon U\to \eR\) est intégrable.
		      \end{itemize}
		      En ce qui concerne la formule, il s'agit seulement d'appliquer le point~\ref{ITEMooEZUBooGBuDOS} aux parties positives, négatives, imaginaires et réelles de \( f\).
	\end{enumerate}
\end{proof}

Notons que la formule peut être écrite sous la forme
\begin{equation}        \label{EQooQKARooELPCFO}
	\langle f, g\rangle_V=\langle f\circ\phi, (g\circ\phi)| J |\rangle_U,
\end{equation}
qui est plus pratique lorsqu'on parle de produits scalaires. Pour rappel, \( \phi\colon U\to C\) est un \( C^1\)-difféomorphisme.

\begin{normaltext}
	La formule de changement de variables peut être comprise de la façon suivante. Si \( \phi\) est linéaire  alors le facteur \( |J_{\phi}|\) est la mesure de l'image par \( \phi\) d'une portion de \( \eR^p\) de mesure \( 1\), sinon  \( |J_{\phi}|\) est le rapport entre la mesure de l'image d'un élément infinitésimal de volume de \( \eR^p\) et sa mesure originale.

	Soit \( \phi(u,v)=g(u,v)e_1+h(u,v)e_2\) un difféomorphisme dans \( \eR^2\). Soit \( (x_0, y_0)\) l'image par \( \phi\) de \( (u_0,v_0)\). On considère le petit rectangle \( R\) de sommets \( (u_0,v_0)\), \( (u_0+\Delta u,v_0)\), \( (u_0+\Delta u,v_0+\Delta v)\) et \( (u_0,v_0+\Delta v)\). L'image de \( R\) n'est pas un rectangle en général, mais peut être bien approximée par le rectangle de sommets \( (x_0,y_0)\), \( (x_0 ,y_0)+ \phi_{u}\Delta u\), \( (x_0 ,y_0)+\phi_{u}\Delta u +\phi_{v}\Delta v\) et  \( (x_0 ,y_0)+ \phi_{v}\Delta v\) et son aire est \( \| \phi_{u}\times \phi_{v}\| \Delta u\Delta v\). La valeur \( |\phi_{u}\times \phi_{v}|\) est exactement \( |J_{\phi}|\)
\end{normaltext}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Exemples}
%---------------------------------------------------------------------------------------------------------------------------

Énormément d'exemples sont disponibles avec les coordonnées polaires et toutes leurs variations. Cependant les fonctions trigonométriques ne seront vues que plus tard; les coordonnées polaires, cylindrique et sphériques seront vues en section \ref{SECooWTPRooZbOSzO} et les exemples d'utilisation pour les intégrales seront dans la section \ref{SECooOOPPooZLbaEH}.

Un exemple avec une exponentielle sera donnée dans l'exemple \ref{EXooNIOZooWxciAC}.


%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Changement d'espace mesuré}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{proposition}[\cite{MonCerveau}]      \label{PROPooILOEooBiumKD}
	Soit un espace mesuré \( (\Omega,\tribA,\mu)\). Soit un ensemble \( \Omega'\) et une bijection \( \varphi\colon \Omega\to \Omega'\). Nous posons
	\begin{enumerate}
		\item
		      \( \tribA'=\varphi(\tribA)\),
		\item
		      \( \mu'(B)=\mu\big( \varphi^{-1}(B) \big)\) pour tout \( B\in\tribA'\).
	\end{enumerate}
	Soit enfin une fonction mesurable \( f\colon \Omega\to X\).

	Alors
	\begin{enumerate}
		\item
		      Le triple \( (\Omega',\tribA',\mu')\) est un espace mesuré.
		\item
		      L'application \( f\circ\varphi^{-1}\colon \Omega'\to X\) est mesurable.
		\item
		      Nous avons l'égalité
		      \begin{equation}
			      \int_{\Omega}fd\mu=\int_{\Omega'}(f\circ\varphi^{-1})d\mu'.
		      \end{equation}
	\end{enumerate}
\end{proposition}

\begin{proof}
	La proposition \ref{PROPooXQHTooUxJoyq} montre déjà que \( (\Omega',\tribA',\mu')\) est un espace mesuré.

	Soit une partie \( S\) mesurable dans \( X\). Alors \( f^{-1}(S)\) est mesurable dans \( \Omega\) par hypothèse sur \( f\), c'est-à-dire que \( f^{-1}(S)\in\tribA\). Ensuite \( (\varphi\circ f^{-1})(S)\) est mesurable dans \( \Omega'\) par hypothèse sur \( \varphi\). Cela prouve que \(  f\circ\varphi^{-1} \) est une application mesurable.

	Nous avons encore à prouver l'égalité d'intégrale. Par la définition \ref{DefTVOooleEst} nous avons
	\begin{equation}
		\int_{\Omega}fd\mu=\sup\{ \sum_{i=1}^na_i\mu(A_i) \}
	\end{equation}
	où le supremum est sur tous les \( n\) et tous les choix de \( A_i\in\tribA\), \( a_i\in\eR^+\) tels que \( f|_{A_i}>a_i\). Vu que \( \tribA'=\varphi(\tribA)\), si \( A_i\in \tribA\) et \( a_i\) sont choisis, nous avons aussi
	\begin{equation}
		f\circ\varphi^{-1}|_{\varphi(A_i)}\geq a_i
	\end{equation}
	avec \( \varphi(A_i)\in\tribA'\). Donc pour un choix de \( \{ (A_i,a_i) \}\) donné,
	\begin{equation}
		\sum_{i=1}^na_i\mu(A_i)=\sum_{i=1}^na_i\mu'\big( \varphi(A_i) \big).
	\end{equation}
	Au final,
	\begin{equation}
		\int_{\Omega}fd\mu=\sup\{ \sum_{i=1}^na_i\mu(A_i) \}=\sup\{ \sum_ia_i\mu'\big( \varphi(A_i) \big) \}=\int_{\varphi(\Omega)}f\circ\varphi^{-1}d\mu'.
	\end{equation}
\end{proof}

\begin{remark}[Ce n'est pas la mesure que nous voulons]     \label{REMooOMYYooNFiKOs}
	La mesure donnée par la proposition \ref{PROPooILOEooBiumKD} n'est pas celle que nous voulons d'habitude sur \( \Omega'\). Anticipons un peu pour comprendre. Prenons l'exemple de la partie \( C^2\) de \( \eR\) donnée par
	\begin{equation}
		C=\{ (x,y)\in \eR^2\tq y=x^2,x\in \mathopen] 0 , 3 \mathclose[ \}.
	\end{equation}
	\begin{enumerate}
		\item
		      La façon correcte de définir la longueur de \( C\) est de prendre une limite d'approximations par des morceaux de droites, comme fait à la définition \ref{DEFooDNZWooXmxhsU}.
		\item
		      Cette définition de la longueur peut être exprimée sous forme intégrale par le théorème \ref{ThoLongueurIntegrale} qui nous assure que
		      \begin{equation}
			      l(C)=\int_0^3\| \varphi'(t) \|dt=\int_0^3\sqrt{ 1+4t^2 }dt\neq \mu'(C).
		      \end{equation}
		      En effet, \( \mu'(C)=\mu\big( \varphi^{-1}(C) \big)=\mu\big( \mathopen] 0 , 3 \mathclose[ \big)=3\), alors que pour tout \( t\) nous avons \( \sqrt{ 1+4t^2 }>1\) et donc \( l(C)>3\).
		\item
		      Donc \( \mu'\) n'est pas exactement ce que nous aurions pu vouloir appeler la «mesure» de \( C\).
		\item
		      La mesure à considérer sur \( C\) doit donc plutôt être quelque chose comme le produit de la mesure \( \mu'\) par la fonction \( \| \varphi' \|\). Mais cela est une autre histoire qui vous sera contée une autre fois.
		\item       \label{ITEMooJTKCooYQknqo}
		      Dans le cas de \( S^1\), nous avons \( \varphi(x)= e^{ix}\), et \( \| \varphi'(x) \|=1\). Donc la mesure donné ici est probablement bien celle que nous voulons. Peut-être à coefficient \( \frac{1}{ 2\pi }\) près pour avoir une normalisation \( \mu'(S^1)=1\). Cela est également une autre histoire qui vous sera contée une autre fois; par exemple dans la proposition \ref{PROPooHMSCooRIjcJq}.
	\end{enumerate}
\end{remark}



%+++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Primitives et intégrales}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++


\begin{definition}      \label{DEFooGLJDooFeZBBC}
	Si \( a<b\) nous posons
	\begin{equation}
		\int_a^bf(t)dt=\int_{\mathopen[ a , b \mathclose]}f.
	\end{equation}
	Si par contre \( a>b\) nous posons \( \int_a^bf=-\int_b^af\).

	Un petit cas particulier :
	\begin{equation}
		\int_{-\infty}^bf(t)dt=\int_{\mathopen] -\infty,b\mathclose]}f.
	\end{equation}
\end{definition}



\begin{proposition}[Primitive et intégrale\cite{TrenchRealAnalisys}] \label{PropEZFRsMj}
	Soit \( f\) une fonction intégrable sur \( \mathopen[ a , b \mathclose]\) et continue sur \( \mathopen] a , b \mathclose[\). Alors la fonction
		\begin{equation}
			\begin{aligned}
				F\colon \mathopen[ a , b \mathclose] & \to \eR                                            \\
				x                                    & \mapsto \int_{\mathopen[ a , x \mathclose]}f(t)dt.
			\end{aligned}
		\end{equation}
		est l'unique primitive de \( f\) sur \( \mathopen] a , b \mathclose[\) s'annulant en \( x=a\).
\end{proposition}
\index{primitive et intégrale}

\begin{proof}
	Nous devons prouver que \( F\) est dérivable et que pour tout \( x_0\in\mathopen] a , b \mathclose[\) nous avons \( F'(x_0)=f(x_0)\). Soit \( \epsilon>0\). Par continuité de \( f\) en \( x_0\), il existe une fonction \( \alpha\colon \eR\to \eR\) telle que
	\begin{equation}
		f(x_0+h)=f(x_0)+\alpha(h)
	\end{equation}
	avec \( \lim_{h\to 0} \alpha(h)=0\). Cette dernière limite signifie qu'il existe un \( \delta>0\) tel que \( |\alpha(h)|<\epsilon\) pour tout \( h\) tel que \( | h |<\delta\), c'est-à-dire pour tout \( h\in B(0,\delta)\). À partir de maintenant nous ne considérons plus que de tels \( h\).

	Notre travail maintenant est de prouver que \( F\) est dérivable en \( x_0\), et de montrer que la dérivée est \( f(x_0)\). Pour cela,
	\begin{subequations}
		\begin{align}
			F(x_0+h)-F(x_0) & =\int_{x_0}^{x_0+h}f(t)dt               \\
			                & =\int_0^hf(x_0+t)dt                     \\
			                & =\int_0^h\big[ f(x_0)+\alpha(t) \big]dt \\
			                & =hf(x_0)+\int_0^{h}\alpha(t)dt.
		\end{align}
	\end{subequations}

	Nous avons donc montré que pour tout \( \epsilon>0\), il existe un \( \delta\) (défini via la fonction \( \alpha\)) tel que \( | h |<\delta\) implique
	\begin{equation}
		\left| \frac{ F(x_0+h)-F(x_0) }{ h }-f(x_0) \right| <\epsilon.
	\end{equation}
	Cela signifie que
	\begin{equation}
		\lim_{h\to 0} \frac{ F(x_0+h)-F(x_0) }{ h }=f(x_0),
	\end{equation}
	qui n'est rien d'autre que le fait que \( F\) est dérivable en \( x_0\) et que sa dérivée est \( f(x_0)\).

	Le fait que \( F\) s'annule en \( x=a\) est par sa définition. L'unicité provient du corolaire~\ref{CorZeroCst}.
\end{proof}

%-------------------------------------------------------
\subsection{Théorème fondamental du calcul intégral}
%----------------------------------------------------


\begin{theorem}[Théorème fondamental du calcul intégral]    \label{ThoRWXooTqHGbC}
	Soit \( f\) une fonction continue sur un intervalle ouvert \( I\) contenant strictement l'intervalle \( \mathopen[ a , b \mathclose]\subset \eR\) et \( F\) une primitive de \( f\) sur \( I\). Alors
	\begin{equation}
		\int_a^bf(t)dt=F(b)-F(a).
	\end{equation}
\end{theorem}
\index{théorème fondamental du calcul intégral}

\begin{proof}
	Nous avons vu par la proposition~\ref{PropEZFRsMj} que la fonction
	\begin{equation}
		\begin{aligned}
			G\colon \mathopen[ a , b \mathclose] & \to \eR                 \\
			x                                    & \mapsto  \int_a^xf(t)dt
		\end{aligned}
	\end{equation}
	était l'unique primitive de \( f\) sur \( \mathopen] a , b \mathclose[\) à s'annuler pour \( x=a\). Nous avons évidemment
	\begin{equation}
		\int_a^bf(t)dt=G(b).
	\end{equation}
	Si \( F\) est une primitive quelconque, il suffit de soustraire sa valeur en \( x=a\) : \( G(x)=F(x)-F(a)\) et donc
	\begin{equation}
		\int_a^bf(t)dt=G(b)=F(b)-F(a),
	\end{equation}
	comme il fallait le prouver.
\end{proof}

Le théorème fondamental s'écrit souvent sous la forme\footnote{Par exemple dans les théorèmes du reste des polynômes de Taylor \ref{THOooEUVEooXZJTRL} et de Cauchy-Lipschitz \ref{ThokUUlgU}.}
\begin{equation}        \label{EqooBBCYooNweVrF}
	f(x)=f(a)+\int_a^xf'(t)dt.
\end{equation}
Sous cette forme, il faut penser que nous calculons \( f(x)\) en un point pas trop éloigné de \( a\), en sachant \( f(a)\) et en intégrant la dérivée entre les deux.

\begin{remark}
	Le lien entre primitive et intégrale est fondamentalement lié à l'invariance par translation de la mesure de Lebesgue, et non à la construction précise de cette mesure. Mais en même temps, la mesure de Lebesgue est l'unique à être invariante par translation.
\end{remark}

Quelque remarques.
\begin{enumerate}
	\item
	      Le théorème fondamental du calcul intégral est à utiliser pour calculer des intégrales des fonctions réelles lorsqu'on a des primitives sur un domaine strictement plus large que le domaine sur lequel nous voulons intégrer.
	\item
	      Une version pour les intégrales impropres sera donnée au corolaire~\ref{CorMUIooXREleR}.
	\item
	      Une primitive est forcément une fonction continue parce qu'une primitive est dérivable.
	\item
	      Le théorème fondamental du calcul intégral ne sert pas qu'à calculer des intégrales à partir de primitives. Il sert aussi à démontrer des résultats plus théoriques, comme le théorème \ref{THOooXZQCooSRteSr}.
	\item
	      En vertu du corolaire~\ref{CorZeroCst}, une fonction ne possède qu'une seule primitive à constante près.
\end{enumerate}


%---------------------------------------------------------------------------------------------------------------------------
\subsection{Exemples et applications}
%---------------------------------------------------------------------------------------------------------------------------

Si \( f\) est une fonction définie sur un intervalle \( I\) et y admettant des primitives, nous notons
\begin{equation}
	\int f(x)dx
\end{equation}
l'ensemble des primitives de \( f\) sur \( I\) :
\begin{equation}
	\int f(x)dx=\left\{    F(x)+C\tq C\in \eR   \right\}
\end{equation}
où \( F\) est une quelconque primitive de \( f\).

\begin{example}
	Une primitive bien connue de \(  f\colon x\mapsto x^2 \) est la fonction \( F\colon x\mapsto \frac{ x^3 }{ 3 }\). Nous écrivons donc
	\begin{equation}
		\int x^2dx=\frac{ x^3 }{ 3 }+C.
	\end{equation}
	Cela est un abus de notation terrible pour dire en réalité
	\begin{equation}
		\{ x\mapsto \frac{ x^3 }{ 3 }+C\tq C\in \eR \}.
	\end{equation}
\end{example}

En termes de notations, nous posons
\begin{equation}\label{Thfondcalc}
	\int_a^bf(t)dt=\Big[ F(t) \Big]_{t=a}^{t=b}=F(b)-F(a).
\end{equation}

\begin{remark}
	La valeur de l'intégrale ne dépend pas de la primitive qu'on choisi pour le calculer, car si \( F_1\) et \( F_2\) sont deux primitives de \( f\) alors \( F_1 = F_2 + C\) et \( F_1(b)-F_1(a) = (F_2(b) + C)-(F_2(a)+C) = F_2(b)-F_2(a)\).
\end{remark}

\begin{remark}
	Si l'intervalle d'intégration est réduit à un seul point alors la valeur de l'intégrale est zéro. Nous le savions déjà, et cela est cohérent avec le théorème fondamental car \(  \int_a^af(t)dt=F(a)-F(a) =0\).
\end{remark}

\begin{remark}
	Toute intégrale d'une fonction impaire sur un intervalle symétrique par rapport à l'origine est nulle.
\end{remark}

\begin{proposition}[\cite{MonCerveau}]      \label{PROPooJYIAooXLkbMx}
	Soient des espaces vectoriels normés \( E\) et \( F\) où \( F\) est de dimension finie\footnote{Sinon l'intégrale dont nous allons parler n'est pas définie au sens où nous n'en avons pas donné de définition. Voir \ref{NORMooTQBIooBaScjt}.}. Nous considérons une fonction \( f\colon E\to F\) de classe \( C^1\) ainsi qu'un chemin \( \gamma\colon \mathopen[ 0 , 1 \mathclose]\to E\) de classe \( C^1\) également.

	Alors nous avons l'égalité
	\begin{equation}
		\int_0^1(df)_{\gamma(t)}\big( \gamma'(t) \big)=f\big( \gamma(1) \big)-f\big( \gamma(0) \big).
	\end{equation}
\end{proposition}

\begin{proof}
	Nous posons
	\begin{equation}
		\begin{aligned}
			g\colon \mathopen[ 0 , 1 \mathclose] & \to F                      \\
			t                                    & \mapsto (f\circ\gamma)(t).
		\end{aligned}
	\end{equation}
	Cette fonction vérifie \( g'(t)=(df)_{\gamma(t)}\big( \gamma'(t) \big)\) par le lemme \ref{LEMooKNBVooQSowos}. Le théorème fondamental du calcul intégral\footnote{Théorème \ref{ThoRWXooTqHGbC}.} nous permet donc d'écrire
	\begin{equation}
		\int_0^1(df)_{\gamma(t)}\big( \gamma'(t) \big)dt=\int_0^1g'(t)df=g(1)-g(0).
	\end{equation}
	Notons que \( g\) est continue grâce aux hypothèses de classe \( C^1\) pour \( \gamma\) et \( f\).
\end{proof}



La proposition suivante est la généralisation à \( \eR\) de la proposition \ref{PROPooSGLGooIgzque}.
\begin{proposition}     \label{PROPooKIASooGngEDh}
	Pour tout \( \alpha\in \eR\), si \( f_{\alpha}(x)=x^{\alpha}\) alors
	\begin{equation}
		f'_{\alpha}(x)=\alpha x^{\alpha-1}.
	\end{equation}
	Au niveau du domaine, c'est \( \eR\) auquel il faut enlever \( \{ 0 \}\) si \( \alpha-1<0\).
\end{proposition}

\begin{proof}
	Soient \( \alpha\in \eR\) et une suite de rationnels \( \alpha_i\) qui converge vers \( \alpha\). Les plus amateurs d'abstraction diront \( (\alpha_i)\in \alpha\) en référence à la proposition \ref{PropooEPFCooMtDOfP}.

	Nous notons \( f_{\alpha}(x)=x^{\alpha}\) et \( f_i(x)=x^{\alpha_i}\). Par définition nous avons
	\begin{equation}
		f_i\to f_{\alpha}
	\end{equation}
	ponctuellement. De plus en utilisant la proposition \ref{PROPooSGLGooIgzque} nous savons que \( f'_i(x)=\alpha_i x^{\alpha_i-1}\). En posant \( g(x)=\alpha x^{\alpha-1}\) nous avons donc
	\begin{equation}
		f'_i\to g.
	\end{equation}
	ponctuellement. Mais \( f'_i\) est continue pour tout \( i\) et \( g\) également. Donc la convergence \( f_i\to f_{\alpha}\) est uniforme sur tout compact\footnote{Proposition \ref{PROPooFWVIooCzXojO}.}. Le théorème \ref{THOooXZQCooSRteSr} nous permet de permuter limite et dérivée pour avoir \( g=f'_{\alpha}\).
\end{proof}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Intégrales impropres}
%---------------------------------------------------------------------------------------------------------------------------
\label{SecGAVooBOQddU}

\begin{definition}[\cite{TrenchRealAnalisys}]
	Une fonction \( f\colon D\subset\eR\to \eR\) est \defe{localement intégrable}{localement!intégrable} sur un intervalle \( I\) si \( f\) est intégrable sur tout intervalle compact contenu dans \( I\).
\end{definition}
\index{intégrale!impropre}

%Dans \cite{TrenchRealAnalisys}, la proposition~\ref{PropCJAooQhNYkp} est prise comme une définition de \( \int_a^bf\) lorsque \( f\) est localement intégrable sur \( \mathopen[ a , b [\). Le point est que lui, il ne passe pas par Lebesgue et la construction abstraite d'intégrale par rapport à une mesure. Nous par contre nous avons déjà une définition de
%\begin{equation}
%    \int_a^bf=\int_{\mathopen[ a , b \mathclose]}f
%\end{equation}
%pour tout choix de \( a\), \( b\) et \( f\), que ce soit borné ou non.

\begin{proposition}     \label{PropCJAooQhNYkp}
	Soit \( f\colon \mathopen[ a , b \mathclose]\to \eR\) une fonction intégrable. Alors
	\begin{equation}    \label{EqPPMooBQDTYl}
		\int_{\mathopen[ a , b \mathclose]}f=\lim_{x\to b^-} \int_a^xf.
	\end{equation}
\end{proposition}

\begin{proof}
	Notons que la valeur de \( f\) en \( b\) n'a strictement aucune importance parce que l'intégrale de Lebesgue ne dépend pas du choix de la valeur de la fonction en un ensemble de mesure nulle; et en même temps la limite à gauche de \eqref{EqPPMooBQDTYl} ne dépend pas non plus de la valeur de \( f\) en \( b\). Bref si \( f\) n'est pas définie en \( b\), nous pouvons poser \( f(b)=42\).

	Notons de plus que du point de vue de l'intégrale de Lebesgue, \( \int_{\mathopen[ a , b \mathclose]}\) et \( \int_{\mathopen[ a , b [}\) sont identiques et valent toutes les deux \( \int_a^b\) (lorsque ça existe).

	\begin{subproof}
		\spitem[Si \( f\) est positive]
		%-----------------------------------------------------------
		Supposons d'abord que \( f\) est positive. Alors nous posons \( f_n=f\mtu_{\mathopen[ a , b-\frac{1}{ n } \mathclose]}\). Ponctuellement nous avons la limite croissante \( f_n\to f\) et de plus
		\begin{equation}
			\lim_{x\to b^-} \int_{\mathopen[ a , x \mathclose]}f=\lim_{n\to \infty} \int_{\mathopen[ a , b \mathclose]}f_n.
		\end{equation}
		Chacun des \( f_n\) est intégrable sur \( \mathopen[ a , b \mathclose]\). Le théorème de Beppo-Levi~\ref{ThoRRDooFUvEAN} implique que \( f\) est intégrable sur \( \mathopen[ a , b \mathclose]\) et que
		\begin{equation}
			\lim_{n\to \infty} \int_a^bf_n=\int_a^bf.
		\end{equation}
		Cela montre que dans le cas d'une fonction \( f\) positive nous avons bien \eqref{EqPPMooBQDTYl}.

		\spitem[Si \( f\) n'est pas positive]
		%-----------------------------------------------------------
		Si \( f\) n'est pas positif, alors nous la décomposons en partie positive et négative \( f=f^+-f^{-}\) et par définition de l'intégrale d'une fonction non positive,
		\begin{equation}
			\lim_{x\to b^-} \int_{\mathopen[ a , x [}f=\lim\int f^{+}-\lim\int f^-.
		\end{equation}
	\end{subproof}
\end{proof}

Il peut cependant arriver que la limite \( \lim_{x\to b} \int_a^bf\) existe alors que \( f\) n'est pas intégrable sur \( \mathopen[ a , b \mathclose]\). C'est l'ennui des fonctions non positives. Un exemple classique est
\begin{equation}\label{EqMMVooDSpgfz}
	\int_0^{\infty}\frac{ \sin(t) }{ t }dt
\end{equation}

La définition suivante est motivée par le lemme \ref{LEMooKGZDooWiKiHR}.
\begin{definition}[\cite{DWNooWUZxRP}]      \label{DEFooINPOooWWObEz}
	Si
	\begin{equation}
		\lim_{x\to b} \int_a^xf
	\end{equation}
	existe alors nous disons que l'intégrale est \defe{convergente}{intégrale!convergente} en \( b\). Ce procédé de limite est l'intégrale \defe{impropre}{intégrale!impropre} de \( f\) sur \( \mathopen[ a , b \mathclose]\).
\end{definition}

\begin{example}[Intégale impropre]
	Nous considérons la fonction \( f\colon \mathopen[ 0 , \infty [\to \eR\) définie par
	\begin{equation}
		f(x)=\begin{cases}
			\frac{1}{ n }  & \text{si } x\in\mathopen[ 2n-2 , 2n-1 [       \\
			-\frac{1}{ n } & \text{si } x\in\mathopen[ 2n-1 , 2n [\text{.}
		\end{cases}
	\end{equation}
	Par la divergence de la série harmonique, \( \int_{0}^{\infty}| f |\) n'existe pas. La fonction \( f\) n'est donc pas intégrable au sens de Lebesgue (définition~\ref{DefTCXooAstMYl}).

	Cependant pour tout \( n\) pair nous avons
	\begin{equation}
		\int_0^nf=0.
	\end{equation}
	Du coup pour tout \( x\geq 0\) nous avons
	\begin{equation}
		\int_0^xf=\int_{2n}^xf
	\end{equation}
	où \( 2n\) est le plus grand nombre pair inférieur à \( x\). Nous avons \( | x-2n |\leq 2\) et \( | f(x) |\leq \frac{1}{ n }\) pour \( x\in\mathopen[ 2n , x \mathclose]\). Donc
	\begin{equation}
		\int_{2n}^xf\leq \frac{ 2 }{ n }.
	\end{equation}
	Nous avons par conséquent
	\begin{equation}
		\lim_{x\to \infty} \int_0^xf=0,
	\end{equation}
	ce qui signifie que l'intégrale de \( f\) sur \( \mathopen[ 0 , \infty [\) converge au sens des intégrales impropres.
\end{example}


L'intégrale \eqref{EqMMVooDSpgfz} est une intégrale convergente mais la fonction n'est pas intégrable (parce que pour être intégrale il faut que \( | f |\) soit intégrable). Nous pouvons ainsi dire que cette intégrale converge mais n'existe pas.

Le corolaire suivant nous autorise à utiliser le théorème fondamental du calcul intégral~\ref{ThoRWXooTqHGbC} même dans les cas limites.
\begin{corollary}   \label{CorMUIooXREleR}
	Si \( f\) est localement intégrable sur \( \mathopen[ a , b \mathclose]\) et si \( F\) est une primitive de \( f\) sur tout ouvert de \( \mathopen[ a , b \mathclose]\) alors
	\begin{equation}
		\int_a^bf=\lim_{x\to b^-} F(x)-F(a).
	\end{equation}
\end{corollary}
\index{primitive!et intégrale}

\begin{proof}
	Pour chaque \( x\) dans \( \mathopen[ a , b [\) nous avons
	\begin{equation}
		\int_a^xf=F(x)-F(a).
	\end{equation}
	La proposition~\ref{PropCJAooQhNYkp} nous explique que la limite \( x\to b^-\) du membre de gauche existe et vaut \( \int_a^bf\). Donc également le membre de droite :
	\begin{equation}
		\int_a^bf=\lim_{x\to b^-} \int_a^xf=\lim_{x\to b^-} F(x)-F(a).
	\end{equation}
\end{proof}

La convergence des intégrales de fonctions \( \frac{1}{ x^{\alpha} }\) en \( 0\) et \( \infty\) est une question classique de l'intégration. De plus ces fonctions servent souvent à utiliser une théorème de comparaison (type intégrale dominée de Lebesgue).
\begin{proposition} \label{PropBKNooPDIPUc}
	Deux intégrales remarquables.
	\begin{enumerate}
		\item

		      Nous avons
		      \begin{equation}
			      \int_0^1\frac{1}{ x^\alpha }=\infty
		      \end{equation}
		      si et seulement si \( \alpha\geq 1\).

		\item   \label{ITEMooJFSXooHmgmEj}

		      Nous avons
		      \begin{equation}
			      \int_1^{\infty}\frac{1}{ x^{\alpha} }=\infty
		      \end{equation}
		      si et seulement si \( \alpha\leq1\).

	\end{enumerate}

\end{proposition}

\begin{proof}
	La fonction \( \frac{1}{ x^{\alpha} }\) admet la primitive \( F(x)=\frac{1}{ 1-\alpha }\frac{1}{ x^{\alpha-1} }\) sur tout compact de \( \mathopen] 0 , \infty \mathclose[\). Le corolaire~\ref{CorMUIooXREleR} nous permet\footnote{Tout ce que nous avons fait avec la borne \( b\) de l'intégrale \( \int_a^b\) reste valable avec la borne \( a\).} de dire que \( \int_0^1\frac{1}{ x^{\alpha} }\) vaudra
	\begin{equation}
		\lim_{x\to 0-^+} \frac{1}{ 1-\alpha }\frac{1}{ x^{\alpha-1} }.
	\end{equation}
	Cela est strictement plus petit que \( \infty\) si et seulement si \( \alpha<1\).
\end{proof}




%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Théorème de Fubini-Tonelli et de Fubini}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Nous rappelons que \( \eR^n\) muni de la mesure de Lebesgue est un espace mesuré \( \sigma\)-fini, conformément à la définition~\ref{DefBTsgznn}.

Le théorème de Fubini-Tonelli parle de fonctions à valeurs réelles positives et non de fonctions à valeurs complexes. Le truc est que ce théorème va servir de base pour construire les autres. Si nous avons une fonction à valeurs complexes, elle se décompose en parties réelles et imaginaires qui elles-mêmes se décomposent en parties positives et négatives. Au final, les preuves pour \( f\colon \Omega\to \eC\) se ramènent à appliquer quatre fois le théorème pour \( f\colon \Omega\to \bar \eR^+\).

\begin{theorem}[Fubini-Tonelli\cite{NBoIEXO}]						\label{ThoWTMSthY}
	Soient \( (\Omega_i,\tribA_i,\mu_i)\) deux espaces mesurés \( \sigma\)-finis, et \( (\Omega,\tribA,\mu)\) l'espace produit. Soit une fonction \( f\colon \Omega_1\times \Omega_2\to \eR\) une fonction mesurable et positive (valant éventuellement \( \infty\) à certains endroits)
	Alors :
	\begin{enumerate}
		\item       \label{ITEMooUTMNooVIBdpP}
		      Les fonction
		      \begin{equation}        \label{EQooWLADooQwNhEy}
			      F_1\colon x\mapsto \int_{\Omega_2}f(x,y)d\mu_2(y)
		      \end{equation}
		      et
		      \begin{equation}
			      F_2\colon y\mapsto \int_{\Omega_1}f(x,y)d\mu_1(x)
		      \end{equation}
		      sont mesurables.
		\item   \label{ITEMooFKQUooCoCOLV}
		      Toutes les intégrales imaginables existent et sont égales :
		      \begin{subequations}    \label{EqJRVtOGx}
			      \begin{align}
				      \int_{\Omega_1\times \Omega_2}f(x,y)d(\mu_1\otimes \mu_2)(x,y) & =\int_{\Omega_1}\left[ \int_{\Omega_2}f(x,y)d\mu_2(y) \right]d\mu_1(x) \\
				                                                                     & =\int_{\Omega_2}\left[ \int_{\Omega_1}f(x,y)d\mu_1(x) \right]d\mu_2(y)
			      \end{align}
		      \end{subequations}
		      où tous les membres de l'égalité valent éventuellement \( +\infty\).
	\end{enumerate}
\end{theorem}
\index{théorème!Fubini-Tonelli}

\begin{proof}
	Commençons par prouver le théorème dans le cas d'une fonction caractéristique d'un ensemble mesurable : \( f(x,y)=\mtu_{A}(x,y)\) pour un certain ensemble \( A\subset \Omega_1\times \Omega_2\). Dans ce cas,
	\begin{equation}
		F_1(x)=\int_{\Omega_2}\mtu_A(x,y)d\mu_2(y)=\int_{\Omega_2}\mtu_{A_1(y)}(x)d\mu_2(y)=\mu_2\big( A_1(x) \big),
	\end{equation}
	et nous avons déjà vu au théorème~\ref{ThoCCIsLhO} que cette fonction \( F_1\) était alors mesurable. En utilisant maintenant les égalités \eqref{EqDFxuGtH} ainsi que le fait que \( \mtu_A(x,y)=\mtu_{A_2(x)}(y)\) nous avons
	\begin{subequations}
		\begin{align}
			\int_{\Omega_1\times \Omega_2}\mtu_A(x,y)d(\mu_1\otimes \mu_2)(x,y) & =(\mu_1\otimes \mu_2)(A)                                                            \\
			                                                                    & =\int_{\Omega_1}\mu_2\big( A_2(x) \big)d\mu_1(x)                                    \\
			                                                                    & =\int_{\Omega_1}\left[   \int_{\Omega_2}\mtu_{A_2(x)}(y)d\mu_2(y)  \right]d\mu_1(x) \\
			                                                                    & =\int_{\Omega_1}\left[ \int_{\Omega_2}\mtu_A(x,y)d\mu_2(y) \right]d\mu_1(x).
		\end{align}
	\end{subequations}
	Le théorème étant valable pour les fonctions caractéristiques, il est valable pour les fonctions simples (définition~\ref{DefBPCxdel}) par linéarité de l'intégrale.

	Si \( f\) n'est pas une fonction simple, alors la proposition~\ref{THOooXHIVooKUddLi} nous donne une suite croissante de fonctions simples et positives convergeant ponctuellement vers \( f\). La partie du théorème sur les fonctions simples dit que pour chaque \( n\) l'intégrale
	\begin{equation}
		\int_{\Omega_1\times \Omega_2}f_n(x,y)d(\mu_1\otimes\mu_2)(x,y)
	\end{equation}
	peut être décomposée comme il faut en suivant la formule \eqref{EqJRVtOGx}. Il faut pouvoir permuter la limite et l'intégrale dans chacun des cas. D'abord le théorème de la convergence monotone~\ref{ThoRRDooFUvEAN} appliqué à l'espace \( \Omega_1\times \Omega_2\) dit que
	\begin{equation}
		\lim_{n\to \infty} \int_{\Omega_1\times \Omega_2}f_n(x,y)d(\mu_1\otimes \mu_2)(x,y)= \int_{\Omega_1\times \Omega_2}f(x,y)d(\mu_1\otimes \mu_2)(x,y).
	\end{equation}
	Ensuite, pour chaque \( x\in\Omega_1\), les fonctions
	\begin{equation}
		\sigma_n(y)=\int_{\Omega_1}f_n(x,y)d\mu_1(x)
	\end{equation}
	forment une suite croissante de fonctions mesurables; nous leur appliquons encore le théorème de la convergence monotone :
	\begin{subequations}
		\begin{align}
			\lim_{n\to \infty} \int_{\Omega_2}\left[ \int_{\Omega_1}f_n(x,y)d\mu_1(x) \right]d\mu_2(y) & =\lim_{n\to \infty} \int_{\Omega_2}\sigma_n(y)d\mu_2(y)                                   \\
			                                                                                           & =\int_{\Omega_2}\left[\lim_{n\to \infty} \int_{\Omega_1}f_n(x,y)d\mu_1(x)\right]d\mu_2(y) \\
			                                                                                           & =\int_{\Omega_2}\left[ \int_{\Omega_1}f(x,y)d\mu_1(x) \right]d\mu_2(y)
		\end{align}
	\end{subequations}
	où nous avons utilisé une seconde fois Beppo-Levi.
\end{proof}

\begin{remark}
	Les formules \eqref{EqJRVtOGx} sont bien, mais ne garantissent en aucun cas que \( f\in L^1(\Omega_1\times \Omega_2)\) : il faut encore que ces intégrales soient finies.
\end{remark}

\begin{corollary}[\cite{MesIntProbb}]           \label{CorTKZKwP}
	Soient \( (\Omega_i,\tribA_i,\mu_i)\) deux espaces mesurés \( \sigma\)-finis, et \( (\Omega,\tribA,\mu)\) l'espace produit\footnote{Définition~\ref{DefUMlBCAO}.}. Soit une fonction mesurable \( f\colon \Omega\to \eR\text{ ou }\eC\). Alors les conditions suivantes sont équivalentes
	\begin{enumerate}
		\item   \label{ITEMooZRAXooTRDIlZ}
		      \( f\in L^1(\Omega_1\times \Omega_2)\),
		\item       \label{ITEMooJMPLooZKwxQC}
		      \begin{equation}
			      \int_{\Omega_1}\left[ \int_{\Omega_2}| f |d\mu_2 \right]d\mu_1 <\infty,
		      \end{equation}
		\item   \label{ITEMooLLBCooTRycwG}
		      \begin{equation}
			      \int_{\Omega_2}\left[ \int_{\Omega_1}| f |d\mu_1 \right]d\mu_2 <\infty.
		      \end{equation}
	\end{enumerate}
\end{corollary}

\begin{proof}

	Nous commençons par supposer que \( f\) est à valeurs dans \( \eR\). La notation \( | f |\), pour l'instant,  dénote donc bien la valeur absolue et non le module.

	La fonction \( | f |\) est mesurable et positive par hypothèse et par le fait que si \( f\) est mesurable, alors \( | f |\) l'est également par le corolaire~\ref{CORooNXYUooEcvDlP}. Le théorème~\ref{ThoWTMSthY}\ref{ITEMooFKQUooCoCOLV} nous dit alors que les intégrales suivantes existent et sont égales :
	\begin{equation}        \label{EQooAIQGooNtBOuC}
		\int_{\Omega_1\times \Omega_2}| f |d(\mu_1\otimes \mu_2)=\int_{\Omega_1}\left[ \int_{\Omega_2}|f(x,y)|d\mu_2(y) \right]d\mu_1(x)
		=\int_{\Omega_2}\left[ \int_{\Omega_1}|f(x,y)|d\mu_1(x) \right]d\mu_2(y).
	\end{equation}
	Attention : rien ne dit encore que ces intégrales sont finies.

	\begin{subproof}
		\spitem[\ref{ITEMooZRAXooTRDIlZ} implique~\ref{ITEMooJMPLooZKwxQC} et~\ref{ITEMooLLBCooTRycwG}]
		Si \( f\in L^1(\Omega_1\times \Omega_2)\) alors \( | f |\) y est également. Cela implique que le membre de gauche de \eqref{EQooAIQGooNtBOuC} est fini. Les deux autres sont alors également finis.
		\spitem[\ref{ITEMooJMPLooZKwxQC} ou~\ref{ITEMooLLBCooTRycwG} implique~\ref{ITEMooZRAXooTRDIlZ}]
		Les expressions à droite de \eqref{EQooAIQGooNtBOuC} sont finies. Donc celle de gauche également. Cele signifie que \( | f |\in L^1(\Omega_1\times \Omega_2)\). Par conséquent \( f\) est également dans \(L^1(\Omega_2\times \Omega_2) \).
	\end{subproof}

	Nous passons maintenant au cas où \( f\) est à valeurs dans \( \eC\). Nous décomposons
	\begin{equation}
		f=f_R+if_I
	\end{equation}
	où \( f_R\) et \( f_I\) sont des fonctions réelles. Nous avons
	\begin{equation}        \label{EQooZEOAooIMwKwk}
		\int_{\Omega}| f |\leq \int_{\Omega}| f_R |+\int_{\Omega}| f_I |.
	\end{equation}
	Donc si \( f_R\) et \( f_I\) sont dans \( L^1(\Omega)\), la fonction \( f\) le sera aussi. De même,
	\begin{equation}
		\int_{\Omega}| f_R |\leq \int_{\Omega}| f |,
	\end{equation}
	qui donne l'inverse : si \( f\in L^1(\Omega)\) alors \( f_R,f_I\in L^1(\Omega)\). Bref, \( f\) est intégrable sur \( \Omega\) si et seulement si \( f_R\) et \( f_I\) le sont.

	Supposons que \( f\in L^1(\Omega_1\times \Omega_2)\). Alors
	\begin{subequations}
		\begin{align}
			\int_{\Omega_1}\left[ \int_{\Omega_2}| f |d\mu_2 \right]d\mu_1 & \leq \int_{\Omega_1}\left[ \int_{\Omega_2}| f_R | \right]+\int_{\Omega_1}\left[ \int_{\Omega_2}| f_I | \right]<\infty
		\end{align}
	\end{subequations}
	où nous avons appliqué~\ref{ITEMooZRAXooTRDIlZ} implique~\ref{ITEMooJMPLooZKwxQC} aux fonctions \( f_R\) et \( f_I\) qui sont dans \( L^1(\Omega_1\times \Omega_2)\) parce que \( f\) y est.

	Dans l'autre sens, si
	\begin{equation}
		\int_{\Omega_1}\left[ \int_{\Omega_2}| f | \right]<\infty,
	\end{equation}
	alors en remplaçant \( | f |\) par \( | f_R |\) ou par \( | f_I |\) nous restons fini. En appliquant alors «\ref{ITEMooJMPLooZKwxQC} implique~\ref{ITEMooZRAXooTRDIlZ}» nous trouvons que \( f_R\) et \( f_I\) sont dans \( L^1(\Omega_1\times \Omega_2)\). Et cela implique que \( f\in L^1(\Omega_1\times \Omega_2)\).
\end{proof}

\begin{theorem}[Fubini\cite{MesIntProbb}]\label{ThoFubinioYLtPI}
	Soient \( (\Omega_i,\tribA_i,\mu_i)\) deux espaces mesurés \( \sigma\)-finis, et \( (\Omega,\tribA,\mu)\) l'espace produit. Soit
	\begin{equation}
		f\in L^1\big( (\Omega,\tribA),\eC \big),
	\end{equation}
	c'est-à-dire une fonction à valeurs mesurable et intégrable sur \( \Omega\). Alors :
	\begin{enumerate}
		\item       \label{ITEMooVFGWooZTePQS}
		      Pour presque tout \( x\in \Omega_1\), la fonction \( y\mapsto f(x,y)\) est \( L^1(\Omega_2)\).
		\item       \label{ITEMooCYMKooUdizni}
		      Si nous posons
		      \begin{equation}
			      \varphi_f(x)=\int_{\Omega_2}f(x,y)d\mu_2(y);
		      \end{equation}
		      alors \( \varphi_f\in L^1(\Omega_1)\).
		\item   \label{ItemQMWiolgiii}
		      Nous avons la formule d'inversion d'intégrale
		      \begin{subequations}
			      \begin{align}
				      \int_{\Omega}fd(\mu_1\otimes \mu_2) & =\int_{\Omega_1}\varphi_fd\mu_1                                         \\
				                                          & =\int_{\Omega_1}\left[ \int_{\Omega_2}f(x,y)d\mu_2(y) \right]d\mu_1(x)  \\
				                                          & =\int_{\Omega_2}\left[ \int_{\Omega_1}f(x,y)d\mu_1(x) \right]d\mu_2(y).
			      \end{align}
		      \end{subequations}
	\end{enumerate}

\end{theorem}
\index{théorème!Fubini!espace mesuré}

\begin{proof}
	Nous commençons par supposer que \( f\) est à valeurs réelles : \( f\in L^1\big( (\Omega_1\times \Omega_2,\tribA_1\otimes\tribA_2 ),\eR\big)\). Nous décomposons la fonction \( f\) en parties positives et négatives : \( f=f^+-f^-\) avec \( f^+\) et \( f^-\) positives ou nulles. Nous avons évidemment
	\begin{equation}
		\int_{\Omega_1\times \Omega_2}| f^+ |\leq \int_{\Omega_1\times \Omega_2}| f |<\infty.
	\end{equation}
	Donc \( f^+\) et \( f^-\) sont des éléments de \( L^1(\Omega_1\times \Omega_2)\).

	\begin{subproof}
		\spitem[Pour~\ref{ITEMooVFGWooZTePQS}]

		Nous posons
		\begin{equation}
			\varphi_{f^+}(x)=\int_{\Omega_2}f^{+}(x,y)d\mu_2(y)
		\end{equation}
		pour tous les \( x\in \Omega_1\) pour lesquels cette intégrale est bien définie. Vu que \( f^+\) est positive et mesurable, le théorème de Fubini-Tonelli~\ref{ThoWTMSthY}\ref{ITEMooUTMNooVIBdpP} s'applique donc pour nous dire que \( \varphi_{f^+}\) est mesurable.

		De plus le résultat \eqref{EqJRVtOGx} appliqué à \( f^+\) donne
		\begin{equation}        \label{EQooSETWooRwkCuW}
			\int_{\Omega_1}\varphi_{f^+}d\mu_1=\int_{\Omega_1\times \Omega_2}f^+d(\mu_1\otimes \mu_2)<\infty.
		\end{equation}
		Le fait que le tout soit fini est une conséquence du fait déjà mentionné que \( f^+\in L^1(\Omega_1\times \Omega_2)\). Vu que \( \varphi_{f^+}\) est une fonction positive, l'inégalité \eqref{EQooSETWooRwkCuW} signifie que \( \varphi_{f^+}\in L^1(\Omega_1,\mu_1)\).

		En particulier, \( \varphi_{f^+}(x)<\infty\) pour presque tout \( x\in\Omega_1\). C'est-à-dire pour presque tout \( x\in \Omega_1\) :
		\begin{equation}
			\int_{\Omega_2}f^+(x,y)d\mu_2(y)<\infty,
		\end{equation}
		et sachant que \( f^+\geq 0\) nous avons \( f^+(x,\cdot)\in L^1(\Omega_2)\) pour presque tout \( x\).

		\spitem[Pour~\ref{ITEMooCYMKooUdizni}]

		Partout où \( \varphi_{f^+}\) et \( \varphi_{f^-}\) sont finies nous avons
		\begin{equation}
			\varphi_f=\varphi_{f^+}-\varphi_{f^-},
		\end{equation}
		et comme cela a lieu presque partout, nous pouvons considérer une partie mesurable \( A\subset \Omega_1\) telle que \( \mu_1(A)=0\) et \( \varphi_f(x)=\varphi_{f^+}(x)-\varphi_{f^-}(x)\) pour tout \( x\) hors de \( A\). Bref, nous posons
		\begin{equation}
			g(x)=\begin{cases}
				\varphi_{f^+}-\varphi_{f^-}(x) & \text{si } x\in A^c \\
				0                              & \text{si } x\in A.
			\end{cases}
		\end{equation}
		Cette fonction \( g\) est mesurable et \( g=\varphi_f\) presque partout. De plus
		\begin{equation}
			\int_{\Omega_1}| g |d\mu_1   = \int_{A^c}| g |\leq \int_{A^c}\varphi_{f^+}+\int_{A^c}\varphi_{f^-}<\infty.
		\end{equation}
		La dernière inégalité est le fait que \( \varphi_{f^{\pm}}\) sont dans \( L^1(\Omega_1)\). Et notons au passage que nous aurions pu laisser toutes les intégrales sur \( \Omega_1\) sans faire de précisions sur la distinction entre \( \Omega_1\) et \( A^c\) parce que la partie de \( \Omega_1\) sur laquelle \( \varphi_{f^{\pm}}\) sont infinies est trop petite pour changer la valeur de l'intégrale.

		Nous avons donc \( g\in L^1(\Omega_1)\), et par conséquent également \( \varphi_f\in L^1(\Omega_1)\) parce que ces deux fonctions sont égales presque partout (les classes sont égales).

		\spitem[Pour~\ref{ItemQMWiolgiii}]

		En utilisant l'équation \eqref{EQooSETWooRwkCuW} nous avons
		\begin{subequations}
			\begin{align}
				\int_{\Omega_1}\varphi_fd\mu_1 & =\int gd\mu_1=\int_{\Omega_1}\varphi_{f^+}-\int_{\Omega_1}\varphi_{f^-}      \\
				                               & =\int_{\Omega_1\times\Omega_2 }f^+d\mu-\int_{\Omega_1\times \Omega_2}f^-d\mu \\
				                               & =\int_{\Omega_1\times \Omega2}fd\mu.
			\end{align}
		\end{subequations}
		Et toutes ces intégrales sont finies.
	\end{subproof}

	Et c'est maintenant que nous considérons le cas complexe. Nous décomposons \( f=f_R+if_I\) avec des fonctions réelles \( f_R\) et \( f_I\). Comme déjà mentionné autour de \eqref{EQooZEOAooIMwKwk}, les fonctions \( f_R\) et \( f_I\) sont intégrables. Nous leur appliquons le théorème.

	Les valeurs de \( x\) pour lesquelles \( f_R(x,\cdot)\) et \( f_I(x,\cdot)\) ne sont pas dans \( L^1(\Omega_2)\) forment un ensemble de mesure nulle, nommons le \( A\). En posant
	\begin{equation}
		g(x,y)=\begin{cases}
			f_R(x,y)+if_I(x,y) & \text{si } x\in A^c \\
			0                  & \text{si } x\in A,
		\end{cases}
	\end{equation}
	nous avons que \( g(x,\cdot)\) est intégrable pour tout \( x\in A^c\). Vu que pour ces valeurs de \( x\) nous avons \( g(x,y)=f(x,y)\) nous en déduisons que pour \( x\in A^c\) nous avons aussi \( f(x,\cdot)\in L^1(\Omega_2)\).

	Les autres points se traitent de la même façon\quext{Attention : je n'ai pas vérifié explicitement. C'est juste une intuition. Vérifiez et écrivez-moi pour dire si c'est bon ou non.}.
\end{proof}

\begin{normaltext}      \label{NORMooKIRJooPvyPWQ}
	En pratique, il n'est pas toujours évident qu'une fonction soit intégrable sur \( \Omega_1\times \Omega_2\). Pour permuter des intégrales sur une fonction à deux paramètres nous faisons comme suit.
	\begin{enumerate}
		\item
		      Nous testons l'intégrabilité en chaine de \( | f |\), et si c'est bon, le corolaire~\ref{CorTKZKwP} nous donne \( f\in L^1(\Omega_1\times \Omega_2)\).
		\item
		      Nous utilisons le théorème de Fubini~\ref{ThoFubinioYLtPI} pour séparer et permuter les intégrales comme des ingénieurs.
	\end{enumerate}

	Si la fonction \( (x,y)\mapsto f(x)g(y)\) satisfait aux hypothèses du théorème de Fubini alors
	\begin{equation}    \label{EqTJEEsJW}
		\int_{\Omega_1\times \Omega_2} f(x)g(y)dx\otimes dy=\left( \int_{\Omega_1}f(x)dx \right)\left( \int_{\Omega_2}g(y)dy \right).
	\end{equation}
	Le théorème de Fubini est souvent utilisé sous cette forme.

\end{normaltext}

\begin{example}[Nécessité d'avoir des mesures \( \sigma\)-finies]
	Nous montrons que le théorème ne tient pas si une des deux mesures n'est pas \( \sigma\)-finie. Soit \( I=\mathopen[ 0 , 1 \mathclose]\). Nous considérons l'espace mesuré
	\begin{equation}
		(I,\Borelien(I),\lambda)
	\end{equation}
	où \( \Borelien(I)\) est la tribu des boréliens sur \( I\) et \( \lambda\) est la mesure de Lebesgue (qui est \( \sigma\)-finie). D'autre part nous considérons l'espace mesuré
	\begin{equation}
		(I,\partP(I),m)
	\end{equation}
	où \( \partP(I)\) est l'ensemble des parties de \( I\) et \( m\) est la mesure de comptage. Cette dernière n'est pas \( \sigma\)-finie parce que les seuls ensembles de mesure finie pour la mesure de comptage sont des ensembles finis, or une union dénombrable d'ensemble finis ne peut pas recouvrir l'intervalle \( I\).

	Nous allons montrer que dans ce cadre, l'intégrale de la fonction indicatrice de la diagonale sur \( I^2\) ne vérifie pas le théorème de Fubini. Étant donné que \( \Borelien(I)\subset\partP(I)\) nous avons
	\begin{equation}
		\Borelien(I^2)\subset\Borelien(I)\otimes\partP(I).
	\end{equation}
	Soit \( \Delta=\{ (x,x)\tq x\in I \}\). La fonction
	\begin{equation}
		\begin{aligned}
			g\colon I^2 & \to \eR     \\
			(x,y)       & \mapsto x-y
		\end{aligned}
	\end{equation}
	est continue et \( \Delta=g^{-1}(\{ 0 \})\) est donc fermé dans \( I^2\). L'ensemble \( \Delta\) est donc un borélien de \( I^2\) et par conséquent un élément de la tribu \( \Borelien(I)\otimes\partP(I)\). La fonction indicatrice \( \mtu_{\Delta}\) est alors mesurable pour l'espace mesuré
	\begin{equation}
		(I\times I,\Borelien(I)\otimes\partP(I),\lambda\otimes m).
	\end{equation}
	Pour \( x\) fixé nous avons
	\begin{equation}
		\mtu_{\Delta}(x,y)=\begin{cases}
			1 & \text{si } y= x    \\
			0 & \text{si } y\neq x
		\end{cases}=\mtu_{\{ x \}}(y),
	\end{equation}
	et donc
	\begin{subequations}
		\begin{align}
			A_1 & =\int_I\left( \int_I\mtu_{\Delta}(x,y)dm(y) \right)d\lambda(x) \\
			    & =\int_I\left( \int_I\mtu_{\{ x \}}(y)dm(y) \right)d\lambda(x)  \\
			    & =\int_I\Big( m(\{ x \}) \Big)d\lambda(x)                       \\
			    & =\int_I 1d\lambda(x)                                           \\
			    & =1.
		\end{align}
	\end{subequations}
	Par contre le support de \( \mtu_{\Delta}\) étant de mesure nulle pour la mesure de Lebesgue, nous avons
	\begin{equation}
		\int_I\mtu_{\Delta}(x,y)d\lambda(x)=0
	\end{equation}
	et par conséquent
	\begin{equation}
		A_2=\int_I\left( \int_I\mtu_{\Delta}(x,y)d\lambda(x) \right)dm(y)=0.
	\end{equation}
	Nous voyons donc que le théorème de Fubini ne s'applique pas.
\end{example}

\begin{example}  \label{EXooLUFAooGcxFUW}
	Nous nous proposons de calculer l'intégrale suivante en utilisant le théorème de Fubini :
	\begin{equation}
		G=\int_{\eR} e^{-x^2}dx=\sqrt{ \pi }
	\end{equation}
	alors que la fonction \( x\mapsto  e^{-x^2}\) n'a pas de primitives parmi les fonctions élémentaires.

	Nous allons le faire de deux façons. Une première directe en utilisant le théorème de Fubini sur un domaine non borné, et une seconde en utilisant Fubini sur un domaine borné, et en passant à la limite ensuite.

	\begin{subproof}
		\spitem[Fubini, domaine non borné]

		Par symétrie nous pouvons nous contenter de calculer
		\begin{equation}
			G_+=\int_0^{\infty} e^{-x^2}dx.
		\end{equation}
		L'astuce est de passer par l'intermédiaire
		\begin{subequations}
			\begin{align}
				H & =\int_{\eR^+\times\eR^+} e^{-(x^2+y^2)}dxdy       \label{EqIntFausasub} \\
				  & =\int_{\eR^+}\left( \int_{\eR^+} e^{-x^2} e^{-y^2}dx \right)dy          \\
				  & =\left( \int_{\eR^+} e^{-x^2} dx\right)^2                               \\
				  & =G_+^2
			\end{align}
		\end{subequations}
		L'intégrale \eqref{EqIntFausasub} se calcule en passant aux coordonnées polaires et le résultat est \( H=\frac{ \pi }{ 4 }\). Nous avons alors \( G=\frac{ \sqrt{\pi} }{ 2 }\) et
		\begin{equation}
			\int_{\eR} e^{-x^2}=\sqrt{\pi}.
		\end{equation}

		\spitem[Fubini, domaine borné, puis limite]
		Une variante, qui n'applique pas Fubini sur un domaine non borné. Nous commençons par écrire
		\begin{equation}
			I=\int_{-\infty}^{+\infty} e^{-x^2} dx := \lim_{R \to +\infty} \int_{-R}^{+R} e^{-x^2} dx
		\end{equation}
		et puis nous faisons le calcul
		\begin{equation}		\label{EqCalculInteeemoisxcar}
			\begin{aligned}[]
				I^2 & = \lim_{R \to +\infty} \left( (\int_{-R}^{+R} e^{-x^2} dx)( \int_{-R}^{+R} e^{-y^2} dy) \right) \\
				    & = \lim_{R \to +\infty} \left( \iint_{K_R}e^{-(x^2+y^2)} dx dy \right)                           \\
				    & = \lim_{R \to +\infty} \left( \iint_{C_R}e^{-(x^2+y^2)} dx dy \right)
			\end{aligned}
		\end{equation}
		où \( K\) est le carré de demi-côté \( R\) centré à l'origine et de côtés parallèles aux axes et \( C_R\) est le cercle de rayon \( R\) centré à l'origine.

		La première étape à justifier est simplement l'application de Fubini. Pour le passage de l'intégrale du carré vers le cercle, définissons
		\begin{equation}
			\begin{aligned}[]
				I_K(r) & =\int_{K_r}f, & I_C(r) & =\int_{C_r}f
			\end{aligned}
		\end{equation}
		où \( K_r\) est la carré de demi-côté \( r\) et \( C_r\) est le cercle de rayon \( r\). Le demi-côté du carré inscrit à \( C_r\) est \( \sqrt{2}\), donc pour tout \( r\) nous avons
		\begin{equation}
			I_K(\sqrt{2}r)\geq I_C(r)>I_K(r),
		\end{equation}
		et en prenant la limite, nous avons évidemment
		\begin{equation}
			\lim_{r\to \infty}I_K(\sqrt{2}r)=\lim_{r\to\infty}I_K(r),
		\end{equation}
		et donc cette limite est également égale à \( \lim_{r\to\infty}I_C(t)\).

		Il ne reste qu'à calculer la dernière intégrale sur le cercle en passant aux coordonnées polaires :
		\begin{equation}
			\int_{C_R} e^{-(x^2+y^2)}dxdy=\int_0^{2\pi}d\theta\int_0^Rr e^{-r^2}dr=\pi(1- e^{-R^2}).
		\end{equation}
		La limite donne \( \pi\), nous en déduisons que
		\begin{equation}    \label{EqFDvHTg}
			\int_{-\infty}^{\infty} e^{-x^2}dx=\sqrt{\pi}.
		\end{equation}
	\end{subproof}

\end{example}

Le théorème de Fubini-Tonelli nous permet également d'inverser des sommes et des séries. En effet une somme n'est rien d'autre qu'une intégrale pour la mesure de comptage :
\begin{equation}
	\sum_{n=0}^{\infty}a_n=\int_{\eN}a_ndm(n).
\end{equation}
La proposition suivante montre comment il faut faire.

\begin{proposition}\label{PropInversSumIntFub}
	Soient les espaces mesurés \( (\eN,\partP(\eN),m)\), \( (\eR^n,\Borelien(\eR^n),\lambda)\) où \( \lambda\) est la mesure de Lebesgue ainsi qu'une suite de fonctions positives \( f_n\colon \eR^d\to \eR\). Nous supposons de plus que la fonction \( f_n\) soit intégrable pour tout \( n\) et que les résultats forment une suite sommable. Alors
	\begin{equation}
		\sum_{n=0}^{\infty}\int_{\eR^n}f_n(x)dx=\int_{\eR^d}\sum_{n\in \eN}f_n(x)dx.
	\end{equation}
\end{proposition}
\index{mesure!de comptage}
\index{permuter!intégrale!et série}

\begin{proof}
	Nous pouvons la récrire le membre de gauche sous la forme
	\begin{equation}
		\int_{\eN}\left( \int_{\eR^n}f(n,x)dx \right)dm(n)
	\end{equation}
	avec la notation évidente \( f(n,x)=f_n(x)\). Prouvons que la fonction \( f\colon \eN\times\eR^d\to \eR\) ainsi définie est une fonction mesurable pour l'espace mesuré
	\begin{equation}
		\big( \eN\times\eR^d,\partP(\eN)\otimes\Borelien(\eR^d),m\otimes\lambda \big).
	\end{equation}
	Si \( A\subset\eR\), nous avons
	\begin{equation}
		f^{-1}(A)=\bigcup_{n\in\eN}\{ n \}\times f_n^{-1}(A).
	\end{equation}
	Chacun des ensembles dans l'union appartient à la tribu \( \partP(\eN)\times\Borelien(\eR^d)\) tandis que les tribus sont stables sous les unions dénombrables. La fonction \( f\) est donc mesurable. Comme nous avons supposé que \( f\) était positive, le théorème de Fubini-Tonelli s'applique et nous avons
	\begin{equation}
		\int_{\eR^d}\left( \int_{\eN}f(n,x)dm(n) \right)dx=\int_{\eR^d}\sum_{n\in \eN}f_n(x)dx.
	\end{equation}
\end{proof}

\begin{theorem}[Fubini]\label{ThoFubini}
	Soit \( (x,y)\mapsto f(x,y)\in\bar \eR\) une fonction intégrable sur \( B_n\times B_m\subset\eR^{n+m}\) où \( B_n\) et \( B_m\) sont des ensembles mesurables de \( \eR^n\) et \( \eR^m\). Alors :
	\begin{enumerate}
		\item pour tout \( x\in B_n\), sauf éventuellement en les points d'un ensemble \( G\subset B_n\) de mesure nulle, la fonction \( y\in B_m\mapsto f(x,y)\in\bar\eR\) est intégrable sur \( B_m\)
		\item
		      la fonction
		      \begin{equation}
			      \begin{aligned}
				      B_n\setminus G & \to \eR                    \\
				      x              & \mapsto \int_{B_m}f(x,y)dy
			      \end{aligned}
		      \end{equation}
		      est intégrable sur \( B_n\setminus G\).
		\item
		      On a
		      \begin{equation}
			      \int_{B_n\times B_m}f(x,y)dxdy=\int_{B_n}\left( \int_{B_m}f(x,y)dy \right)dx.
		      \end{equation}

	\end{enumerate}
\end{theorem}
\index{théorème!Fubini!dans \(  \eR^n\)}
\index{Fubini!théorème!dans \(  \eR^n\)}

Notons en particulier que si \( f(x,y)=\varphi(x)\phi(y)\), alors \( \int_{B_m}\varphi(y)dy\) est une constante qui peut sortir de l'intégrale sur \( B_n\), et donc
\begin{equation}		\label{EqFubiniFactori}
	\int_{B_n\times B_m}\varphi(x)\phi(y)dxdy=\int_{B_n}\varphi(x)dx\int_{B_m}\phi(y)dy.
\end{equation}

%-------------------------------------------------------
\subsection{Utiliser Fubini sur \( \eR^n\)}
%----------------------------------------------------

Nous montrons à présent une série de théorème qui disent que sur \( \eR^n\), nous pouvons intégrer dans l'ordre qu'on veut.

\begin{proposition}[\cite{MonCerveau}]	\label{PROPooODWYooWSlHlU}
	Si \( f\in L^1(\eR^{n})\), alors
	\begin{equation}
		\int_{\eR^n}f=\int_{\eR^{n-1}}\left[   \int_{\eR}f_{(x_1,\ldots,x_{n-1})}(t)t  \right]dx_1,\ldots,dx_{n-1}
	\end{equation}
	où, pour \( (x_1,\ldots,x_{n-1})\in \eR^{n-1}\), nous définissons
	\begin{equation}
		\begin{aligned}
			f_{(x_1,\ldots,x_{n-1})}\colon \eR & \to \eR                         \\
			t                                  & \mapsto f(x_1,\ldots,x_{n-1},t)
		\end{aligned}
	\end{equation}
\end{proposition}

\begin{proof}
	Il s'agit d'une application du théorème de Fubini \ref{ThoFubinioYLtPI}\ref{ItemQMWiolgiii} avec \( \Omega_1=\eR^{n-1}\) et \( \Omega_2=\eR\).
\end{proof}

\begin{lemma}[\cite{MonCerveau}]	\label{LEMooEDQUooZudeex}
	Soit un ouvert \( U\) de \( \eR^n\). Soit une fonction \( C^{\infty}\) à support compact \(f \colon U\to \eR  \). Alors l'application
	\begin{equation}
		\begin{aligned}
			g\colon \eR^n & \to \eR                              \\
			x             & \mapsto \begin{cases}
				                        0    & \text{si } x\not\in U \\
				                        f(x) & \text{si } x\in U
			                        \end{cases}
		\end{aligned}
	\end{equation}
	est de classe \( C^{\infty}\).
\end{lemma}

\begin{proposition}[\cite{MonCerveau}]	\label{PROPooCQEIooENbfux}
	Soit un ouvert \( U\) de \( \eR^n\). Soit une fonction \( C^{\infty}\) à support compact \(f \colon U\to \eR  \). Alors
	\begin{equation}
		\int_U\partial_if=0.
	\end{equation}
\end{proposition}

\begin{proof}
	En deux parties très inégales.
	\begin{subproof}
		\spitem[Si \( i=n\)]
		%-----------------------------------------------------------
		Nous considérons l'application du lemme \ref{LEMooEDQUooZudeex} :
		\begin{equation}
			\begin{aligned}
				g\colon \eR^n & \to \eR                              \\
				x             & \mapsto \begin{cases}
					                        0    & \text{si } x\not\in U \\
					                        f(x) & \text{si } x\in U
				                        \end{cases}
			\end{aligned}
		\end{equation}
		Elle est de classe \( C^{\infty}\) et vérifie
		\begin{equation}
			\int_U\partial_nf=\int_{\eR^n}\partial_ng.
		\end{equation}
		Soit \( a\in \eR^n\). Nous posons
		\begin{equation}
			\begin{aligned}
				h\colon \eR & \to \eR            \\
				t           & \mapsto g(a+te_n).
			\end{aligned}
		\end{equation}
		Nous avons
		\begin{subequations}
			\begin{align}
				(\partial_ng)(a+ue_n) & =\frac{d}{dt} \left[ g(a+ue_n+te_n)  \right]_{t=0}          \\
				                      & =\frac{d}{dt} \left[ g\big( a+(t+u)e_n \big)  \right]_{t=0} \\
				                      & =\frac{d}{dt} \left[ h(t+u)  \right]_{t=0}                  \\
				                      & =h'(u).
			\end{align}
		\end{subequations}
		Nous pouvons donc déjà calculer une intégrale :
		\begin{subequations}
			\begin{align}
				\int_{\eR}(\partial_ng)(a+te_n)dt & = \int_{\eR}h'(t)dt                                                               \\
				                                  & =\lim_{R\to\infty}\int_{-R}^Rh'(t)dt      & \text{prop. \ref{PROPooSBKEooOlxqRk}} \\
				                                  & =\lim_{R\to \infty}\Big( h(R)-h(-R) \Big) & \text{tho. \ref{ThoRWXooTqHGbC}}      \\
				                                  & =0.
			\end{align}
		\end{subequations}
		La dernière égalité est parce que \( h(R)=g(a+Re_t)\) et que \( g\) est à support compact.

		Nous utilisons la proposition \ref{PROPooODWYooWSlHlU} pour isoler l'intégrale sur \( x_n\) dans \( \int_{\eR^n}\partial_ig\) :
		\begin{equation}
			\int_{\eR^n}\partial_ng=\int_{\eR^{n-1}}\left[   \int_{\eR}(\partial g)(a+te_n)dt \right]da_1\ldots da_{n-1}=0.
		\end{equation}

		\spitem[Si \( i\neq n\)]
		%-----------------------------------------------------------

		Nous considérons l'application \(\sigma \colon \eR^n\to \eR^n  \) qui permute \( e_i\) et \( e_n\). Nous avons \( \int_{\eR^n}f\circ\sigma=\int_{\eR^n}f\) par le changement de variables, théorème \ref{THOooUMIWooZUtUSg}. Cela nous ramène au cas \( i=n\).

	\end{subproof}
\end{proof}


%---------------------------------------------------------------------------------------------------------------------------
\subsection{Absolue continuité et variation bornée}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}[\cite{BIBooSQMWooEgERdj,BIBooFNPXooFAavvy}]	\label{DEFooLZWPooSSRaMv}
	Soit un intervalle \( I\) de \( \eR\). Une fonction \(f \colon I\to \eR  \) est \defe{absolument continue}{absolument continue} si pour tout \( \epsilon>0\), il existe \( \delta>0\) tel que pour tout suite finie \( \{ \mathopen[ a_n,b_n\mathclose] \}_{n\leq N}\) de sous-intervalles de \( I\) d'intérieurs disjoints,
	\begin{equation}
		\sum_{n\geq 0}(b_n-a_n)<\delta\Rightarrow \sum_{n\geq 0}| f(a_n)-f(b_n) |<\epsilon.
	\end{equation}
\end{definition}

\begin{proposition}[\cite{BIBooSQMWooEgERdj}]	\label{PROPooNZYKooSlwFYK}
	Soient des applications absolument continues \( f\) et \( g\) sur \( \mathopen[ a,b\mathclose]\). Alors
	\begin{enumerate}
		\item
		      \( f+g\), \( f-g\) et \( fg\) sont absolument continues.
		\item
		      Si il existe \( C>0\) tel que \( | g(x) |\geq C\) pour tout \( x\in\mathopen[ a,b\mathclose]\), alors \( f/g\) est absolument continue.
	\end{enumerate}
	%TODOooCJVTooPAdqBf. Prouver ça.
\end{proposition}

\begin{proposition}[\cite{BIBooSQMWooEgERdj}]	\label{PROPooHCCWooHaYitq}
	Si \( f\in L^1\big( \mathopen[ a,b\mathclose] \big)\), alors la fonction
	\begin{equation}
		\begin{aligned}
			F\colon \mathopen[ a,b\mathclose] & \to \eR                \\
			x                                 & \mapsto \int_a^xf(t)dt
		\end{aligned}
	\end{equation}
	est absolument continue.
	%TODOooJDXCooYASsUE. Prouver ça.
\end{proposition}


\begin{proposition}[\cite{BIBooSQMWooEgERdj}]	\label{PROPooUMXIooUhbZvl}
	Une application \( F\) sur \( \mathopen[ a,b\mathclose]\) est absolument continue\footnote{Définition \ref{DEFooLZWPooSSRaMv}.} si et seulement si il existe une application \( f\) intégrable sur \( \mathopen[ a,b\mathclose]\) telle que pour tout \( x\in\mathopen[ a,b\mathclose]\),
	\begin{equation}
		F(x)-F(a)=\int_a^xf(t)dt.
	\end{equation}
	%TODOooCXMBooSpSMXG. Prouver ça.
\end{proposition}


\begin{definition}[Variation totale, variation bornée\cite{BIBooFNPXooFAavvy,BIBooZBPJooEKNIRa}]	\label{DEFooLANWooGnVGPV}
	Soit un intervalle \( I\) de \( \eR\). Pour \( n\in \eN\) nous définissons
	\begin{equation}
		\mP_n=\{ (x_0,\ldots,x_n)\tq a=x_0\leq x_1\leq\ldots\leq x_n=b \}.
	\end{equation}
	et
	\begin{equation}
		\mP=\bigcup_{n=1}^{\infty}\mP_n.
	\end{equation}
	Si \( P\in \mP\), nous notons \( l(P)\) le \( n\in \eN\) tel que \( P\in\mP_n\). La \defe{variation totale}{variation totale} d'une application application \(f \colon I\to \eC  \) est le nombre
	\begin{equation}
		V_a^b(f)=\sup_{P\in\mP}\sum_{i=0}^{l(P)-1}| f(P_{i+1})-f(P_i) |.
	\end{equation}

	Nous disons que \( f\) est à \defe{variation bornée}{variation bornée} sur \( \mathopen[ a,b\mathclose]\) si \( V_a^b(f)<\infty\). L'ensemble des fonctions à variation bornée de \( \mathopen[ a,b\mathclose]\) est noté \( BV\big( \mathopen[ a,b\mathclose] \big)\).
\end{definition}

\begin{proposition}[\cite{BIBooFNPXooFAavvy}]	\label{PROPooDJTDooMMWMcS}
	Si \( f\) est à variation bornée sur \( \mathopen[ a,b\mathclose]\) et si \( c\in \mathopen[ a,b\mathclose]\), alors
	\begin{equation}
		V_a^b(f)=V_a^c(f)+V_c^b(f).
	\end{equation}
	%TODOooGVWJooDvTLXQ. Prouver ça.
\end{proposition}


\begin{proposition}[\cite{BIBooSQMWooEgERdj}]	\label{PROPooMONZooWVkYWb}
	Soit \( f\) absolument continue sur \( \mathopen[ a,b\mathclose]\). Alors \( f\) est à variation bornées sur \( \mathopen[ a,b\mathclose]\).
	%TODOooKDQHooVlTrKD. Prouver ça.
\end{proposition}


\begin{proposition}[\cite{BIBooFNPXooFAavvy}]	\label{PROPooVHGNooSDlrrq}
	À propos de fonctions à variation bornées.
	\begin{enumerate}
		\item
		      Une fonction \(f \colon \mathopen[ a,b\mathclose]\to \eR  \) est à variation bornée si et seulement si elle est la différence entre deux fonctions monotones sur \( \mathopen[ a,b\mathclose]\).
		\item
		      Si \( f\in BV\big( \mathopen[ a,b\mathclose] \big)\), alors \( f'(x)\) existe pour presque tout \( x\in \mathopen[ a,b\mathclose]\).
	\end{enumerate}
	%TODOooIXRJooVDHyFy. Prouver ça.
\end{proposition}



%-------------------------------------------------------
\subsection{Dérivation dans les bornes}
%----------------------------------------------------

\begin{probleme}		\label{PROPooCPWJooPydIHL}
	ça m'étonnerais que la proposition suivante soit correcte. Si \( \varphi\) et \( \psi\) ont des valeurs dans \( \eR\), alors les bornes de l'intégrale ne sont pas spécialement dans le domaine de définition de \( f\).
	%TODOooFPNPooAoukms. Traiter ce problème et probablement supprimer la proposition.
\end{probleme}

La proposition suivante sera utilisée entre autres pour montrer que sous l'hypothèse d'une densité continue, la loi exponentielle est sans mémoire, proposition~\ref{PropREXaIBg}.
\begin{proposition}     \label{PropDerrFnAvecBornesFonctions}
	Soit une application continue
	\begin{equation}
		f   \colon    [\alpha,\beta]\times[a,b]   \to \eR
	\end{equation}
	telle que \( \frac{ \partial f }{ \partial x }\) existe et soit continue sur \( ]\alpha,\beta[\times[a,b]\). Soient \( \varphi\) et \( \psi\), des fonctions continues de \( [\alpha,\beta]\) dans \( \eR\) et admettant une dérivée continue sur \( ]\alpha,\beta [\). Alors la fonction
		\begin{equation}
			\begin{aligned}
				F\colon \eR & \to \eR                                     \\
				x           & \mapsto \int_{\varphi(x)}^{\psi(x)}f(x,t)dt
			\end{aligned}
		\end{equation}
		admet une dérivée continue sur \( ]\alpha,\beta[\) et
	\begin{equation}    \label{EqFormDerrFnAvecBorneNInt}
		\frac{ dF }{ dx }=\int_{\varphi(x)}^{\psi(x)}\frac{ \partial f }{ \partial x }(x,t)dt+f\big( x,\psi(x) \big)\cdot\frac{ d\psi }{ dx }- f\big( x,\varphi(x) \big)\cdot\frac{ d\varphi }{ dx }.
	\end{equation}
	%TODOooFPNPooAoukms. Prouver ça. Voir le problème PROPooCPWJooPydIHL juste au-dessus.
\end{proposition}
\index{permuter!dérivée et intégrale!dans \( \eR\) avec les bornes}

L'exemple qui suit sera rendu rigoureux par les propositions \ref{PROPooUMIPooQGXaPd} et \ref{PropJLnPpaw}.
%TODOooRNUUooQFJyke. Il faut donc le déplacer, pour éviter de le citer.

\begin{example} \label{ExfYXeQg}
	Si \( g\) est une fonction continue, la fonction suivante est une primitive de \( g\) :
	\begin{equation}
		\int_0^xg(t)dt=\int_0^{\infty}g(t)\mtu_{t<x}(t)dt.
	\end{equation}
	Nous nous proposons de justifier \emph{de façon un peu heuristique} le fait que ce soit bien une primitive de \( g\) en considérant la fonction
	\begin{equation}
		f(t,x)=g(t)\mtu_{t<x}(t).
	\end{equation}
	Nous posons
	\begin{equation}
		F(x)=\int_0^{\infty}f(x,t)dt,
	\end{equation}
	et nous calculons \( F'\) en permutant la dérivée et l'intégrale\footnote{Ceci n'est pas rigoureux : il faudrait avoir un théorème à propos de distributions qui permet de le faire.}. D'abord,
	\begin{equation}
		f(t,x)=\begin{cases}
			g(t) & \text{si } t\in \mathopen[ 0 , x \mathclose] \\
			0    & \text{sinon.}
		\end{cases}
	\end{equation}
	La dérivée de \( f\) par rapport à \( x\) est donnée par la distribution
	\begin{equation}
		\frac{ \partial f }{ \partial x }(t_0,x_0)=g(t_0)\delta(t_0-x_0).
	\end{equation}
	Donc
	\begin{equation}
		F'(x_0)=\int_0^{\infty}\frac{ \partial f }{ \partial x }(t,x_0)dt=\int_0^{\infty}g(t)\delta(t-x_0)=g(x_0),
	\end{equation}
	comme attendu.
\end{example}




\begin{proposition}[\cite{MonCerveau}]	\label{PROPooDOTQooWaMBrO}
	Soit un espace mesuré \( (\Omega,\tribA,\mu)\). Soient des fonctions réelles et mesurables \( f_n\) et \( g\) sur \( \Omega\). Si
	\begin{enumerate}
		\item
		      \( f_n(x)\leq g(x)\) pour presque tout \( x\in\Omega\),
		\item
		      \( \lim_{n\to\infty}f_n(x)=f(x)\) pour tout \( x\in \Omega\),
	\end{enumerate}
	alors \( f(x)\leq g(x)\) pour presque tout \( x\in \Omega\).
\end{proposition}

\begin{proof}
	Notons \( Z_n=\{ x\in \Omega\tq f_n(x)>g(x) \}\). La partie \( Z=\bigcup_{n\in \eN}Z_n\) est de mesure nulle par le lemme \ref{LemIDITgAy}. Pour chaque \( x\in \Omega\setminus Z\), nous avons \( f_n(x)\leq g(x)\) et nous pouvons passer à la limite pour obtenir \( f(x)\leq g(x)\). Cette dernière égalité étant valable sur \( \Omega\setminus Z\), elle est valable presque partout.
\end{proof}

\begin{proposition}[\cite{MonCerveau}]	\label{PROPooRUSEooFYGLLU}
	Si \( f\)  est une fonction intégrable et continue sur un voisinage de \( a\), alors
	\begin{equation}
		\lim_{n\to \infty}n\int_a^{a+1/n}f=f(a).
	\end{equation}
	%TODOooRDYLooBqkNXd. Prouver ça.
\end{proposition}

\begin{lemma}	\label{LEMooLRPJooUuwZRW}
	Soit une application mesurable \(f \colon \mathopen[ a,b\mathclose]\to \eR  \). Nous posons
	\begin{equation}
		E=\{ x\in\mathopen[ a,b\mathclose]\tq f(x)\neq 0 \},
	\end{equation}
	et nous supposons que\footnote{Mesure de Lebesgue.} \( \lambda(E)> 0\). Alors il existe \( \epsilon>0\) et \( E_{\epsilon}\subset E\) tel que
	\begin{enumerate}
		\item
		      \( \lambda(E_{\epsilon})>0\),
		\item
		      \( | f(x) |>\epsilon\) sur \( E_{\epsilon}\).
	\end{enumerate}
\end{lemma}

\begin{proof}
	Nous démontrons la contraposée. Pour chaque \( \epsilon>0\), nous posons \( A_{\epsilon}=\{ x\in \mathopen[ a,b\mathclose]\tq | f(x) |>\epsilon \}\), et nous supposons que \( \lambda(A_{\epsilon})=0\) pour tout \( \epsilon\).

	Nous en déduisons que \( \lambda(E)=0\). En effet nous avons \( E=\bigcup_{\substack{ n\in \eN \\ n\neq 0 }  }A_{1/n}\). Nous avons \( \lambda(E)=0\) comme union dénombrable d'ensemble de mesure nulle.
\end{proof}




%---------------------------------------------------------------------------------------------------------------------------
\subsection{Permuter limite et dérivée}
%---------------------------------------------------------------------------------------------------------------------------

\begin{normaltext}[\cite{TrenchRealAnalisys}]      \label{NORMALooGYUEooKrYjyz}
	Voici une preuve alternative du théorème \ref{THOooXZQCooSRteSr}. Elle utilise des intégrales; elle demande donc plus de dépendances.

	\paragraph{Énoncé}
	Soient une suite de fonctions \( f_i\colon \eR\to \eR\), une fonction \( f\colon \eR\to \eR\) et une fonction \( g\colon \eR\to \eR\) telles que
	\begin{enumerate}
		\item
		      \( f_i\) est de classe \( C^1\) pour tout \( i\),
		\item
		      \( f_i\to f\) simplement,
		\item
		      \( f_i'\to g\) uniformément sur tout compact.
	\end{enumerate}
	Alors
	\begin{enumerate}
		\item
		      \( f\) est de classe \( C^1\),
		\item
		      \( f'=g\),
		\item
		      \( f_i\to f\) uniformément sur tout compact.
	\end{enumerate}
	\paragraph{Preuve}

	Nous commençons par considérer \( x_0\in \eR\) et un intervalle compact \( K\) contenant \( x_0\). Nous montrons que \( f'(x_0)=g(x_0)\) en plusieurs étapes.
	\begin{subproof}
		\spitem[Une formule intégrale]
		Par hypothèse, les fonctions \( f_i\) sont continues (en particulier sur un ouvert contenant \( K\)), et le théorème fondamental de l'analyse \ref{ThoRWXooTqHGbC} donne
		\begin{equation}        \label{EQooFUBZooOVUhep}
			f_i(x)=f_i(x_0)+\int_{x_0}^xf_i'(t)dt
		\end{equation}
		pour tout \( x\in K\). Nous avons envie de prendre la limite \( i\to \infty\) en permutant la limite avec l'intégrale. Pour cela nous allons utiliser la convergence dominée de Lebesgue.

		\spitem[Convergence dominée]
		La convergence uniforme sur tout compact des fonctions continues \( f'_i\) vers \( g\) donne la continuité de \( g\), théorème \ref{ThoUnigCvCont}. En particulier \( g\) est bornée et donc intégrable sur le compact \( \mathopen[ x_0 , x \mathclose]\). Mais il en faut plus pour le théorème de la convergence dominée de Lebesgue (théorème \ref{ThoConvDomLebVdhsTf}). Soit \( a>0\); il existe \( N\) tel que pour tout \( i>n\) nous ayons \( \| f'_i-g \|<a\). Avec cela nous avons
		\begin{equation}
			| f'_i(x) |<| g(x) |+a
		\end{equation}
		pour tout \( x\in K\). En particulier, la fonction \( x\mapsto g(x)+a\) fonctionne pour la convergence dominée et nous pouvons permuter la limite et l'intégrale dans \eqref{EQooFUBZooOVUhep}.

		\spitem[Passage à la limite]

		En passant à la limite \( i\to \infty\) dans \eqref{EQooFUBZooOVUhep} nous trouvons
		\begin{equation}        \label{EQooAECSooZpoJhd}
			f(x)=f(x_0)+\int_{x_0}^xg(t)dt.
		\end{equation}
		\spitem[Premières conclusions]

		Il suffit maintenant de prendre la dérivée de \eqref{EQooAECSooZpoJhd} au point \( x=x_0\) grâce à la proposition \ref{PropEZFRsMj} :
		\begin{equation}
			f'(x_0)=g(x_0).
		\end{equation}
		Cela nous donne l'égalité \( f'=g\) parce que \( x_0\) était arbitraire.

		De plus \( g\) est continue comme limite uniforme des fonctions continues \( f'_i\). Plus précisément, pour voir la continuité de \( g\) en \( x_0\), prendre un ouvert borné \( B(x_0,r)\) autour de \( x_0\), et ensuite un compact \( K\) contenant cet ouvert. La convergence uniforme \( f'_i\to g\) sur \( K\) implique la convergence uniforme sur \( B(x_0,r)\) et donc la continuité sur \( B(x_0,r)\) (théorème \ref{ThoUnigCvCont}).

		\spitem[\( f_i\to f\) uniforme sur tout compact]

		Un compact n'étant pas spécialement connexe, nous ne pouvons pas reprendre le travail fait jusqu'ici sans prendre une petite précaution. Soit un compact \( L\). Cette partie de \( \eR\) étant bornée\footnote{Par le théorème de Borel-Lebesgue \ref{ThoXTEooxFmdI}}, nous pouvons prendre \( r\) assez grand pour que \( L\subset \overline{ B(0,r) }\). Nous posons \( K=\overline{ B(0,r) }\) et nous prouvons la convergence uniforme \( f_i\to f\) sur \( K\). A fortiori, cela donnera la convergence uniforme sur \( L\).

		Prenons la différence entre \eqref{EQooAECSooZpoJhd} et \eqref{EQooFUBZooOVUhep} :
		\begin{subequations}
			\begin{align}
				| f(x)-f_i(x) | & =\big| f(x_0)-f_i(x_0)+\int_{x_0}^x g(t)-f'_i(t)dt \big|                                               \\
				                & \leq | f(x_0)-f_i(x_0) |+\Big| \int_{x_0}^x| g(t)-f_i'(t) |dt  \Big|       \label{SUBEQooIWSJooGckNmj} \\
				                & \leq | (f-f_i)(x_0) |+| x-x_0 |\| g-f'_i \|_K.
			\end{align}
		\end{subequations}
		Notez les valeurs absolues autour de l'intégrale dans \eqref{SUBEQooIWSJooGckNmj}. Elles sont nécessaires parce que \( x\) est dans un voisinage de \( x_0\), sans que nous sachions si \( x\geq x_0\) ou \( x\leq x_0\) (ça change le signe de l'intégrale).

		Nous avons donc
		\begin{equation}
			\| f-f_i \|\leq | (f-f_i)(x_0) |+\diam(K)\| g-f'_i \|
		\end{equation}
		où \( \diam(K)\) est le diamètre de \( K\), c'est-à-dire la plus grande distance entre deux éléments de \( K\) c'est un nombre fini parce que \( K\) est borné. Il majore évidemment \( | x-x_0 |\). Le membre de droite tend vers zéro si \( i\to \infty\) parce que nous avons convergence simple \( f_i\to f\) et donc \( (f-f_i)(x_0)\to 0\), et parce que nous avons convergence uniforme sur tout compact, donc \( \| g-f_i' \|\to 0\).

		Nous avons donc bien \( \lim_{i\to \infty}\| f-f_i \|=0\), c'est-à-dire convergence uniforme de \( (f_i)\) vers \( f\) sur \( K\).
	\end{subproof}
\end{normaltext}
