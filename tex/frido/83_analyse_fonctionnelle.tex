% This is part of Mes notes de mathématique
% Copyright (c) 2011-2018
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Approximation}
%---------------------------------------------------------------------------------------------------------------------------

\begin{lemma}[Théorème fondamental d'approximation \cite{TribuLi}]      \label{LempTBaUw}
    Soit \( \Omega\) un espace mesurable et \( f\colon \Omega\to \mathopen[ 0 , \infty \mathclose]\) une application mesurable. Alors il existe une suite croissante d'applications étagées \( \varphi_n\colon \Omega\to \eR^+\) dont la limite est \( f\).

    De plus si \( f\) est bornée, la convergence est uniforme.
\end{lemma}

\begin{theorem}[\cite{HilbertLi}]       \label{ThoJsBKir}
    Soit \( I\) un intervalle de \( \eR\). L'espace \( \swD(I)\)\nomenclature[Y]{\( C_c(I)\)}{fonctions continues à support compact dans \( I\)} des fonctions continues à support compact sur \( I\) est dense dans \( L^2(I)\).
\end{theorem}
Ce théorème sera généralisé à tous les \( L^p(\eR^d)\) par le théorème~\ref{ThoILGYXhX}. Cependant \( L^p\) n'étant pas un Hilbert, il faudra travailler sans produit scalaire.

\begin{proof}
    Soit \( g\in L^2(I)\) une fonction telle que \( g\perp f\) pour toute fonction \( f\in C_c(I)\). Nous avons donc
    \begin{equation}
        \langle f, g\rangle =\int_If\bar g=0.
    \end{equation}
    En passant éventuellement aux composantes réelles et imaginaires nous pouvons supposer que les fonctions sont toutes réelles. Nous décomposons \( g\) en parties positives et négatives : \( g=g^+-g^-\). Notre but est de montrer que \( g^+=g^-\), c'est à dire que \( g\) est nulle. La proposition~\ref{PropqiWonByiBmc} conclura que \( C_c(I)\) est dense dans \( L^2(I)\).

    Soit un intervalle \( \mathopen[ a , b \mathclose]\subset I\) et une suite croissante de fonctions \( f_n\in C_c(I)\) qui converge vers \( \mtu_{\mathopen[ a , b \mathclose]}\). Par hypothèse pour chaque \( n\) nous avons
    \begin{equation}
        \int_If_ng^+=\int_I f_ng^-.
    \end{equation}
    La suite étant croissante, le théorème de la convergence monotone (théorème~\ref{ThoRRDooFUvEAN}) s'applique et nous avons
    \begin{equation}
        \lim_{n\to \infty} \int_I f_ng^+=\int_a^bg^+,
    \end{equation}
    de telle sorte que nous ayons, pour tout intervalle \( \mathopen[ a , b \mathclose]\subset I\) l'égalité
    \begin{equation}        \label{EqYlErAM}
        \int_a^bg^+=\int_a^bg^-.
    \end{equation}
    De plus ces intégrales sont finies parce que
    \begin{equation}
        \int_a^b g^+\leq\int_a^b| g |=\int_I| g |\mtu_{\mathopen[ a , b \mathclose]}=\langle | g |, \mtu_{\mathopen[ a , b \mathclose]}\rangle \leq \| g \|_{L^2}\sqrt{b-a}<\infty
    \end{equation}
    par l'inégalité de Cauchy-Schwarz.

    Soit maintenant un ensemble mesurable \( A\subset I\). La fonction caractéristique \( \mtu_A\) est mesurable et il existe une suite croissante de fonctions étagées \( (\varphi_n)\) convergente vers \( a\) par le lemme~\ref{LempTBaUw}. À multiples près, les fonctions \( \varphi_n\) sont des sommes de fonctions caractéristiques du type \( \mtu_{\mathopen[ a , b \mathclose]}\), par conséquent, en vertu de \eqref{EqYlErAM} nous avons
    \begin{equation}
        \int_I\varphi_ng^+=\int_I\varphi_ng^-.
    \end{equation}
    Une fois de plus nous pouvons utiliser le théorème de la convergence monotone et obtenir
    \begin{equation}
        \int_Ag^+=\int_A g^-
    \end{equation}
    pour tout ensemble mesurable \( A\subset I\). Si nous notons \( dx\) la mesure de Lebesgue, les mesures \( g^+dx\) et \( g^-dx\) sont par conséquent égales et dominées par \( dx\). Par le corollaire~\ref{CorZDkhwS} du théorème de Radon Nikodym, les fonctions \( g^+\) et \( g^-\) sont égales.
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Convolution}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Le théorème qui permet de définir le produit de convolution est la suivant.

\begin{theoremDef}[\cite{MesIntProbb}]     \label{THOooMLNMooQfksn}
    Soient \( f,g\in L^1(\eR^n)\).
    \begin{enumerate}
        \item
            Pour presque tout \( x\in \eR^n\), la fonction
            \begin{equation}
                y\mapsto g(x-y)f(y)
            \end{equation}
            est dans \( L^1(\eR^n)\), et nous définissons le \defe{produit de convolution}{produit!de convolution} de \( f\) et \( g\) par
            \begin{equation}
                (f*g)(x)=\int_{\eR^n} f(y)g(x-y)dy.
            \end{equation}
        \item
            \( f*g\in L^1(\eR^n)\).
        \item
            \( \| f*g \|_1\leq \| f \|_1\| g \|_1\).
    \end{enumerate}
\end{theoremDef}

L'ensemble \( L^1(\eR^n)\) devient alors une algèbre de Banach.

\begin{lemma}
    Le produit de convolution est commutatif : \( f*g=g*f\).
\end{lemma}

\begin{proof}
    Le théorème de Fubini (théorème~\ref{ThoFubinioYLtPI}) permet d'écrire
    \begin{equation}
        (f*g)(x)=\int_{\eR^n}f(y)g(x-y)dy=\int_{-\infty}^{\infty}dy_1\ldots \int_{-\infty}^{\infty}dy_nf(y)g(x-y).
    \end{equation}
    En effectuant le changement de variable \( z_i=x_i-y_i\) dans chacune des intégrales nous obtenons
    \begin{equation}
        (f*g)(x)=\int_{\eR^n}g(z)f(x-z)dz=(g*f)(x).
    \end{equation}
    Attention : on pourrait croire qu'un signe apparaît du fait que \( z=x-y\) donne \( dz=-dy\). Mais en réalité, l'intégrale \( \int_{-\infty}^{+\infty}\) devient par le même changement de variables \( \int_{+\infty}^{-\infty}\) qui redonne un nouveau signe au moment de remettre dans l'ordre.
\end{proof}

\begin{proposition}     \label{PROPooDMMCooPTuQuS}
    Si \( 1\leq p\leq \infty\) et si \( f\in L^p(\eR^d)\) et \( g\in L^1(\eR^d)\) alors
    \begin{enumerate}
        \item
            \( f*g\in L^p\)
        \item
            \( \| f*g \|_p\leq \| f \|_p\| g \|_1\).
    \end{enumerate}
\end{proposition}
Cette proposition est une conséquence de l'inégalité de Minkowski sous forme intégrale :~\ref{PropInegMinkKUpRHg}\ref{ItemDHukLJiii}.

\begin{proposition}[\cite{CXCQJIt}] \label{PropHNbdMQe}
    Si \( f\in L^1(\eR)\) et si \( g\) est dérivable avec \( g'\in L^{\infty}\), alors \( f*g\) est dérivable et \( (f*g)'=f*g'\).
\end{proposition}

\begin{proof}
    La fonction qu'il faut intégrer pour obtenir \( f*g\) est $f(t)g(x-t)$, dont la dérivée par rapport à \( x\) est \( f(t)g'(x-t)\). La norme de cette dernière est majorée (uniformément en \( x\)) par \( G(t)=| f(t) | \| g' \|_{\infty}\). La fonction \( f\) étant dans \( L^1(\eR)\), la fonction \( G\) est intégrable et le théorème de dérivation sous l'intégrale (théorème~\ref{ThoMWpRKYp}) nous dit que \( f*g\) est dérivable et
    \begin{equation}
        (f*g)'(x)=\frac{ d }{ dx }\int_{\eR}f(t)g(x-t)dt=\int_{\eR}f(t)g'(x-t)dt=(f*g')(x).
    \end{equation}
\end{proof}

\begin{corollary}       \label{CORooBSPNooFwYQrc}
    Si \( f\in L^1(\eR^d)\) et si \( g\) est de classe \(  C^{\infty}\), alors \( f*g\) est de classe \(  C^{\infty}\).
\end{corollary}

\begin{proof}
    Il s'agit d'itérer la proposition~\ref{PropHNbdMQe}.
\end{proof}

\begin{lemma}       \label{LemDQEKNNf}
    Soit \( f\in L^2(I)\) telle que
    \begin{equation}
        \int_If\varphi=0
    \end{equation}
    pour toute fonction \( \varphi\in C^{\infty}_c(I)\). Alors \( f=0\) presque partout sur \( I\).
\end{lemma}

\begin{proof}
    Nous considérons la forme linéaire
    \begin{equation}
        \begin{aligned}
            \phi\colon L^2(I)&\to \eC \\
            g&\mapsto \langle f, g\rangle=\int_If\bar g .
        \end{aligned}
    \end{equation}
    Par densité\footnote{Théorème~\ref{ThoILGYXhX}\ref{ItemYVFVrOIv}.} nous pouvons aussi considérer une suite \( (\varphi_n)\) dans \(  C^{\infty}_c(I)\) convergeant dans \( L^2\) vers \( f\). Alors nous avons pour tout \( n\) :
    \begin{equation}
        \langle f, \varphi_n\rangle =0.
    \end{equation}
    En passant à la limite, \( \langle f, f\rangle =0\), ce qui implique \( f=0\) dans \( L^2\) et donc \( f=0\) presque partout en tant que bonne fonction.
\end{proof}
Ce résultat est encore valable dans les espaces \( L^p\) (proposition~\ref{PropUKLZZZh}), mais il demande le théorème de représentation de Riesz\footnote{Théorème~\ref{ThoLPQPooPWBXuv}.}.

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Approximation de l'unité}
%---------------------------------------------------------------------------------------------------------------------------

Nous considérons \( \Omega=\eR^d\) ou \( (S^1)^d\).

\begin{definition}
    Une \defe{approximation de l'unité}{approximation!de l'unité} sur \( \Omega\) est une suite \( (\varphi_n)\) dans \( L^1(\Omega)\) telle que
    \begin{subequations}
        \begin{align}
            \sup_k \| \varphi_k \|_1 <\infty\\
            \int_{\Omega}\varphi_n=1        \label{subeqAQcisBt}\\
            \lim_{k\to \infty} \int_{\Omega\setminus B(0,\alpha)}| \varphi_k |=0
        \end{align}
    \end{subequations}
    pour tout \( n\) et pour tout \( \alpha>0\).
\end{definition}
%TODO : voir si ça n'approxime pas un delta de Dirac d'une façon ou d'une autre.
Ce sont des fonctions dont la masse vient s'accumuler autour de zéro. En effet quel que soit le voisinage \( B(0,\alpha)\), si \( k\) est assez grand, il n'y a presque plus rien en dehors.

Pour le point \eqref{subeqAQcisBt}, si \( \Omega\) est \( S^1\), la mesure que nous considérons est \( \frac{ dx }{ 2\pi }\).


\begin{example}
    Une façon de construire une approximation de l'unité sur \( \eR\) est de considérer une fonction \( \varphi\in L^1(\Omega)\) telle que \( \int\varphi=1\) puis de poser
    \begin{equation}
        \varphi_k(x)=k^d\varphi(kx).
    \end{equation}
    Ici, \( \Omega\) peut être \( \eR\) ou \( S^1\).
\end{example}

Le lemme suivant permet de construire des approximations de l'unité intéressantes.
\begin{lemma}[\cite{TUEWwUN}]   \label{LemCNjIYhv}
    Si nous posons
    \begin{equation}
        \varphi_n(x)=\left( \int\varphi(y)^n \right)^{-1}\varphi(x)^n,
    \end{equation}
    alors nous obtenons une approximation de l'unité dans les deux cas suivants :
    \begin{enumerate}
        \item
            Soit \( \varphi\) une fonction continue et positive sur \( S^1\) telle que \( \varphi(x)<\varphi(0)\) pour tout \( x\notin 2\pi \eZ\). Dans ce cas la mesure à prendre pour l'intégrale est \( \frac{ dy }{ 2\pi }\).
        \item
            Soit \( \varphi\) est une fonction continue et positive à support compact sur \( \eR^d\) telle que \( \varphi(x)>\varphi(0)\) pour tout \( x\neq 0\).

    \end{enumerate}
\end{lemma}

\begin{theorem}[\cite{TUEWwUN}] \label{ThoYQbqEez}
    Soit \( (\varphi_k)\) une approximation de l'unité sur \( \Omega=\eR^d\) ou \( (S^1)^d\).
    \begin{enumerate}
        \item
            Si \( g\) est mesurable et bornée sur \( \Omega\) et si \( g\) est continue en \( x_0\) alors
            \begin{equation}
                (\varphi_k*g)(x_0)\to g(x_0).
            \end{equation}
        \item
            Si \( g\in L^p(\Omega)\) (\( 1\leq p<\infty\)) alors
            \begin{equation}
                \varphi_k*g\stackrel{L^p}{\to}g.
            \end{equation}
        \item
            Si \( g\) est uniformément continue et bornée, alors
            \begin{equation}
                \varphi_k*g\stackrel{L^{\infty}}{\to}g
            \end{equation}
    \end{enumerate}
\end{theorem}

\begin{proof}
    Les trois points vont se ressembler.
    \begin{enumerate}
        \item
            Nous notons \( d_k=(\varphi_k*g)(x_0)-g(x_0)\) et nous devons prouver que \( d_k\to 0\). Vu que \( \varphi_k\) est d'intégrale \( 1\) sur \( \Omega\) nous pouvons écrire
            \begin{equation}
                |d_k|=\big| \int_{\Omega}\big( g(x_0-y)-g(x_0) \big)\varphi_k(y)dy\big|\leq\int_{\Omega}\big| g(x_0-y)-g(x_0) \big| |\varphi_k(y) |dy.
            \end{equation}
            Nous notons \( M=\sup_k\| \varphi_k \|_1\), et nous considérons \( \alpha>0\) tel que
            \begin{equation}
                \big| g(x_0-y)-g(x_0) \big|\leq \epsilon.
            \end{equation}
            Nous nous restreignons maintenant aux \( k\) suffisamment grands pour que \( \int_{\complement B(0,\alpha)}| \varphi_k(y) |dy\leq \epsilon\). Alors en découpant l'intégrale en \( B(0,\alpha)\) et son complémentaire dans \( \Omega\),
            \begin{equation}
                | d_k |\leq \epsilon M+\int_{\complement B(0,\alpha)} 2\| g \|_{\infty}| \varphi_k(y) |dy  \leq \epsilon M+2\| g \|_{\infty}\epsilon\leq \epsilon C.
            \end{equation}
            Donc oui, nous avons \( | d_k |\to 0\), et donc le premier point du théorème.

        \item

            Nous posons \( d_k(x)=(\varphi_k*g)(x)-g(x)\) et nous voulons prouver que \( \| d_k \|_{\infty}\to 0\), c'est à dire que \( d_k(x)\) converge vers zéro uniformément en \( x\). Nous posons aussi
            \begin{equation}
                \tau_y(g)\colon x\mapsto g(x-y).
            \end{equation}
            En récrivant le produit de convolution, une petite majoration donne
            \begin{equation}
                | d_k(x) |\leq \int_{\Omega}\| \tau_y(g)-g \|_{\infty}| \varphi_k(y) |dy.
            \end{equation}
            L'uniforme continuité de \( g\) signifie que pour tout \( \epsilon\), il existe un \( \alpha\) tel que pour tout \( y\in B(0,\alpha)\),
            \begin{equation}
                \| \tau_y(g)-g \|_{\infty}\leq \epsilon.
            \end{equation}
            Encore une fois nous découpons le domaine d'intégration en \( B=B(0,\alpha)\) et son complémentaire :
            \begin{subequations}
                \begin{align}
                    \| d_k \|_{\infty}&\leq\int_B\underbrace{\| \tau_y(g)-g \|_{\infty}}_{\leq \epsilon}| \varphi_k(y) |dy+\int_{\complement B}\underbrace{\| \tau_y(g)-g \|_{\infty}}_{\leq 2\| g \|_{\infty}}| \varphi_k(y) |\\
                    &\leq \epsilon M+2\| g \|_{\infty}\epsilon
                \end{align}
            \end{subequations}
            où la seconde ligne est justifiée par le choix d'un \( k\) assez grand pour que \( \int_{\complement B}| \varphi_k(y) |dy\leq \epsilon\).

            Nous avons donc bien \( \| d_k \|_{\infty}\to 0\).

        \item

            Cette fois \( g\in L^p(\Omega)\) et nous cherchons à montrer que \( \| d_k \|_p\to 0\). Encore qu'ici \( d_k\) soit défini à partir d'un représentant dans la classe de \( g\) et que d'ailleurs, nous allons travailler avec ce représentant.

            D'abord nous développons un peu ce \( d_k\) :
            \begin{subequations}
                \begin{align}
                \| d_k \|_p&=\left[ \int_{\Omega}\left|     \int_{\Omega}\big( g(x-y)-g(x) \big)\varphi_k(y)dy  \right|^pdx \right]^{1/p}\\
                &\leq\left[    \int_{\Omega}\Big( \int_{\Omega}| g(x-y)-g(x) |\cdot |\varphi_k(y) |dy \Big)^pdx \right]^{1/p}.
                \end{align}
            \end{subequations}
            À cette dernière expression nous appliquons l'inégalité de Minkowski (théorème~\ref{PropInegMinkKUpRHg}) sous la forme \eqref{EqZSiTZrH} pour la norme \( d\nu(y)=| \varphi_k(y) |dy\) et \( f(x,y)=g(x-y)-g(x)\) :
            \begin{equation}
                \| d_k \|_p\leq \int_{\Omega}\Big( \int_{\Omega}\big| g(x-y)-g(x) \big|^pdx \Big)^{1/p}| \varphi_k(y) |dy=\int_{\Omega}\| \tau_yg-g \|_p| \varphi_k(y) |dy.
            \end{equation}
            Par le lemme~\ref{LemCUlJzkA} nous pouvons trouver \( \alpha>0\) tel que \( \| \tau_yg-g \|_p\leq \epsilon\) pour tout \( y\in B(0,\alpha)\). Avec cela nous découpons encore le domaine d'intégration :
            \begin{equation}
                \| d_k \|_p\leq \int_{B(0,\alpha)}\underbrace{\| \tau_yg-g \|_p}_{\leq \epsilon}| \varphi_k(y) |dy+\int_{\complement B(0,\alpha)}  \underbrace{\| \tau_yg-g \|_p}_{\leq 2\| g \|_p}| \varphi_k(y) |dy\leq \epsilon M+2\epsilon\| g \|_p.
            \end{equation}
    \end{enumerate}
\end{proof}

Une petite remarque en passant : aussi triste que cela en ait l'air, la convergence uniforme n'implique pas la convergence \( L^p(\Omega)\) si \( \Omega\) n'est pas borné. En effet si \( f\in L^p\), la suite donnée par
\begin{equation}
    f_n(x)=f(x)+\frac{1}{ n }
\end{equation}
converge uniformément vers \( f\), mais
\begin{equation}
    \| f_n-f \|_p=\int_{\Omega}\frac{1}{ n }
\end{equation}
n'existe même pas si le domaine \( \Omega\) n'est pas borné.

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Densité des polynômes trigonométriques}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}      \label{DEFooGCZAooFecAHB}
    Le \defe{système trigonométrique}{système!trigonométrique} donné par \( \{ e_n \}_{n\in \eZ}\) est
    \begin{equation}
        e_n(t)= \frac{1}{ \sqrt{ 2\pi } } e^{int}.
    \end{equation}
\end{definition}

Une bonne partie de la douleur qu'évoque mot « densité » consiste à montrer que ce système est total dans \( L^2(S^1)=L^2(\mathopen[ 0 , 2\pi \mathclose])\), et donc en est une base hilbertienne.

\begin{definition}
    Un \defe{polynôme trigonométrique}{polynôme!trigonométrique} est une fonction de la forme
    \begin{equation}
        P(t)=\sum_{n=-N}^Nc_n e_n(t).
    \end{equation}
\end{definition}

\begin{definition}[Coefficients de Fourier]
    Pour toute fonction pour laquelle ça a un sens (que ce soit des fonctions \( L^2\) ou non), nous posons
    \begin{equation}\label{EqhIPoPH}
        c_n(f)=\langle f, e_n\rangle .
    \end{equation}
    Ces nombres sont les \defe{coefficients de Fourier}{coefficients!de Fourier} de \( f\). 
\end{definition}

Ces trois définitions n'ont a priori aucun rapport, et rien en particulier ne devrait vous faire penser à une égalité du type
\begin{equation}
    f(x)=\sum_{n=-\infty}^{\infty}c_n(f)e_n(x).
\end{equation}
Nous avons toutefois quelque liens.

\begin{lemma}   \label{LemZVfZlms}
    Deux petits résultats simples mais utiles à propos des polynômes trigonométriques.
    \begin{enumerate}
        \item
    Si \( f\in L^1(S^1)\), alors nous avons la formule
    \begin{equation}
        f*e_n=c_n(f)e_n.
    \end{equation}
\item

    Si \( P\) est un polynôme trigonométrique et si \( f\in L^1(S^1)\) alors \( f*P\) est encore un polynôme trigonométrique.
    \end{enumerate}
\end{lemma}

\begin{proof}
    Le premier point est un simple calcul :
    \begin{subequations}
        \begin{align}
            (f*e_n)(x)=\int_0^{2\pi}f(x-t)e_n(t)
        \end{align}
    \end{subequations}

    En ce qui concerne le second point, nous notons \( P=\sum_{k=-N}^NP_ke_k\), et par linéarité de la convolution,
    \begin{equation}
        f*P=\sum_{k=-N}^NP_kf*e_k=\sum_{k=-N}^nc_k(f)e_k,
    \end{equation}
    qui est encore un polynôme trigonométrique.
\end{proof}

\begin{example} \label{ExDMnVSWF}
    Sur \( S^1\) nous construisons alors l'approximation de l'unité basée sur la fonction \( 1+\cos(x)\) et le lemme~\ref{LemCNjIYhv}. Cette fonction est évidemment un polynôme trigonométrique parce que
    \begin{equation}
        \cos(x)=\frac{  e^{ix}+ e^{-ix} }{2}.
    \end{equation}
    Ensuite les puissances le sont aussi à cause de la formule du binôme :
    \begin{equation}
        \big( 1+\cos(x) \big)^n=\sum_{k=0}^n\binom{ n }{ k }\cos^n(x),
    \end{equation}
    dans laquelle nous pouvons remettre \( \cos(x)\) comme un polynôme trigonométrique et développer à nouveau la puissance avec (encore) la formule du binôme. La chose importante est qu'il existe une approximation de l'unité \( (\varphi_n)\) formée de polynômes trigonométrique.

    Ce qui fait la spécificité des polynômes trigonométriques est qu'ils sont à la fois stables par convolution (lemme~\ref{LemZVfZlms}) et qu'ils permettent de créer une approximation de l'unité sur \( \mathopen[ 0 , 2\pi \mathclose]\). Ce sont ces deux choses qui permettent de prouver l'important théorème suivant.
\end{example}

\begin{theorem} \label{ThoQGPSSJq}
    Les polynôme trigonométriques sont dense dans \( L^p(S^1)\) pour \( 1\leq p<\infty\).
\end{theorem}

\begin{proof}
    Soit \( f\in L^p(S^1)=L^p\big( \mathopen[ 0 , 2\pi \mathclose] \big)\), et \( (\varphi_n)\) une approximation de l'unité sur \( S^1\) formée de polynômes trigonométriques, par exemple ceux de l'exemple~\ref{ExDMnVSWF}. D'abord \( \varphi_k*f\) est un polynôme trigonométrique par le lemme~\ref{LemZVfZlms}, et ensuite nous avons convergence
    \begin{equation}
        \varphi_k*f\stackrel{L^p}{\to}f
    \end{equation}
    par le théorème~\ref{ThoYQbqEez}. Nous avons donc convergence \( L^p\) d'une suite de polynômes trigonométrique, ce qui prouve que l'espace de polynômes trigonométriques est dense dans \( L^p(S^1)\).
\end{proof}

\begin{remark}
    Deux remarques.
    \begin{itemize}
        \item
            Il n'est pas possible que les polynômes trigonométriques soient dense dans \( L^{\infty}\) parce qu'une limite uniforme de fonctions continues est continue (c'est le théorème~\ref{ThoUnigCvCont}).
        \item
            Nous donnerons au théorème~\ref{ThoDPTwimI} une démonstration indépendante de la densité des polynômes trigonométriques dans \( L^p(S^1)\).
    \end{itemize}
\end{remark}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Différents espaces \texorpdfstring{$L^2$}{$L^2$}}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\label{SECooEVZSooLtLhUm}

L'espace \( L^2\) est l'espace \( L^p\) définit à la section~\ref{SecVKiVIQK} avec \( p=2\). Cependant il possède une propriété extraordinaire par rapport aux autres \( L^p\), c'est que la norme \( | . |_2\) dérive d'un produit scalaire. Il sera donc un espace de Hilbert.

\begin{normaltext}  \label{NORMooUEIEooYtlFse}
    Nous en rappelons la construction. Soit \( (\Omega,\tribA,\mu)\) un espace mesuré. Nous considérons l'opération
    \begin{equation}    \label{DefProdScalLubrgTj}
        \langle f, g\rangle =\int_{\Omega}f(\omega)\overline{ g(\omega)}d\mu(\omega)
    \end{equation}
    et la norme associée
    \begin{equation}
        \| f \|_2=\sqrt{\langle f, f\rangle }.
    \end{equation}
    Nous considérons l'ensemble
    \begin{equation}
        \mL^2(\Omega,\mu)=\{ f\colon \Omega\to \eC\tq \| f \|_2<\infty \}
    \end{equation}
    et la relation d'équivalence \( f\sim g\) si et seulement si \( f(x)=g(x)\) pour \( \mu\)-presque tout \( x\).
\end{normaltext}

\begin{definition}      \label{DEFooSVCHooIwwuIx}
    Nous définissons le quotient
    \begin{equation}
        L^2(\Omega,\mu)=\mL^2(\Omega,\mu)/\sim.
    \end{equation}
\end{definition}

Ces espaces seront utilisés pour de nombreuses applications. Nous en aurons besoin pour plusieurs combinaisons d'ensembles \( \Omega\) et de mesures \( \mu\).
\begin{itemize}
    \item Pour \( \eR^d\)
    \item Pour \( S^1\)
    \item Pour \( \mathopen[ 0 , 2\pi \mathclose[\)
        \item Pour \( \mathopen[ -T , T \mathclose[\)
\end{itemize}
Le premier est non compact et il est raisonnable de penser qu'il sera foncièrement différents des autres. À isomorphismes assez triviaux près, les espaces des fonctions sur les trois autres sont identiques. Nous nous attendons donc à ce qu'ils aient les mêmes propriétés. Notons que du point de vue de \( L^2\), étant donné qu'il y a un quotient par les parties de mesures nulles, prendre \( \mathopen] 0 , 2\pi \mathclose[\) ou \( \mathopen[ 0 , 2\pi \mathclose]\) ou n'importe quelle autre possibilité de ce genre revient au même.

Afin de pouvoir utiliser ces espaces de façon optimale, et entre autres y définir les séries de Fourier, nous avons besoin, pour chacun d'entre eux de définir les éléments suivants :
\begin{itemize}
    \item mesure
    \item produit de convolution
    \item produit scalaire (que nous allons montrer plus bas être un produit scalaire)
    \item le système trigonométrique (que nous allons montrer être une base hilbertienne)
    \item coefficients de Fourier
\end{itemize}
Ça fait pas mal de choses à définir.

Les définitions qui viennent sont à prendre «tant que les formules ont un sens». Nous parlons donc de fonctions dans \( \Fun(\Omega,\eC)\), l'ensemble de toutes les fonctions sur \( \Omega\) à valeurs dans \( \eC\). Nous verrons plus tard les espaces de fonctions sur lesquels tout a un sens.
%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Sur \( \eR^d\)}
%---------------------------------------------------------------------------------------------------------------------------

La mesure est celle de Lebesgue. Le produit de convolution est donné, pour \( f,g\in\Fun(\eR^d,\eC)\), par
\begin{equation}
    (f*g)(x)=\int_{\eR^d}f(y)g(x-y)dy
\end{equation}
Certaines de ses propriétés ont déjà été vues dans la proposition \ref{THOooMLNMooQfksn}.

Le produit est donné par
\begin{equation}  
    \langle f, g\rangle =\int_{\eR^d}f(x)\overline{ g(x)}dy.
\end{equation}

En ce qui concerne le système trigonométrique, pour tout \( \xi\in \eR^d\) nous définirions bien
\begin{equation}
    e_{\xi}(x)= e^{i\xi x},
\end{equation}
genre pour faire que les transformations de Fourier sont des séries continues \ldots mais bon. Nous n'allons pas tenter le diable plus que ça, et nous ne définissons pas de système trigonométrique sur \( \eR^d\).

Pas de coefficients de Fourier non plus\footnote{Quand je disais que la non-compacité de \( \eR^d\) allait un peu changer les choses par rapport aux autres, je ne rigolais pas.}.

Bref, pas de théorie des séries de Fourier sur \( \eR^d\).

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Sur \( S^1\)}
%---------------------------------------------------------------------------------------------------------------------------

En tant qu'ensemble,
\begin{equation}
    S^1=\{  e^{it} \}_{t\in \eR},
\end{equation}
sans garanties que cette paramétrisation soit une bijection. Nous considérons sur \( S^1\) une mesure «normalisée» qui donne \( \mu(S^1)=1\), cela se traduit par des coefficients \( 1/2\pi\) dans certaines définitions.

Nous considérons la fonction
\begin{equation}
    \begin{aligned}
        \varphi\colon \eR&\to S^1 \\
        t&\mapsto e^{it}.
    \end{aligned}
\end{equation}

Si \( \varphi(u)=\varphi(t)\), alors \( u=t+2k\pi\) pour un certain \( k\in \eZ\). Cette condition implique que \( \varphi(t-\theta)=\varphi(u-\theta)\), et donc l'égalité 
\begin{equation}
    \int_0^{2\pi}(f\circ \varphi)(\theta)(g\circ\varphi)(t-\theta)\frac{ d\theta }{ 2\pi }=\int_0^{2\pi}(f\circ \varphi)(\theta)(g\circ\varphi)(u-\theta)\frac{ d\theta }{ 2\pi }.
\end{equation}
Cela nous permet de définir le produit de convolution sur \( S^1\) par
\begin{equation}
    (f*g)\big( \varphi(t) \big)=\int_0^{2\pi}(f\circ \varphi)(\theta)(g\circ\varphi)(t-\theta)\frac{ d\theta }{ 2\pi }
\end{equation}
pour toutes les paires de fonctions \( f,g\in \Fun(S^1,\eC)\) pour lesquelles l'intégrale converge.

Le produit se définit également avec un facteur \( 1/2\pi\) :
\begin{equation}
    \langle f, g\rangle =\frac{1}{ 2\pi }\int_0^{2\pi} (f\circ\varphi)(t)\overline{ (g\circ\varphi)(t) }dt,
\end{equation}
et la famille trigonométrique :
\begin{equation}
    \begin{aligned}
        e_n\colon S^1&\to \eC \\
        z&\mapsto \frac{1}{ \sqrt{ 2\pi } }z^n. 
    \end{aligned}
\end{equation}
Le but de \( z\mapsto z^n\) est d'être lu \(  t\mapsto e^{in t}\) lorsqu'on considère les fonctions sur \( \mathopen[ 0 , 2\pi \mathclose[\).

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Sur \( \mathopen[ 0 , 2\pi \mathclose[\)} 
%---------------------------------------------------------------------------------------------------------------------------

Le produit de convolution est un peut subtil parce que \( f(t-x)\) n'est pas défini a priori pour tout \( t,x\in \mathopen[ 0 , 2\pi \mathclose[\), vu que \( f\) n'est définie que sur \( \mathopen[ 0 , 2\pi \mathclose[\). Au moins trois solutions s'offrent à nous :
\begin{itemize}
    \item 
       considérer implicitement la fonction prolongée par périodicité.
   \item
       considérer les fonctions sur \( \eR/2\pi\), et définir un peut toutes les opérations modulo \( 2\pi\) (fastidieux)
   \item
       passer à \( S^1\) sur lequel tout est déjà fait.
\end{itemize}
Nous sélectionnons la troisième voie. Pour cela nous considérons la fonction (attention, elle n'est pas tout à fait la même que celle plus haut)
\begin{equation}
    \begin{aligned}
        \varphi\colon \mathopen[ 0 , 2\pi \mathclose[&\to S^1 \\
            t&\mapsto  e^{it} 
    \end{aligned}
\end{equation}
qui est une bijection.

Le produit\footnote{Encore une fois, nous ne sous-entendons pas ici que c'est un produit scalaire ou quoi que ce soit de ce genre. Ici nous ne donnons que des formules.} est
\begin{equation}
    \langle f, g\rangle=\langle f\circ\varphi^{-1}, g\circ\varphi^{-1}\rangle  =\frac{1}{ 2\pi }\int_0^{2\pi}f(x)\overline{ g(x) }dx.
\end{equation}
Pour le produit de convolution,
\begin{equation}
    (f * g)(x)=(f\circ \varphi^{-1})*(g\circ\varphi^{-1})\big( \varphi(x) \big).
\end{equation}


%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Sur \( \mathopen[ -T , T \mathclose[\)}
%---------------------------------------------------------------------------------------------------------------------------

    Encore à faire.

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{La suite}
%---------------------------------------------------------------------------------------------------------------------------
    
\begin{lemma}   \label{LemIVWooZyWodb}
    Soit un espace mesuré\quext{Est-ce qu'il ne faudrait pas un peu plus d'hypothèses, comme \( \sigma\)-fini par exemple ? Vérifiez et écrivez-moi quand vous avez la réponse.} \( (\Omega,\tribA,\mu)\).
    \begin{enumerate}
        \item
            Pour tout \( f,g\in L^2(\Omega,\tribA,\mu)\), le produit 
            \begin{equation}
                \langle f, g\rangle =\left( \int_{\Omega}f\bar g\,d\mu \right)^{1/2}
            \end{equation}
            est bien défini et est un nombre complexe\footnote{Par opposition au fait que ce serait l'infini}.
        \item
            L'opération \( (f,g)\mapsto \langle f, g\rangle \) est un produit hermitien\footnote{Définition \ref{DefMZQxmQ}. Pour rappel, nous considérons des fonctions à valeurs complexes. Si au contraire nous avions considéré seulement des fonctions à valeurs réelles, nous aurions eu un produit scalaire.}.
        \item
            Le couple \( \big( L^2(\Omega,\tribA,\mu),\langle ., .\rangle  \big)\) est un espace de Hilbert\footnote{Définition \ref{DefORuBdBN}.}.
    \end{enumerate}
\end{lemma}

\begin{proof}
    D'abord si \( f\) et \( g\) sont dans \( L^2\), alors l'inégalité de Hölder (proposition~\ref{ProptYqspT}) nous indique que le produit \( fg\) est un élément de \( L^1\). Par conséquent la formule a un sens.

    Ensuite nous montrons que la formule passe au quotient. Pour cela, nous considérons des fonctions \( \alpha\) et \( \beta\) nulles presque partout et nous regardons le produit de \( f_1=f+\alpha\) par \( g_1=g+\beta\) :
    \begin{equation}
        \langle f_1, g_1\rangle =\int fg+\beta f+\alpha g+ \alpha\beta.
    \end{equation}
    Les fonctions \( \beta f\), \( \alpha g\) et \( \alpha\beta\) étant nulles presque partout, leur intégrale est nulle et nous avons bien \( \langle f_1, g_1\rangle =\langle f,g \rangle \). Nous pouvons donc considérer le produit sur l'ensemble des classes.

    Pour vérifier que la formule est un produit scalaire, le seul point non évidement est de prouver que \( \langle f, f\rangle =0\) implique \( f=0\). Cela découle du fait que
    \begin{equation}
        \langle f, f\rangle =\int_{\Omega}| f |^2.
    \end{equation}
    La fonction \( x\mapsto | f(x) |^2\) vérifie les hypothèses du lemme~\ref{Lemfobnwt}. Par conséquent \( | f(x) |^2\) est presque partout nulle.

    En ce qui concerne le fait que \( L^2(\Omega)\) soit un espace de Hilbert, il s'agit simplement de se remémorer que c'est un espace complet (théorème ~\ref{ThoUYBDWQX}) et dont la norme dérive d'un produit scalaire. Nous sommes donc bien dans la définition~\ref{DefORuBdBN}.
\end{proof}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Coefficients et série de Fourier}
%---------------------------------------------------------------------------------------------------------------------------
\label{subSecXAYasNI}

Nous utilisons ici des résultats de bases hilbertiennes autour du théorème~\ref{ThoyAjoqP}. Nous considérons l'espace de Hilbert \( L^2\mathopen[ -T/2 , T/2 \mathclose]\) muni du produit scalaire\footnote{Il s'agit de  \eqref{DefProdScalLubrgTj}.}
\begin{equation}    \label{EqQBcpyyJ}
    \langle f, g\rangle =\int_{-T/2}^{T/2}f(t)\overline{ g(t) }dt.
\end{equation}

\begin{probleme}
    Attention à la cohérence : jusqu'au 27 mars 2018, la définition était
    \begin{equation}   
        \langle f, g\rangle =\frac{1}{ T }\int_{-T/2}^{T/2}f(t)\overline{ g(t) }dt,
    \end{equation}
    avec un coefficient supplémentaire qui causait de l'incohérence. Il y en a sûrement encore pas mal. 

    Signalez moi toutes les incohérences que vous pourriez trouver.
\end{probleme}

\begin{proposition}     \label{PROPooERHQooNYlggy}
    La famille de fonctions
    \begin{equation}
        e_k(t)=  e^{2i\pi kt/T}
    \end{equation}
    est une base hilbertienne de \( L^2\mathopen[ -T/2 , T/2 \mathclose]\) 
\end{proposition}


%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Le cas dans \( \mathopen[ 0 , 2\pi \mathclose]\)}
%---------------------------------------------------------------------------------------------------------------------------

En pratique, nous n'allons pas souvent travailler avec des fonctions sur \( \mathopen[ -T/2 , T/2 \mathclose]\), mais le plus souvent nous serons sur \( \mathopen[ 0 , 2\pi \mathclose]\).

Nous notons ici une conséquence du théorème~\ref{ThoGVmqOro} dans le cas de l'espace \( L^2\). La proposition suivante est une petite partie du corollaire~\ref{CorQETwUdF}, qui sera d'ailleurs démontré de façon indépendante.

\begin{proposition}
    Si nous avons une suite de réels \( (a_k)\) telle que \( \sum_{k=0}^{\infty}| a_k |^2<\infty\) alors la suite
    \begin{equation}
        f_n(x)=\sum_{k=0}^na_k e^{ikx}
    \end{equation}
    converge dans \( L^2\big( \mathopen] 0 , 2\pi \mathclose[ \big)\).
\end{proposition}

\begin{proof}
    Quitte à séparer les parties réelles et imaginaires, nous pouvons faire abstraction du fait que nous parlons d'une série de fonctions à valeurs dans \( \eC\) au lieu de \( \eR\).

    Un simple calcul est :
    \begin{equation}    \label{EqHVdJxZT}
        \| f_n-f_m \|^2\leq\int_0^{2\pi}\sum_{k=n}^m| a_k |^2dx\leq 2\pi\sum_{k=n}^m| a_k |^2.
    \end{equation}
    Par hypothèse le membre de droite est \( | s_m-s_n |\) où \( s_k\) dénote la suite des sommes partielles de la série des \( | a_k |^2\). Cette dernière est de Cauchy (parce que convergente dans \( \eR\)) et donc la limite \( n\to\infty\) (en gardant \( m>n\)) est zéro. Donc la suite des \( f_n\) est de Cauchy dans \( L^2\) et donc converge dans \( L^2\).
\end{proof}

Adaptons tout cela pour l'espace \( L^2\big( \mathopen[ 0 , 2\pi \mathclose] \big)\). Nous posons
\begin{equation}        \label{EQooBFKDooMkCZOt}
    \langle f, g\rangle =\int_0^{2\pi}f(t)\overline{ g(t) }dt
\end{equation}
et
\begin{equation}        \label{EQooKMYOooLZCNap}
    e_n(t)=\frac{1}{ \sqrt{ 2\pi } } e^{int}.
\end{equation}


L'importance du système trigonométrique défini en \ref{DEFooGCZAooFecAHB} est d'être une base de \( L^2\big( \mathopen[ 0 , 2\pi \mathclose] \big)\), comme précisé dans le lemme suivant.
\begin{lemma}       \label{LEMooBJDQooLVPczR}
    Le système trigonométrique \( \{ e_n \}_{n\in \eZ}\) est une base hilbertienne de \( L^2\big( \mathopen[ 0 , 2\pi \mathclose] \big)\).
\end{lemma}

\begin{proof}
    Pour rappel, une base hilbertienne est la définition~\ref{DEFooADQXooFoIhTG}. Nous prouvons d'abord que le système est orthogonal. Nous avons
    \begin{equation}
        \langle e_n, e_m\rangle =\frac{1}{ 2\pi }\int_0^{2\pi} e^{i(n-m)t}dt.
    \end{equation}
    Si \( n=m\), alors cela est égal à \( 1\). Sinon c'est une intégrale simple :
    \begin{equation}
        \langle e_n, e_m\rangle =\left[ \frac{ i }{ n-m } e^{i(n-m)t} \right]_0^{2\pi}=0.
    \end{equation}
    Cela est pour l'orthogonalité.

    Pour que le système soit total, il faut que son espace vectoriel engendré soit dense. Cela est le théorème~\ref{ThoQGPSSJq}.
\end{proof}

Note : le théorème~\ref{ThoDPTwimI} donné aussi la densité, mais sera démontré plus tard, indépendamment. Voir aussi les thèmes~\ref{THEooPUIIooLDPUuq} et~\ref{THEMooNMYKooVVeGTU}.

Pour un élément donné \( f\in L^2\big( \mathopen[ 0 , 2\pi \mathclose] \big)\), nous définissons\nomenclature[Y]{\( S_nf\)}{somme partielle de série de Fourier}
\begin{equation}
    S_nf=\sum_{k=-n}^n\langle f, e_k\rangle e_k
\end{equation}
et nous avons le théorème suivant, qui récompense les efforts consentis à propos de la densité des polynômes trigonométriques dans \( L^2\).

\begin{theorem} \label{ThoYDKZLyv}
    Soit \( f\in L^2\big( \mathopen[ 0 , 2\pi \mathclose] \big)\). Nous avons égalité\footnote{Notons que la somme sur \( \eZ\) dans \eqref{EqXMMRpSN} est commutative; il n'est donc pas besoin d'être plus précis.}
    \begin{equation}    \label{EqXMMRpSN}
        f=\sum_{n\in \eZ}c_n(f)e_n
    \end{equation}
    dans \( L^2\).

    Nous avons aussi la convergence
\begin{equation}    \label{EqRBWKsYP}
    S_nf\stackrel{L^2}{\to} f.
\end{equation}
\end{theorem}

\begin{proof}
    Le système trigonométrique \( \{ e_n \}_{n\in \eZ}\) est total pour l'espace de Hilbert \( L^2\big( \mathopen[ 0 , 2\pi \mathclose] \big)\) (sans périodicité particulière). Donc le point~\ref{ItemQGwoIxi} du théorème~\ref{ThoyAjoqP} nous donne l'égalité demandée.

    La convergence \eqref{EqRBWKsYP} est une reformulation de l'égalité \eqref{EqXMMRpSN}.
\end{proof}

\begin{normaltext}
    Obtenir la convergence \( L^2\) ne demande pas d'hypothèses de périodicité : la convergence \eqref{EqRBWKsYP} est automatique du fait que le système trigonométrique soit total. Ce n'est cependant pas plus qu'une convergence \( L^2\) et elle ne demande pas \( f(0)=f(2\pi)\), même si pour chacun des \( e_k\) nous avons \( e_k(0)=e_k(2\pi)\).

    Si \( f(2\pi)\neq f(0)\), alors il existe tout de même une suite \( (f_n)\) convergente vers \( f\) au sens \( L^2\) telle que \( f_n(0)=f_n(2\pi)\). Cela ne contredit en rien le fait que \( e_k(0)=e_k(2\pi)\) parce que dans \( L^2\), la valeur d'un point seul n'a pas d'importance.

    Si nous voulons une vraie convergence ponctuelle voir uniforme \( (S_nf)(x)\to f(x)\), alors il faut ajouter des hypothèses sur la continuité de \( f\), sa périodicité ou le comportement des coefficients \( c_n\). Voir aussi le thème~\ref{THMooHWEBooTMInve}.
\end{normaltext}

\begin{example}     \label{EXooQDWUooLtuIOm}
    Si \( f\in L^2\big( \mathopen[ 0 , 2\pi \mathclose] \big)\) est (la classe de) une fonction à valeurs réelles, alors on peut la développer avec nettement moins de termes. D'abord nous savons que \( e_{-n}=\overline{ e_n }\), et donc
    \begin{equation}
        \langle f, e_n\rangle =\overline{ \langle f, e_{-n}\rangle  },
    \end{equation}
    ce qui donne
    \begin{equation}
        f=\sum_{n\in\eZ}\langle f, e_n\rangle e_n=\sum_{n\in \eN}\langle f, e_n\rangle e_n +\overline{ \langle f, e_n\rangle e_n }=\sum_{n\in \eN}\Re\big( \langle f, e_n\rangle e_n \big).
    \end{equation}
    Or
    \begin{equation}        \label{EQooMWJNooSjPCpR}
        \Re\big( \langle f, e_n\rangle e_n \big)=\frac{1}{ (2\pi)^{3/2} }\cos(nx)\int_0^{2\pi}f(t)\cos(nt)dt-\frac{1}{ (2\pi)^{3/2} }\sin(nx)\int_0^{2\pi}f(t)\sin(nt)dt.
    \end{equation}

    Considérons la fonction impaire \( \tilde f\in\L^2\big( [-2\pi,2\pi] \big)\) créée à partir de \( f\). Elle se développe de même et nous avons la même formule \eqref{EQooMWJNooSjPCpR} à part quelques coefficients et le fait que les intégrales sont entre \( -2\pi\) et \( 2\pi\). Vu que \( \tilde f\) est impaire, l'intégrale avec \( \cos(nt)\) s'annule et
    \begin{equation}
        \tilde f(x)=\sum_{n\in \eN}c_n\sin(nx)
    \end{equation}
    pour certains coefficients réels \( c_n\). Cette égalité est à considérer dans \( L^2\), c'est à dire presque partout et en particulier presque partout sur \( \mathopen[ 0 , 2\pi \mathclose]\).

    Donc les fonctions réelles sur \( \mathopen[ 0 , 2\pi \mathclose]\) peuvent être écrites sous la forme d'une série de seulement des sinus.

    Note : en choisissant \( \tilde f\) paire, nous aurions eu une série de cosinus.
\end{example}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Théorème de la projection}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Avant d'entrer dans le vif du sujet, nous nous fendons d'une petite étude de fonction. Soit
\begin{equation}
    \begin{aligned}
        \phi\colon \mathopen[ 0 , 1 \mathclose]&\to \eR \\
        x&\mapsto \frac{ (1+x)^r }{ 1+x^r }. 
    \end{aligned}
\end{equation}
Un peu de calcul montre que
\begin{equation}
    \frac{ \phi'(x) }{ \phi(x) }=\frac{ r(1-x^{r-1}) }{ (1+x^r)(1+x) }.
\end{equation}
<++>

\begin{theorem}[Théorème de la projection] \label{THOooRJFUooQivDKm}
    Nous considérons \( p>1\). Soit un sous-espace vectoriel fermé \( W\subset L^p(\Omega,\tribA,\mu)\) et \( u_0\in L^p\). Nous notons
    \begin{equation}
        d(u_0,W)=\inf_{w\in W}d(u_0,W).
    \end{equation}
    Alors il existe \( w_0\in W\) tel que \( \| u_0-w_0 \|=d(u_0,W)\).
\end{theorem}

\begin{proof}
    Nous allons séparer trois cas : \( p=2\), \( 1<p<2\) et \( p>2\). Pour \( p=2\), nous savons que \( L^2\) est un espace de Hilbert\footnote{Lemme \ref{LemIVWooZyWodb}.}, nous avons déjà le théorème de la projection \ref{ThoProjOrthuzcYkz}.
    \begin{subproof}
        \item[\( p>2\)]
            Pour chaque \( x\in \Omega\) nous avons \( f(x), g(x)\in \eC\) et donc l'identité du parallélogramme\footnote{Proposition \ref{PropEQRooQXazLz} en remarquant que \( (z_1,z_2)\mapsto z_1\bar z_2\) est un produit scalaire hermitien sur $\eC$.} :
            \begin{equation}
                \big| f(x)-g(x) \big|^2+\big| f(x)+g(x) \big|=2| f(x) |+2| g(x) |^2.
            \end{equation}
            Vu que \( p>2\), la fonction \( x\mapsto x^{p/2}\) est convexe (lemme \ref{LEMooSXTXooZOmtKq}).
    \end{subproof}
    <++>
\end{proof}
<++>

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Dualité et théorème de représentation de Riesz}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Dans la suite \( E'\) est le dual topologique, c'est à dire l'espace des formes linéaires et continues sur \( E\).

\begin{proposition}[\cite{PAXrsMn}, thème~\ref{THEMEooULGFooPscFJC}] \label{PropOAVooYZSodR}
    Soit \( 1<p<2\) et \( q\) tel que \( \frac{1}{ p }+\frac{1}{ q }=1\). L'application
    \begin{equation}
        \begin{aligned}
            \Phi\colon L^q\big( \mathopen[ 0 , 1 \mathclose] \big)&\to  L^p\big( \mathopen[ 0 , 1 \mathclose] \big)'  \\
            \Phi_g(f)&= \int_{\mathopen[ 0 , 1 \mathclose]}f\bar g.
        \end{aligned}
    \end{equation}
    est une isométrie linéaire surjective.
\end{proposition}

\begin{proof}
    Pour la simplicité des notations nous allons noter \( L^2\) pour \( L^2\big( \mathopen[ 0 , 1 \mathclose] \big)\), et pareillement pour \( L^p\).
    \begin{subproof}
        \item[\( \Phi_g\) est un élément de \( (L^p)'\)]

            Si \( f\in L^p\) et \( g\in L^q\) nous devons prouver que \( \Phi_q(f)\) est bien définie. Pour cela nous utilisons l'inégalité de Hölder\footnote{Proposition~\ref{ProptYqspT}.} qui dit que \( fg\in L^1\); par conséquent la fonction \( f\bar g\) est également dans \( L^1\) et nous avons
            \begin{equation}
                | \Phi_g(f) |\leq\int_{\mathopen[ 0 , 1 \mathclose]}| f\bar g |=\| fg \|_1\leq \| f \|_p\| g \|_q.
            \end{equation}
            En ce qui concerne la norme de l'application \( \Phi_g\) nous avons tout de suite
            \begin{equation}
                \| \Phi_g \|=\sup_{\| f\|_p=1}\big| \Phi_g(f) \big|\leq \| g \|_q.
            \end{equation}
            Cela signifie que l'application \( \Phi_g\) est bornée et donc continue par la proposition~\ref{PROPooQZYVooYJVlBd}. Nous avons donc bien \( \Phi_g\in (L^p)'\).

        \item[Isométrie]

            Afin de prouver que \( \| \Phi_g \|=\| g \|_q\) nous allons trouver une fonction \( f\in L^p\) telle que \( \frac{ | \Phi_g(f) | }{ \| f \|_p }=\| g \|_q\).  De cette façon nous aurons prouvé que \( | \Phi_g |\geq \| g \|_q\), ce qui conclurait que \( | \Phi_g |=\| g \|_q\).

            Nous posons \( f=g| g |^{q-2}\), de telle sorte que \( | f |=| g |^{q-1}\) et
            \begin{equation}
                \| f \|_p=\left( \int| g |^{p(q-1)} \right)^{1/p}=\left( \int | g |^q \right)^{1/p}=\| g \|_q^{q/p}
            \end{equation}
            où nous avons utilisé le fait que \( p(q-1)=q\). La fonction \( f\) est donc bien dans \( L^p\). D'autre part,
            \begin{equation}
                \Phi_g(f)=\int f\bar g=\int g| g |^{q-2}\bar g=\int | g |^q=\| g \|_q^q.
            \end{equation}
            Donc
            \begin{equation}
                \frac{ | \Phi_g(f) | }{ \| f \|_p }=\| g \|_q^{q-\frac{ q }{ p }}=\| g \|_q
            \end{equation}
            où nous avons encore utilisé le fait que \( q-\frac{ q }{ p }=\frac{ q(p-1) }{ p }=1\).

        \item[Surjectif]

            Soit \( \ell\in (L^p)'\); c'est une application \( \ell\colon L^p\to \eC\) sont nous pouvons prendre la restriction à \( L^2\) parce que la proposition~\ref{PropIRDooFSWORl} nous indique que \( L^2\subset L^p\). Nous nommons \( \phi\colon L^2\to \eC\) cette restriction.

            \begin{subproof}

                \item[\( \phi\in (L^2)'\)]

                    Nous devons montrer que \( \phi\) est continue pour la norme sur \( L^2\). Pour cela nous montrons que sa norme opérateur (subordonnée à la norme de \( L^2\) et non de \( L^p\)) est finie :
                    \begin{equation}
                        \sup_{f\in L^2}\frac{ | \phi(f) | }{ \| f \|_{2} }\leq \sup_{f\in L^2}\frac{ | \ell(f) | }{ \| f \|_p }<\infty.
                    \end{equation}
                    Nous avons utilisé l'inégalité de norme \( \| f \|_p\leq \| f \|_2\) de la proposition~\ref{PropIRDooFSWORl}\ref{ItemWSTooLcpOvXii}.

                \item[Utilisation du dual de \( L^2\)]

                    Étant donné que \( L^2\) est un espace de Hilbert (lemme~\ref{LemIVWooZyWodb}) et que \( \phi\in (L^2)'\), le théorème~\ref{ThoQgTovL} nous donne un élément \( g\in L^2\) tel que \( \phi(f)=\Phi_g(f)\) pour tout \( f\in L^2\).

                    Nous devons prouver que \( g\in L^q\) et que pour tout \( f\in L^p\) nous avons \( \ell(f)=\Phi_g(f)\).

                \item[\( g\in L^q\)]

                    Nous posons \( f_n=g| g |^{q-2}\mtu_{| g |<n}\). Nous avons d'une part
                    \begin{equation}    \label{EqEBUooOnlRHj}
                        \Phi_g(f_n)=\int_0^1f_n\bar g=\int_{| g |<n}| g |^q.
                    \end{equation}
                    Et d'autre part comme \( f_n\in L^2\) nous avons aussi \( \phi(f_n)=\Phi_g(f_n)\) et donc
                    \begin{subequations}
                        \begin{align}
                            0\leq \Phi(f_n)= \phi(f_n)&\leq \| \ell \|\| f_n \|_p\\
                            &=\| \ell \|\left( \int_{| g |<n}| g |^{(q-1)p} \right)^{1/p}\\
                            &=\| \ell \|\left( \int_{| g |<n}| g |^q \right)^{1/p}.
                        \end{align}
                    \end{subequations}
                    où nous avons à nouveau tenu compte du fait que \( p(q-1)=q\). En combinant avec \eqref{EqEBUooOnlRHj} nous trouvons
                    \begin{equation}
                        \int_{| g |<n}| g |^q\leq \| \ell \|\left( \int_{| g |<n}| g |^q \right)^{1/p},
                    \end{equation}
                    et donc
                    \begin{equation}
                        \left( \int_{| g |<n}| g |^{q} \right)^{1-\frac{1}{ p }}\leq \| \ell \|,
                    \end{equation}
                    c'est à dire
                    \begin{equation}
                        \Big( \int_{| g |<n}| g |^q \Big)^{1/q}\leq \| \ell \|.
                    \end{equation}

                    Si ce n'était pas encore fait nous nous fixons un représentant de la classe \( g\) (qui est dans \( L^2\)), et nous nommons également \( g\) ce représentant. Nous posons alors
                    \begin{equation}
                        g_n=| g |^q\mtu_{| g |<n}
                    \end{equation}
                    qui est une suite croissante de fonctions convergeant ponctuellement vers \( | g |^q\). Le théorème de Beppo-Levi~\ref{ThoRRDooFUvEAN} nous permet alors d'écrire
                    \begin{equation}
                        \lim_{n\to \infty} \int_{| q |<n}| g |^q=\int_{0}^1| g |^q.
                    \end{equation}
                    Mais comme pour chaque \( n\) nous avons \( \int_{| g |<n}| q |^q\leq \| \ell \|^q\), nous conservons l'inégalité à la limite et
                    \begin{equation}
                        \int_0^1| g |^q\leq \| \ell \|^q.
                    \end{equation}
                    Cela prouve que \( g\in L^p\).

                \item[\( \ell(f)=\Phi_g(f)\)]

                    Soit \( f\in L^p\). En vertu de la densité de \( L^2\) dans \( L^p\) prouvée dans le corollaire~\ref{CorFZWooYNbtPz} nous pouvons considérer une suite \( (f_n)\) dans \( L^2\) telle que \( f_n\stackrel{L^p}{\longrightarrow}f\). Pour tout \( n\) nous avons
                    \begin{equation}
                        \ell(f_n)=\Phi_g(f_n).
                    \end{equation}
                    Mais \( \ell\) et \( \Phi_g\) étant continues sur \( L^p\) nous pouvons prendre la limite et obtenir
                    \begin{equation}
                        \ell(f)=\Phi_g(f).
                    \end{equation}
            \end{subproof}
        \end{subproof}
\end{proof}

\begin{lemma}[\cite{MathAgreg}] \label{LemHNPEooHtMOGY}
    Soit \( (\Omega,\tribA,\mu)\) un espace mesuré et \( X\subset \Omega\) une partie de mesure \( \mu(X)<\infty\). Soit \( g\in L^1(\Omega)\) et \( S\) fermé dans \( \eC\). Si pour tout \( E\in \tribA\) nous avons
    \begin{equation}
        \frac{1}{ \mu(E) }\int_egd\mu\in S,
    \end{equation}
    alors \( g(x)\in S\) pour presque tout \( x\in X\).
\end{lemma}

\begin{proof}
    Soit \( D=\overline{ B(a,r) }\) un disque fermé dans le complémentaire de \( S\) (ce dernier étant fermé, le complémentaire est ouvert). Posons \( E=g^{-1}(D)\). Prouvons que \( \mu(E)=0\) parce que cela prouverait que \( g(x)\in D\) pour seulement un ensemble de mesure nulle. Mais \( S^c\) pouvant être écrit comme une union dénombrable de disques fermés\footnote{Tout ouvert peut être écrit comme union dénombrable d'éléments d'une base de topologie par la proposition~\ref{PropMMKBjgY} et $\eC$ a une base dénombrable de topologie par la proposition~\ref{PropNBSooraAFr}.}, nous aurions \( g(x)\in S^c\) presque nulle part.

    Vu que \( \frac{1}{ \mu(E) }\int_Ea=a\) nous avons
    \begin{subequations}
        \begin{align}
            \big| \frac{1}{ \mu(E) }gd\mu-a \big|=\big| \frac{1}{ \mu(E) }\int_E(g-a) \big|\leq  \frac{1}{ \mu(E) }\int_E| g-a |\leq\frac{1}{ \mu(E) }\mu(E)r=r.
        \end{align}
    \end{subequations}
    Donc
    \begin{equation}
        \frac{1}{ \mu(E) }\int_Egd\mu\in D,
    \end{equation}
    ce qui est une contradiction avec le fait que \( D\subset S^c\).
\end{proof}

Dans toute la partie d'analyse fonctionelle, sauf mention du contraire, nous considérons dans \( L^p\) des fonctions à valeurs complexes, et donc les éléments du dual sont des applications linéaires continues à valeurs dans \( \eC\).

\begin{theorem}[Théorème de représentation de Riesz, thème~\ref{THEMEooULGFooPscFJC}, \cite{MathAgreg,TLRRooOjxpTp,LRBWftc,OYRmzAa}]  \label{ThoLPQPooPWBXuv}
    Soit \( 1\leq p<\infty\) et un espace mesuré \( \sigma\)-fini \( (\Omega,\tribA,\mu)\). Soit \( q\) tel que \( \frac{1}{ p }+\frac{1}{ q }=1\). Alors l'application
    \begin{equation}
        \begin{aligned}
            \Phi\colon L^q&\to (L^p)' \\
            \Phi_g(f)&=\int_{\Omega}f\bar gd\mu
        \end{aligned}
    \end{equation}
    est une bijection isométrique.
\end{theorem}
\index{dual!de $L^p$}

\begin{proof}
    Par petits bouts.
    \begin{subproof}
        \item[\( \Phi\) est injective]
        Nous commençons par prouver que \( \Phi\) est injectif. Soient \( g,g'\in L^q\) tels que \( \Phi_g=\Phi_{g'}\). Alors pour tout \( f\in L^p\) nous avons
                \begin{equation}
                    \int_{\Omega}f(g-g')d\mu=0.
                \end{equation}
                Soient des parties \( A_i\) de mesures finies telles que \( \Omega=\bigcup_{n=1}^{\infty}A_i\). Étant donné que \( \mu(A_i)\) est fini, nous avons \( \mtu_{A_i}\in L^p(\Omega)\) et donc
                \begin{equation}
                    \int_{A_i}(g-g')d\mu=\int_{\Omega}\mtu_{A_i}(x)(g-g')(x)d\mu(x)=0.
                \end{equation}
                La proposition~\ref{PropRERZooYcEchc} nous dit alors que \( g-g'=0\) dans \( L^q(A_i)\). Pour chaque \( i\), la partie \( N_i=\{ x\in A_i\tq (g-g')(x)=0 \}\) est de mesure nulle.

                Vu que \( \Omega\) est l'union de tous les \( A_i\), la partie de \( \Omega\) sur laquelle \( g-g'\) est non nulle est l'union des \( N_i\) et donc de mesure nulle parce que une réunion dénombrable de parties de mesure nulle est de mesure nulle. Donc \( g-g'=0\) presque partout dans \( \Omega\), ce qui signifie \( g-g'=0\) dans \( L^q(\Omega)\).

            \item[La suite]

        La partie difficile est de montrer que \( \Phi\) est surjective.

        Soit \( \phi\in L^p(\Omega)'\). Si \( \phi=0\), c'est bien dans l'image de \( \Phi\); nous supposons donc que non. Nous allons commencer par prouver qu'il existe une (classe de) fonction \( g\in L^1(\Omega)\) telle que \( \Phi_g(f)=\phi(f)\) pour tout \(f\in L^{\infty}(\Omega,\mu)\); nous montrerons ensuite que \( g\in L^q\) et que le tout est une isométrie.

        \item[Une mesure complexe]

            Si \( E\in\tribA\) nous notons \( \nu(E)=\phi(\mtu_E)\). Nous prouvons maintenant que \( \nu\) est une mesure complexe\footnote{Définition~\ref{DefGKHLooYjocEt}.} sur \( (\Omega,\tribA)\). La seule condition pas facile est la condition de dénombrable additive. Il est déjà facile de voir que \( A\) et \( B\) sont disjoints, \( \nu(A\cup B)=\nu(A)+\nu(B)\). Soient ensuite des ensembles \( A_n\) deux à deux disjoints et posons \( E_k=\bigcup_{i\leq k}A_i\) pour avoir \( \bigcup_kA_k=\bigcup_kE_k\) avec l'avantage que les \( E_k\) soient emboîtés. Cela donne
            \begin{equation}
                \| \mtu_E-\mtu_{E_k} \|_p=\mu(E\setminus E_k)^{1/p},
            \end{equation}
            mais vu que \( 1\leq p<\infty\), avoir \( x_k\to 0\) implique d'avoir \( x_k^{1/p}\to 0\). Prouvons que \( \mu(E\setminus E_k)\to 0\). En vertu du lemme~\ref{LemPMprYuC} nous avons pour chaque \( k\) :
            \begin{equation}
                \mu(E\setminus E_k)=\mu(E)-\mu(E_k),
            \end{equation}
            et vu que \( E_k\to E\) est une suite croissante, le lemme~\ref{LemAZGByEs}\ref{ItemJWUooRXNPci}, sachant que \( \mu\) est une mesure « normale », donne
            \begin{equation}
                \lim_{n\to \infty} \mu(E_k)=\mu\big( \bigcup_kE_k \big).
            \end{equation}
            Donc effectivement \( \mu(E_k)\to \mu(E)\) et donc oui : \( \mu(E\setminus E_k)\to 0\). Jusqu'à présent nous avons
            \begin{equation}
                \lim_{k\to \infty} \| \mtu_E-\mtu_{E_k} \|_p=0,
            \end{equation}
            c'est à dire \( \mtu_{E_k}\stackrel{L^p}{\longrightarrow}\mtu_E\). La continuité de \( \phi\) sur \( L^p\) donne alors
            \begin{equation}
                \lim_{k\to \infty} \nu(E_k)=\lim_{k\to \infty} \phi(\mtu_{E_k})=\phi(\lim_{k\to \infty} \mtu_{E_k})=\phi(\mtu_E)=\nu(E).
            \end{equation}
            Par additivité finie de \( \nu\) nous avons
            \begin{equation}
                \nu(E_k)=\sum_{i\leq k}\nu(A_i)
            \end{equation}
            et en passant à la limite, \( \sum_{i=1}^{\infty}\nu(A_i)=\nu(\bigcup_{i}A_i)\). L'application \( \nu\) est donc une mesure complexe.

        \item[Mesure absolument continue]

            En prime, si \( \mu(E)=0\) alors \( \nu(E)=0\) parce que
            \begin{equation}
                \mu(E)=0\Rightarrow \| \mtu_E \|_p=0\Rightarrow \mtu_E=0\text{ (dans } L^p\text{)}\Rightarrow\phi(\mtu_E)=0
            \end{equation}

        \item[Utilisation de Radon-Nikodym]

            Nous sommes donc dans un cas où \( \nu\ll\mu\) et nous utilisons le théorème de Radon-Nikodym~\ref{ThoZZMGooKhRYaO} sous la forme de la remarque~\ref{RemSYRMooZPBhbQ} : il existe une fonction intégrable \( g\colon \Omega\to \eC\)\footnote{On peut écrire, pour utiliser de la notation compacte que \( g\in L^1(\Omega,\eC)\).} telle que pour tout \( A\in\tribA\),
            \begin{equation}
                \nu(A)=\int_A\bar gd\mu.
            \end{equation}
            C'est à dire que
            \begin{equation}
                \phi(\mtu_A)=\int_A\bar gd\mu=\int_{\Omega}\bar g\mtu_Ad\mu.
            \end{equation}
            Nous avons donc exprimé \( \phi\) comme une intégrale pour les fonctions caractéristiques d'ensembles.

        \item[Pour les fonctions étagées]

            Par linéarité si \( f\) est mesurable et étagée nous avons aussi
            \begin{equation}
                \phi(f)=\int f\bar gd\mu=\Phi_g(f).
            \end{equation}

        \item[Pour \( f\in L^{\infty}(\Omega)\)]

            Une fonction \( f\in L^{\infty}\) est une fonction presque partout bornée. Nous supposons que \( f\) est presque partout bornée par \( M\). Par ailleurs cette \( f\) est limite uniforme de fonctions étagées : \( \| f_k-f \|_{\infty}\to 0\) en posant \( f_k=f\mtu_{| f |\leq k}\). Pour chaque \( k \) nous avons l'égalité
            \begin{equation}    \label{EqPDCJooGNjuAO}
                \Phi_g(f_k)=\phi(f_k).
            \end{equation}
            Par ailleurs la fonction \( f_k\bar g\) est majorée par la fonction intégrable \( M\bar g\) et le théorème de la convergence dominée~\ref{ThoConvDomLebVdhsTf} nous donne
            \begin{equation}
                \lim_{k\to \infty} \Phi_g(f_i)=\lim_{k\to \infty} \int f_k\bar g=\int f\bar g=\Phi_g(f).
            \end{equation}
            Et la continuité de \( \phi\) sur \( L^p\) couplée à la convergence \( f_k\stackrel{L^p}{\longrightarrow}f\) donne \( \lim_{k\to \infty} \phi(f_k)=(f)\). Bref prendre la limite dans \eqref{EqPDCJooGNjuAO} donne
            \begin{equation}
                \Phi_g(f)=\phi(f)
            \end{equation}
            pour tout \( f\in L^{\infty}(\Omega)\).

        \item[La suite \ldots]

            Voici les prochaines étapes.
            \begin{itemize}
                \item Nous avons \( \int f\bar g=\phi(f)\) tant que \( f\in L^{\infty}\). Nous allons étendre cette formule à \( f\in L^p\) par densité. Cela terminera de prouver que notre application est une bijection.
                \item Ensuite nous allons prouver que \( \| \phi \|=\| \Phi_g \|\), c'est à dire que la bijection est une isométrie.
            \end{itemize}

        \item[De \( L^{\infty}\) à \( L^p\)]

            Soit \( f\in L^p\). Si nous avions une suite \( (f_n) \) dans \( L^{\infty}\) telle que \( f_n\stackrel{L^p}{\longrightarrow}f\) alors \( \lim \phi(f_n)=\phi(f)\) par continuité de \( \phi\). La difficulté est de trouver une telle suite de façon à pouvoir permuter l'intégrale et la limite :
            \begin{equation}    \label{EqLYYAooUQnbfV}
                \lim_{n\to \infty} \int_{\Omega}f_n\bar g=\int_{\Omega}\lim_{n\to \infty} f_n\bar g=\int_{\Omega}f\bar g=\Phi_g(f).
            \end{equation}
            Nous allons donc maintenant nous atteler à la tâche de trouver \( f_n\in L^{\infty}\) avec \( f_n\stackrel{L^p}{\longrightarrow}f\) et telle que \eqref{EqLYYAooUQnbfV} soit valide.

            Nous allons d'abord supposer que \( f\in L^p\) est positive à valeurs réelles. Nous avons alors par la proposition~\ref{PropUXjnwLf} qu'il existe une suite croissante de fonction étagées (et donc \( L^{\infty}\)) telles que \( f_n\to f\) ponctuellement. De plus étant donné que \( | f_n |\leq | f |\), la proposition~\ref{PropBVHXycL} nous dit que \( f_n\stackrel{L^p}{\longrightarrow}f\). Pour chaque \( n\) nous avons
            \begin{equation}
                \int_{\Omega}f_n\bar g=\phi(f_n).
            \end{equation}
            Soit \( g^+\) la partie réelle positive de \( \bar g\). Alors nous avons la limite croissante ponctuelle \( f_ng^+\to fg^+\) et le théorème de la convergence monotone~\ref{ThoRRDooFUvEAN} nous permet d'écrire
            \begin{equation}
                \lim_{n\to \infty} \int f_ng^+=\int fg^+.
            \end{equation}
            Faisant cela pour les trois autres parties de \( \bar g\) nous avons prouvé que si \( f\in L^p\) est réelle et positive,
            \begin{equation}
                \int f\bar g=\phi(f),
            \end{equation}
            c'est à dire que \( \Phi_g(f)=\phi(f)\).

            Refaisant le tout pour les trois autres parties de \( f\) nous montrons que
            \begin{equation}
                \Phi_g(f)=\phi(f)
            \end{equation}
            pour tout \( f\in L^p(\Omega)\). Nous avons donc égalité de \( \phi\) et \( \Phi_g\) dans \(  (L^p)' \) et donc bijection entre \( (L^p)'\) et \( L^q\).

        \item[Isométrie : mise en place]

            Nous devons prouver que cette bijection est isométrique. Soit \( \phi\in (L^p)'\) et \( g\in L^q\) telle que \( \Phi_g=\phi\). Il faut prouver que
            \begin{equation}
                \| g \|_q=\| \phi \|_{(L^p)'}.
            \end{equation}

        \item[ \( \| \phi \|\leq \| g \|_q\) ]

            Nous savons que \( \phi(f)=\int f\bar g\), et nous allons écrire la définition de la norme dans \( (L^p)'\) :
            \begin{subequations}
                \begin{align}
                    \| \phi \|_{(L^p)'}&=\sup_{\| f \|_p=1}\big| \phi(f) \big|\\
                    &=\sup| \int f\bar g |\\
                    &\leq\sup\underbrace{\int| f\bar g |}_{=\| f\bar g \|_1}.
                \end{align}
            \end{subequations}
            Il s'agit maintenant d'utiliser l'inégalité de Hölder~\ref{ProptYqspT} :
            \begin{equation}
                \| \phi \|\leq \sup_{\| f \|_p=1}\| f \|_p\| \bar g \|_q=\| g \|_q.
            \end{equation}

            L'inégalité dans l'autre sens sera démontrée en séparant les cas \( p=1\) et \( 1<p<\infty\).

        \item[Si \( p=1\)]

            Si \( E\) est un ensemble mesurable, alors
            \begin{equation}
                | \int_Egd\mu |=\big| \phi(\mtu_E) \big|.
            \end{equation}
            Mais le fait que \( \mu(\Omega)<\infty\) donne que \( \mtu_E\in L^1(\Omega)\). Donc \( \mtu_E\in L^{\infty}\cap L^1\); nous pouvons alors écrire \( \phi(\mtu_E)=\int_{\Omega}\mtu_E\bar gd\mu\) et donc
            \begin{equation}    \label{EqUPCTooJvoKKI}
                | \int_{\Omega}\mtu_E\bar gd\mu |=|\int_Egd\mu |=\big| \phi(\mtu_E) \big|\leq \| \phi \|_{(L^1)'}\| \mtu_E \|_1=\| \phi \|\mu(E).
            \end{equation}
            Pour utiliser le lemme~\ref{LemHNPEooHtMOGY}, nous écrivons cela dans l'autre sens :
            \begin{equation}
                \| \phi \|\geq \frac{1}{ \mu(E) }| \int_{\Omega}\mtu_E\bar gd\mu |=| \frac{1}{ \mu(E) }\int_E\bar gd\mu |.
            \end{equation}
            Si nous prenons \( S=\{ t\in \eC\tq | t |\leq \| \phi \| \}\), c'est un fermé vérifiant que
            \begin{equation}
                \frac{1}{ \mu(E) }\int_E\bar gd\mu\in S,
            \end{equation}
            donc \( \bar g\in S\) presque partout, ce qui signifie que \( \| g \|_{\infty}\in S\). Nous en concluons que
            \begin{equation}
                \| g \|_{\infty}\leq \| \phi \|
            \end{equation}
            et donc que \( g\in L^{\infty}\).

            Notons que cet argument ne tient pas avec \( p\neq 1\) parce que l'équation \eqref{EqUPCTooJvoKKI} terminerait sur \( \| \phi \|\mu(E)^{1/p}\). Du coup l'ensemble \( S\) à prendre serait \( S=\{ t\in \eC\tq | t |\leq \| \phi \|\mu(E)^{1/p-1} \}\) et nous sommes en dehors des hypothèses du lemme parce qu'il n'y a pas d'ensemble \emph{indépendant} de \( E\) dans lequel l'intégrale \( \frac{1}{ \mu(E) }\int_{E}\bar gd\mu\) prend ses valeurs.

        \item[\( 1<p<\infty\)]

            La fonction
            \begin{equation}
                \alpha(x)=\begin{cases}
                    \frac{ g(x) }{ | g(x) | }    &   \text{si } g(x)\neq 0\\
                    1    &    \text{si } g(x)=0
                \end{cases}
            \end{equation}
            a la propriété de faire \( \alpha g=| g |\) en même temps que \( | \alpha(x) |=1\) pour tout \( x\). Nous définissons
            \begin{equation}
                E_n=\{ x\tq | g(x) |\leq n \}
            \end{equation}
            et
            \begin{equation}
                f_n=\mtu_{E_n}| g^{q-1} |\alpha.
            \end{equation}
            Ce qui est bien avec ces fonctions c'est que\footnote{C'est ici que nous utilisons le lien entre \( p\) et \( q\). En l'occurrence, de \( 1/p+1/q=1\) nous déduisons \( q(p-1)=p\).}
            \begin{equation}
                | f_n |^p=| g^{p(q-1)} | \alpha |^p=| g |^q
            \end{equation}
            sur \( E_n\). Dans \( E_n\) nous avons \( | f_n |=| g^{q-1} |\leq n^{q-1}\) et dans \( E_n\) nous avons \( f_n=0\). Au final, \( f_n\in L^{\infty}\). Par ce que nous avons vu plus haut, nous avons alors
            \begin{equation}
                \phi(f_n)=\Phi_g(f_n).
            \end{equation}
            Par ailleurs,
            \begin{equation}
                f_n\bar g=\mtu_{E_n}| g^{q-1} |\frac{ g }{ | g | }\bar g,
            \end{equation}
            donc\quext{Dans \cite{MathAgreg}, cette équation arrive sans modules, ce qui me laisse entendre que \( \phi(f_n)\) est réel et positif pour pouvoir écrire que \( \phi(f_n)\leq \| \phi \|\| f_n \|_p\), mais je ne comprends pas pourquoi.}
            \begin{equation}
                \left|\int_{E_n}| g |^qd\mu\right|=|\int_{\Omega}f_n\bar gd\mu|=|\phi(f_n)|\leq \| \phi \|\| f_n \|_p=\| \phi \|\left( \int_{E_n}| f_n |^p \right)^{1/p}=\| \phi \|\left( \int_{E_n}| g |^q \right)^{1/p}.
            \end{equation}

            Nous avons de ce fait une inégalité de la forme \( A\leq \| \phi \|A^{1/p}\) et donc aussi \( A^{1/p}\leq \| \phi \|^{1/p}A^{1/p^2}\), et donc \( A\leq \| \phi \|\| \phi \|^{1/p}A^{1/p^2}\). Continuant ainsi à injecter l'inégalité dans elle-même, pour tout \( k\in \eN\) nous avons :
            \begin{equation}
                \left| \int_{E_n}| g |^qd\mu \right| \leq\| \phi \|^{1+\frac{1}{ p }+\cdots+\frac{1}{ p^k }}\left( \int_{E_n}| g |^qd\mu \right)^{1/p^k}.
            \end{equation}
            Nous pouvons passer à la limite \( k\to \infty\). Sachant que \( p>1\) nous savons \( A^{1/k}\to 1\) et
            \begin{equation}
                1+\frac{1}{ p }+\cdots+\frac{1}{ p^k }\to\frac{ p }{ p-1 }=q.
            \end{equation}
            Nous avons alors
            \begin{equation}
                \int_{E_n}| g |^qd\mu\leq \| \phi \|^q.
            \end{equation}
            L'intégrale s'écrit tout aussi bien sous la forme \( \int_{\Omega}| g  |^q\mtu_{E_n}\). La fonction dans l'intégrale est une suite croissante de fonctions mesurables à valeurs dans \( \mathopen[ 0 , \infty \mathclose]\). Nous pouvons alors permuter l'intégrale et la limite \( n\to \infty\) en utilisant la convergence monotone (théorème~\ref{ThoRRDooFUvEAN}) qui donne alors \( \int_{\Omega}| g |^q\leq \| \phi \|^q\) ou encore
            \begin{equation}
                \| g \|_q\leq \| \phi \|.
            \end{equation}

            Ceci achève de prouver que l'application \( \phi\mapsto \Phi_g\) est une isométrie, et donc le théorème.

    \end{subproof}
\end{proof}

\begin{proposition}     \label{PROPooGIOZooBMokXi}
    Soit un espace mesuré \( (\Omega,\tribA,\mu)\) et \( 1<p<\infty\). Alors l'espace \( L^p(\Omega)\) est réflexif.
\end{proposition}

\begin{theorem}
    Nous considérons pour ce théorème des fonctions à valeurs réelles.

    Soit l'espace mesuré \( (\Omega,\tribA,\mu)\) et \( 1<p<\infty\).
    \begin{enumerate}
        \item
            L'espace \( L^p(\Omega)\) est réflexif\footnote{Défintion \ref{PROPooMAQSooCGFBBM}.}.
    \end{enumerate}
    Si \( \mu\) est une mesure \( \sigma\)-finie, alors
    \begin{enumerate}
        \item
            \( (L^1)'=L^{\infty}\)
        \item
            \( L^1\subset (L^{\infty})' \) avec une inclusion stricte sauf dans les cas triviaux.
    \end{enumerate}
\end{theorem}
% TODO : la preuve est sur Wikipédia.
\index{dual!de $L^p(\Omega)$}

\begin{proposition} \label{PropUKLZZZh}
    Soit \( f\in L^p(\Omega)\) telle que
    \begin{equation}
        \int_{\Omega}f\varphi=0
    \end{equation}
    pour tout \( \varphi\in C^{\infty}_c(\Omega)\). Alors \( f=0\) presque partout.
\end{proposition}

\begin{proof}
    Nous considérons la forme linéaire \( \Phi_f\in (L^q)'\) donnée par
    \begin{equation}
        \begin{aligned}
            \Phi_f\colon L^p&\to \eC \\
            u&\mapsto \int_{\Omega}fu
        \end{aligned}
    \end{equation}
    Par hypothèse cette forme est nulle sur la partie dense \(  C^{\infty}_c(\Omega)\). Si \( (\varphi_n)\) est une suite dans \(  C^{\infty}_c(\Omega)\) convergente vers \( u\) dans \( L^p\), nous avons pour tout \( n\) que
    \begin{equation}
        0=\Phi_f(\varphi_n)
    \end{equation}
    En passant à la limite, nous voyons que \( \Phi_f\) est la forme nulle. Elle est donc égale à \( \Phi_0\). La partie « unicité » du théorème de représentation de Riesz~\ref{ThoLPQPooPWBXuv} nous indique alors que \( f=0\) dans \( L^p\) et donc \( f=0\) presque partout.
\end{proof}

\begin{proposition} \label{PropLGoLtcS}
    Si \( f\in L^1_{loc}(I)\) est telle que
    \begin{equation}
        \int_If\varphi'=0
    \end{equation}
    pour tout \( \varphi\in  C^{\infty}_c(I)\), alors il existe une constante \( C\) telle que \( f=C\) presque partout.
\end{proposition}

\begin{proof}
    Soit \( \psi\in C^{\infty}_c(I)\) une fonction d'intégrale \( 1\) sur \( I\). Si \( w\in C^{\infty}_c(I)\) alors nous considérons la fonction
    \begin{equation}
        h=w-\psi\int_Iw,
    \end{equation}
    qui est dans \(  C^{\infty}_c(I)\) et dont l'intégrale sur \( I\) est nulle. Par la proposition~\ref{PropHFWNpRb}, la fonction \( h\) admet une primitive dans \(  C^{\infty}_c(I)\); et nous notons \( \varphi\) cette primitive. L'hypothèse appliquée à \( \varphi\) donne
    \begin{equation}
        0=\int_If\varphi'=\int_If\left( w-\psi\int_Iw \right)=\int_Ifw-\underbrace{\left( \int_If(x)\psi(x)dx \right)}_C\left( \int_Iw(y)dy \right)=\int_Iw(f-C).
    \end{equation}
    L'annulation de la dernière intégrale implique par la proposition~\ref{PropUKLZZZh} que \( f-C=0\) dans \( L^2\), c'est à dire \( f=C\) presque partout.
\end{proof}

\begin{lemma}[\cite{ooHGADooNGZnbt}]        \label{LEMooLDQRooEGWDlm}
    Pour tout \( \epsilon>0\), il existe un \( \delta>0\) tel que pour tout \( s,t\in \eC\) vérifiant \( | s |\leq 1\) et \( | s-t |\geq 2\epsilon\), nous avons
    \begin{equation}
        \left| \frac{ s+t }{ 2 } \right|^p\leq (1-\delta)\frac{ | s |^p+| t |^p }{2}.
    \end{equation}
\end{lemma}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Théorèmes de Hahn-Banach}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{theorem}[Hahn-Banach\cite{brezis,TQSWRiz}]
    Soit \( E\), un espace vectoriel réel et une application \( p\colon E\to \eR\) satisfaisant
    \begin{enumerate}
        \item
            \( p(\lambda x)=\lambda p(x)\) pour tout \( x\in E\) et pour tout \( \lambda>0\),
        \item
            \( p(x+y)\leq p(x)+p(y)\) pour tout \( x,y\in E\).
    \end{enumerate}
    Soit de plus \( G\subset E\) un sous-espace vectoriel muni d'une application \( g\colon G\to \eR\) vérifiant \( g(x)\leq p(x)\) pour tout \( x\in G\). Alors il existe \( f\in\aL(E,\eR)\) telle que \( f(x)=g(x)\) pour tout \( x\in G\) et \( f(x)\leq p(x)\) pour tout \( x\in E\).
\end{theorem}
\index{théorème!Hahn-Banach}

\begin{proof}
    Si \( h\) une application linéaire définie sur un sous-espace de \( E\), nous notons \( D_h\) ledit sous-espace.

    \begin{subproof}
    \item[Un ensemble inductif]

        Nous considérons \( P\), l'ensemble des fonctions linéaires suivant
        \begin{equation}
            P=\Big\{  h\colon D_h\to \eR\tq
            \begin{cases}
                G\subset D_h\\
                h(x)=g(x)&\forall x\in G\\
                h(x)\leq p(x)&\forall x\in D_h
            \end{cases}
        \Big\}
        \end{equation}
        Cet ensemble est non vide parce que \( g\) est dedans. Nous le munissons de la relation d'ordre \( h_1\leq h_2\) si et seulement si \( D_{h_1}\subset D_{h_2}\) et \( h_2\) prolonge \( h_1\). Nous montrons à présent que \( P\) est un ensemble inductif. Soit un sous-ensemble totalement ordonné \( Q\subset P\); nous définissons une fonction \( h\) de la façon suivante. D'abord \( D_h=\sup_{l\in Q}D_l\) et ensuite
        \begin{equation}
            \begin{aligned}
                h\colon D_h&\to \eR \\
                x&\mapsto l(x)&\text{si } x\in D_l
            \end{aligned}
        \end{equation}
        Cela est bien définit parce que si \( x\in D_l\cap D_{l'}\) alors, vu que \( Q\) est totalement ordonné (i.e. \( l\leq l'\) ou \( l'\leq l\)), on a obligatoirement \( D_l\subset D_{l'}\) et \( l'\) qui prolonge \( l\) (ou le contraire). Donc \( h\) est un majorant de \( Q\) dans \( P\) parce que \( h\geq l\) pour tout \( l\in Q\). Cela montre que \( P\) est inductif (définition~\ref{DefGHDfyyz}). Le lemme de Zorn~\ref{LemUEGjJBc} nous dit alors que \( P\) possède un maximum \( f\) qui va être la réponse à notre théorème.

    \item[Le support de \( f\)]

        La fonction \( f\) est dans \( P\); donc \( f(x)\leq p(x)\) pour tout \( x\in D_h\) et \( f(x)=g(x)\) pour tout \( x\in G\). Pour terminer nous devons montrer que \( D_f=E\). Supposons donc que \( D_f\neq E\) et prenons \( x_0\notin D_f\). Nous allons contredire la maximalité de \( f\) en considérant la fonction \( h\) donnée par \( D_h=D_f+\eR x_0 \) et
        \begin{equation}
            h(x+tx_0)=f(x)+t\alpha
        \end{equation}
        où \( \alpha\) est une constante que nous allons fixer plus tard.

        Nous commençons par prouver que \( f\) est dans \( P\). Nous devons prouver que
        \begin{equation}    \label{EqOIXrlFe}
            h(x+tx_0)=f(x)+t\alpha\leq p(x+tx_0)
        \end{equation}
        Pour cela nous allons commencer par fixer \( \alpha\) pour avoir les relations suivantes :
        \begin{subequations}    \label{EqMDNkcQk}
            \begin{numcases}{}
                f(x)+\alpha\leq p(x+x_0)    \label{EqDYmRWEY}\\
                f(x)-\alpha\leq p(x-x_0)
            \end{numcases}
        \end{subequations}
        pour tout \( x\in D_f\). Ces relations sont équivalentes à demander \( \alpha \) tel que
        \begin{subequations}
            \begin{numcases}{}
                \alpha\leq p(x+x_0)-f(x)\\
                \alpha\geq f(x)-p(x-x_0)
            \end{numcases}
        \end{subequations}
        Nous nous demandons donc s'il existe un \( \alpha\) qui satisfasse
        \begin{equation}
            \sup_{y\in D_f}\big( f(y)-p(y-x_0) \big)\leq \alpha\leq \inf_{z\in D_f}\big( p(z+x_0)-f(z) \big).
        \end{equation}
        Ou encore nous devons prouver que pour tout \( y,z\in D_f\),
        \begin{equation}
            p(z+x_0)-f(x)\geq f(y)-p(y-x_0)\geq 0.
        \end{equation}
        Par les propriétés de \( p\) et de \( f\),
        \begin{equation}
        p(z+x_0)+p(y-x_0)-f(z)-f(y)\geq p(z+y)-f(z+y)\geq 0.
        \end{equation}
        La dernière inégalité est le fait que \( f\in P\). Un choix de \( \alpha\) donnant les inéquations \eqref{EqMDNkcQk} est donc possible.

        À partir des inéquations \eqref{EqMDNkcQk} nous obtenons la relation \eqref{EqOIXrlFe} de la façon suivante. Si \( t>0\) nous multiplions l'équation \eqref{EqDYmRWEY} par \( t\) :
        \begin{equation}
            tf(x)+t\alpha\leq tp(x+x_0).
        \end{equation}
        Et nous écrivons cette relation avec \( x/t\) au lieu de \( x \) en tenant compte de la linéarité de \( f\) :
        \begin{equation}
            f(x)+t\alpha\leq  tp\big( \frac{ x }{ t }+x_0 \big)=p(x+tx_0).
        \end{equation}
        Avec \( t<0\), c'est similaire, en faisant attention au sens des inégalités.

        Nous avons donc construit \( h\colon D_h\to \eR\) avec \( h\in P\), \( D_f\subset D_h\) et \( h(x)=f(x)\) pour tout \( x\in D_f\). Cela pour dire que \( h>f\), ce qui contredit la maximalité de \( f\). Le domaine de \( f\) est donc \( E\) tout entier.

        La fonction \( f\) est donc une fonction qui remplit les conditions.

    \end{subproof}
\end{proof}

\begin{definition}  \label{DefPJokvAa}
    Un espace topologique est \defe{localement convexe}{convexité!locale} si tout point possède un système fondamental de voisinages formé de convexes.
\end{definition}
%TODO : il faudrait parler de système fondamental de voisinages.

\begin{definition}[Hyperplan qui sépare]
    Soit \( E\) un espace vectoriel topologique ainsi que \( A\), \( B\) des sous-ensembles de \( E\). Nous disons que l'hyperplan d'équation \( f=\alpha\) \defe{sépare au sens large}{hyperplan!séparer!au sens large} les parties \( A\) et \( B\) si \( f(x)\leq \alpha\) pour tout \( x\in A\) et \( f(x)\geq \alpha\) pour tout \( x\in B\).

    La séparation est \defe{au sens strict}{hyperplan!sépare!au sens strict} s'il existe \( \epsilon>0\) tel que
    \begin{subequations}
        \begin{align}
            f(x)\leq \alpha-\epsilon&&\text{pour tout } x\in A\\
            f(x)\geq \alpha+\epsilon&&\text{pour tout } x\in B.
        \end{align}
    \end{subequations}
\end{definition}

\begin{theorem}[Hahn-Banach, première forme géométrique\cite{TQSWRiz}]  \label{ThoSAJjdZc}
    Soit \( E\) un espace vectoriel topologique et \( A\), \( B\) deux convexes non vides disjoints de \( E\). Si \( A\) est ouvert, il existe un hyperplan fermé qui sépare \( A\) et \( B\) au sens large.
\end{theorem}

\begin{theorem}[Hahn-Banach, seconde forme géométrique] \label{ThoACuKgtW}
    Soient un espace vectoriel topologique localement convexe\footnote{Définition~\ref{DefPJokvAa}.} ainsi que des convexes non vides disjoints \( A\) et \( B\) tels que \( A\) soit compact et \( B\) soit fermé. Alors il existe un hyperplan fermé qui sépare strictement \( A\) et \( B\).
\end{theorem}

\begin{proof}
    Vu que \( B\) est fermé, \( A\) est dans l'ouvert \( E\setminus B\). Donc si \( a\in A\), il existe un voisinage ouvert convexe de \( a\) inclus dans \( A\). Soit \( U_a\) un voisinage ouvert et convexe de \( 0\) tel que \( (a+U_a)\cap B=\emptyset\).

    Vu que la fonction \( (x,y)\mapsto x+y\) est continue, nous pouvons trouver un ouvert convexe \( V_a\) tel que \( V_a+V_a\subset U_a\). L'ensemble \( a+V_a\) est alors un voisinage ouvert de \( a\) et bien entendu \( \bigcup_a(a+V_a)\) recouvre \( A\) qui est compact. Nous en extrayons un sous-recouvrement fini, c'est à dire que nous considérons \( a_1,\ldots, a_n\in A\) tels que
    \begin{equation}
        A\subset \bigcup_{i=1}^n(a_i+V_{a_i}).
    \end{equation}
    Nous posons alors
    \begin{equation}
        V=\bigcap_{i=1}^nV_{a_i}.
    \end{equation}
    Cet ensemble est non vide parce et il contient un voisinage de zéro parce que c'est une intersection finie de voisinages de zéro. Soit \( x\in A+V\). Il existe \( i\) tel que
    \begin{equation}
        x\in a_i+U_{a_i}+V\subset a_i+V_{a_i}+V_{a_i}\subset a_i+U_{a_i}\subset E\setminus B.
    \end{equation}
    Donc \( (A+V)\cap B=\emptyset\). L'ensemble \( A+V\) est alors un ouvert convexe disjoint de \( B\). Par la première forme géométrique du théorème de Hahn-Banach~\ref{ThoSAJjdZc} nous avons un hyperplan qui sépare \( A+V\) de \( B\) au sens large : il existe \( f\in E'\setminus\{ 0 \}\) tel que \( f(a)+f(v)\leq f(b)\) pour tout \( a\in A\), \( v\in V\) et \( b\in B\).

    Il suffit donc de trouver un \( v\in V\) tel que \( f(v)\neq 0\) pour avoir la séparation au sens strict. Cela est facile : \( V\) étant un voisinage de zéro et \( f\) étant linéaire, si elle était nulle sur \( V\), elle serait nulle sur \( E\).
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Théorème de Tietze}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{definition}
Si \( E\) et \( F\) sont des espaces normés, une application \( f\colon E\to F\) est \defe{presque surjective}{presque!surjective} s'il existe \( \alpha\in\mathopen] 0 , 1 \mathclose[\) et \( C>0\) tels que pour tout \( y\in \overline{ B_F(0,1) }\), il existe \( x\in\overline{ B_E(0,C) }\) tel que \( \| y-f(x) \|\leq \alpha\).
\end{definition}

\begin{lemma}[\cite{KXjFWKA}]   \label{LemBQLooRXhJzK}
    Soient \( E\) et \( F\) des espaces de Banach et \( f\in\cL(E,F)\)\footnote{L'ensemble des applications linéaires continues}. Si \( f\) est presque surjective, alors
    \begin{enumerate}
        \item   \label{ItemTSOooYkxvBui}
            \( f\) est surjective
        \item\label{ItemTSOooYkxvBuii}
            pour tout \( y\in \overline{ B_F(0,1) }\), il existe \( x\in\overline{ B_E(0,\frac{ C }{ 1-\alpha }) }\) tel que \( y=f(x)\).
    \end{enumerate}
\end{lemma}
Le point~\ref{ItemTSOooYkxvBuii} est une précision du point~\ref{ItemTSOooYkxvBui} : il dit quelle est la taille de la boule de \( E\) nécessaire à obtenir la boule unité dans \( F\).

\begin{proof}
    Soit \( y\in \overline{ B_F(0,1) }\). Nous allons construire \( x\in B\big( 0,\frac{ C }{ 1-\alpha } \big)\) qui donne \( f(x)=y\). Ce \( x\) sera la limite d'une série que nous allons construire par récurrence. Pour \( n=1\) nous utilisons la presque surjectivité pour considérer \( x_1\in\overline{ B_E(0,C) } \) tel que \( \| y-f(x_1) \|\leq \alpha\). Ensuite nous considérons la récurrence
    \begin{equation}
        x_n\in \overline{ B_E(0,C) }
    \end{equation}
    tel que
    \begin{equation}
        \big\| y-\sum_{i=1}^n\alpha^{i-1}f(x_i) \big\|\leq \alpha^n
    \end{equation}
    Pour montrer que cela existe nous supposons que la série est déjà construire jusqu'à \( n>1\) :
    \begin{equation}
        \frac{1}{ \alpha^n }\Big( y-\sum_{i=1}^n\alpha^{i-1}f(x_i) \Big)\in \overline{ B_F(0,1) }
    \end{equation}
    À partir de là, par presque surjectivité il existe un \( x_{n+1}\in \overline{ B_E(0,C) }\) tel que
    \begin{equation}
        \big\| \frac{ y-\sum_{i=1}^n\alpha^{i-1}f(x_i) }{ \alpha^n }-f(x_{n+1}) \big\|\leq \alpha.
    \end{equation}
    En multipliant par \( \alpha^{n}\), le terme \( \alpha^nf(x_{n+1})\) s'intègre bien dans la somme :
    \begin{equation}
        \big\| y=\sum_{i=1}^{n+1}\alpha^{i-1}f(x_i) \big\|\leq \alpha^{n+1}.
    \end{equation}
    Nous nous intéressons à une éventuelle limite à la somme des \( \alpha^{n-1}x_n\). D'abord nous avons la majoration \( \| \alpha^{n-1}x_n \|\leq \alpha^{n-1}C\), et vu que par la définition de la presque surjectivité \( 0<\alpha<1\), la série
    \begin{equation}
        \sum_{n=1}^{\infty}\alpha^{n-1}x_n
    \end{equation}
    converge absolument\footnote{Définition~\ref{DefVFUIXwU}.} parce que la suite des normes est une suite géométrique de raison \( \alpha\). Vu que \( E\) est de Banach, la convergence absolue implique la convergence simple (la suite des sommes partielles est de Cauchy et Banach est complet). Nous posons
    \begin{equation}
        x=\sum_{n=1}^{\infty}\alpha^{n-1}x_n\in E,
    \end{equation}
    et en termes de normes, ça vérifie
    \begin{equation}
        \| x \|\leq\sum_{n=1}^{\infty}\alpha^{n-1}\| x_n \|\leq C\sum_{n=1}^{\infty}\alpha^{n-1}=\frac{ C }{ 1-\alpha }.
    \end{equation}
    Donc c'est bon pour avoir \( x\in B\big( 0,\frac{ C }{ 1-\alpha } \big)\). Nous devons encore vérifier que \( y=f(x)\). Pour cela nous remarquons que
    \begin{equation}
        \| y-f\Big( \sum_{n=1}^N\alpha^{n-1}x_n \Big) \|\leq \alpha^N.
    \end{equation}
    Nous pouvons prendre la limite \( N\to \infty\) et permuter \( f\) avec la limite (par continuité de \( f\)). Vu que \( 0<\alpha<1\) nous avons
    \begin{equation}
        \| y-f(x) \|=0.
    \end{equation}
\end{proof}

\begin{theorem}[Tietze\cite{KXjFWKA,ytMOpe}]   \label{ThoFFQooGvcLzJ}
    Soit un espace métrique \( (X,d)\) et un fermé \( Y\subset X\). Soit \( g_0\in C^0(Y,\eR)\). Alors \( g_0\) admet un prolongement continu sur \( X\).
\end{theorem}

\begin{proof}
    Soit l'opération de restriction
    \begin{equation}
        \begin{aligned}
            T\colon (C^0_b(X,\eR),\| . \|_{\infty})&\to (C^0_b(Y,\eR),\| . \|_{\infty}) \\
            f&\mapsto f|_Y.
        \end{aligned}
    \end{equation}
    L'application \( T\) est évidemment linéaire. Elle est de plus borné pour la norme opérateur usuelle donnée par la proposition~\ref{DefNFYUooBZCPTr} parce que \( \| T(f) \|\leq \| f \|<\infty\). L'application \( T\) est alors continue par la proposition~\ref{PROPooQZYVooYJVlBd}.

    \begin{subproof}
    \item[Presque surjection]

    Soit \( g\in C^0_b(Y,\eR)\) avec \( \| g \|_{\infty}\leq 1\). Nous posons
    \begin{subequations}
        \begin{align}
            Y^+=\{ x\in Y\tq \frac{1}{ 3 }\leq g(x)\leq 1 \}\\
            Y^-=\{ x\in Y\tq -1\leq g(x)\leq -\frac{1}{ 3 } \}.
        \end{align}
    \end{subequations}
    Nous considérons alors
    \begin{equation}
        \begin{aligned}
            f\colon X&\to \eR \\
            x&\mapsto \frac{1}{ 3 }\frac{ d(x,Y^-)-d(x,Y^+) }{ d(x,Y^-)+d(x,Y^+) }
        \end{aligned}
    \end{equation}
    Vu qu'en valeur absolue le dénominateur est plus grand que le numérateur nous avons \( \| f \|_{\infty}\leq \frac{1}{ 3 }\). Notons que
    \begin{itemize}
        \item Si \( x\in Y^+\) alors \( f(x)=\frac{1}{ 3 }\) et \( g(x)\in\mathopen[ \frac{1}{ 3 } , 1 \mathclose]\);
        \item Si \( x\in Y^-\) alors \( f(x)=-\frac{1}{ 3 }\) et \( g(x)\in\mathopen[-1,-\frac{1}{ 3 } \mathclose]\);
        \item Si \( x\) n'est ni dans \( Y^+\) ni dans \( Y^-\) alors nous avons\footnote{Nous rappelons que \( \| g \|=1\), donc \( g(x)\) est forcément ente \( -1\) et \( 1\).} \( g(x)\in\mathopen[ -\frac{1}{ 3 } , \frac{1}{ 3 } \mathclose]\) et donc \( \big| f(x)-g(x) \big|\leq \big| f(x) \big|+\big| g(x) \big|\leq \frac{ 2 }{ 3 }\).
    \end{itemize}
    Dans les deux cas nous avons \( \big| f(x)-g(x) \big|\in\mathopen[ 0 , \frac{ 2 }{ 3 } \mathclose]\) pour tout \( x\in X\). Cela prouve que
    \begin{equation}
        \| T(f)-g \|_{Y,\infty}\leq \frac{ 2 }{ 3 }.
    \end{equation}
    En résumé nous avons pris \( g\) dans la boule \( \overline{ B(0,1) }\) de \( \big( C^0_b(Y,\eR), \| . \|_{\infty} \big)\) et nous avons construit une fonction \( f\) dans la boule \( \overline{ B(0,\frac{1}{ 3 }) }\) de \( \big( C^0_b(X,\eR),\| . \|_{\infty} \big)\) telle que \( \| T(f)-g \|_{\infty}\leq \frac{ 2 }{ 3 }\). L'application \( T\) est donc une presque surjection avec \( \alpha=\frac{1}{ 3 }\) et \( C=\frac{ 2 }{ 3 }\).

\item[Prolongement dans les boules unité fermées]

    La proposition~\ref{PropSYMEZGU} nous assure que les espaces \( C^0_b(X,\eR)\) et \( C_b^0(Y,\eR)\) sont de Banach (complets), et le lemme~\ref{LemBQLooRXhJzK} nous dit alors que \( T\) est surjective et que pour tout \( g\in\overline{ B(0,1) }\), il existe
    \begin{equation}
        f\in\overline{ B\left( 0,\frac{ 1/3 }{ 1-\frac{ 2 }{ 3 } } \right) }=\overline{ B(0,1) }.
    \end{equation}
    telle que \( g=T(f)\).


\item[Prolongement pour les boules ouvertes]

    Jusqu'à présent nous avons montré qu'une fonction \( g\in\overline{ B(0,1) }\) admet une prolongement continu dans \( \overline{ B(0,1) }\). Nous allons montrer que si \( g\) est dans la boule ouverte \( B(0,1)\) de \( \big( C^0_b(Y,\eR),\| . \|_{\infty} \big)\) alors \( g\) admet un prolongement dans la boule ouverte \( B(0,1)\) de \( \big( C_b^0(X,\eR),\| . \|_{\infty} \big)\).

    Soit \( g\in B_{C^0_b(Y)}(0,1) \) et son prolongement \( h\in \overline{ B_{C_b^0(X)}(0,1) }\). Si \( \| h \|_{\infty}<1\) alors le résultat est vrai. Sinon nous considérons l'ensemble
    \begin{equation}
        Z=\{ x\in X\tq | h(x) |=1 \}.
    \end{equation}
    Nous avons \( Y\cap Z=\emptyset\) parce que nous avons \( h=g\) sur \( Y\) et nous avons choisi \( \| g \|_{\infty}<\infty\). Par ailleurs \( Y\) est fermé par hypothèse et \( Z\) est fermé parce que \( h\) est continue; par conséquent \( Y\cap Z\) est fermé, donc\footnote{Si vous avez l'intention de dire que \( \overline{ Y\cap Z }=\bar Y\cap\bar Z=Y\cap Z=\emptyset\), allez d'abord voir l'exemple~\ref{ExBFLooUNyvbw}. Ici c'est correct parce que \( Y\) et \( Z\) sont fermés.}
    \begin{equation}
        \bar Y\cap\bar Z=Y\cap Z=\emptyset.
    \end{equation}
    Nous posons
    \begin{equation}
        \begin{aligned}
            u\colon X&\to \eR^+ \\
            x&\mapsto \frac{ d(x,Z) }{ d(x,Y)+d(x,Z) }
        \end{aligned}
    \end{equation}
    Le dénominateur n'est pas nul parce qu'il faudrait \( d(x,Y)=d(x,Z)=0\), ce qui demanderait \( x\in \bar Y\cap\bar Z\), ce qui n'est pas possible. Nous posons \( f=uh\). Si \( x\in Y\) alors \( u(x)=1\), donc \( f\) est encore un prolongement de \( g\). De plus \( f\) est encore continue, et donc encore un bon candidat. Enfin si \( x\) est hors de \( Y\) alors \( d(x,Y)>0\) (strictement parce que \( Y\) est fermé) et donc \( 0<u(x)<1\), ce qui donne \( | f(x) |<| h(x) |\leq 1\). Donc \( \| f \|_{\infty}<1\).

    Nous avons donc trouvé qu'une fonction dans la boule ouverte \( B_{C^0_b(Y)}(0,1)\) se prolonge en une fonction dans la boule ouverte \( B_{C^0_b(X)}(0,1)\).

\item[Le cas non borné]

Soit enfin \( g_0\in C^0(Y,\eR)\). Nous allons nous ramener au cas de la boule unité ouverte en utilisant un homéomorphisme \( \phi\colon \eR\to \mathopen] -1 , 1 \mathclose[\). L'application \( g=\phi\circ g_0\) est dans la boule unité ouvert de \( C^0(Y,\eR)\) et donc admet un prolongement \( f\) dans la boule unité ouverte de \( C^0(X)\). L'application \( f_0=\phi^{-1}\circ f\) est un prolongement continu de \( g_0\).

    \end{subproof}
\end{proof}

Un homéomorphisme \( \phi\colon \eR\to \mathopen] -1 , 1 \mathclose[\) est donné par exemple par la fonction \( \phi(t)=\frac{ 2 }{ \pi }\arctan(t)\) dont le graphique est donné ci-dessous :
\begin{center}
    \input{auto/pictures_tex/Fig_FXVooJYAfif.pstricks}
\end{center}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Espace de Schwartz}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Pour un multiindice \( \alpha=(\alpha_1,\ldots, \alpha_d)\in \eN^d\), nous notons
\begin{equation}
    \partial^{\alpha}\varphi=\partial_{x_1}^{\alpha_1}\ldots\partial_{x_d}^{\alpha_d}\varphi
\end{equation}
pour peu que la fonction \( \varphi\) soit \( | \alpha |=\alpha_1+\cdots +\alpha_d\) fois dérivable.

\begin{definition}  \label{DefHHyQooK}
    Soit \( \Omega\subset\eR^d\). L'\defe{espace de Schwartz}{espace!de Schwartz} \( \swS(\Omega)\) est le sous-ensemble de \(  C^{\infty}(\Omega)\) des fonctions dont toutes les dérivées décroissent plus vite que tout polynôme :
    \begin{equation}
        \swS(\Omega)=\big\{   \varphi\in C^{\infty}(\Omega)\tq\forall \alpha,\beta\in \eN^d, p_{\alpha,\beta}(\varphi)<\infty   \big\}
    \end{equation}
    où nous avons considéré
    \begin{equation}    \label{EqOWdChCu}
        p_{\alpha,\beta}(\varphi)=\sup_{x\in \Omega}| x^{\beta}(\partial^{\alpha}\varphi)(x) |=\| x^{\beta}\partial^{\alpha}\varphi \|_{\infty}.
    \end{equation}
\end{definition}

Pour simplifier les notations (surtout du côté de Fourier), nous allons parfois écrire \( M_i\varphi\)\nomenclature[Y]{\( M_i\varphi\)}{La fonction \( x\mapsto x_i\varphi(x)\)} pour la fonction \( x\mapsto x_i\varphi(x)\).

\begin{example}
    La fonction \(  e^{-x^2}\) est une fonction à décroissance rapide sur \( \eR\).
\end{example}

\begin{definition}
    Une fonction \( f\colon \eR^d\to \eC\) est dite à \defe{décroissance rapide}{fonction!à décroissance rapide} si elle décroît plus vite que n'importe quel polynôme. Plus précisément, si pour tout polynôme \( Q\), il existe un \( r>0\) tel que \(  | f(x) |<\frac{1}{ | Q(x) | } \) pour tout \( \| x \|\geq r\).
\end{definition}

\begin{proposition} \label{PropCSmzwGv}
    Une fonction Schwartz est à décroissance rapide.
\end{proposition}

\begin{proof}
    Nous commençons par considérer un polynôme \( P\) donné par
    \begin{equation}
        P(x)=\sum_kc_kx^{\beta_k}
    \end{equation}
    où les \( \beta_k\) sont des multiindices, les \( c_k\) sont des constantes et la somme est finie. Nous avons la majoration
    \begin{equation}
        \sup_{x\in \eR^d}| \varphi(x)P(x) |\leq\sum_k\sup_x\big| c_k\varphi(x) x^{\beta_k} \big|\leq\sum_k| c_k |p_{0,\beta_k}(\varphi)<\infty.
    \end{equation}
    Nous allons noter \( M_P\) la constante \( \sum_k| c_k |p_{0,\beta_k}(\varphi)\), de sorte que pour tout \( x\in \eR^d\) nous ayons \( | \varphi(x)P(x) |\leq M_P\) et donc
    \begin{equation}
        | \varphi(x) |\leq \frac{ M_P }{ | P(x) | }=\frac{1}{ | \frac{1}{ M_P }P(x) | }.
    \end{equation}
    Notons que cette inégalité est a fortiori correcte pour les \( x\) sur lesquels \( P\) s'annule.

    Soit maintenant un polynôme \( Q\). Nous considérons le polynôme \( P(x)=\| x \|Q(x)\). Étant de plus haut degré, pour toute constante \( C\) il existe un rayon \( r_C\) tel que \( | P(x) |\geq C| Q(x) |\) pour tout \( | x |\geq r_C\). En particulier pour \( | x |\geq r_{M_P}\) nous avons
    \begin{equation}
        | P(x) |\geq M_P| Q(x) |
    \end{equation}
    et donc, pour ces \( x\),
    \begin{equation}
        | \varphi(x) |\leq \frac{1}{ | \frac{1}{ M_P }P(x) | }\leq \frac{1}{ | Q(x) | }.
    \end{equation}
    La première inégalité est valable pour tout \( x\), et la seconde pour \( \| x \|\geq r_{M_P}\).
\end{proof}

\begin{corollary}[\cite{MonCerveau}]        \label{CORooZFPSooHCFUSH}
    Soit \( \varphi\) une fonction Schwartz sur \( \eR^m\times \eR^n\). Alors la fonction
    \begin{equation}
        y\mapsto \sup_{x\in \eR^n}| \varphi(x,y) |
    \end{equation}
    est intégrable.
\end{corollary}

\begin{proof}
    Soit un polynôme \( Q\) en la variable \( y\). Par la proposition~\ref{PropCSmzwGv}, il existe \( r>0\) tel que
    \begin{equation}
        | \varphi(x,t) |<\frac{1}{ Q(y) }
    \end{equation}
    pour tout \( \| (x,y) \|>r\). A fortiori l'inégalité tient pour tout \( | y |>r\). Donc
    \begin{equation}
        \int_{\eR^m}\sup_{x\in \eR^n}| \varphi(x,y) |dy=\int_{\| y \|\leq r}\sup_{x}| \varphi(x,y) |dy+\int_{ \| y \|>r  }\sup_{x}| \varphi(x,y) |dy.
    \end{equation}
    La première intégrale est bornée par \( \Vol\big( B(0,r) \big)\| f \|_{\infty}\) tandis que la seconde est bornée par l'intégrale de \( \frac{1}{ Q(y) }\). En prenant \( Q\) de degré suffisamment élevé en toutes les composantes de \( y\) nous avons intégrabilité.
\end{proof}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Topologie}
%---------------------------------------------------------------------------------------------------------------------------

\begin{lemmaDef}        \label{LEMDEFooZEFVooMMmiBr}
    Les \( p_{\alpha,\beta}\) donnés par l'équation \eqref{EqOWdChCu} ci-dessus sont des semi-normes\footnote{Définition~\ref{DefPNXlwmi}.}. La topologie considérée sur \( \swS(\eR^d)\) est celle des semi-normes \( p_{\alpha,\beta}\).
\end{lemmaDef}
%TODO : une preuve pour égayer la galerie.

\begin{normaltext}      \label{NORMooVQESooRwJShl}
Nous avons un enchaînement de résultats qui nous aident à prouver la continuité d'une application \( T\colon \swS(\eR^d)\to X\).
\begin{enumerate}
    \item
        La topologie de \( \swS(\eR^d)\) est donnée par une famille dénombrable de semi-normes. Donc la proposition~\ref{PROPooMJEQooHtIyeX} nous dit que \( \swS(\eR^d)\) est métrisable.
    \item
        La proposition~\ref{PROPooKNVUooMbLZoy} nous dit alors que si \( X\) est métrique, toute application séquentiellement continue \( T\colon \swS(\eR^d)\to X\) est continue.
    \item
        Donc si \( X\) est métrique, il suffit de prouver que pour \( f_n\stackrel{\swS(\eR^d)}{\longrightarrow}0\) nous avons \( T(f_n)\stackrel{X}{\longrightarrow} 0\) où \( f_n\colon \swS(\eR^d)\to X\). Dans les cas usuels, \( T\) sera une distribution et \( X=\eC\).
    \item
        En vertu de la proposition~\ref{PropQPzGKVk}, la convergence \( f_n\stackrel{\swS(\eR^d)}{\longrightarrow}0\) signifie que pour tout choix de multiindice \( \alpha\) et \( \beta\),  \( p_{\alpha,\beta}(f_n)\to 0\), c'est à dire
        \begin{equation}        \label{EQooPUJPooNbtNFh}
            \| x^{\beta}\partial^{\alpha}f_n \|_{\infty}\to 0.
        \end{equation}
    \item
        Et enfin, la technique pour montrer que \( T\colon \swS(\eR^d)\to \eC\) est continue est de montrer que sous l'hypothèse d'avoir \eqref{EQooPUJPooNbtNFh} pour tout choix de \( \alpha\) et \( \beta\), nous avons \( T(f_n)\to 0\) dans \( \eC\).
\end{enumerate}
\end{normaltext}

\begin{lemma}[\cite{OEVAuEz}]   \label{LemRJhCbkO}
    La topologie sur \( \swS(\eR^d)\) est donnée aussi par les semi-normes
    \begin{equation}
        q_{n,m}=\max_{| \alpha |\leq n}\sup_{x\in \eR^d}\big( 1+\| x \| \big)^m\big| \partial^{\alpha}\varphi(x) \big|.
    \end{equation}
    Autrement dit, une suite \( \varphi_n\stackrel{\swS(\eR^d)}{\to}0\) si et seulement si \( q_{n,m(\varphi)}\to 0\) pour tout \( n\) et \( m\).
\end{lemma}
Le fait que les \( q_{n,m}(\varphi)\) restent bornés est la proposition~\ref{PropCSmzwGv}. Cependant ce lemme est plus précis parce qu'en disant seulement que \( \varphi\) est majoré par des polynôme, nous ne disons pas que les polynômes correspondants aux \( \varphi_n\) tendent vers zéro si \( \varphi_n\stackrel{\swS}{\to}0\). Et d'ailleurs on ne sait pas très bien ce que signifierait \( P_n\to 0\) pour une suite de polynômes.

\begin{proposition}     \label{PropGNXBeME}
    Pour \( p\in\mathopen[ 1 , \infty \mathclose]\), l'espace \( \swS(\eR^d)\) s'injecte continument dans \( L^p(\eR^d)\).
\end{proposition}

\begin{proof}
    L'injection dont nous parlons est l'identité ou plus précisément l'identité suivie de la prise de classe. Il faut vérifier que cela est correct et continu, c'est à dire d'abord qu'une fonction à décroissance rapide est bien dans \( L^p\) et ensuite que si \( f_n\stackrel{\swS}{\to}0\), alors \( f_n\stackrel{L^p}{\to}0\).

    Commençons par \( p=\infty\). Alors \( \| f_n \|_{\infty}=p_{0,0}(f_n)\to 0\) parce que si \( f_n\stackrel{\swS}{\to}0\), alors en particulier \( p_{0,0}(f_n)\to 0\).

    Au tour de \( p<\infty\) maintenant. Nous savons qu'en dimension \( d\), la fonction
    \begin{equation}
        x\mapsto \frac{1}{ (1+\| x \|)^s }
    \end{equation}
    est intégrable dès que \( s>d\).
    %TODO : il faudrait une petite preuve de ça.
    Pour toute valeur de \( m\) nous avons
    \begin{equation}
        \| \varphi \|_p^p=\int_{\eR^d}| \varphi(x) |^pdx=\int_{\eR^d}\frac{ \big|    (1+\| x \|)^m\varphi(x)   \big|^p }{ \big( 1+\| x \| \big)^{mp} }\leq\int_{\eR^d}\frac{q_{0,m}(\varphi)^p}{ \big( 1+\| x \| \big)^{mp} }.
    \end{equation}
    En choisissant \( m\) de telle sorte que \( mp>d\), nous avons convergence de l'intégrale et donc \( \| \varphi \|_p<\infty\). Nous retenons que
    \begin{equation}    \label{EqVWfEFMk}
        \| \varphi \|_p^p\leq Cq_{0,m}(\varphi)^p
    \end{equation}
    pour une certaine constance \( C\) et un bon choix de \( m\).

    Ceci prouve que \( \swS(\eR^d)\subset L^p(\eR^d)\). Nous devons encore vérifier que l'inclusion est continue. Si \( \varphi_n\stackrel{\swS}{\to}0\), alors en particulier nous avons \( q_{0,m}(\varphi_n)\to 0\) par le lemme~\ref{LemRJhCbkO}. Par conséquent la majoration \eqref{EqVWfEFMk} nous dit que \( \| \varphi_n \|_p\to 0\) également.

\end{proof}
En résumé, si \( \varphi_n\stackrel{\swS(\eR^d)}{\to}\varphi\) alors \( \varphi_n\stackrel{L^p}{\to}\varphi\).

\begin{theorem}[\cite{MesIntProbb}]      \label{ThoRWEoqY}
    Soit \( \mu\) une mesure sur les boréliens de \( \eR^n\) finie sur les compacts. Alors \( \swD(\eR^n)\) est dense dans \( L^1(\eR^n,\Borelien(\eR^n),\mu)\).
\end{theorem}
\index{densité!de \( \swD(\eR^n)\) dans \( L^1(\eR^n)\)}

\begin{proposition}[\cite{ooIKXSooRlKVJR}]      \label{PROPooJNQZooIRbJei}
    La partie \( \swD(\eR^d)\) est dense dans \( \swS(\eR^d)\).
\end{proposition}

\begin{proof}
    Soit \( f\in \swS(\eR^d)\), et \( \phi\), une fonction de \( \swD(\eR^d)\) telle que \( \phi(x)=1\) pour \(| x |\leq 1 \) (l'existence de telles fonctions est discutée en~\ref{subsecOSYAooXXCVjv}). Soit aussi \( \phi_k(x)=\phi(x/k)\). Nous posons
    \begin{equation}
        f_k(x)=\phi_k(x)f(x),
    \end{equation}
    et nous allons prouver que pour tout multiindices \( \alpha\) et \( \gamma\),
    \begin{equation}
        p_{\alpha,\gamma}(f_k-f)=\| x^{\gamma}\partial^{\alpha}(f_k-f)  \|_{\infty}\to 0.
    \end{equation}
    Pour cela nous allons noter \(  \beta\leq \alpha  \) lorsque \( \beta\) est un multiindice contenu dans \( \alpha\). En utilisant la dérivée du produit nous avons
    \begin{subequations}
        \begin{align}
            (\partial^{\alpha}f_k)(x)&=\sum_{\beta\leq \alpha}(\partial^{\alpha-\beta}\phi_k)(x)\partial^{\beta}f(x)\\
            &=\sum_{\beta\leq \alpha}k^{-| \alpha-\beta |}(\partial^{\alpha-\beta}\phi)(x/k)(\partial^{\beta}f)(x)\\
            &=\sum_{\beta< \alpha}k^{-| \alpha-\beta |}(\partial^{\alpha-\beta}\phi)(x/k)(\partial^{\beta}f)(x) + \phi(x/k)(\partial^{\alpha}f)(x).
        \end{align}
    \end{subequations}
    Nous devons donc étudier et majorer
    \begin{equation}
        \begin{aligned}[]
        \sup_{x\in \eR^d}| x^{\gamma}\partial^{\alpha}(f_k-f) |&\leq \sup\big| x^{\gamma}  \sum_{\beta< \alpha}k^{-| \alpha-\beta |}(\partial^{\alpha-\beta}\phi)(x/k)(\partial^{\beta}f)(x)  \big|\\
        &\quad+\sup \big| x^{\gamma}\big( \phi(x/k)-1 \big)(\partial^{\alpha}f)(x) \big|\\
        \end{aligned}
    \end{equation}
    En ce qui concerne le second terme, soit \( \epsilon>0\), vu que \( f\) est Schwartz, il existe \( R\) tel que
    \begin{equation}
        | x^{\gamma}(\partial^{\alpha}f)(x) |<\epsilon
    \end{equation}
    dès que \( \| x \|>R\). En prenant \( k>R\),
    \begin{equation}
        | x^{\gamma}(\partial^{\alpha}f)(x) |\begin{cases}
            =0    &   \text{si } \| x \|<R\\
            \leq \epsilon    &    \text{si } \| x \|>R\text{.}
        \end{cases}
    \end{equation}
    En ce qui concerne le premier terme,
    \begin{subequations}
        \begin{align}
            \sup_{x\in \eR^d}\big| x^{\gamma}&\sum_{\beta<\alpha}k^{-|\alpha-\beta |}(\partial^{\alpha-\beta}\phi)(x/k)(\partial^{\beta}f)(x) \Big|\\
            &\leq \frac{1}{ k }\sup_{x}\big| \sum_{\beta<\alpha}(\partial^{\alpha-\beta}\phi)(x/k)(x^{\gamma}\partial^{\beta}f)(x) \big|\\
            &= \frac{1}{ k }\sup_{x}\big| \sum_{\beta<\alpha}(\partial^{\alpha-\beta}\phi)(x/k)  p_{\beta,\gamma}(f)   \big|
        \end{align}
    \end{subequations}
    La somme ne contient qu'un nombre fini de \( \beta\) différents, donc nous pouvons considérer un nombre \( K\) qui majore tous les \( p_{\beta,\gamma}(f)\) en même temps. La partie avec \( \phi\) peut être majorée par \( \| \partial^{\alpha-\beta}\phi \|_{\infty}\) (qui est fini) dont nous pouvons prendre le maximum sur \(\beta<\alpha\). Toute l'expression dans la somme est donc majorée par un nombre qui ne dépend ni de \( x\) ni de \( \beta\). Vu que la somme est finie, elle est majorée par ce nombre multiplié par le nombre de termes dans la somme et au final
    \begin{equation}
        \sup_{x\in \eR^d}\big| x^{\gamma}\sum_{\beta<\alpha}k^{-|\alpha-\beta |}(\partial^{\alpha-\beta}\phi)(x/k)(\partial^{\beta}f)(x) \Big|\leq \frac{ K' }{ k }.
    \end{equation}
    La limite \( k\to \infty\) ne fait alors plus de doutes.
\end{proof}

\begin{remark}
    Vu la topologie de \( \swS(\eR^d)\) (définition~\ref{LEMDEFooZEFVooMMmiBr}), la convergence \( f_k\stackrel{\swS(\eR^d)}{\longrightarrow}f\) peut être exprimée par le fait que pour tout \( k,l\),
    \begin{equation}
        t^kf_n^{(l)}\stackrel{unif}{\longrightarrow}t^kf^{(l)}.
    \end{equation}
    C'est à dire convergence uniforme de toutes les dérivées multipliées par n'importe quel polynôme.
\end{remark}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Produit de convolution}
%---------------------------------------------------------------------------------------------------------------------------

\begin{proposition}[Stabilité de Schwartz par convolution\footnote{Définition~\ref{THOooMLNMooQfksn}.} \cite{CXCQJIt}]     \label{PROPooUNFYooYdbSbJ}
    Si \( \varphi\in L^1(\eR^d)\) et \( \psi\in\swS(\eR^d)\), alors \( \varphi * \psi\in \swS(\eR^d)\).
\end{proposition}

\begin{proof}
    Nous devons prouver que
    \begin{equation}
        p_{\alpha,\beta}(\varphi*\psi)=\sup_{x\in \eR^d}| x^{\beta}(\partial^{\alpha}(\varphi*\psi))(x) |
    \end{equation}
    est borné pour tout multiindices \( \alpha\) et \( \beta\). En appliquant \( | \alpha |\) fois la proposition~\ref{PropHNbdMQe}, nous mettons toutes les dérivées sur \( \psi\) : \( \partial^{\alpha}(\varphi*\psi)=(\varphi*\partial^{\alpha}\psi)\). Cela étant fait, nous majorons
    \begin{subequations}
        \begin{align}
            \big| x^{\beta}(\varphi*\partial^{\alpha}\psi)(x) \big|&\leq| x^{\beta} |\int_{\eR^d} |\varphi(y)|\underbrace{\big| (\partial^{\alpha}\psi)(x-y)\big|}_{\leq\| \partial^{\alpha}\psi \|_{\infty}} dy \big|\\
            &\leq | x^{\beta} |  \| \partial^{\alpha}\psi \|_{\infty}\int_{\eR^d}| \varphi(y) |dy\\
            &\leq p_{\alpha,\beta}(\psi)\| \varphi \|_{_{L^1}}.
        \end{align}
    \end{subequations}
    Par conséquent, \( p_{\alpha,\beta}(\varphi*\psi)\leq \| \varphi \|_{L^1}p_{\alpha,\beta}(\psi)<\infty\).
\end{proof}
