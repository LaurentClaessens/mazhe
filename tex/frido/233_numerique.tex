% This is part of Mes notes de mathématique
% Copyright (C) 2010-2018, 2022
%   Laurent Claessens
% See the file LICENCE.txt for copying conditions.


%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
\subsubsection{Propriétés du système}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

La matrice est la suivante :
\begin{equation}
    L_h=\begin{pmatrix}
        \frac{ 2 }{ h^2 }+c_1 & -1/h^2                & 0                     & 0      & \cdots & 0                     \\
        -1/h^2                & \frac{ 2 }{ h^2 }+c_2 & -1/h^2                & 0      & \cdots & 0                     \\
        0                     & -1/h^2                & \frac{ 2 }{ h^2 }+c_3 & -1/h^2 & \ddots & \vdots                \\
        0                     & 0                     & -1/h^2                & \ddots & \ddots & 0                     \\
        \vdots                & \vdots                & \ddots                & \ddots & \ddots & -1/h^2                \\
        0                     & 0                     & \cdots                & 0      & -1/h^2 & \frac{ 2 }{ h^2 }+c_N
    \end{pmatrix}
\end{equation}
où nous avions déjà posé l'hypothèse \( c_i\geq 0\) pour tout \( i\).

\begin{lemma}       \label{LEMooGGHQooNnVsuu}
    La matrice \( L_h\) est irréductible\footnote{Caractérisation~\ref{PROPooZTYDooZAxQxF}.} à diagonale fortement dominante\footnote{Définition~\ref{DEFooLSUTooHuXabV}.}.
\end{lemma}

\begin{proof}
    Nous décomposons la preuve en plusieurs parties, en notant \( L\) pour \( L_h\), afin d'alléger les notations.
    \begin{subproof}
        \item[La première ligne]
            Sur la première ligne, seuls deux éléments sont non nuls et nous avons \( | L_{11} |=\frac{ 2 }{ h^2 }+c_1\) parce que \( c\) est une fonction positive et \( | L_{12}|=\frac{1}{ h^2 }\). Nous avons donc
        \begin{equation}
            | L_{11} |-| L_{12} |=\frac{ 2 }{ h^2 }+c_1-\frac{1}{ h^2 }=\frac{1}{ h^2 }+c_1>0.
        \end{equation}
        L'inégalité stricte est importante.

        \item[La dernière ligne]
        Elle est semblable à la première.

        \item[Les autres lignes]
        Sur les autres lignes nous avons trois éléments non nuls et
        \begin{equation}
            \sum_{j\neq i}| L_{ij} |=\frac{ 2 }{ h^2 }\leq \frac{ 2 }{ h^2 }+c_i=L_{ii}.
        \end{equation}

        \item[Diagonale fortement dominante]
        Nous avons prouvé jusqu'à présent que \( L_h\) était une matrice à diagonale fortement dominante.

        \item[Irréductible]
        Nous allons utiliser la caractérisation de la proposition~\ref{PROPooZTYDooZAxQxF}\ref{ITEMooVNOHooRUNpwG}. Pour cela, nous considérons la chaine d'éléments non nuls
        \begin{equation}
            L_{12}, L_{23},\ldots, L_{N-1,N}=-\frac{1}{ h^2 }.
        \end{equation}
        Soient deux indices \( i\) et \( j\) avec \( i<j\). Cette suite d'indice (ou une sous-suite) rend \( i\) et \( j\) connectés.

        Si par contre \( i>j\), il faut considérer la suite inversée grâce au fait que \( L_h\) est symétrique :
        \begin{equation}
            L_{N,N-1},L_{N-1,N-2},\ldots, L_{32}, L_{21}=-\frac{ 1 }{ h^2 }.
        \end{equation}
    \end{subproof}
\end{proof}

\begin{proposition}     \label{PROPooOQJVooJMTkVM}
    Soit le problème
    \begin{equation}                \label{EQooEUHQooWHRelr}
        \begin{cases}
            -u''(x)+c(x)u(x)=f & \text{sur } \Omega \\
            u(0)=\alpha                             \\
            u(1)=\beta
        \end{cases}
    \end{equation}
    où \( c\) est une fonction positive et \( \alpha,\beta\in \eR\). Nous considérons \( h>0\) assez petit pour que le reste ait un sens. Et nous approximons \( u''\) par \( D^-D^+u\).

    La matrice \( L_h\) des différences finies associée à ce problème est
    \begin{enumerate}
        \item
              une M-matrice,
        \item
              strictement définie positive,
        \item
              d'inverse \( L_h^{-1}>0\).
    \end{enumerate}
\end{proposition}

\begin{proof}
    Le théorème~\ref{THOooLZGSooSevggj} dit que \( L_h\) est une M-matrice. La proposition~\ref{PROPooQBWQooBbeZLO} nous donne aussi que \( L_h\) est strictement définie positive.

    Le lemme~\ref{LEMooGGHQooNnVsuu} dit que \( L_h\) est irréductible, ce qui permet à la proposition~\ref{PROPooZDMQooIZAbKK} de conclure que \( L_h^{-1}>0\).
\end{proof}

Cela étant rappelé, nous pouvons continuer.

\begin{lemma}       \label{LEMooDXPRooOhwqSZ}
    Soit \( \Omega=\mathopen] 0 , 1 \mathclose[\), soit \( N\in \eN\) et \( h=1/(N+1)\).  La solution \( w_h\colon \Omega_h \to \eR\) du problème discrétisé
    \begin{subequations}        \label{SUBEQooFJKIooLvzMBG}
        \begin{numcases}{}
            -(D^-D^+w_h)(x_k)=1\\
            w_h(0)=0\\
            w_h(1)=0
        \end{numcases}
    \end{subequations}
    pour tout \( x_k=kh\) (\( k=1,\ldots, N\)) donne les valeurs exactes des \( w(x_k)\) lorsque \( w\) est la solution de
    \begin{subequations}        \label{SUBEQooCRFWooJegcUk}
        \begin{numcases}{}
            -w''(x)=1\\
            w(0)=0\\
            w(1)=0.
        \end{numcases}
    \end{subequations}
\end{lemma}

\begin{proof}
    Un enseignement de la proposition~\ref{PROPooOQJVooJMTkVM} est que le système \eqref{SUBEQooFJKIooLvzMBG} peut être écrit sous la forme d'un système linéaire \( L^0_hw_h=F_h\) où \( L_h^0\) est inversible. Il y a donc unicité de la solution.

    D'autre part, la solution du système \eqref{SUBEQooCRFWooJegcUk} est \( w(x)=\frac{ 1 }{2}(x-x^2)\), qui est de classe \(  C^{\infty}\). Le lemme~\ref{LEMooZECZooVKxOZZ}\ref{ITEMooRWUHooZJLKuL} dit que \( D^-D^+w=w''\). Donc les valeurs \( w(x_k)\) résolvent aussi le système \eqref{SUBEQooFJKIooLvzMBG}.
\end{proof}

\begin{lemma}[Quelques estimations]
    La matrice \( L_h\) du problème sus-mentionné en \eqref{EQooEUHQooWHRelr} vérifie\quext{Dans le CTES d'analyse numérique de Marseille, l'estimation donnée est \(  \| L_h^{-1} \|_{\infty}\leq \frac{1}{ 4 } \).} :
    \begin{enumerate}
        \item
              \( \| L_h \|_{\infty}\leq \frac{4 }{ h^2 }+\| c \|_{\infty}\)
        \item
              \( \| L_h^{-1} \|_{\infty}\leq \frac{1}{ 8 }\).
    \end{enumerate}
\end{lemma}

\begin{proof}
    Nous nous souvenons de la formule \eqref{EQooPLCIooVghasD} :
    \begin{equation}
        \| A \|_{\infty}=\max_{i=1,\ldots, n}\sum_{j=1}^n| A_{ij} |.
    \end{equation}
    La première ligne a pour somme : \( \frac{ 3 }{ h^2 }+c_1\), la dernière a pour somme \( \frac{ 3 }{ h^2 }+c_n\) et les autres ont pour somme \( \frac{ 4 }{ h^2 }+c_i\). Elles sont donc toutes majorées par \( \frac{ 4 }{ h^2 }+\| c \|_{\infty}\).

    Pour l'estimation de \( \| L_h^{-1} \|_{\infty}\) nous allons nous appuyer sur le théorème~\ref{THOooWIFGooBQpddF}.

    Commençons par considérer le problème
    \begin{subequations}        \label{SUBEQSooRENKooZaRjvL}
        \begin{numcases}{}
            -w''=1\\
            w(0)=w(1)=0.
        \end{numcases}
    \end{subequations}
    La première équation dit que \( w\) est un polynôme de degré \( 2\). En écrivant \( w(x)=ax^2+bx+c\) et en imposant toutes les contraintes, nous trouvons l'unique solution
    \begin{equation}
        w(x)=-\frac{ 1 }{2}(x^2-x).
    \end{equation}
    Le lemme~\ref{LEMooDXPRooOhwqSZ} nous dit que la fonction \( w\) prise aux points \( x_k=kh\) donne les valeurs de \( w_h\).

    La matrice \( L^0_h\) est une M-matrice et le vecteur \( w_h\) vérifie \( L_h^0w_h=\mtu\). Donc le théorème~\ref{THOooWIFGooBQpddF} s'applique et
    \begin{equation}
        \| (L_h^0)^{-1} \|\leq \| w_h \|_{\infty}=\frac{1}{ 8 }.
    \end{equation}
    L'obtention de \( 1/8\) n'est rien d'autre que la recherche du maximum (en valeur absolue) de la parabole \( x\mapsto (x-x^2)/2\) pour \( x\in \mathopen[ 0 , 1 \mathclose]\). Le maximum est atteint pour \( x=1/2\); calcul de dérivée et tout ça \ldots

    Nous retournons maintenant à notre matrice originale \( L_h\). Nous avons
    \begin{equation}
        L_h-L_h^0=\diag(c_1,\ldots, c_n)\geq 0,
    \end{equation}
    et aussi
    \begin{equation}
        L_h^{-1}-(L_h^0)^{-1}=\underbrace{L_h^{-1}}_{\geq 0}\underbrace{(L_h^0-L_h)}_{\leq 0}\underbrace{(L_h^0)^{-1}}_{\geq 0}
    \end{equation}
    parce que \( L_h\) est une M-matrice. Donc tous les coefficients de \( L_h^{-1}-(L_h^0)^{-1}\) sont négatifs. Cela implique
    \begin{equation}
        L_h^{-1}\leq (L_h^0)^{-1}.
    \end{equation}
    Mais nous savons que les coefficients de \( L_h^{-1}\) sont positifs, donc le maximum de ses coefficients en valeur absolue est plus petit que ceux de \( (L_h^0)^{-1}\), c'est-à-dire
    \begin{equation}
        \| L_h^{-1} \|_{\infty}\leq\| (L_h^0)^{-1} \|_{\infty}\leq\frac{1}{ 8 }.
    \end{equation}

\end{proof}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Exemple}
%---------------------------------------------------------------------------------------------------------------------------

Soit \( \Omega=\mathopen] 0 , 1 \mathclose[\) et une fonction \( u\colon \overline{ \Omega }\to \eR\) de classe \( C^4\) vérifiant
\begin{subequations}
    \begin{numcases}{}
        -u''(x)+u(x)=\sin(x)\\
        u(0)=0\\
        u(1)=0.
    \end{numcases}
\end{subequations}
Nous allons écrire la méthode des différences finies pour \( h=1/4\). Nous posons donc les points
\begin{subequations}
    \begin{numcases}{}
        x_0=0\\
        x_1=1/4\\
        x_2=1/2\\
        x_3=3/4\\
        x_4=1.
    \end{numcases}
\end{subequations}

Puisque nous avons supposé \( u\) de classe \( C^4\), le lemme~\ref{LEMooZECZooVKxOZZ}\ref{ITEMooRWUHooZJLKuL} nous donne\footnote{Nous ferions n'importe quoi pour ne pas écrire \( u''(x)=(D^-D^+u)(x)+o(h^2)\). Notez que vous faites ce que vous voulez : écrivez avec la notation «petit \( o\)» si cela vous chante.}
\begin{equation}
    u''(x)=(D^-D^+u)(x)+\alpha(h)
\end{equation}
avec \( \lim_{h\to 0} \alpha(h)/h=0\). L'équation discrétisée serait alors
\begin{subequations}        \label{SYSTooNEQHooOWJSbT}
    \begin{numcases}{}
        -(D^-D^+u)(x)+u(x)=\sin(x)\\
        u(0)=u(1)=0.
    \end{numcases}
\end{subequations}
où nous n'avons pas précisé l'indice \( h\) au bas des opérateurs \( D^+\) et \( D^-\). Les équations \eqref{SYSTooNEQHooOWJSbT} ne doivent être posées que pour \( x_1\), \( x_2\) et \( x_3\) parce que les valeurs en \( x_0\) et \( x_4\) sont déjà connues.

\begin{subproof}
    \item[Pour \( x_1\)]
    \begin{equation}
        \frac{ u_2-2u_1+u_0 }{ h^2 }+u_1=\sin(x_1)
    \end{equation}
    \item[Pour \( x_2\)]
    \begin{equation}
        \frac{ u_3-2u_2+u_1 }{ h^2 }+u_2=\sin(x_2)
    \end{equation}
    \item[Pour \( x_3\)]
    \begin{equation}
        \frac{ u_4-2u_3+u_2 }{ h^2 }+u_3=\sin(x_3).
    \end{equation}
\end{subproof}
Nous tenons compte du fait que \( u_0=u_4=0\) et que \( h=1/4\) pour écrire le système
\begin{equation}
    \begin{pmatrix}
        -31 & 16  & 0   \\
        16  & -31 & 16  \\
        0   & 16  & -31
    \end{pmatrix}\begin{pmatrix}
        u_1 \\
        u_2 \\
        u_3
    \end{pmatrix}=\begin{pmatrix}
        s_1 \\
        s_2 \\
        s_3
    \end{pmatrix}
\end{equation}
où les \( s_k\) sont des nombres parfaitement connus : par exemple \( s_1=\sin(x_1)=\sin(1/4)\simeq 0.247403959254523\).

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Problèmes de dimension deux}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Nous allons considérer le système
\begin{equation}                \label{SYSooTANLooRgnIMp}
    \begin{cases}
        -\Delta u=f & \text{sur } \Omega         \\
        u=g         & \text{sur } \partial\Omega
    \end{cases}
\end{equation}
où \( \Omega=\mathopen] 0 , a \mathclose[\times \mathopen] 0 , b \mathclose[\).

\begin{remark}
Pourquoi un signe moins devant le laplacien ? Pour avoir la proposition~\ref{PROPooOQJVooJMTkVM} qui dira que la matrice correspondant aux différences finies appliquées à ce système est une M-matrice. Sinon, c'est la matrice \(-L_h\) qui en serait une.
\end{remark}
