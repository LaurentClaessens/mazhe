% This is part of (almost) Everything I know in mathematics
% Copyright (c) 2016, 2025
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Lax-Milgram theorem}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{definition}  \label{DEFooGFTZooUQfUdY}
	A bilinear form \( a\colon V\times V\to \eR\) is \defe{elliptic}{bilinear form!elliptic} or \defe{coercive}{bilinear form!coercive} is there exists a \( \alpha>0\) such that \( a(u,u)\geq \alpha\| u \|^2\) for every \( u\in V\).
\end{definition}

\begin{theorem}[Lax-Milgram\cite{ooRIEKooXIQYhE}]       \label{THOooFDJYooCSNnuv}
	Let \( V\) be ah Hilbert space and
	\begin{enumerate}
		\item
		      a linear and bounded map \( L\colon V\to \eR\); we write \( \| L \|=C\),
		\item
		      a bilinear map \( a\colon V\times V\to \eR\) is continuous; we write \( M\) a constant such that \( | a(u,v) |\leq M\| u \|\| v \|\) for all \( u,v\in V\),
		\item
		      the bilinear form \( a\) is elliptic\footnote{Définition~\ref{DEFooGFTZooUQfUdY}} and we write \( \alpha\) a strictly positive constant such that \( a(u,u)\geq \alpha\| u \|^2\).
	\end{enumerate}
	Then the problem of finding \( u\in V\) such that
	\begin{equation}
		a(u,v)=L(v)
	\end{equation}
	for every \( v\in V\) has one and only one solution \( u\in V\). Moreover this solution satisfies
	\begin{equation}
		\| u \|\leq \frac{ M }{ \alpha }C.
	\end{equation}
\end{theorem}
The map \( L\) is linear and bounded; it is continuous by proposition~\ref{PROPooQZYVooYJVlBd}. The existence of \( M\) is due to the fact that \( a\) is bilinear on \( V\) and in particular linear (and continuous, then bounded) on \( V\times V\). But this is not quite obvious from the definition \eqref{DefFAJgTCE}. It is shown in \cite{ooCUHNooNYIeGt} that putting on \( V\times V\) the product topology\footnote{Définition~\ref{DefIINHooAAjTdY}.} that a sesquilinear map is continuous if and only if there exist such a constant. And since the topology of the product norm is the product topology (lemma~\ref{DefFAJgTCE}), we are safe.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Variational formulation (not too rigorous)}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

As mentioned in the title, we are not going to deal with existence of the derivative and the integrals that we will write down.

Let the partial derivative equation
\begin{subequations}        \label{EQooZAISooSylvFH}
	\begin{numcases}{}
		-\Delta u=f\\
		u|_{\partial \Omega}=0
	\end{numcases}
\end{subequations}
where \( \Delta u=\sum_{j=1}^n\frac{ \partial^2 v  }{ \partial x_j }\) on the open bounded part \( \Omega\) of \( \eR^n\).

We are searching the solutions in a vector space
\begin{equation}
	V=\{ v\colon \Omega\to \eR\tq v|_{\partial \Omega}=0 \}.
\end{equation}
Our aim is to found a bilinear form \( a\colon V\times V\to \eR\) and a linear map \( L\colon V\to \eR\) such that the solutions of the original problem \eqref{EQooZAISooSylvFH} are solutions of the problem
\begin{subequations}
	\begin{numcases}{}
		u\in V\\
		a(u,v)=L(v)\,\forall v\in V
	\end{numcases}
\end{subequations}
The choice of \( V\), \( a\) and \( L\) is a \defe{variational formulation}{variational!formulation} of the differential equation\footnote{I said ``not too rigorous'' in the title, so please don't ask yourself now what space $V$ can be.}.

In order to have a variational formulation of the equation \eqref{EQooZAISooSylvFH} we multiply \( -\Delta u=f\) by a test function \( v\in V\) and we integrate over \( \Omega\):
\begin{equation}
	-\int_{\Omega}\Delta u\,v=\int_{\Omega}fv.
\end{equation}
Now if we set
\begin{subequations}
	\begin{align}
		a(u,v) & =-\int_{\Omega}(\Delta u)v   \label{SUBEQooKUNUooOtKVaP} \\
		L(v)   & =\int_{\Omega}fv
	\end{align}
\end{subequations}
we have a variational formulation of our problem. A solution of a variational formulation is a \defe{weak solution}{solution!weak} of the partial derivative equation.

Does the form \eqref{SUBEQooKUNUooOtKVaP} check the hypothesis of the Lax-Milgram theorem~\ref{THOooFDJYooCSNnuv}? Obviously not because we did not defined the space \( V\), so nothing has any sense here. But we can say more: the bilinear form \( a\) is not \emph{obviously} positive. As we will see it is positive on \( V\) because of the boundary condition. We want to write is slightly differently in order to, taking into account the boundary condition, have a bilinear form that is for sure positive.

Using the integration by part of formula \eqref{EQooJLDTooIMtxEX} taking into account the fact that the boundary term vanishes we have
\begin{equation}
	\int_{\Omega}(\Delta u)v=-\int_{\Omega}\nabla u\cdot \nabla v,
\end{equation}
so that we can as well consider the variational problem
\begin{subequations}
	\begin{align}
		a(u,v) & =-\int_{\Omega}\nabla u\cdot \nabla v   \label{SUBEQooLFDKooTDKiDA} \\
		L(v)   & =\int_{\Omega}fv
	\end{align}
\end{subequations}
In this case, the form \( a\) is more clearly positive defined:
\begin{equation}
	a(u,u)=\int_{\Omega}| \nabla u |^2\geq 0.
\end{equation}

Notons que cette formule pour \( a\) est symétrique et que nous n'avons pas encore démontré quoi que ce soit pour les hypothèses du théorème de Lax-Milgram. Nous espérons seulement que la forme bilinéaire \eqref{SUBEQooLFDKooTDKiDA} ait de meilleures propriétés que \eqref{SUBEQooKUNUooOtKVaP}.

The result of this sections is the following.
\begin{proposition}[Not too rigorous]
	A function \( u\in V\) is solution of the variational problem if and only if it is solution of the Poisson equation.
\end{proposition}

\begin{proof}
	The fact that the solution of the Poisson equation (including the boundary conditions) are solutions of the variational problem is what we just did.

	In the other sense we recall the equation:
	\begin{subequations}
		\begin{numcases}{}
			-\Delta u=f\\
			u|_{\partial \Omega}=0
		\end{numcases}
	\end{subequations}
	The variational problem is searching a function in \( V\), that is a function that automatically satisfy the boundary condition. If \( u\) is solution of the variational problem, then
	\begin{equation}
		\int_{\Omega}\nabla u\cdot \nabla v=\int_{\Omega}fv
	\end{equation}
	We integrate by part the left hand side:
	\begin{equation}
		\int_{\Omega}\nabla u\cdot \nabla v=-\int_{\Omega}(\Delta u)v+\underbrace{\int_{\partial\Omega}\frac{ \partial u }{ \partial n }v}_{=0},
	\end{equation}
	so that
	\begin{equation}        \label{EQooAJMDooNJTYRm}
		\int_{\Omega}(f-\Delta u)v=0
	\end{equation}
	for every \( v\in V\).

	If we really know nothing about the space \( V\), we cannot conclude that \( f-\Delta u=0\). We can however do something that will probably work if \( V\) is not too strange. If \( f-\Delta u\neq 0\) at some point \( x\in \Omega\) (suppose \( (f-\Delta u)(x)>0\) in order to fix the ideas), then \( f-\Delta u>0\) on an open set \( A\) around \( x\). If \( v\) is a positive function that vanishes outside \( A\) then, taking \( B\subset A\) on which \( v>0\),
	\begin{equation}
		\int_{\Omega}(f-\Delta u)v=\int_A(f-\Delta u)v>\int_B(f-\Delta u)v.
	\end{equation}
	The last integral is for sure strictly positive, which contradicts \eqref{EQooAJMDooNJTYRm}.
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Galerkin's approximation}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Let us once again be not too rigorous and deal with the problem
\begin{subequations}
	\begin{numcases}{}
		-u''+u=f\\
		u(0)=u(1)=0
	\end{numcases}
\end{subequations}
on the open interval \( \mathopen] 0 , 1 \mathclose[\). The good functional space seems to be
	\begin{equation}
		H_0^1\big( \mathopen] 0 , 1 \mathclose[ \big)=\{ u\in H^1\big( \mathopen] 0 , 1 \mathclose[ \big)\tq u(0)=u(1)=0 \}.
	\end{equation}
	Of course, this definition is not rigorous because the elements in the Sobolev spaces are classes of functions and the boundary values are not defined. Let us go on and see what happens.

	Let \( v\in H_0^1\). We multiply the equation by \( v\) and integrate over the interval \( I=\mathopen] 0 , 1 \mathclose[\):
\begin{equation}
	-\langle u'', v\rangle +\langle u, v\rangle =\langle f, v\rangle,
\end{equation}
and an integration by part, taking into account the fact that \( v\) vanishes at the border gives
\begin{equation}
	\langle u', v'\rangle +\langle u, v\rangle =\langle f, v\rangle,
\end{equation}

If \( u\in C^2(I)\), the two formulations are equivalent. If not, we are not sure. The point of the second formulation is that one can build a piecewise affine approximation. We divide the interval \( I\) into \( N+1\) pieces
\begin{equation}
	x_j=\frac{ j }{ N+1 }
\end{equation}
with \( j=0,\ldots, N+1\). Let \( V_N\) be the set of continuous piecewise affine functions that are vanishing on the border:
\begin{equation}
	V_N=\{ v\in C^0(I)\tq v|_{\mathopen] x_j , x_{j+1} \mathclose[}\text{ is linear and } v(0)=v(1)=0 \}.
\end{equation}
This is a finite dimensional vector space because the elements are determined by the values on the \( x_i\)'s. Moreover the space \( V_N\) is included in \( H^1_0(I)\).

\begin{proposition}
	There exists an unique element \( u_N\in V_N\) satisfying the equation
	\begin{equation}        \label{EQooOFLCooHmjaOM}
		\langle u_n', v'\rangle +\langle u_N, v\rangle =\langle f, v\rangle
	\end{equation}
	for all \( v\in V_N\). This solution is the \defe{Galerkin approximation}{Galerkin approximation}.
\end{proposition}

\begin{proof}
	We consider the basis \( \{ \phi_j \}_{j=1,\ldots, N}\) of \( V_N\) defined by
	\begin{equation}
		\phi_j(x_i)=\delta_{ij}.
	\end{equation}
	We are searching for \( u_N\) under the form \( u_N=\sum_{j=1}^Na_j\phi_j\). Just by computing on the point \( x_j\) we know that
	\begin{equation}
		a_j=u_N(x_j).
	\end{equation}
	At this moment, this equality does not help, but we keep it in mind. Since the equality \eqref{EQooOFLCooHmjaOM} has to hold for every \( v \in V_N\), it holds in particular for \( v=\phi_k\):
	\begin{equation}
		\langle u_N', \phi_k'\rangle +\langle u_N, \phi_k\rangle =\langle f, \phi_k\rangle
	\end{equation}
	and by linearity of the inner product,
	\begin{equation}
		\sum_la_l\big( \langle \phi'_k, \phi'_l\rangle +\langle \phi_l, \phi_k\rangle  \big)=\langle f, \phi_k\rangle .
	\end{equation}
	If we set
	\begin{subequations}
		\begin{align}
			R_{kl} & =\langle \phi_k', \phi_l'\rangle +\langle \phi_k, \phi_l\rangle \\
			b_k    & =\langle f, \phi_k\rangle,
		\end{align}
	\end{subequations}
	we have to solve the linear system
	\begin{equation}
		Ra=b.
	\end{equation}
	In order to show that this system has an unique solution, we have to get some informations about the matrix \( R\). The matrix \( R\) is the matrix of the \( 2\)-form
	\begin{equation}
		R(f,g)=\langle f', g'\rangle +\langle f, g\rangle
	\end{equation}
	in the basis \( \{ \phi_j \}\) of \( V_N\).

	\begin{subproof}
		\spitem[\( R\) is strictly positive defined]
		We have \( R(f,f)\geq 0\) and if \( R(f,f)=0\), then \( \langle f, f\rangle =0\) and \( \langle f', f'\rangle =0\). Thus \( f=0\) almost everywhere and since elements of \( V_N\) are continuous, \( f=0\).
		\spitem[\( R\) is symmetric] Clear from the definition.
	\end{subproof}

	The matrix is thus invertible (in fact we do not use the symmetry to reach this conclusion) and the system has an unique solution in \( V_N\).

\end{proof}

We can compute the matrix \( R\): the elements are only some inner products and integrals. Here is a graph of \( \phi_1\) and \( \phi_2\):
\begin{center}
	\input{auto/pictures_tex/Fig_DGFSooWgbuuMoB.pstricks}
\end{center}
The affines pieces are:
\begin{subequations}
	\begin{align}
		f_1(x) & =(N+1)x     \\
		f_2(x) & =-(N+1)x+2  \\
		f_3(x) & =(N+1)x-1   \\
		f_4(x) & =-(N+1)x+3.
	\end{align}
\end{subequations}
And we have to integrate. We make the computations:
\lstinputlisting{tex/sage/sageSnip008.sage}
returns
\VerbatimInput[tabsize=3]{tex/sage/sageSnip008.txt}
which means that
\begin{subequations}
	\begin{align}
		\langle \phi_j, \phi_j\rangle       & =\frac{ 2 }{ 3(N+1) }                                                           \\
		\langle \phi_j, \phi_{j+1}\rangle   & =\langle \phi_j, \phi_{j-1}\rangle =\langle f_2, f_3\rangle =\frac{1}{ 6(N+1) } \\
		\langle \phi'_j, \phi'_j\rangle     & =2N+2                                                                           \\
		\langle \phi'_j, \phi'_{j+1}\rangle & =-N-1
	\end{align}
\end{subequations}
The inner product \( \langle \phi_i, \phi_j\rangle \) is zero when \( | i-j |\geq 2\).

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Gradient on a boundary}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Let \( \Omega\) be an open subset of \( \eR^3\) and a smooth function \( f\colon \eR^3\to \eR\) that assumes positives and negatives values in \( \Omega\). Let \( \Omega_1=\Omega\cap\{ f>0 \}\), \( \Omega_2=\Omega\cap\{ f<0 \}\) and \( C=\Omega\cap\{ f=0 \}\). We have the decomposition
\begin{equation}
	\Omega=\Omega_1\cup \Omega_2\cup C
\end{equation}

A typical example is \( \Omega=B(0,1)\) subdivided into \( \Omega_1=B(0,1)\cap\{ z>0 \}\), \( \Omega_2=B(0,1)\cap \{ z<0 \}\) and \( C=\{ (x,y,0)\tq x^2+y^2<1 \}\).


Let \( u\) be a vector field defined on \( \Omega\) by
\begin{equation}
	u(x)=\begin{cases}
		u_1(x) & \text{if } x\in \Omega_1 \\
		u_2(x) & \text{if } x\in \Omega_2
	\end{cases}
\end{equation}
where \( u_1\) and \( u_2\) are defined on \( \Omega\). We do not define \( u\) on \( C\) because it is of measure zero, but we consider the step function
\begin{equation}
	s=u_2-u_1
\end{equation}
that is defined on \( \Omega\). We assume that \( u\) is derivable on \( \Omega\setminus C\).

Let \( T_u\in \swD'(\Omega)\) be the distribution associated with \( u\). We compute its gradient:
\begin{equation}
	\langle \nabla\cdot T_u, \phi\rangle =-\langle T_u, \nabla\cdot u\rangle =-\int_{\Omega}u\cdot\nabla \phi=-\int_{\Omega_1}u_1\cdot \nabla \phi-\int_{\Omega_2}u_2\cdot \nabla \phi.
\end{equation}
Here we used the fact that \( \Omega=\Omega_1\cup \Omega_2\cup C\) while the integral on \( C\) is zero since we are computing a three-dimensional integral. We use the integration by part \eqref{EQooRUCKooUUrgxI}:
\begin{equation}        \label{EQooTKJDooOopGtW}
	\int_{\Omega_1}u_1\cdot \nabla\phi=\int_{\partial \Omega_1}\phi u_1\cdot n_1-\int_{\Omega_1}\phi\nabla\cdot u_1.
\end{equation}
An element of \( \partial \Omega_1\) is in particular the limit of a sequence in \( \Int(\Omega_1)\). The limit can \emph{a priori} belong in one of the following: \( \Int(\Omega)\), \( \Int(\Omega_1)\), \( \Int(\Omega_2)\), \( \partial \Omega\), \( \partial \Omega_1\), \( \partial\Omega_2\) or \( C\). Let us review them
\begin{itemize}
	\item Since we are speaking about an element of \( \partial\Omega_1\),it cannot belong to \( \Int(\Omega_1)\).
	\item Since \( \Omega_1\) and \( \Omega_2\) have no intersection, the limit of a sequence contained in \( \Omega_1\) cannot belong to \( \Int(\Omega_2)\).
	\item If the element we are speaking about belong to \( \partial \Omega_2\), then it belong to \( \partial\Omega_1\cap\partial\Omega_2=C\).
	\item Let \( a\in\partial \Omega_1\cap \Int(\Omega)\). A neighbourhood around \( a\) cannot be completely contained in \( \Omega_1\) or \( \Omega_2\), but it has to have parts in each of these two sets (because \( C\) has lower dimension). Thus it has to belong to \( \partial \Omega_1\cap\partial\Omega_2=C\).
\end{itemize}
Thus we are left with \( \partial\Omega_1\subset C\cup\partial\Omega\). Then one can write
\begin{equation}
	\int_{\partial \Omega_1}\phi u_1\cdot n_1\leq =\int_{C}\phi u_1\cdot n_1+\int_{\partial \Omega\cap\partial\Omega_1}\phi u_1\cdot n_1.
\end{equation}
But \( \phi\in \swD(\Omega)\) and \( \Omega\) is open, so \( \phi\) vanishes on the boundary of \( \Omega\), so that the second term is zero. One can thus reduce the integral over \( \partial\Omega_1\) into an integral over \( C\) in the equation \eqref{EQooTKJDooOopGtW}:
\begin{equation}
	\langle \nabla\cdot T_u, \phi\rangle =\int_{\Omega_1}\phi\nabla\cdot u_1-\int_C\phi u_1\cdot n_1+\int_{\Omega_2}\phi\nabla\cdot u_2-\int_C\phi u_2\cdot n_2.
\end{equation}
Since \( n_i\) is normal and exterior to \( \Omega_i\), we have \( n_1=-n_2\) on \( C\). By convention, we name \( n=n_1\) and \( s=u_2-u_1\). So we have
\begin{equation}
	u_1\cdot n_1+u_2\cdot n_2=u_1\cdot n-u_2\cdot n=-s\cdot n
\end{equation}
and we can write
\begin{equation}
	\langle \nabla\cdot T_u, \phi\rangle =\sum_{i=1}^2\int_{\Omega_i}\phi\nabla\cdot u_i+\int_C(s\cdot n)\phi.
\end{equation}
The whole concludes in
\begin{equation}
	\nabla\cdot T_u=T_{\nabla\cdot u}+\delta_C^{s\cdot n}
\end{equation}
where we used the Dirac ``generalization'' of~\ref{LEMooYABKooWPXIXZ}.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Locally integrable functions}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{definition}
	A function \( f\colon \Omega\to \eC\) is \defe{locally integrable}{locally!integrable} if \( f\in L^1(K)\) for every compact \( K\) in \( \Omega\). The set of locally integrable functions on \( \Omega\) is denoted by \( L^1_{loc}(\Omega)\)\nomenclature[Y]{\( L^1_{loc}(\Omega)\)}{locally integrable functions on \( \Omega\)}
\end{definition}

\begin{proposition}
	We have the inclusion \( L^2(\Omega)\subset L^1_{loc}(\Omega)\).
\end{proposition}

\begin{proof}
	Let \( K\) be compact in \( \Omega\) in \( \eR^d\) and \( f\in L^2(\Omega)\). We have to show \( f\in L^1(K)\). Using the Cauchy-Schwarz inequality~\ref{ThoAYfEHG} in \( L^2(K)\) we have
	\begin{equation}
		\int_K| f |=\langle f, 1\rangle_{L^2(K)} \leq \| f \|_{L^2(K)}\| 1 \|_{L^2(K)}\leq \| f \|_{L^2(\Omega)}\Vol(K)<\infty.
	\end{equation}
	Since \( f\in L^2(\Omega)\),
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{An approximation result}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{theorem}[\cite{ooXRCOooCFWVg}]
	Let \( \Omega\) be an open set in \( \eR^3\) subdivided into a finite number of subdomains \( \Omega_i\). We suppose that for each \( i\), the polynomials of degree \( n\) are part of \( H^1(\Omega_i)\).

	We consider a function \( u\colon \Omega\to \Omega\) which is a polynomial of degree \( n\) on each of the subdomains \( \Omega_i\) and we suppose it to be continuous on the boundaries of \( \Omega_i\).

	\begin{enumerate}
		\item
		      Then \( u\in H^1(\Omega)\)
		\item
		      If we suppose that \( u\) is differentiable on each boundary, then \( u\in H^2(\Omega)\).
	\end{enumerate}
\end{theorem}

\begin{proof}
	First, the function \( u\) belongs to \( L^2(\Omega)\) because the integral of \( | u |^2\) on \( \Omega\) reduces to the integral over the interior of each \( \Omega_i\) (because the boundaries have zero measure). Since \( u\) belongs to \( L^2(\Omega_i)\) for each \( i\), we have \( u\in L^2(\Omega)\).

	Now we have to prove that the partial derivatives (in the weak sense) belong to \( L^2(\Omega)\) too. Since \( u\) is a polynomial on the interiors we can consider the function
	\begin{equation}
		f_{\alpha}(x)=\frac{ \partial u }{ \partial x_{\alpha} }
	\end{equation}
	on \( \Int(\Omega_i)\) (for each \( i\)). Here the partial derivative is not in the weak sense. We do not define the function \( f_{\alpha}\) on the boundaries. Let \( \varphi\in \swD(\Omega_i)\) and perform an integration by part:
	\begin{equation}        \label{EQooMGESooSkBybZ}
		\int_{\Omega_i}f_{\alpha}\varphi=\int_{\Omega_i}\frac{ \partial u }{ \partial x_{\alpha} }\varphi=-\int_{\Omega_i}u\frac{ \partial \varphi }{ \partial x_{\alpha} }+\int_{\partial\Omega_i}u\varphi(n_i\cdot e_{\alpha})
	\end{equation}
	where \( n_i\) is the normal vector field to \( \partial\Omega_i\). In order to make sense, the integrals over \( \Omega_i\) are in fact integrals over \( \Int(\Omega_i)\) because \( f_{\alpha}\) and \( \partial_{\alpha}u\) are only well defined on the interior.

	We sum \eqref{EQooMGESooSkBybZ} over \( i\):
	\begin{equation}        \label{EQooKACAooGlBMaQ}
		\int_{\Omega}f_{\alpha}\varphi=\sum_i\int_{\Omega_i}f_{\alpha}\varphi=-\int_{\Omega}u\frac{ \partial \varphi }{ \partial x_{\alpha} }+\sum_i\int_{\partial\Omega_i}u\varphi(n_i\cdot e_{\alpha}).
	\end{equation}
	The value of \( u\) on \( \partial \Omega_i\) is univoque since we assume that \( u\) is continuous on the boundaries.

	The set \( \bigcup_i\partial\Omega_i\) can be subdivided into two parts. Some points are in \( \partial \Omega\) and the other ones are on the intersections \( \partial\Omega_i\cap \partial\Omega_j\).

	The function \( \varphi\) vanishes on \( \partial\Omega\). And the contribution of \( \partial\Omega\) in \( \sum_i\int_{\partial\Omega_i}u\varphi (n_i\cdot e_{\alpha})\) is zero.

	The contribution of the intersections in this integral is double: the intersection \( \partial\Omega_i\cap\partial\Omega_j\) comes in the integral over \( \partial\Omega_i\) and in the one over \( \partial\Omega_j\). Since on the intersection we have \( n_i=-n_j\) (because they are outwards), the sum vanishes and the whole sum of integrals over \( \partial\Omega_i\) in \eqref{EQooKACAooGlBMaQ} disappear. Here we also use the fact that \( u\) is continuous on the intersections. We are left with
	\begin{equation}
		\int_{\Omega}f_{\alpha}\varphi=-\int_{\Omega}u\frac{ \partial \varphi }{ \partial x_{\alpha} }.
	\end{equation}
	We proved that setting
	\begin{equation}
		f_{\alpha}(x)=\begin{cases}
			\frac{ \partial u }{ \partial x_{\alpha} } & \text{if } x\in\Int(\Omega_i) \text{for some }i \\
			\text{whatever}                            & \text{otherwise }
		\end{cases}
	\end{equation}
	we get
	\begin{equation}
		\langle f_{\alpha}, \varphi\rangle =-\langle u, \partial_{\alpha}\varphi\rangle
	\end{equation}
	for every \( \varphi\in\swD(\Omega)\). This shows that \( f_{\alpha}\) is the weak derivative of \( u\).

	Moreover \( f_{\alpha}\) is a sum of polynomials of degree \( n-1\) on \( \Omega\) and is thus integrable. So by hypothesis \( f_{\alpha}\in H^1(\Omega)\subset L^2(\Omega)\).
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Lax-Milgram with a boundary condition}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

We want to give an example of use of the Sobolev space \( H_O^1(\Omega)\) defined in~\ref{DEFooFICWooBWCDyO}.

\begin{example}
	Let the differential equation for \( u\colon \mathopen[ 0 , 1 \mathclose]\to \eR\)
	\begin{subequations}
		\begin{numcases}{}
			-u''(x)=f(x)\\
			u(0)=u(1)=0
		\end{numcases}
	\end{subequations}
	with \( f\) in a not yet well precise functional space. The most obvious prescription for the functional spaces if to ask \( f\in L^2\) and then \( u\in H^2\), so that \( u\) has \( L^2\) second derivative. Instead of that, we will look at the variational form of the problem. We consider \( w\in\swD\big( \mathopen[ 0 , 1 \mathclose] \big)\) satisfying \( w(0)=w(1)=0\) and compute the inner product between \( v\) and the equation:
	\begin{equation}
		-\langle u'', w\rangle =\langle f, w\rangle .
	\end{equation}
	An integration by part produces the equation
	\begin{equation}        \label{EQooRTXVooYmoAJM}
		\int_0^1u'w'=\int_0^1fw.
	\end{equation}

	Since no precision is provided about the functional spaces, the equation \eqref{EQooRTXVooYmoAJM} is by no means related to initial equation. We only hope that the solution of the variational problem will be a solution of the initial problem, and that we will be able to furnish a functional setting in which the integral by part makes sense.

	Since the variational formulation only needs first derivative of \( u\) and \( v\) we are lead to consider \( H^1\big( \mathopen] 0 , 1 \mathclose[ \big)\). Let us write down the variational problem.

	Let \( f\in L^2\big( \mathopen] 0 , 1 \mathclose[ \big)\) and consider the space \( V=H_0^1\big( \mathopen] 0 , 1 \mathclose[ \big)\). We define the functionals defined by
	\begin{equation}
		\begin{aligned}
			a\colon V\times V & \to \eC              \\
			(u,w)             & \mapsto \int_0^1u'w'
		\end{aligned}
	\end{equation}
	and
	\begin{equation}
		\begin{aligned}
			l\colon V & \to \eC             \\
			w         & \mapsto \int_0^1fw.
		\end{aligned}
	\end{equation}
	We are searching for \( u\in V\) such that \( a(u,\cdot)=l\), that is such that
	\begin{equation}
		a(u,w)=l(w)
	\end{equation}
	for every \( w\in V\).

	Let us check the hypothesis of the Lax-Milgram theorem~\ref{THOooFDJYooCSNnuv}.

	\begin{subproof}
		\spitem[\( l\colon H_0^1\to \eR\) is continuous]

		Let \( w_i\stackrel{H_0^1}{\longrightarrow}0\). Using the Cauchy-Schwarz inequality~\ref{ThoAYfEHG} we have
		\begin{equation}
			| l(w_i) |^2=| \langle w_i, f\rangle  |^2\leq\| w_i \|_{L^2}\| f \|_{L^2}\leq C| w_i |_{1,\Omega}\| f \|_{L^2}
		\end{equation}
		where we used the Poincaré inequality of theorem~\ref{THOooMIHQooYShOps}. By hypothesis we have \( w_i\stackrel{H^1(\Omega)}{\longrightarrow}0\) and in particular \( | w_i |_{1,\Omega}\to 0\), so that
		\begin{equation}
			| l(w_i) |^2\to 0,
		\end{equation}
		and \( l\) is continuous.

		\spitem[\( a\colon H_0^1\times H_0^1\to \eR\) is continuous]

		By definition
		\begin{equation}
			a(u,v)=\langle u', w'\rangle_{L^2\big( \mathopen] 0 , 1 \mathclose[ \big) }.
		\end{equation}
		If \( (u_i,w_i)\stackrel{H_0^1\times H_0^1}{\longrightarrow}(0,0)\) we have
		\begin{equation}
			| a(u_i,w_i) |\leq \| u' \|_{L^2}\| w' \|_{L^2}=| u_i|_{1,\Omega}| w_i |_{1,\Omega}\to 0.
		\end{equation}
		<++>

	\end{subproof}
	<++>

\end{example}
