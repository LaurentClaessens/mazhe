% This is part of Giulietta
% Copyright (c) 2010-2017, 2019, 2021-2025
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.


\section{Differentiable manifolds}
%+++++++++++++++++++++++++++++++++

\subsection{Definition, charts}
%------------------------------

\begin{definition}		\label{DEFooRUVIooSZDjlE}
	Let \( M\) be a topological manifold\footnote{Definition \ref{DEFooJOMAooZscKwn}.}. An \defe{atlas}{atlas} is a set \( \{ (U_{\alpha}, \varphi_{\alpha})\}_{\alpha\in\Lambda}\) such that
	\begin{enumerate}
		\item
		      For every \( \alpha\in\Lambda\), the part \( U_{\alpha}\) is open in some normed vector space \( E_{\alpha}\), and \( \varphi_{\alpha}(U_{\alpha})\) is open in \( M\),
		\item
		      The map \( \varphi_{\alpha}\) is homeomorphic.
		\item
		      For every \( p\in M\), there exists \( \alpha\in \Lambda\) such that \( p\in \varphi_{\alpha}(U_{\alpha})\).
	\end{enumerate}
\end{definition}

\begin{example}
	Any open set of $\eR^n$ is a smooth manifold if we choose the identity map as maps.
\end{example}

Most of surfaces $z=f(x,y)$ in $\eR^3$ are manifolds, depending on certain regularity conditions on~$f$.

\begin{definition}[\cite{MonCerveau}]       \label{DEFooQLPIooPGagtz}
	Let \( M\) be a manifold with its maps \(  \{ (U_{\alpha}, \varphi_{\alpha}) \}_{\alpha\in I}   \). A \( C^k\)-\defe{chart}{chart} of \( M\) is a couple \( (V,\psi)\) where \( V\) is open in \( \eR^n\) and \( \psi\colon V\to M\) is such that for every \( \alpha\in I\), the maps
	\begin{equation}
		\psi^{-1}\circ \varphi_{\alpha}\colon \varphi_{\alpha}^{-1}\big( \psi(V) \big)\to V
	\end{equation}
	and
	\begin{equation}
		\varphi_{\alpha}^{-1}\circ \psi\colon \psi^{-1}\big( \varphi_{\alpha}(U_{\alpha}) \big)\to U_{\alpha}
	\end{equation}
	are of class \( C^k\).
\end{definition}

\begin{propositionDef}[\cite{MonCerveau}]     \label{PROPooUFGQooACIjVL}
	Let \( \mA\) be a class of functions (\( C^k\), smooth, analytic). Let \( M,N\) be two manifolds. We consider the charts \( (U,\varphi)\) and \( (V,\phi)\) of \( M\) and \( N\). We say that a map \(f\colon M\to N \) is in the class \( \mA\) with respect to these charts if the map
	\begin{equation}
		\phi^{-1}\circ f\circ\varphi\colon \varphi^{-1}\big( \phi(V) \big)\to V
	\end{equation}
	is in the class \( \mA\).

	If \( f\) is in the class \( \mA\) with respect to a couple \( \varphi,\phi\) of charts, then it is in the class \( \mA\) with respect to every couple of charts.
\end{propositionDef}

\begin{proof}
	If \( \varphi_{\alpha}\) and \( \phi_i\) are two other charts we have
	\begin{equation}
		\phi_i^{-1}\circ f\circ \varphi_{\alpha}=\phi_i\circ\phi\underbrace{\phi^{-1}\circ f\circ \varphi}_{\in \mA}\circ\varphi^{-1}\circ\varphi_{\alpha}
	\end{equation}
	By definition of charts the maps \( \phi_i^{-1}\circ\phi\) and \( \varphi^{-1}\circ\varphi_{\alpha}\) are in the class \( \mA\).
\end{proof}


\begin{definition}[\cite{MonCerveau}]       \label{DEFooMLNQooEgEfdq}
	Let \( M\) be a manifold. An \defe{atlas}{atlas} for \( M\) is a set of charts\footnote{Definition \ref{DEFooQLPIooPGagtz}.} \( \{  (U_j,\phi_j)  \}_{j\in J}\) such that \( \bigcup_{j\in J}\phi_j(U_j)=M\).
\end{definition}

\begin{normaltext}
	An atlas is a set of charts which is sufficient to reach each point of \( M\). It is however not required that every open sets in \( M\) is the image of a chart in the atlas.
\end{normaltext}


\begin{proposition}		\label{PROPooCWPAooKDnwHR}
	If \( f\) and \( g\) are \( C^k\) functions on \( M\), then the functions \( f+g\) and \( fg\) are \( C^k\).
	%TODOooQKNRooAytawz. Prouver ça.
\end{proposition}

\begin{lemma}       \label{LEMooGAMVooIWUzmy}
	Let \( (M,\{ (U_{\alpha}, \varphi_{\alpha}) \}_{\alpha\in I}) \) be a manifold. If \( (V,\psi)\) is a chart, the set
	\begin{equation}
		\psi^{-1}\big(\varphi_{\alpha}(U_{\alpha})\big)
	\end{equation}
	is open in \(\eR^n\).
\end{lemma}

\begin{proof}
	By definition \ref{DEFooQLPIooPGagtz}, the map \( \varphi_{\alpha}\circ \psi \colon V\to U_{\alpha}\) is \( C^k\) and, in particular, continuous\footnote{Definition \ref{DefOLNtrxB}\ref{ITEMooEHGWooDdITRV}.}. Thus if \( \mO\) is open in \( U_{\alpha}\), then \( (\varphi_{\alpha}^{-1}\circ\psi)^{-1}(\mO)\) is open in \( V\). Since \( V\) is open in \( \eR^n\), an open set in \( V\) is open in \( \eR^n\). The set \( U_{\alpha}\) is in particular open in \( U_{\alpha}\), thus the part
	\begin{equation}
		(\varphi_{\alpha}^{-1}\circ \psi)^{-1}(U_{\alpha})=(\psi^{-1}\circ\varphi_{\alpha})(U_{\alpha})
	\end{equation}
	is open in \( \eR^n\).
\end{proof}

\begin{proposition}[\cite{MonCerveau}]      \label{PROPooUDVFooEJeluM}
	If \( (V_1,\psi_1)\) and \( (V_2,\psi_2)\) are \( C^k\)-charts, then the map
	\begin{equation}
		\psi_2^{-1}\circ \psi_1\colon \psi_1^{-1}\big( \psi_2(V_2) \big)\to V_2
	\end{equation}
	is of class \( C^k\).
\end{proposition}

\begin{proof}
	Let \( q\in \psi_1^{-1}\big( \psi_2(V_2) \big)\). We will prove that \( \psi_2^{-1}\circ\psi_1\) is \( C^k\) on a neighbourhood of \( q\).  Let \( p=\psi_1(q)\) and \( (U_{\alpha},\varphi_{\alpha})\) be a definition chart around \( p\). We consider
	\begin{equation}
		A=\varphi_{\alpha}(U_{\alpha})\cap\psi_1(V_1)\cap\psi_2(V_2).
	\end{equation}
	The point \( p\) belongs to \( A\). We set \( U'=\varphi_{\alpha}^{-1}(A)\), \( V_1'=\psi_1^{-1}(A)\) and \( V_2'=\psi_2^{-1}(A)\). We show that
	\begin{equation}
		\psi_2^{-1}\circ\psi_1\colon V_1'\to V_2'
	\end{equation}
	is \( C^k\).

	We have
	\begin{equation}
		\psi_2^{-1}\circ\psi_1=\psi_2^{-1}\circ\varphi\circ\varphi^{-1}\circ\psi_1.
	\end{equation}
	Since \( \psi_1\) and \( \psi_2\) are charts, the maps \( \psi_2^{-1}\circ \varphi\) and \( \varphi^{-1}\circ\psi_1\) are \( C^k\), so that the compound function is \( C^k\) by theorem \ref{ThoAGXGuEt}.
\end{proof}

\begin{lemma}       \label{LEMooOPPJooXezOHS}
	Let \( M\) be a \( C^k\) manifold and \( p\in M\). There exists a chart \( (V,\psi)\) of \( M\) around \( p\) such that \( 0\in V\) and \( p=\psi(0)\).
\end{lemma}

\begin{proof}
	By definition there exists a chart \( (U_{\alpha},\varphi_{\alpha})\) around \( p\) and \( u\in U_{\alpha}\) such that \( p=\varphi_{\alpha}(u)\). Let \( V=U-u\) and \( \psi(x)=\varphi_{\alpha}(x+u)\).

	Then \( V\) is an open set and \( \psi(0)=\varphi_{\alpha}(u)=p\).
\end{proof}

\subsection{Topology}
%--------------------

\begin{probleme}  \label{PROBooGNZMooFknpBn}
	The proposition-definition \ref{DEFooHGNOooNqGmxE} should not exist because of the proposition \ref{PROPooDEVUooCATTZI}.
\end{probleme}

\begin{propositionDef}[Topology on a differntiable manifold]      \label{DEFooHGNOooNqGmxE}
	Let \( M\) be a manifold with the set of all the charts \( \{ (U_{\alpha}, \varphi_{\alpha}) \}_{\alpha\in \Lambda}\). We denote by \( \tau_{n}\) the topology on \( \eR^n\).
	The set
	\begin{equation}
		\tau_M=\{ S\subset M\tq \forall \alpha\in \Lambda, \varphi_{\alpha}^{-1}\big( S\cap \varphi_{\alpha}(U_{\alpha}) \big) \in \tau_n \}
	\end{equation}
	is a \defe{topology}{topology on manifold} on \( M\).
\end{propositionDef}

\begin{proof}
	First we prove that the open system defines a topology. For this, remark that $\varphi_{\alpha}^{-1}$ is injective (if not, there should be some multivalued points). Then $\varphi^{-1}(A\cap B)=\varphi^{-1}(A)\cap\varphi^{-1}(B)$. If $V_1$ and $V_2$ are open in $M$, then
	\begin{equation}
		\varphi^{-1}(V_1\cap V_2\cap\varphi(\mU))=\varphi^{-1}(V_1\cap\varphi(\mU))\cap\varphi^{-1}(V_2\cap\varphi(\mU))
	\end{equation}
	which is open in $\eR^n$. The same property works for the unions.
\end{proof}

\begin{theorem}     \label{THOooIAXUooDqMrav}
	Let \( M\) be a manifold. Its topology has the following properties.
	\begin{enumerate}
		\item the charts maps are continuous,
		\item the sets $\varphi_{\alpha}(\mU_{\alpha})$ are open.
	\end{enumerate}
\end{theorem}

\begin{proof}
	We proof the continuity of $\dpt{\varphi}{\mU}{M}$; for an open set $V$ in $M$, we have to show that $\varphi^{-1}(V)$ is open in $\mU\subset\eR^n$. But the definition of the topology on $M$, is precisely the fact that $\varphi^{-1}(V\cap\varphi(\mU))$ is open.
\end{proof}

\begin{lemma}       \label{LEMooGDMZooLCtnuA}
	The topology of \( \eR^n\) as manifold is the same as the usual one.
\end{lemma}

\begin{proof}
	The manifold structure on \( \eR^n\) is the one given by the theorem \ref{THOooFIHIooLiSUxH} with the unique chart \(\varphi \colon \eR^n\to \eR^n  \) which is the identity.

	We denote by \( \tau_d\) the manifold topology on \( \eR^n\) and by \( \tau\) its usual (norm) topology. By the point \ref{ITEMooXGDRooRWiVnF}, the map \( \varphi\) is continuous. It means that if \( A\in\tau_d\), then \( A\in \tau\). By the point \ref{ITEMooCMUKooBvlXbs}, the map \(\varphi \colon (\eR^n,\tau)\to (\eR^n,\tau_d)  \) is homeomorphic, so that \( \tau\subset\tau_d\).
\end{proof}

\begin{proposition}[\cite{MonCerveau}]		\label{PROPooCXXKooJAOmOl}
	If \( \{ \varphi_{\alpha} \}_{\alpha\in \Lambda}\) is the set of all charts of the smooth manifold \( M\), then the parts \( \{ \varphi_{\alpha}(U_{\alpha}) \}\) is a basis of topology of \( M\).
	%TODOooKOHUooNIoVmj. Prouver ça.
\end{proposition}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Regularity}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}      \label{DEFooMELXooEkEnwz}
	If $M$ and $M$ are two analytic manifolds, a map $\dpt{\phi}{M}{N}$ is \defe{regular}{regular}\label{PgDefRegular} at $p\in M$ if it is analytic at $p$ and $\dpt{d\phi_p}{T_pM}{T_{\phi(p)}N}$ is injective.
\end{definition}

\begin{definition}[\cite{BIBooXDPUooVeTGwz}]        \label{DEFooFNTHooEwsqXB}
	Let \( \mA\) be a class of functions : differentiable, \( C^k\), analytic. Let \( M\) and \( N\) be \( \mA\)-manifolds. We say that a map \( h\colon M\to N\) is \( \mA\) if the two following conditions hold:
	\begin{enumerate}
		\item
		      The map \( h\) is continuous\footnote{With respect to the topology of the definition \ref{DEFooHGNOooNqGmxE}.}.
		\item
		      for every \( p\in M\), there exists charts \( (U,\varphi)\) around \( p\) and \( (V,\psi)\) around \( h(p)\) such that
		      \begin{enumerate}
			      \item
			            \( h\big( \varphi(U) \big)\subset\psi(V)\)
			      \item       \label{SUBITEMooXQFUooRxMVnw}
			            the map \( \psi^{-1}\circ h\circ\varphi\colon U \to V \) is in \( \mA\)
		      \end{enumerate}
	\end{enumerate}
	The set of differentiable maps \(f \colon M\to N  \) is denoted by \( \Diff(M,N)\). The set of \( C^k\) maps \(f \colon M\to N  \) is denoted by \(C^k(M,N)\).
\end{definition}

\begin{proposition}[\cite{MonCerveau}]		\label{PROPooGQVUooWmPmQV}
	Let \( M\) and \( N\) be \( C^k\) manifolds. If for every \( m\in M\) there exists a chart \( (U_m,\varphi_m)\) such that \( m\in \varphi_m(U_m)\) and  \(f \colon U_m\to \varphi_m(U_m)  \) is \( C^k\) (here \( \varphi_m(U_m)\) is seen as a manifold with this chart), then \( f\) is \( C^k\) on \( M\).
\end{proposition}

\begin{proposition}[Composition\cite{MonCerveau}]		\label{PROPooODGHooFYluSu}
	Let \( X\), \( Y\) and \( Z\) be \( C^k\) manifolds. We consider \( C^k\) maps \(f \colon X\to Y  \) and \(g \colon Y\to Z  \). Then the composition \(g\circ f \colon X\to Z  \) is \( C^k\).
\end{proposition}

For the sake of the following lemma, we say «\( mC^k\)» for «manifold»-\( C^k\) (definition \ref{DEFooFNTHooEwsqXB}) and «\( uC^k\)» for «usual» \( C^k\) (definition \ref{DefPNjMGqy} for normed vector spaces). The lemma will say that the two notions are the same, so that we can say «\( C^k\)» without more precisions.
\begin{lemma}[\cite{MonCerveau}]			\label{LEMooXGFXooBcmIbK}
	We consider the manifolds \( M=\eR^m\) and \( N=\eR^n\) with the identify as charts. A map \( f\colon M\to N\) is \( mC^k\) if and only if it is \( uC^k\).
\end{lemma}

\begin{proof}
	For the sake of notations, we set the charts \( U=\eR^m\), \( V=\eR^n\) and \( \psi_m\colon U\to M\), \( \psi_n\colon V\to N\). The maps \( \psi_n\) and \( \psi_m\) are the identity.
	\begin{subproof}
		\spitem[\( \Rightarrow\)]
		The hypothesis that \( f\colon M\to N\) is \( mC^k\) says that the map \( \psi_n^{-1}\circ f\circ\psi_m\) is \( uC^k\). Thus the map
		\begin{equation}
			f=\psi_n\circ\psi_n^{-1}\circ f\circ\psi_m\circ\psi_m^{-1}
		\end{equation}
		is \( uC^k\) too.
		\spitem[\( \Leftarrow\)]
		Since \( f\) is \( uC^k\) and since \( \psi_n\) and \( \psi_m\) are the identity, the map \( \psi_n^{-1}\circ f\circ\psi_m\) is \( uC^k\), which means that \( f\) is \( mC^k\).
	\end{subproof}
\end{proof}


%-------------------------------------------------------
\subsection{Partition of unity}
%----------------------------------------------------

\begin{definition}[Partition of unity\cite{BIBooAQKHooVyiyN}]			\label{DEFooGEAJooInejRf}
	Let \( M\) be a smooth manifold. A \defe{partition of unity}{partition of unity} on \( M\) is a collection of smooth functions \( \{\phi_i \colon M\to \eR   \}_{i\in I}\) such that
	\begin{enumerate}
		\item		\label{ITEMooWBHEooSHUQvv}
		      The sets \( \{ \supp(\phi_i) \}_{i\in I}\) is a locally finite covering of \( M\).
		\item		\label{ITEMooSPHGooQSDFTz}
		      \( \phi_i(m)\geq 0\) for every \( i\in I\) and \( m\in m\).
		\item		\label{ITEMooGWGPooOGdAGU}
		      \( \sum_{i\in I}\phi_i(m)=1\) for every \( m\in M\).
	\end{enumerate}
	The last sum is defined by \ref{DefIkoheE}, but in most cases we will be reduced to a finite sum.
\end{definition}

\begin{definition}[\cite{BIBooAQKHooVyiyN}]			\label{DEFooPJKOooFnCkuk}
	Let \( \{ \phi_i \}_{i\in I}\) be a partition of unity on the smooth manifold \( M\). Let \( \mW=\{ W_{\alpha} \}_{\alpha\in \Lambda}\) be an open covering of \( M\). We say that the partition \( \{ \phi_i \}_{i\in I}\) is \defe{subordinate}{partition of unity subordinate} to the covering \( \mW\) if for every \( i\in I\), there exists \( \alpha\in\Lambda\) such that \( \supp(\phi_i)\subset W_{\alpha}\).
\end{definition}

\begin{normaltext}
	The definition of "subordinate" partition of unity in \cite{BIBooAQKHooVyiyN} and \cite{BIBooKCFIooSAYbJK} are not the same. There are several conventions.
\end{normaltext}

\begin{lemma}[\cite{BIBooAQKHooVyiyN}]		\label{LEMooBBBNooVmpLok}
	Let \( M\) be a smooth manifold. There exists a basis of topology \( \{ B_i \}_{i\in I}\) such that
	\begin{enumerate}
		\item
		      \( \bar B_i\) is compact for every \(  i\in I\),
		\item
		      For every \( i\in I\), there exists a smooth function \(\phi_i \colon M\to \eR  \) such that
		      \begin{enumerate}
			      \item
			            \( \phi_i(x)=0\) if \( x\notin B_i\)
			      \item
			            \( \phi_i(x)>0\) if \( x\in B_i\)
		      \end{enumerate}
	\end{enumerate}
\end{lemma}

\begin{proof}
	We consider the open cubes in \( \eR^n\):
	\begin{equation}
		C(r)=\{ x\in \eR^n\tq x_i\in\mathopen] -r,r\mathclose[  \}.
	\end{equation}
	\begin{subproof}
		\spitem[The set \( \Lambda_p\)]
		%-----------------------------------------------------------

		We consider the set \( \{ (U_{\alpha}, \varphi_{\alpha}) \}_{\alpha\in\Lambda}\) of all the charts of \( M\). For each \( p\in M\) we define
		\begin{equation}
			\Lambda_p=\{ \alpha\in\Lambda\tq p=\varphi_{\alpha}(0), C(3)\subset U_{\alpha} \}.
		\end{equation}
		Notice that any chart containing \( p\) can be translated and dilated in order to satisfy the conditions. For every \( p\), the set \( \Lambda_p\) is non empty and, in fact, infinite.
		\spitem[The set \( \mR(p)\)]
		%-----------------------------------------------------------
		We define \( \mR(p)=\{ \varphi_{\alpha}\big( C(2) \big) \}_{\alpha\in\Lambda_p}\) and we prove that this is a basis of neighbourhood at \( p\). Let \( A\) be a neighbourhood of \( p\in M\). Since the charts make a basis of topology (proposition \ref{PROPooCXXKooJAOmOl}), exists a chart \(\varphi_{\alpha} \colon U_{\alpha}\to M  \) with \(   p\in \varphi_{\alpha}(U_{\alpha})\subset A  \). Then we consider the translated chart
		\begin{equation}
			\begin{aligned}
				\varphi_{\beta}\colon U_{\alpha}-x & \to M                         \\
				y                                  & \mapsto \varphi_{\alpha}(y+x)
			\end{aligned}
		\end{equation}
		where \( x=\varphi_{\alpha}^{-1}(p)\). Notice that
		\begin{equation}
			\varphi_{\beta}\big( B(0,r) \big)\subset \varphi_{\beta}(U_{\beta})=\varphi_{\alpha}(U_{\alpha})\subset A.
		\end{equation}
		We choose a \( r>0\) such that \( B(0,r)\subset U_{\beta}\), and for each \( k\in \eN\), we consider the chart
		\begin{equation}
			\begin{aligned}
				\varphi_k\colon B(0,kr) & \to M                         \\
				x                       & \mapsto \varphi_{\beta}(x/k).
			\end{aligned}
		\end{equation}
		This is well defined because, if \( x\in B(0,kr)\), we have \( x/k\in B(0,r)\subset U_{\beta}\). We choose \( k\) large enough to fulfill the two conditions
		\begin{itemize}
			\item
			      \( C(3)\subset B(0,kr)\)
			\item
			      \( \varphi_k\big( C(2) \big)\subset A\).
		\end{itemize}
		The first condition ensures that \( \varphi_k\) belongs to \( \{ \varphi_{\alpha} \}_{\alpha\in \Lambda_{p}}\). If \( x\in C(3)\), we have \( \| x \|\leq 3\sqrt{n}\), so that taking \( k>3\sqrt{n}/r\) satisfy the first condition. For the second condition, taking \( k>2\sqrt{n}/r\) ensures that
		\begin{subequations}
			\begin{align}
				\varphi_k\big( C(2) \big) & \subset \varphi_k\big( B(0,2\sqrt{n}) \big)                                           \\
				                          & =\varphi_{\beta}\big( B(0,2\sqrt{n}/k) \big)                                          \\
				                          & \subset\varphi_{\beta}\left( B\big( 0,\frac{ 2\sqrt{n} }{ 2\sqrt{n}/r } \big) \right) \\
				                          & =\varphi_{\beta}\big( B(0,r) \big)                                                    \\
				                          & \subset A.
			\end{align}
		\end{subequations}

		\spitem[Basis of topology]
		%-----------------------------------------------------------
		Taking \( I=\bigcup_{m\in M}\Lambda_m\), the parts \( B_i=\varphi_i\big( C(2) \big)\) with \( i\in I\) form a basis of the topology of \( M\).

		\spitem[Bump function]
		%-----------------------------------------------------------
		We consider the Urysohn's lemma\footnote{Proposition \ref{PROPooBOZIooAhKbPs}.} with the compact \( C(2)\) and the open \( \Int\big( C(3) \big)\). There exists a smooth function \(b \colon \eR^n\to \mathopen[ 0,1\mathclose] \) such that \( b(x)=1\) if \( x\in C(2)\) and \( C(x)=0\) if \( x\notin C(3)\).

		For each \( i\in I \) we define
		\begin{equation}
			\begin{aligned}
				\phi_i\colon M & \to \eR                                                           \\
				x              & \mapsto \begin{cases}
					                         b\circ \varphi_i^{-1}(x) & \text{if } x\in \varphi_i(U_i) \\
					                         0                        & \text{otherwise. }
				                         \end{cases}
			\end{aligned}
		\end{equation}
		We have to check that \( \phi_i\) is smooth in the sense of definition \ref{DEFooFNTHooEwsqXB}. The proposition \ref{PROPooGQVUooWmPmQV} allows us to prove more or less pointwise while the lemma \ref{LEMooXGFXooBcmIbK} says that \( b\) is smooth in the sense of manifolds. We will also use the proposition \ref{PROPooODGHooFYluSu} to deal with the composition.

		Let \( m\in M\). There are two possibilities: \( m\in \varphi_i(U_i)\) or not. If \( m\in \varphi_i(U_i)\), then the part \( \varphi_i(U_i)\) is an open neighbourhood of \( m\) on which \( \phi_i\) is smooth because for every chart \(\varphi_{\beta} \colon U_{\beta}\to M  \) we have \( \varphi_{\beta}\circ \phi_i=\varphi_{\beta}\circ b\circ \varphi_i^{-1}\) which is smooth.

		Now we suppose that \( m\) does not belong to \( \varphi_i(U_i)\). We have two (sub-)cases: there is a neighbourhood of \( m\) which does not intersect \( \varphi_i(U_i)\) or every neighbourhood of \( m\) intersects \( \varphi_i(U_i)\). In the first case we have a neighbourhood of \( m\) on which \( \phi_i=0\), and \( \phi_i\) is smooth.

		Now we suppose that every neighbourhood of \( m\) intersects \( \varphi_i(U_i)\). We use the lemma \ref{LEMooNIJEooMdvkuA}: \( M\) is Hausdorff, \(  \varphi_i(\overline{C(3)})\subset\varphi_i(U_i)  \) where \( \varphi_u\big( \overline{C(3)} \big)\) is compact and \( \varphi_i(U_i)\) is open. Since \( m\) is outside \( \varphi_i(U_i)\), there exists a neighbourhood \( A\) of \( m\) which do not intersect \( \overline{C(3)}\). We have \( \phi_i=0\) on this neighbourhood.
	\end{subproof}
\end{proof}



\begin{theorem}[Existence of a partition of unity\cite{BIBooAQKHooVyiyN}\footnote{Most of the time, you want to use the proposition \ref{PROPooGEWIooTwCfPp} which allows to choose a gentle atlas.}]			\label{THOooEJDHooTkRvsn}
	Let \( M\) be a smooth manifold. Let \( \mW\) be an open covering. There exists a partition of unity \( \{ \phi_i \}_{i\in I}\) such that
	\begin{enumerate}
		\item
		      \( I\) is countable,
		\item
		      subordinate to \( \mW\)\footnote{Definition \ref{DEFooPJKOooFnCkuk}.},
		\item
		      \( \supp(\phi_i)\) is compact for every \( i\in I\).
		\item
		      \( \{ \supp(\phi_i) \}_{i\in I}\) is a locally finite covering of \( M\)\footnote{This is not really a point because this is part of the definition of a partition of unity.}.
	\end{enumerate}
\end{theorem}

\begin{proof}
	The lemma \ref{LEMooBBBNooVmpLok} provides a basis of topology \( \{ B_i \}_{i\in I}\) and smooth maps \(\phi_i \colon M\to \eR  \) such that
	\begin{enumerate}
		\item
		      \( \bar B_i\) is compact
		\item
		      \( \phi_i=0\) outside \( B_i\)
		\item
		      \( \phi_i>0\) on \( B_i\).
	\end{enumerate}
	The proposition \ref{PROPooKAXIooNhNkNB} says that there exists a countable part \( J\subset I\) such that \( \{ B_j \}_{j\in J}\) is a locally finite refinement of \( \mW\).

	\begin{subproof}
		\spitem[The function \( \phi\)]
		%-----------------------------------------------------------

		We define
		\begin{equation}
			\phi(x)=\sum_{j\in J}\phi_j(x).
		\end{equation}
		Since \( \{ B_j \}_{j\in J}\) is locally finite, for each \( x\), the sum is finite.

		\spitem[\( \phi\) is smooth]
		%-----------------------------------------------------------
		Let \( m\in M\). There exists a neighbourhood \( A\) of \( m\) and a finite subset \( J'\subset J\) such that \( A\cap B_j\neq \emptyset\) only when \( j\in J'\). Thus the map \(\phi \colon A\to \eR  \) is a finite sum and is smooth as finite sum of smooth functions.

		\spitem[\( \phi(x)\neq 0\)]
		%-----------------------------------------------------------
		We prove that \( \phi\) is everywhere non vanishing. Let \( m\in M\). There is a \( j_0\in J') \) such that \( m\in B_{j_0}\). Then \( \phi_{j_0}(m)>0\) and
		\begin{equation}
			\phi(m)=\sum_{j\in J}\phi_j(m)\geq \phi_{j_0}(m)>0.
		\end{equation}

		\spitem[The functions \( \psi_j\)]
		%-----------------------------------------------------------
		Since \( \phi(x)\neq 0\), we are allowed to define, or each \( j\in J'\)
		\begin{equation}
			\begin{aligned}
				\psi_j\colon   M & \to \eR                                \\
				x                & \mapsto \frac{ \phi_j(x) }{ \phi(x) }.
			\end{aligned}
		\end{equation}
		We show that this is our partition of unity subordinate to \( \mW\). We have
		\begin{equation}		\label{EQooVRCOooKnBAmA}
			\supp(\psi_j)=\supp(\phi_j)=\bar B_i.
		\end{equation}
		\begin{subproof}
			\spitem[Condition \ref{DEFooGEAJooInejRf}\ref{ITEMooWBHEooSHUQvv}]
			%-----------------------------------------------------------
			The covering \( \{ B_j \}_{j\in J'}\) is locally finite. Lemma \ref{LEMooGRPUooVhmqDH} says that \( \{ \bar B_j \}_{j\in J'}\) is locally finite.

			\spitem[Condition \ref{DEFooGEAJooInejRf}\ref{ITEMooSPHGooQSDFTz}]
			%-----------------------------------------------------------

			We have \( \phi(x)>0\) for every \( x\) and \( \phi_j(x)\geq 0 \) for every \( x\in M\).

			\spitem[Condition \ref{DEFooGEAJooInejRf}\ref{ITEMooGWGPooOGdAGU}]
			%-----------------------------------------------------------

			Let \( m\in M\). We have
			\begin{equation}
				\sum_{j\in J'}\psi_j(m)=\frac{1}{ \phi(m)}\sum_{j\in J'}\phi_j(m)=1.
			\end{equation}

			\spitem[Subordinate to \( \mW\) (definition \ref{DEFooPJKOooFnCkuk})]
			%-----------------------------------------------------------

			Let \( W\in\mW\). We have chosen \( \{ B_j \}_{j\in J}\) to be a refinement of \( \mW\); thus \( \{ \bar B_j \}_{j\in J'}\) is also a refinement.

			\spitem[\( \supp(\psi_j)\) is compact]
			%-----------------------------------------------------------
			By equation \ref{EQooVRCOooKnBAmA} and the fact that we choose \( B_i\) in such a way that \( \bar B_i\) is compact.
		\end{subproof}
	\end{subproof}
\end{proof}

\begin{proposition}[\cite{MonCerveau}]		\label{PROPooGEWIooTwCfPp}
	Let \( M\) be a smooth manifold. There exists an atlas \( \{ (U_{\alpha},\varphi_{\alpha})_{\alpha\in \Lambda} \}\) and a partition of unity \( \{ \phi_i \}_{i\in I}\) such that
	\begin{enumerate}
		\item
		      The atlas \( \{ (U_{\alpha},\varphi_{\alpha}) \}_{\alpha\in \Lambda}\) is countable and locally finite.
		\item
		      The partition of unity \( \{ \phi \}_{i\in I}\)  is countable and subordinate to \( \mW=\{ \varphi_{\alpha}(U_{\alpha}) \}_{\alpha\in \Lambda}\).
		\item
		      The supports \( \supp(\phi_i)\) are compacts.
	\end{enumerate}
\end{proposition}

\begin{proof}
	The proposition \ref{PROPooYJKOooRwbOXF} gives an atlas \( \{ (U_{\alpha}, \varphi_{\alpha}) \}_{\alpha\in \Lambda}\) which is countable and for which \( \mW=\{ \varphi_{\alpha}(U_{\alpha}) \}_{\alpha\in \Lambda}\) is locally finite. Now the theorem \ref{THOooEJDHooTkRvsn} provides a partition of unity \( \{ \phi_i \}_{i\in I}\) which is subordinate to \( \mW\) with compact supports.
\end{proof}

\begin{proposition}[\cite{MonCerveau}]	\label{PROPooOVQHooMNRQDH}
	Let \( \{ U_{\alpha} \}_{\alpha\in \Lambda}\) be an open covering of a smooth manifold. There exists a partition of unity \( \{ \rho_{\alpha} \}_{\alpha\in\Lambda}\) such that for every \( \alpha\in\Lambda\),
	\begin{enumerate}
		\item
		      \( \supp(\rho_{\alpha})\subset U_{\alpha}\),
		\item
		      \( \supp(\rho_{\alpha})\) is compact.
	\end{enumerate}
\end{proposition}

\begin{proof}
	We consider a partition of unity \( \{ \phi_i \}_{i\in I}\) subordinate to the open covering \( \{ U_{\alpha} \}\) as in theorem \ref{THOooEJDHooTkRvsn}. For each \( i\in I\), there exists a \( \alpha\in \Lambda\) such that \( \supp(\phi_i)\subset U_{\alpha}\). We consider a map \(f \colon I\to \Lambda  \) such that\footnote{Such a map is not unique, and its existence maybe requires some form of axiom of choice.}
	\begin{equation}
		\supp(\phi_i)\subset U_{f(i)}.
	\end{equation}
	Now for each \( x\) we define
	\begin{equation}		\label{EQooBMYNooBnXQHm}
		\rho_{\alpha}(x)=\sum_{i\in f^{-1}(\alpha)}\phi_i(x).
	\end{equation}
	Since the covering \(  \{ \supp(\phi_i) \}_{i\in I}   \) is locally finite, the sum in the right hand side of \eqref{EQooBMYNooBnXQHm} is finite. We check that \( \{ \phi_{\alpha} \}_{\alpha\in\Lambda}\) is the requested partition of unity.

	\begin{subproof}
		\spitem[Sum to \( 1\)]
		%-----------------------------------------------------------

		For each \( i\in I\), there exists a unique \( \alpha\in\Lambda\) such that \( i\in f^{-1}(\alpha)\), thus
		\begin{equation}
			\sum_{\alpha\in\Lambda}\rho_{\alpha}(x)=\sum_{i\in I}\phi_i(x)=1.
		\end{equation}
		\spitem[Support]
		%-----------------------------------------------------------
		For every \( i\in f^{-1}(\alpha)\) we have \( \supp(\phi_{i})\subset U_{\alpha}\). Thus
		\begin{equation}
			\supp(\rho_{\alpha})=\supp\big( \sum_{i\in f^{-1}(\alpha)}\phi_i \big)\subset U_{\alpha}.
		\end{equation}
	\end{subproof}
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Tangent vector}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{definition}
	An open set \( \Omega\subset \eR^n\) is a manifold with the identify chart \( (\Omega, \varphi)\) where \( \phi\colon \Omega\to \Omega\) is the identity.
\end{definition}

\begin{lemma}		\label{LEMooMFQNooMTtpRp}
	Let \( \gamma\colon \eR\to M\) be a differentiable map\footnote{Definition \ref{DEFooFNTHooEwsqXB}.}. Let \( f\colon M\to \eR\) be a differentiable function. Then the map \( f\circ \gamma\colon \eR\to \eR\) is differentiable\footnote{In other words, its derivative exists.}
\end{lemma}

\begin{proof}
	Let \( a\in \eR\) and \( p=\gamma(a)\). We consider a chart \( (U,\varphi)\) of \( M\) around \( p\). We decompose
	\begin{equation}
		f\circ \gamma= f\circ \varphi\circ \varphi^{-1}\circ\gamma.
	\end{equation}
	Since \( \varphi\) is a chart, the maps \( f\circ\varphi\) and \( \varphi^{-1}\circ\gamma\) are differentiable.
\end{proof}


\subsection{Tangent vector}
%--------------------------


\begin{definition}      \label{DEFooJJVIooDUBwDJ}
	Let \( M\) be a differentiable manifold. Let \(\gamma \colon \eR\to M  \). We define\footnote{The map \( f\circ\gamma\) is differentiable by lemma \ref{LEMooMFQNooMTtpRp}.}
	\begin{equation}
		\begin{aligned}
			\nabla_{\gamma}\colon \Diff(M,N) & \to \eR                    \\
			f                                & \mapsto (f\circ\gamma)'(0)
		\end{aligned}
	\end{equation}
	where \( \Diff(M,N)\) is the set of differentiable maps from \( M\) to \( N\), see the definition \ref{DEFooFNTHooEwsqXB}.
\end{definition}

For a map \(\gamma \colon \eR\to M  \) we consider the following notations:
\begin{equation}        \label{EQooJQVRooLziKoH}
	\nabla_{\gamma}=\gamma'(0)=\Dsdd{ \gamma(t) }{t}{0}.
\end{equation}
These are three times the same operator on the functions over \( M\).


If one sees \( \eR\) as a manifold, then the expression \( \Dsdd{ 2t+1 }{t}{0}\) can stand for the number \( 1\) (usual derivative of \( t\mapsto 2t+1\) at \( t=0\)) or for the operator
\begin{equation}
	\Dsdd{ 2t+1 }{t}{0}\phi=2\phi'(1).
\end{equation}


\begin{definition}      \label{DEFooJJGMooSdmMOa}
	Let \( \mA\) be a class of functions, let \( M\) be a \( \mA\)-manifold and \( a\in M\). We define
	\begin{equation}
		T_aM=\{ \nabla_{\gamma}\tq \gamma\in \mA(\eR,M),\gamma(0)=a \}.
	\end{equation}
	This is the \defe{tangent space}{tangent space} at \( a\).
\end{definition}


\begin{remark}      \label{REMooJQFHooQuoZxt}
	The notation \( \gamma'(0)\) for the tangent vector to the curve \( \gamma\) has to be taken with caution. In particular, \( \gamma'(0)\) is not defined by the limit
	\begin{equation}        \label{EQooVMGFooFUCNEY}
		\lim_{\epsilon\to 0} \frac{ \gamma(\epsilon)-\gamma(0) }{ \epsilon }
	\end{equation}
	because when \( M\) is a manifold, there is in general no notion of difference between the points of \( M\), so that the difference \( \gamma(\epsilon)-\gamma(0)\) has no meaning.

	The only definition of \( \gamma'(0)\) is as differential operator.
\end{remark}


\begin{lemma}[\cite{MonCerveau}]        \label{LEMooMHSQooQyTZCg}
	Let \( \gamma\colon I\to M\) be a \( C^1\) path. Let \( u\in \eR\). We consider the path
	\begin{equation}
		\begin{aligned}
			\sigma\colon I & \to M               \\
			t              & \mapsto \gamma(ut).
		\end{aligned}
	\end{equation}
	Then we have \( \sigma'(0)=u\gamma'(0)\).
\end{lemma}

\begin{proof}
	Let \( f\) be a \( C^1\) map on \( M\). We consider the map
	\begin{equation}
		\begin{aligned}
			m\colon \eR & \to \eR    \\
			t           & \mapsto ut
		\end{aligned}
	\end{equation}
	and we use the usual chain derivation rule :
	\begin{subequations}
		\begin{align}
			\nabla_{\sigma}(f) & =(f\circ\sigma)'(0)                    \\
			                   & =\Big( (f\circ\gamma)\circ m \Big)'(0) \\
			                   & =(f\circ\gamma)'\big( m(0) \big)m'(0)  \\
			                   & =\nabla_{\gamma}(f)u.
		\end{align}
	\end{subequations}
\end{proof}


\begin{proposition}[\cite{MonCerveau}]	\label{PROPooMJKEooLvsYjl}
	Let \( M\) be a smooth manifold. Let \(\gamma \colon \eR\to M  \) be a smooth path. We have
	\begin{equation}
		\nabla_{\gamma}(f)=\sum_k\partial_k(f\circ\varphi_{\alpha})(a)(\varphi_{\alpha}^{-1}\circ\gamma)_k'(0)
	\end{equation}
	where \( a=(\varphi_{\alpha}^{-1}\circ\gamma)(0)\).
	%TODOooVMGGooZMZQQl. Prouver ça.
\end{proposition}



%---------------------------------------------------------------------------------------------------------------------------
\subsection{Vector space structure on the tangent space}
%---------------------------------------------------------------------------------------------------------------------------

The fact that \( \{ \partial_i \}\) is a basis of \( T_pM\) will be the proposition \ref{PROPooAAAXooKAMsfK}.

\begin{definition}[\( T_pM\) is a vector space\cite{MonCerveau}]		\label{PROPooEJBWooSbvypo}
	Let \( M\) be a \( C^k\) manifold. If \( X\) and \( Y \) are elements of \( T_pM\), and if \( \lambda\in \eR\), we introduce the operations\footnote{These are the usual definitions of sum and product by a scalar of maps \( E\to \eR\) where \( E\) is whatever. The point here is not these definitions, but the fact that they are defining elements that keep in \( T_pM\).}
	\begin{equation}
		\begin{aligned}
			\lambda X\colon  C^{\infty}(M) & \to \eR              \\
			f                              & \mapsto \lambda X(f)
		\end{aligned}
	\end{equation}
	and
	\begin{equation}
		\begin{aligned}
			X+Y\colon  C^{\infty}(M) & \to \eR            \\
			f                        & \mapsto X(f)+Y(f).
		\end{aligned}
	\end{equation}
	Then:
	\begin{enumerate}
		\item
		      We have \( \lambda X\in T_pM\)
		\item
		      We have \( X+Y\in T_pM\)
		\item		\label{ITEMooDRUQooWrsaDd}
		      With these operations, \( (T_pM,+,\cdot)\) is a vector space.
		\item		\label{ITEMooJEYEooLuJiqz}
		      The dimension of \( T_pM\) is the dimension of \( M\).
	\end{enumerate}
\end{definition}


\begin{proof}
	Let \( p\in M\) and a chart \( (U,\varphi)\) of \( M\) around \( p\) such that \( p=\varphi(0)\) (lemma \ref{LEMooOPPJooXezOHS}). We consider \( X,Y\in T_pM\) and paths \( \gamma\colon \eR\to M\), \( \sigma\colon \eR\to M\) such that \( X=\nabla_{\gamma}\) and \( Y=\nabla_{\sigma}\).

	\begin{subproof}
		\spitem[Sum]


		We aim to find a path \( s\colon \eR\to M\) such that \( \nabla_s=X+Y\). We set
		\begin{equation}        \label{EQooYNAOooKkKmxo}
			\begin{aligned}
				s\colon \eR & \to M                                                                                           \\
				t           & \mapsto \varphi\Big( \varphi^{-1}\big( \gamma(t) \big)+\varphi^{-1}\big( \sigma(t) \big) \Big).
			\end{aligned}
		\end{equation}
		This path satisfy \( s(0)=\varphi\Big( \varphi^{-1}(p)+\varphi^{-1}(p) \Big)=\varphi(0)=p\). In order to prove that \( \nabla_s=X+Y\) we consider \( f\in C^k(M,\eR)\) and we compute \( \nabla_s(f)\) :
		\begin{subequations}        \label{SUBEQSooKOGNooGISCax}
			\begin{align}
				\Dsdd{ (f\circ s)(t) }{t}{0} & =\Dsdd{ (f\circ\varphi)\Big( \varphi^{-1}\big( \gamma(t) \big)+\varphi^{-1}\big( \sigma(t) \big) \Big) }{t}{0}              \\
				                             & =\sum_k\partial_k(f\circ \varphi)(0)\Dsdd{ \varphi^{-1}\big( \gamma(t) \big)_k+\varphi^{-1}\big( \sigma(t) \big)_k }{t}{0}.
			\end{align}
		\end{subequations}
		We used the theorem \ref{THOooKBTYooWFtoSF} with the maps \( f\circ \varphi\colon \eR^n\to \eR\) and
		\begin{equation}
			\begin{aligned}
				g\colon \eR & \to \eR^n                                                                    \\
				t           & \mapsto \varphi^{-1}\big( \gamma(t) \big)+\varphi^{-1}\big( \sigma(t) \big).
			\end{aligned}
		\end{equation}
		We focus on one term:
		\begin{subequations}
			\begin{align}
				\sum_k\partial_k(f\circ \varphi)(0)\Dsdd{ \varphi^{-1}\big( \gamma(t) \big)_k }{t}{0} & =\Dsdd{ (f\circ\varphi)\big( \varphi^{-1}(\gamma(t)) \big) }{t}{0} \\
				                                                                                      & =\Dsdd{ f\big( \gamma(t) \big) }{t}{0}                             \\
				                                                                                      & =\nabla_{\gamma}(f).
			\end{align}
		\end{subequations}
		The two terms of \eqref{SUBEQSooKOGNooGISCax} sum to \( \nabla_{\gamma}(f)+\nabla_{\sigma}(f)\), so that \( \nabla_s=\nabla_{\gamma}+\nabla_{\sigma}=X+Y\).

		\spitem[Product]

		We ail to find a path \( s\colon \eR\to M\) such that \( \nabla_s=\lambda X\). The answer is easy: \( s(t)=\gamma(\lambda t)\). Indeed:
		\begin{equation}
			\Dsdd{ (f\circ s)(t) }{t}{0}=\Dsdd{ (f\circ \gamma)(\lambda t) }{t}{0}=\lambda \Dsdd{ (f\circ \gamma)(t) }{t}{0}=\lambda X(f).
		\end{equation}
		We used the lemma \ref{LEMooXHVBooHYjXdq}.

		\spitem[It is a vector space]
		%-----------------------------------------------------------

		We have to check that \( T_pM\) is a real vector space\footnote{A module over \( \eR\), see definition \ref{DEFooKHWZooIfxdNc}.}. So we have to check the conditions of definition \ref{DEFooHXITooBFvzrR}. In particular we have to check that \( (T_pM,+)\) is a group.

		The neutral is the constant null operator \( X(f)=0\) which is \( \nabla_{\gamma}\) with \( \gamma\) begin the constant path \( \gamma(t)=p\). Lemma \ref{LEMooMHSQooQyTZCg} shows an inverse for the sum : \( \nabla_{\gamma}+\nabla_{\sigma}=0\) when \( \sigma\) is defined by
		\begin{equation}
			\begin{aligned}
				\sigma\colon I & \to M               \\
				t              & \mapsto \gamma(-t).
			\end{aligned}
		\end{equation}

	\end{subproof}
\end{proof}


%-------------------------------------------------------
\subsection{Basis vectors}
%----------------------------------------------------

\begin{definition}		\label{DEFooUWWWooXhHVXP}
	Let \( M\) be a \( C^k\) manifold. Let \(\varphi_{\alpha}\colon U_{\alpha} \to M  \) be a chart around \( p\in M\). We consider the path
	\begin{equation}
		\begin{aligned}
			\sigma\colon \eR & \to U_{\alpha}                         \\
			t                & \mapsto \varphi_{\alpha}^{-1}(p)+te_i.
		\end{aligned}
	\end{equation}
	We define the tangent vector \( \partial_{\alpha,i}\) as
	\begin{equation}		\label{EQooHBUBooSuKyLm}
		\partial_{\alpha,i}=(\varphi_{\alpha}\circ\sigma)'(0).
	\end{equation}
	In other words, if \(f \colon M\to \eR  \) is a \( C^k\) function,
	\begin{equation}		\label{EQooLDOGooHbLoMC}
		\partial_{\alpha,i}(f)=(f\circ\varphi_{\alpha}\circ \sigma)'(0)=\frac{d}{dt} \left[f\Big(  \varphi_{\alpha}\big( \varphi_{\alpha}^{-1}(p)+te_i \big)  \Big)\right]_{t=0}
	\end{equation}
\end{definition}


\begin{proposition}[\cite{MonCerveau}]	\label{PROPooERIQooBWWbkX}
	Let \(\varphi_{\alpha} \colon U_{\alpha}\to M  \) be a chart. Let \( m\in M\). We have
	\begin{equation}		\label{EQooMCBOooBBupHl}
		(\partial_{\alpha, i}f)(m)=\partial_i(f\circ\varphi_{\alpha})\big( \varphi_{\alpha}^{-1}(m) \big)
	\end{equation}
	where on the let \( \partial_{\alpha,i}\) is the one defined in \ref{DEFooUWWWooXhHVXP}, while on the right \( \partial_i\) is the usual partial derivative defined by \ref{DEFooCATTooTPLtpR}
\end{proposition}

\begin{proof}
	Using \eqref{EQooLDOGooHbLoMC} we have
	\begin{equation}
		(\partial_if)(m)=\frac{d}{dt} \left[ (f\circ\varphi_{\alpha})\big( \varphi_{\alpha}^{-1}(m)+te_i \big)  \right]_{t=0}.
	\end{equation}
	We develop what we usually intend by «\( \frac{d}{dt} \left[ \ldots  \right]_{t=0}\)» and we write \( a=\varphi_{\alpha}^{-1}(m)\in U_{\alpha}\) :
	\begin{subequations}
		\begin{align}
			\frac{d}{dt} \left[ (f\circ\varphi_{\alpha})\big( \varphi_{\alpha}^{-1}(m)+te_i \big)  \right]_{t=0} & =\lim_{t\to 0}\frac{ (f\circ\varphi_{\alpha})(a+te_i)-(f\circ\varphi_\alpha)(a) }{ t } \\
			                                                                                                     & =\partial_{e_i}(f\circ\varphi_{\alpha})(a).
		\end{align}
	\end{subequations}
\end{proof}

\begin{proposition}		\label{PROPooCGKRooLjlULU}
	For every \( X_k,Y_k\in \eR\) we have
	\begin{equation}
		\left( \sum_kX_k\partial_k \right)+\left( \sum_kY_k\partial_k \right)=\sum_k (X_k+Y_k)\partial_k.
	\end{equation}
\end{proposition}

\begin{proof}
	This is merely the associativity of the sum of operators :
	\begin{subequations}
		\begin{align}
			\Big( \sum_kX_k\partial_k+\sum_kY_k\partial_k \Big)(f) & =\sum_kX_k(\partial_kf)+\sum_kY_k(\partial_kf) \\
			                                                       & =\sum_k(X_k+Y_k)(\partial_kf).
		\end{align}
	\end{subequations}
	The first equality is the definition of the sum of operators. The second equality is the commutativity and associativity of the sum of reals.
\end{proof}


\begin{proposition} \label{PROPooAAAXooKAMsfK}
	Let \( X\in T_pM\).
	\begin{enumerate}
		\item
		      Using the vectors \( \partial_i\) of definition \ref{DEFooUWWWooXhHVXP}, there exists a unique choice of \( X_k\in \eR\) such that
		      \begin{equation}
			      X(f)=\sum_{i=1}^n X_i(\partial_if)
		      \end{equation}
		      for every \( C^k\) function \( f\).
		\item		\label{ITEMooLWEHooRQwZQW}
		      If \( k\neq l\), then \( \partial_k\neq \partial_l\).
		\item		\label{ITEMooJRPCooOGopSu}
		      The vectors
		      \begin{equation}
			      \partial_i=\frac{d}{dt} \left[ \varphi_{\alpha}(s_0+te_i)  \right]_{t=0}
		      \end{equation}
		      form a basis of the vector space\footnote{Proposition \ref{PROPooCGKRooLjlULU} for the vector space structure on \( T_pM\).} \( T_pM\).
		\item		\label{ITEMooPJHVooOHNSNP}
		      We have
		      \begin{equation}
			      \dim(T_pM)=\dim(M)
		      \end{equation}
	\end{enumerate}
\end{proposition}


\begin{proof}
	Two parts.
	\begin{subproof}
		\spitem[Existence]
		%-----------------------------------------------------------

		Let \(\varphi \colon U\to M \) be a chart of a neighbourhood of \( p\) with \( \varphi^{-1}(p)=0\). Let \(f \colon M\to \eR  \) be a \( C^k\) function. We say \( X=\nabla_{\gamma}\) with \(\gamma \colon \eR\to M  \) and we define
		\begin{equation}
			\begin{aligned}
				\tilde \gamma\colon \eR & \to U_{\alpha}                         \\
				t                       & \mapsto (\varphi^{-1}\circ \gamma)(t).
			\end{aligned}
		\end{equation}
		Let's compute:
		\begin{subequations}
			\begin{align}
				X(f) & =(f\circ\gamma)'(0)                                                                                         \\
				     & =\big((f\circ\varphi)\circ\tilde \gamma\big)'(0)                                                            \\
				     & = \sum_k\partial_k(f\circ\varphi)\big( \tilde \gamma(0) \big)\tilde \gamma'(0)_k		\label{SUBEQooJVQNooEuipsc} \\
				     & =\sum_k(\partial_kf)\tilde \gamma'(0)_k.		\label{SUBEQooBQCSooSQldjW}
			\end{align}
		\end{subequations}
		Note. In \eqref{SUBEQooJVQNooEuipsc}, the symbol \( \partial_k\) stands for the usual partial derivative of the function \(f\circ\varphi \colon U\to \eR  \) while in \eqref{SUBEQooBQCSooSQldjW}, the symbol \( \partial_k\) stands for the tangent vector defined in \eqref{EQooHBUBooSuKyLm}.

		We see that \( X_k=\tilde \gamma'(0)_k\) makes the job. This shows the existence part.
		\spitem[Unicity]
		%-----------------------------------------------------------
		Suppose \( X=\sum_kX_k\partial_k\). With \( X=\nabla_{\gamma}\) and \(\gamma \colon \eR\to M  \). We consider
		\begin{equation}
			\begin{aligned}
				f_i\colon M & \to \eR                              \\
				m           & \mapsto (\pr_i\circ\varphi^{-1})(m).
			\end{aligned}
		\end{equation}
		We have
		\begin{subequations}
			\begin{align}
				X(f_i) & =\sum_kX_k(\partial_kf_i)                                                                  \\
				       & =\sum_k(f_i\circ\varphi\circ\sigma_i)'(0)                                                  \\
				       & =\sum_k\sum_l\partial_l(f_i\circ\varphi)\big( \sigma_i(0) \big)\big( \sigma'_i(0) \big)_l.
			\end{align}
		\end{subequations}
		On the one hand, from the expression \( \sigma_i(t)=\varphi^{-1}(p)+te_i\) we get \( \sigma_i'(0)_l=\delta_{il}\). On the other hand we have
		\begin{equation}
			f_i\circ\varphi=\pr_i\circ\varphi^{-1}\circ\varphi=\pr_i,
		\end{equation}
		and \( \partial_k(\pr_i)=\delta_{ki}\). Using these two relations we have
		\begin{equation}
			X(f_i)=\sum_kX_k\delta_{ki}=X_i.
		\end{equation}

		Now we compute the same, but using \( \gamma\). We define \( \tilde \gamma=\varphi^{-1}\circ\gamma]\). And we consider the functions \(a_k \colon \eR\to \eR  \) defined by
		\begin{equation}
			\tilde \gamma(t)=\sum_ka_k(t)e_k.
		\end{equation}
		We have
		\begin{subequations}
			\begin{align}
				X(f_i) & =(f_i\circ\varphi\circ\tilde \gamma)'(0) \\
				       & =(\pr_i\circ\tilde \gamma)'(0)           \\
				       & =a'_i(0).
			\end{align}
		\end{subequations}

		Thus we have \( X_i=a'_i(0)\), which proves the unicity.

		\spitem[For \ref{ITEMooLWEHooRQwZQW}]
		%-----------------------------------------------------------
		Let \( k\neq l\). Apply \( \partial_k\) and \( \partial_l\) on the function \( f_k\). We have \( \partial_k(f_k)=1\) and \( \partial_l(f_k)=0\).

		\spitem[For \ref{ITEMooJRPCooOGopSu}]
		%-----------------------------------------------------------
		The fact that \( T_pM\) is a vector space is proposition \ref{PROPooEJBWooSbvypo}\ref{ITEMooDRUQooWrsaDd}. We know that every element in \( T_pM\) can be written as a finite linear combination of \( \{ \partial_k \}_{k=1,\ldots,n}\) in a unique way. Proposition \ref{PROPooVJFNooSbkzTF} says that \( \{ \partial_k \}_{k=1,\ldots,n}\) is a basis of \( T_pM\).


		If you doubt about the cardinal, let \( B=\{ \partial_k \}_{k=1,\ldots,n} \). The map
		\begin{equation}
			\begin{aligned}
				\psi\colon \{ 1,\ldots,n \} & \to B              \\
				k                           & \mapsto \partial_k
			\end{aligned}
		\end{equation}
		is obviously surjective. It is injective by point \ref{ITEMooLWEHooRQwZQW}. Thus it is a bijection. The definition \ref{PROPooJLGKooDCcnWi} says that \( \Card(B)=n\).

		\spitem[For \ref{ITEMooPJHVooOHNSNP}]
		%-----------------------------------------------------------
		The vector space \( T_pM\) has a basis of cardinal \( n\). Thus its dimension is \( n\) (definition \ref{DEFooWRLKooArTpgh}).
	\end{subproof}
\end{proof}

\begin{lemma}[\cite{MonCerveau}]	\label{LEMooBFKIooSPRxZJ}
	Let \( M\) be a \( C^k\) manifold. Let \( m\in M\). We consider the function \(r_k \colon \varphi_{\alpha}(U_{\alpha})\to \eR  \) given by
	\begin{equation}
		r_k=\pr_k\circ \varphi_{\alpha}^{-1}
	\end{equation}
	and the vector \( \partial_{\alpha,i}\) defined by \ref{DEFooUWWWooXhHVXP}. We have:
	\begin{equation}
		\partial_{\alpha,i}(r_k)=\delta_{ik}.
	\end{equation}
\end{lemma}

\begin{proof}
	This is a simple computation:
	\begin{subequations}
		\begin{align}
			\partial_i(r_k) & =\frac{d}{dt} \left[ (r_k\circ \varphi_{\alpha})\big( \varphi_{\alpha}^{-1}(m)+te_i \big)  \right]_{t=0} \\
			                & =\frac{d}{dt} \left[ \pr_k\big( \varphi_{\alpha}^{-1}(m)+te_i \big)  \right]_{t=0}                       \\
			                & =\frac{d}{dt} \left[ t\delta_{ik}  \right]_{t=0}                                                         \\
			                & = \delta_{ik}.
		\end{align}
	\end{subequations}
\end{proof}

\begin{proposition}[\cite{MonCerveau}]	\label{PROPooPXTVooKIzptQ}
	Let \( M\) be a \( C^k\) manifold. Let \( m\in M\) and \( X,Y\in T_mM\). We consider the functions \(r_k \colon \varphi_{\alpha}(U_{\alpha})\to \eR  \) given by
	\begin{equation}
		r_k=\pr_k\circ \varphi_{\alpha}^{-1}.
	\end{equation}
	If \( X(r_k)=Y(r_k)\) for every \( k\), then \( X=Y\).
\end{proposition}

\begin{proof}
	Proposition \ref{PROPooAAAXooKAMsfK} says that there exists unique \( X_i,Y_i\in \eR\) such that \( X=\sum_iX_i\partial_i\) and \( Y=\sum_iY_i\partial_i\). Here \( \partial_i\) is the vector in \( T_mM\) given by the definition \ref{DEFooUWWWooXhHVXP}. We know from lemma \ref{LEMooBFKIooSPRxZJ} that \( \partial_i(r_k)=\delta_{ik}\). Thus \( X(r_k)=\sum_iX_i\partial_i(r_k)=X_k\). The hypothesis \( X(r_k)=Y(r_k)\) implies \( X_k=Y_k\) and then \( X=Y\).
\end{proof}

\begin{proposition}[\cite{MonCerveau}]     \label{PROPooJVSQooGvNqIx}
	Let \( V\) be a \( n\)-dimensional vector space.
	\begin{enumerate}
		\item
		      \( V\) has a structure of \( n\)-dimensional manifold.
		\item
		      For every \( a\in V\), the map
		      \begin{equation}
			      \begin{aligned}
				      i\colon V & \to T_aV                    \\
				      v         & \mapsto \sum_iv_i\partial_i
			      \end{aligned}
		      \end{equation}
		      is a vector space isomorphism.
	\end{enumerate}
	%TODOooLFMCooDNcZUc
\end{proposition}


%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Differential of a map}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

%-------------------------------------------------------
\subsection{Definition and properties}
%----------------------------------------------------


\begin{propositionDef}[Differential of a map\cite{MonCerveau}]      \label{DEFooDRGUooDPFIJa}
	Let \( \mA\) be a class of functions (differentiable, \( C^k\), analytic). Let \( M\), \( N\) be \( \mA\)-manifolds. Let \( a\in M\). Let \( s\in\mA(M,N)\). We consider two paths \(\sigma,\gamma \in\mA(\eR,M)  \) satisfying \( \gamma(0)=\sigma(0)=a\) and
	\begin{equation}
		\nabla_{\gamma}=\nabla_{\sigma}.
	\end{equation}
	Then
	\begin{equation}
		\nabla_{s\circ \gamma}=\nabla_{s\circ \sigma}.
	\end{equation}
	We define
	\begin{equation}        \label{EQooQNZPooMVaSQC}
		\begin{aligned}
			ds_a\colon T_aM & \to T_{s(a)}N                   \\
			\nabla_{\gamma} & \mapsto \nabla_{s\circ \gamma}.
		\end{aligned}
	\end{equation}
	We have the formula
	\begin{equation}        \label{EQooEWMRooFsSVpb}
		ds_a(\nabla_{\gamma})f=\nabla_{s\circ \gamma}(f)=\Dsdd{ (f\circ s\circ\gamma)(t) }{t}{0}
	\end{equation}
	where \( a=\gamma(0)\).
\end{propositionDef}

\begin{proof}
	Let \( f\in\mA(N,\eR)\). The map \( f\circ s\colon M\to \eR\) belongs to \( \mA(M,\eR)\) so that we can apply \( \nabla_{\gamma}\) and \( \nabla_{\sigma}\) on it. By hypothesis,
	\begin{equation}
		\nabla_{\gamma}(f\circ s)=\nabla_{\sigma}(f\circ s).
	\end{equation}
	Using the definition of \( \nabla\),
	\begin{equation}
		\nabla_{\gamma}(f\circ s)=\Dsdd{ (f\circ s\circ \gamma)(t) }{t}{0}=\nabla_{s\circ\gamma}(f).
	\end{equation}
	and
	\begin{equation}
		\nabla_{\sigma}(f\circ s)=\Dsdd{ (f\circ s\circ \sigma)(t) }{t}{0}=\nabla_{s\circ\sigma}(f).
	\end{equation}
\end{proof}

\begin{proposition}[\cite{MonCerveau}]      \label{PROPooALATooGgcVQV}
	Let \( M\), \( N\) be \( C^1\)-manifolds. Let \(I \) be an interval around \( 0\) in \( \eR\) and a \( C^1\) path \( \gamma\colon I\to M\). We consider a \( C^1\) map \( \phi\colon M\to N\) and a function \( f\colon N\to \eR\).

	We have the formula
	\begin{equation}        \label{EQooYHBZooUqInIC}
		\Dsdd{ (f\circ\phi)\big( \gamma(t) \big) }{t}{t_0}=d\phi_{\gamma(t_0)}\big( \gamma'(t_0) \big)f,
	\end{equation}
	or
	\begin{equation}        \label{EQooVLUIooAbGZEi}
		d\phi_{\gamma(t_0)}\big( \gamma'(t_0) \big)=\Dsdd{ (\phi\circ \gamma)(t) }{t}{t_0}.
	\end{equation}
\end{proposition}

\begin{proof}
	It's a computation. We write \( s(t)=\gamma(t_0+t)\) and
	\begin{subequations}
		\begin{align}
			\Dsdd{ (f\circ\phi)\big( \gamma(t) \big) }{t}{t_0} & =\Dsdd{ (f\circ\phi)\big( s(t) \big) }{t}{0}        \label{SUBEQooMYOQooTBvFTn} \\
			                                                   & =d\phi_{s(0)}\big( s'(0) \big)f        \label{SUBEQooNINCooIwqrdP}              \\
			                                                   & =d\phi_{\gamma(t_0)}\big( \gamma'(t_0) \big)f.
		\end{align}
	\end{subequations}
	Justifications.
	\begin{itemize}
		\item For \eqref{SUBEQooMYOQooTBvFTn}.  The left hand side of is a classical derivative of the map \( f\circ\phi\circ \gamma\colon I\to \eR\).
		\item For \eqref{SUBEQooNINCooIwqrdP}.  This is formula \eqref{EQooEWMRooFsSVpb}.
	\end{itemize}
\end{proof}

\begin{lemma}[\cite{MonCerveau}]        \label{LEMooBOZBooNJMccB}
	Let \( M,N\) be \( C^1\)-manifolds. We consider \( C^1\)-maps \( \phi\colon M\to N\) and \( f \colon N\to \eR\). Let \( \gamma\colon \eR\to M\) be a \( C^1\)-path. We have
	\begin{equation}
		\nabla_{\gamma}(f\circ\phi)=\nabla_{\phi\circ \gamma}(f).
	\end{equation}
\end{lemma}

\begin{proof}
	By definition,
	\begin{equation}
		\nabla_{\gamma}(f\circ \phi)=\Dsdd{ (f\circ\phi\circ \gamma)(t) }{t}{0}=\Dsdd{ f\big( (\phi\circ \gamma)(t) \big) }{t}{0}=\nabla_{\phi\circ\gamma}(f).
	\end{equation}
\end{proof}

\begin{proposition}[\cite{MonCerveau}]	\label{PROPooMYSMooQnRQyx}
	Let \( M,N\) be \( C^1\)-manifolds. We consider \( C^1\)-maps \( \phi\colon M\to N\) and \( f \colon N\to \eR\). Let \( a\in M\) and \( X\in T_aM\). We have
	\begin{equation}
		X(f\circ\phi)=(d\phi_aX)(f).
	\end{equation}
\end{proposition}

\begin{proof}
	We have \( X=\nabla_{\gamma}\) for some \(\gamma \colon \eR\to M  \) satisfying \( \gamma(0)=a\). With that path we have
	\begin{subequations}
		\begin{align}
			X(f\circ \phi) & =\frac{d}{dt} \left[ (f\circ\phi\circ\gamma)(t)  \right]_{t=0}                                                \\
			               & = \frac{d}{dt} \left[ f\big( (\phi\circ\gamma)(t) \big)  \right]_{t=0}                                        \\
			               & =(\phi\circ\gamma)'(0)f                                                                                       \\
			               & =d\phi_a(\nabla_{\gamma})f                                             & \text{def. \eqref{EQooQNZPooMVaSQC}} \\
			               & =(d\phi_aX)f
		\end{align}
	\end{subequations}
\end{proof}


Here we prove that \( df_a\) is linear. The proposition \ref{PROPooPEMLooPQcywG} will provide the reciprocal map : \( (df_a)^{-1}=(df^{-1})_{f(a)}\).
\begin{proposition}     \label{PROPooNRLVooChhiIS}
	Let \( M\) and \( N\) be \( C^1\)-manifolds. Let \( f\in C^1(M,N)\) and \( a\in M\). The map \( df_a\colon T_aM\to T_{f(a)}N\) is linear.
\end{proposition}

\begin{proof}
	We consider two tangent vectors \( \nabla_{\gamma}\) and \( \nabla_{\sigma}\) to \( M\) at \( a\). We know that there exists a path \( s\colon \eR\to M\) such that \( \nabla_{\gamma}+\nabla_{\sigma}=\nabla_s\). This is proposition \ref{PROPooEJBWooSbvypo}, see equation \eqref{EQooYNAOooKkKmxo}.

	Let \( \phi\in C^1(N,\eR)\) be a test function; we have
	\begin{subequations}
		\begin{align}
			df_a(\nabla_{\gamma}+\nabla_{\sigma})\phi & =df_a(\nabla_s)\phi  \label{EQooIMZIooQlZODR}                                           \\
			                                          & =\nabla_s(\phi\circ f)     \label{EQooXMHHooGpbAge}                                     \\
			                                          & =\nabla_{\gamma}(\phi\circ f)+\nabla_{\sigma}(\phi\circ f)                              \\
			                                          & =\nabla_{f\circ \gamma}(\phi)+\nabla_{f\circ \sigma}(\phi)     \label{EQooHMZAooArgfTN} \\
			                                          & =df_a(\nabla_{\gamma})\phi+df_a(\nabla_{\sigma})\phi.
		\end{align}
	\end{subequations}
	Justifications:
	\begin{itemize}
		\item For \eqref{EQooIMZIooQlZODR}: definition od the path \( s\).
		\item For \eqref{EQooXMHHooGpbAge}: definition \eqref{EQooQNZPooMVaSQC} of \( df_a\).
		\item For \eqref{EQooHMZAooArgfTN}: lemma \ref{LEMooBOZBooNJMccB}.
	\end{itemize}
\end{proof}


%-------------------------------------------------------
\subsection{Link with usual differential}
%----------------------------------------------------

\begin{normaltext}		\label{NORMooGEFJooALLfTa}
	We one consider a map \(f \colon \eR^n\to \eR^m  \), there is an ambiguity writing \( df_a\): it can be the "manifold" differential \ref{DEFooDRGUooDPFIJa}  \(df_a \colon T_{a}\eR^n\to T_{f(a)}\eR^m  \) or the \(df_a \colon \eR^n\to \eR^m  \) or the
	"usual" differential \ref{DefDifferentiellePta} \(df_a \colon \eR^n\to \eR^m  \).

	For the sake of making the difference, we denote by \( d_Mf\) the "manifold" differential when there could be a problem.


	Let \( M\) be a differentiable manifold. Let \(\varphi_{\alpha} \colon U_{\alpha}\to M  \) be chart around \( a\in M\). We consider the map
	\begin{equation}
		\begin{aligned}
			s\colon \eR^k & \to T_a\eR^k                                \\
			v             & \mapsto \sum_{i=1}^kv_i\partial_{\alpha,i}.
		\end{aligned}
	\end{equation}
	When we write "\( s\)", the chart \( \varphi_{\alpha}\), the point \( a\) and the space \( \eR^k\) are implicit.
\end{normaltext}

\begin{proposition}[\cite{MonCerveau}]	\label{PROPooORWSooAZsGzz}
	Let \(f \colon \eR^n\to \eR^m  \) be a differentiable map. We have
	\begin{equation}		\label{EQooFIUPooHswOVm}
		(d_Mf)_a=s\circ df_a\circ s^{-1}.
	\end{equation}
\end{proposition}

\begin{proof}
	We apply the right hand side of \eqref{EQooFIUPooHswOVm} to the basis vector \( \partial_{\alpha, i}\) :
	\begin{subequations}
		\begin{align}
			(s\circ df_a\circ s^{-1})(\partial_{\alpha, i}) & =(s\circ df_a)(e_i)                                                                        \\
			                                                & =s\Big( \sum_{k=1}^m(\partial_if_k)(a)e_k \Big)    & \text{prop. \ref{PROPooZOFLooBmcZqN}} \\
			                                                & =\sum_{k=1}^m(\partial_if_k)(a)\partial_{\beta,k}.
		\end{align}
	\end{subequations}
	On the last line, we used the implicit chart \(\varphi_{\beta} \colon \eR^m\to \eR^m  \).

	We apply the whole to a differentiable map \(g \colon \eR^m\to \eR  \). We denote\footnote{Recall that the maps \( \varphi_{\alpha}\) are the identity.} \( y_0=\varphi_{\beta}^{-1}\big( f(a) \big)\) and \( e_k\) be basis vector in \( \eR^m\), so that
	\begin{equation}
		\partial_{\beta, k}(g)=\frac{d}{dt} \left[ g(y_0+te_k)  \right]_{t=0}.
	\end{equation}
	Thus
	\begin{equation}		\label{EQooBYZIooTvwYJh}
		(s\circ df_a\circ s^{-1})(\partial_{\alpha,i})(g)=\sum_{k=1}^m(\partial_if_k)(a)(\partial_kg)(y_0).
	\end{equation}

	Now we look at the left hand side of \eqref{EQooFIUPooHswOVm}. We consider the map
	\begin{equation}
		\begin{aligned}
			u\colon \eR & \to \eR^m                                   \\
			t           & \mapsto (f\circ\varphi_{\alpha})(x_0+te_i).
		\end{aligned}
	\end{equation}
	and we compute
	\begin{subequations}
		\begin{align}
			(d_Mf)_a(\partial_{\alpha, i})g & =\frac{d}{dt} \left[ (g\circ f\circ\varphi_{\alpha})(x_0+te_i)  \right]_{t=0}                                         \\
			                                & =(g\circ u)'(0)                                                                                                       \\
			                                & =\sum_{k=1}^m(\partial_kg)\big( u(0) \big)u_k'(0)                             & \text{prop. \ref{PROPooYNQYooSjXBfU}} \\
			                                & =\sum_k(\partial_kg)\big( f(a) \big)(\partial_if_k)(x_0).
		\end{align}
	\end{subequations}
	This is the same as \eqref{EQooBYZIooTvwYJh} because \( f(a)=y_0\) because the chart \( \varphi_{\beta}\) is the identity.
\end{proof}


%-------------------------------------------------------
\subsection{Decomposition}
%----------------------------------------------------


The following lemma will be generalized to vector fields in \ref{LEMooZWFAooDlYaJm}.
\begin{lemma}       \label{LEMooSCVHooYPiGse}
	Let \( \varphi\colon U\to M\) be a chart around \( a\in M\) with \( \varphi(s)=a\) (\( s\in U\)). We have \( v\in T_aM\) if and only if there exists reals numbers \( \{ v_k \}_{k=1,\ldots, n}\) such that
	\begin{equation}        \label{EQooNEDSooOhyrCZ}
		v(f)=\sum_{k=1}^nv_k\partial_k(f\circ \varphi)(s).
	\end{equation}
\end{lemma}

\begin{proof}
	Two parts.
	\begin{subproof}
		\spitem[\( \Rightarrow\)]
		Let \( \gamma\colon \eR\to M\) be a path for the vector \( v\): \( v=\nabla_{\gamma}\). By the regularity hypothesis\footnote{The manifold \( M\) is \( C^k\), the charts maps are \( C^k\) and all that.}, the maps \( f\circ \varphi\colon U\to \eR\) and \( \varphi^{-1}\circ\gamma\colon \eR \to U \) are differentiable usual maps.

		Thus, using the equalities of lemma \ref{LemdfaSurLesPartielles} and theorem \ref{THOooIHPIooIUyPaf}, we can write
		\begin{subequations}
			\begin{align}
				\nabla_{\gamma}f & =\Dsdd{ (f\circ\gamma)(t) }{t}{0}                                                          \\
				                 & =\Dsdd{ (f\circ\varphi)\circ(\varphi^{-1}\circ\gamma)(t) }{t}{0}                           \\
				                 & =d(f\circ \varphi)_{(\varphi^{-1}\circ\gamma)(0)}\big( (\varphi^{-1}\circ\gamma)'(0) \big) \\
				                 & =d(f\circ \varphi)_{s}\big( (\varphi^{-1}\circ\gamma)'(0) \big)                            \\
				                 & =\sum_k\partial_k(f\circ \varphi)(s)(\varphi^{-1}\circ\gamma)'(0)_k
			\end{align}
		\end{subequations}
		Let \( v_k=(\varphi^{-1}\circ\gamma)'(0)_k\) and we have the result.

		\spitem[$ \Leftarrow$ ]
		%---------------------------------
		We have to prove that the map \( f\mapsto \partial_k(f\circ\varphi)(s)\) is an element of \( T_aM\). For that, we define \( \gamma(t)=\varphi(s+te_k)\). We have
		\begin{equation}
			\nabla_{\gamma}(f)=(f\circ\gamma)'(0)=\frac{d}{dt} \left[ (f\circ\varphi)(s+te_k)  \right]_{t=0}=\partial_k(f\circ\varphi)(s)
		\end{equation}
		while, by definition \ref{DEFooJJVIooDUBwDJ}, we have \( \nabla_{\gamma}\in T_aM\).
	\end{subproof}
\end{proof}




\begin{lemma}       \label{LEMooZXEFooZgXbNP}
	Let \( \varphi\colon U\to M\) be a chart around \( a\in M\) with \( \varphi(s)=a\) (\( s\in U\)). Let \( v=\nabla_{\gamma}\in T_aM\). We have
	\begin{equation}
		v(f)=\sum_{k=1}^nv_k\partial_k(f\circ \varphi)(s)
	\end{equation}
	with \( v= (\varphi^{-1}\circ \gamma)'(0)\).
\end{lemma}

\begin{proof}
	We have this small computation:
	\begin{subequations}
		\begin{align}
			\nabla_{\gamma}(f) & =\frac{d}{dt} \left[ (f\circ\gamma)(t)  \right]_{t=0}                                        \\
			                   & =\frac{d}{dt} \left[ (f\circ\varphi\circ\varphi^{-1}\circ\gamma)(t)  \right]_{t=0}           \\
			                   & =\frac{d}{dt} \left[ (f\circ\varphi)\Big( (\varphi^{-1}\circ\gamma)(t) \Big)  \right]_{t=0}.
		\end{align}
	\end{subequations}
	The map \(f\circ\varphi \colon U\to \eR  \) is a usual real map. We use the usual chain rule:
	\begin{equation}
		\nabla_{\gamma}(f)=\sum_k\partial_k(f\circ\varphi)\Big( (\varphi^{-1}\circ\gamma)(0) \Big)(\varphi^{-1}\circ\gamma)'(0).
	\end{equation}
	This is the requested formula.
\end{proof}

\begin{proposition}		\label{PROPooLHMSooMMXrSS}
	Let \( M\) be a \( n\)-dimensional manifold. Let \( X\in T_pM\) be a tangent vector. There exists a unique \( v\in \eR^n\) such that
	\begin{equation}
		X=\frac{d}{dt} \left[ \varphi_{\alpha}(s_0+tv)  \right]_{t=0}
	\end{equation}
	where \( s_0=\varphi_{\alpha}^{-1}(p)\).
	%TODOooGGQWooDKnCGP. Prouver ça.
	% Presque certainement un corolaire de LEMooZXEFooZgXbNP.
\end{proposition}

\begin{normaltext}      \label{NORMooXAJGooDNyxjv}
	If \( v\in \eR^n\) and if \( a\in \eR^n\), we can speak of \( v\in T_a\eR^n\) with the abuse of notation \( v=\nabla_{\gamma}\) where
	\begin{equation}
		\begin{aligned}
			\gamma\colon \eR & \to \eR^n     \\
			t                & \mapsto a+tv.
		\end{aligned}
	\end{equation}
	You have to keep in mind that \( v\) is an element of \( \eR^n\) (a list of numbers) while \( \nabla_{\gamma}\) is an element of \( T_a\eR^n\) (a differential operator). Writing «\( v=\nabla_{\gamma}\)» is an abuse of notation.

	The object \( \nabla_{\gamma}\) is what one could name «the vector \( v\) tied to the point \( a\)».
\end{normaltext}

This remark is formalised by the following proposition which provides a canonical isomorphism between \( \eR^n\) and \( T_a\eR^n\).

\begin{proposition}     \label{PROPooRXIIooFmhqJd}
	Let \( M\) be a \( C^k\) manifold and \( a\in M\). We consider a chart \( \varphi\colon U\to M\) around \( a\). For \( v\in \eR^n\) we define
	\begin{equation}
		\gamma_{a,v}(t)=\varphi\big( \varphi^{-1}(a)+tv \big).
	\end{equation}
	\begin{enumerate}
		\item
		      The map \( \gamma_{a,v}\colon \eR\to M\) is \( C^k\).
		\item
		      The map
		      \begin{equation}
			      \begin{aligned}
				      \psi\colon \eR^n & \to T_aM                      \\
				      v                & \mapsto \nabla_{\gamma_{a,v}}
			      \end{aligned}
		      \end{equation}
		      is a bijection.
		\item
		      We have the equalities
		      \begin{equation}
			      \psi(v)f=d\varphi_s(v)f=\nabla_{s,v}(f)=\Dsdd{ (f\circ\varphi)\big( \varphi^{-1}(a)+tv \big) }{t}{0}=\sum_kv_k\partial_k(f\circ\varphi)\big( \varphi^{-1}(x) \big)
		      \end{equation}
		      where \( \nabla_{s,v}\) is the operator defined in proposition \ref{PROPooRXIIooFmhqJd}.
	\end{enumerate}
\end{proposition}

\begin{proof}
	The map \( \gamma_{a,v}\) is continuous as composed of continuous maps. The set \( \eR\) is a manifold with the identity as charts. Thus the condition \ref{DEFooFNTHooEwsqXB}\ref{SUBITEMooXQFUooRxMVnw} to be checked reduces to
	\begin{equation}
		\tilde \gamma_{a,v}=\varphi^{-1}\circ\gamma_{a,v}.
	\end{equation}
	We consider the \(  C^{\infty}\) map
	\begin{equation}
		\begin{aligned}
			l\colon \eR & \to \eR^n                   \\
			t           & \mapsto \varphi^{-1}(a)+tv.
		\end{aligned}
	\end{equation}
	We have \( \tilde \gamma_{a,v}=\varphi^{-1}\circ\varphi \circ l\). Thus \( \tilde \gamma\) is \(  C^{\infty}\).

	Remain to prove that \( \psi\) is a bijection.
	\begin{subproof}
		\spitem[Injective]
		Suppose that \( \psi(v)=\psi(w)\). For every \( f\in C^k(M)\) we have \( \nabla_{a,v}(f)=\nabla_{a,w}(f)\), which means
		\begin{equation}        \label{EQooMXJWooQKpzCG}
			\Dsdd{ f\Big( \varphi\big( \varphi^{-1}(a)+tv \big) \Big) }{t}{0}=\Dsdd{ f\Big( \varphi\big( \varphi^{-1}(a)+tw \big) \Big) }{t}{0}.
		\end{equation}
		We apply this to the function \( f=\pr_k\circ\varphi^{-1}\) :
		\begin{equation}
			f\Big( \varphi\big( \varphi^{-1}(a)+tv \big) \Big)=\varphi^{-1}(a)_k+tv_k,
		\end{equation}
		so that
		\begin{equation}
			\nabla_{a,v}(f)=\Dsdd{ \varphi^{-1}(a)_k+tv_k }{t}{0}=v_k.
		\end{equation}
		The equation \eqref{EQooMXJWooQKpzCG} implies \( v_k=w_k\) for every \( k\).
		\spitem[Surjective]
		The map \( f\circ \varphi\colon U \to \eR \) is a usual \( C^k\) function. The formulas of the lemma \ref{LemdfaSurLesPartielles} are valid; in particular the ones concerning the directional derivative. We have
		\begin{subequations}
			\begin{align}
				\nabla_{a,v}(f) & =\Dsdd{ (f\circ \varphi)\big( \varphi^{-1}(a)+tv \big) }{t}{0}   \\
				                & =\partial_v(f\circ \varphi)\big( \varphi^{-1}(a) \big)           \\
				                & =\sum_k v_k\partial_k(f\circ\varphi)\big( \varphi^{-1}(a) \big).
			\end{align}
		\end{subequations}
		This is the general form \eqref{EQooNEDSooOhyrCZ} for the action of a tangent vector on \( f\).
	\end{subproof}
\end{proof}

\begin{proposition}     \label{PROPooKMCGooDEuaWz}
	Let \( \varphi\colon U\to M\) be a chart satisfying \( \varphi(s)=a\).
	\begin{enumerate}
		\item       \label{ITEMooSFUBooNXgGuu}
		      The set\footnote{We use the abuse of notation of \ref{NORMooXAJGooDNyxjv}.} \( \{ d\varphi_s(e_i) \}_{i=1,\ldots, n}\) is a basis of \( T_aM\).
		\item       \label{ITEMooPYPVooKkHrkQ}
		      For every \( X\in T_aM\), there exists an unique \( v\in \eR^n\) such that
		      \begin{equation}
			      X=d\varphi_{s}(v).
		      \end{equation}
	\end{enumerate}
\end{proposition}

\begin{proof}
	For part \ref{ITEMooSFUBooNXgGuu}, we have to prove that the vectors of the form \( d\varphi_s(e_i)\) are linearly independent and spanning \( T_aM\).
	\begin{subproof}
		\spitem[Spanning]
		Lemma \ref{LEMooSCVHooYPiGse} says that, if \( v\in T_aM\), there exist numbers \( v_k\) such that
		\begin{equation}
			v(f)=\sum_{k=1}^nv_k\partial_k(f\circ\varphi)(s)
		\end{equation}
		We consider the path
		\begin{equation}
			\begin{aligned}
				\gamma_k\colon \eR & \to U           \\
				t                  & \mapsto s+te_k.
			\end{aligned}
		\end{equation}
		Now we have
		\begin{subequations}
			\begin{align}
				v(f) & =\sum_{k=1}^nv_k\partial_k(f\circ\varphi)(s)             \\
				     & =\sum_kv_k\Dsdd{ (f\circ\varphi)(s+te_k) }{t}{0}         \\
				     & =\sum_kv_k\Dsdd{ (f\circ\varphi\circ\gamma_k)(t) }{t}{0} \\
				     & =\sum_kv_kd\varphi_{\gamma_k(0)}(\nabla_{\gamma_k})f     \\
				     & =\sum_kv_kd\varphi_s(\nabla_{\gamma_k})f                 \\
				     & =\sum_kv_kd\varphi_s(e_k).
			\end{align}
		\end{subequations}
		The last equality is the abuse of notation explained in \ref{NORMooXAJGooDNyxjv}.
		\spitem[Independent]
		We suppose that
		\begin{equation}
			\sum_{k=1}^nv_kd\varphi_s(e_k)=0
		\end{equation}
		for some numbers \( v_k\). It means that for every \( C^k\) functions \( f\colon M\to \eR\) we have
		\begin{equation}
			\sum_{k}v_k\partial_k(f\circ \varphi)(s)=0.
		\end{equation}
		Since the function
		\begin{equation}
			\begin{aligned}
				\pr_i\colon \eR^n & \to \eR     \\
				x                 & \mapsto x_i
			\end{aligned}
		\end{equation}
		is \(  C^{\infty}\), we can choose \( f=\pr_k\circ\varphi^{-1}\). Then we have
		\begin{subequations}
			\begin{align}
				0 & =\sum_kv_k\partial_k(\pr_i\circ\varphi^{-1}\circ\varphi)(s) \\
				  & =\sum_kv_k\partial(s\mapsto s_i)(s)                         \\
				  & =\sum_kv_k\delta_{ki}                                       \\
				  & =v_i.
			\end{align}
		\end{subequations}
		We conclude that \( v_i=0\) for every \( i\) and we are done.
	\end{subproof}
	Now we prove part \ref{ITEMooPYPVooKkHrkQ}. From part \ref{ITEMooSFUBooNXgGuu} there is a set of numbers \( v_i\) such that
	\begin{equation}
		X=\sum_iv_i
	\end{equation}
	We pose \( v=\sum_iv_ie_i\) and we use the linearity of \( d\varphi_s\) :
	\begin{equation}
		X=\sum_iv_id\varphi_s(e_i)=\sum_id\varphi_s(v_ie_i)=d\varphi_s\big( \sum_iv_ie_i \big)=d\varphi_s(v).
	\end{equation}
	For the unicity, let \( v,w\in \eR^n\) such that \( d\varphi_s(v)=d\varphi_s(w)\). Thus we have \( d\varphi_s(v-w)=0\) which implies \( v=w\).
\end{proof}

\begin{lemma}[\cite{MonCerveau}]
	Let \( a\) and \( b\) be different points in the manifold \( M\). Then
	\begin{equation}
		T_aM\cap T_bM=\{ 0 \}.
	\end{equation}
\end{lemma}

\begin{proof}
	The operator which maps every function to zero belongs to \( T_aM\) and \( T_bM\). This is easy. The tricky part is the contrary. Let \( v\in T_aM\) and \( w\in T_bM\) both non zero. We consider charts \( \varphi\colon U\to M\) and \( \psi\colon V\to M\) such that
	\begin{itemize}
		\item \( U\cap V=\emptyset\)
		\item \( \varphi(U)\cap \psi(V)=\emptyset\)
		\item \( a=\varphi(s)\) and \( b=\psi(t)\) with \( s\in U\) and \( t\in V\).
	\end{itemize}
	Let \( \phi\in C^k(M,\eR)\). By lemma \ref{LEMooSCVHooYPiGse} we have
	\begin{equation}        \label{EQooTQKZooIeQNaU}
		v(\phi)=\sum_kv_k\partial_k(\phi\circ \varphi)(s)
	\end{equation}
	and
	\begin{equation}
		w(\phi)=\sum_kw_k\partial_k(\phi\circ \varphi)(t).
	\end{equation}
	The trick now is to build a function \( \phi\) for which \( v(\phi)\neq w(\phi)\).

	Let \( r>0\) such that \( \overline{ B(s,r) }\subset U\). We use the Urysohn lemma \ref{PROPooBOZIooAhKbPs} to create a function \( p\colon U\to \eR\) such that
	\begin{itemize}
		\item \( p=1\) on a neighbourhood of \( s\),
		\item \( p=0\) outside \( \overline{ B(s,r) }\),
		\item \( p\in  C^{\infty}(U)\).
	\end{itemize}
	We also consider a \(  C^{\infty}\) function \( q\colon U\to \eR\) such that \( (\partial_kq)(s)=\alpha_k\) for some numbers \( \alpha_k\) to be fixed later.

	Finally we build
	\begin{equation}
		\begin{aligned}
			\phi\colon M & \to \eR                                                                       \\
			x            & \mapsto \begin{cases}
				                       (pq)\big( \varphi^{-1}(x) \big) & \text{if }  x\in \varphi(U) \\
				                       0                               & \text{otherwise. }
			                       \end{cases}
		\end{aligned}
	\end{equation}
	This function is \( C^k\). Indeed there are two possibilities : \( x\in \varphi(U)\) or \( x\notin\varphi(U)\). In the first case \( \phi\) is the composition of \( pq\) (which is \(  C^{\infty}\)) with \( \varphi^{-1}\) which is \( C^k\). If \( x\notin\varphi(U)\), then it is in particular outside \( \varphi\big( \overline{ B(s,r) } \big)\) which is closed.

	The set of points outside of \( \varphi\big( \overline{ B(s,r) } \big)\) is open. Thus there is a neighbourhood of \( x\) which does not intersect \( \varphi\big( \overline{ B(r,s) } \big)\). The function \( \phi\) is zero in this neighbourhood, so that \( \phi\) is \(  C^k\).

	We can compute the values of \( v(\phi)\) and \( w(\phi)\). The easiest if \( w(\phi)=0\) because \( \phi=0\) on a neighbourhood of \( b\). For \( v(\phi)\) we use the formula \ref{EQooTQKZooIeQNaU}. We have
	\begin{equation}
		\partial_k(\phi\circ\varphi)(s)=\partial_k(q)(s)=\alpha_k
	\end{equation}
	because \( p=1\) on a neighbourhood of \( \varphi^{-1}(a)\). Thus we have
	\begin{equation}
		v(\phi)=\sum_kv_k\alpha_k.
	\end{equation}
	We can choose the \( \alpha_k\) in such a way that \( v(\phi)\neq 0\) because \( v\neq 0\).
\end{proof}

\begin{proposition}       \label{PROPooLJYEooMjevio}
	Let $M$ be a submanifold of the manifold $N$. If $p\in M$, then there  exists a coordinate system $\{x_1,\ldots,x_n\}$ on a neighbourhood of $p$ in $N$ such that $x_1(p)=\ldots=x_n(p)=0$ and such that the set
	\[
		U=\{q\in V\tq x_j(q)=0\,\forall\, m+1\leq j\leq n\}
	\]
	gives a local chart of $M$ containing $p$.
\end{proposition}

The sense of this proposition is that one can put $p$ at the center of a coordinate system on $N$ such that $M$ is just a submanifold of $N$ parametrised by the fact that its last $m-n$ components are zero.

\begin{lemma}\label{lem:var_cont_diff}
	Let $V,M$ be two manifolds and $\varphi\colon V\to M$, a differentiable map. We suppose that $\varphi(V)$ is contained in a submanifold $S$ of $M$. If $\dpt{\varphi}{V}{S}$ is continuous\footnote{This hypothesis states the continuity for the topology of \( S\), which is different from the continuity with respect to the topology of \( M\).}, then it is differentiable.
\end{lemma}

\begin{proof}
	Let $p\in V$. By proposition~\ref{PROPooLJYEooMjevio}, we have  a coordinate system $\{x_1,\ldots,x_m\}$ valid on a neighbourhood $N$ of $\varphi(p)$ in $M$ such that the set
	\[
		\{r\in N\tq x_j(r)=0\, \forall s<j\leq m  \}
	\]
	with the restriction of $(x_1,\ldots, x_s)\in N_S$ form a local chart which contains $\varphi(p)$. From the continuity of $\varphi$, there exists a chart $(W,\psi)$ around $p$ such that $\varphi(W)\subset N_S$. The coordinates $x_j(\varphi(q))$ are differentiable functions of  the coordinates of $q$ in $W$. In particular, the coordinates $x_j(\varphi(q))$ for $1\leq j\leq s$ are differentiable and $\dpt{\varphi}{V}{S}$ is differentiable because its expression in a chart is differentiable.
\end{proof}

A consequence of this lemma: if $V$ and $S$ are submanifolds of $M$ with $V\subset S$, and if $S$ has the induced topology from $M$, then $V$ is a submanifold of $S$. Indeed, we can consider the inclusion $\dpt{\iota}{V}{S}$: it is differentiable from $V$ to $M$ and continuous from $V$ to $S$ then it is differentiable from $V$ to $S$ by the lemma. Thus $V=\iota^{-1}(S)$ is a submanifold of $S$ (this is a classical result of differential geometry).

\begin{proposition}[\cite{MonCerveau}]	\label{PROPooNAACooIUMcNw}
	Let \(f \colon M\to \eR  \) be a smooth manifold. Then
	\begin{equation}
		df_m=\sum_{k=1}^n(\partial_kf)(m)\partial^*_k
	\end{equation}
	where \( \partial_k\) is the vector field.
\end{proposition}

\begin{proposition}[\cite{MonCerveau}]	\label{PROPooCGWUooHehCXm}
	Let \( M\) and \( N\) be smooth manifolds. Let \(s \colon M\to N  \) and \(f \colon M\to \eR  \) be smooth maps. If \( X=\gamma'(0)\in T_mM\), we have
	\begin{equation}
		(ds_mX)(f)=\frac{d}{dt} \left[ (f\circ s\circ \gamma)(t)  \right]_{t=0}.
	\end{equation}
	%TODOooHPTRooZYtfgC. Prouver ça.
\end{proposition}


\begin{proposition}[\cite{MonCerveau}]	\label{PROPooYRBRooLFVoqf}
	Let \( M\) be a smooth manifold and two smooth paths \(f \colon M\to \eR  \) and \(\gamma \colon \eR\to M  \). If we consider
	\begin{equation}
		\begin{aligned}
			h\colon \eR & \to \eR                    \\
			t           & \mapsto (f\circ\gamma)(t),
		\end{aligned}
	\end{equation}
	then
	\begin{equation}
		h'(0)=df_{\gamma(0)}\big( \gamma'(0) \big).
	\end{equation}
	%TODOooKDTAooIcDssi. Prouver ça.
\end{proposition}


%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Chain rule and inverse}
%---------------------------------------------------------------------------------------------------------------------------

\begin{lemma}       \label{LEMooEGITooXbAPDe}
	If \( M\) is a \( C^k\) manifold, and if \( \id\colon M\to M\) is the identity map, we have
	\begin{equation}
		d\id_a=\id_{T_aM}.
	\end{equation}
	In other words, the differential of the identity map is the identity.
\end{lemma}

\begin{proof}
	We consider an element \( \nabla_{\gamma}\in T_aM\). Then we compute
	\begin{equation}
		(d\id_a)\gamma'(0)=\frac{d}{dt} \left[ \gamma(t)  \right]_{t=0}=\gamma'(0)=\nabla_{\gamma}.
	\end{equation}
\end{proof}

\begin{lemma}[Chain rule\cite{BIBooJMRFooTAhhcg}]       \label{LEMooGRRAooXxDMuw}
	Let \( M_i\) be \( C^k\) manifolds. If the maps \( g\colon M_1\to M_2\) and \( f\colon M_2\to M_3 \) are \( C^k\), thus the composition \( f\circ g\) is \( C^k\) and for every \( a\in M_1\) we have
	\begin{equation}
		d(f\circ g)_a=df_{g(a)}\circ dg_a.
	\end{equation}
\end{lemma}

\begin{proof}
	Two parts.
	\begin{subproof}
		\spitem[\( f\circ g\) is \( C^k\)]
		%-----------------------------------------------------------
		We consider charts \(\varphi_{\alpha} \colon U_{\alpha}\to M_1  \), \(\sigma_k \colon U_k\to M_2  \) and \(\phi_i \colon U_i\to M_3  \). We have to prove that \(\phi_i^{-1}\circ(f\circ g)\circ\varphi_{\alpha} \colon U_{\alpha}\to U_i  \) is a \( C^k\) map. Introducing the identity as \( \sigma_k\circ\sigma_k^{-1}\) we have
		\begin{equation}
			\phi_i^{-1}\circ(f\circ g)\circ \varphi_{\alpha}=(\phi_i^{-1}\circ f\circ\sigma_k)\circ(\sigma_k^{-1}\circ g\circ\varphi_{\alpha}).
		\end{equation}
		By hypothesis \( f\) and \( g\) are \( C^k\), so \( \phi_i^{-1}\circ f\circ\sigma_k\)  and \( \sigma_k^{-1}\circ g\circ\varphi_{\alpha}\) are \( C^k\). The composition is \( C^k\) by proposition \ref{PROPooLRRMooRzrTNE}.
		\spitem[The formula]
		%-----------------------------------------------------------
		Using the definitions :
		\begin{subequations}
			\begin{align}
				\big( df_{g(a)}\circ dg_a \big)\big( \gamma'(0) \big) & =df_{g(a)}\frac{d}{dt} \left[ (g\circ\gamma)(t)  \right]_{t=0} \\
				                                                      & =\frac{d}{dt} \left[ (f\circ g\circ\gamma)(t)  \right]_{t=0}   \\
				                                                      & =d(f\circ g)_a\gamma'(0).
			\end{align}
		\end{subequations}

	\end{subproof}
\end{proof}


If the differential is bijective, then the function is a local diffeomorphism.
\begin{theorem}[Local inversion\cite{MonCerveau}]	\label{THOooDWEXooMClWVi}
	Let \( M\) and \( N\) be \( C^p\)-manifolds. Let \( f\in C^p(M,N)\) and \( a\in M\) such that \( df_a\) is a bicontinuous bijection. Then there exists open neighbourhood \( V\) of \( a\) and an open neighbourhood \( W\) of \( f(a)\) such that
	\begin{enumerate}
		\item
		      \(f \colon V\to W  \) is bijective and \( C^p\).
		\item
		      \(f^{-1} \colon W\to v  \) is \( C^p\).
	\end{enumerate}
\end{theorem}

\begin{proof}
	The hypothesis is that \(f \colon M\to N  \) est \( C^p\). Thus there exists charts \(\varphi_{\alpha} \colon U_{\alpha}\to M  \) around \( a\) and \(\phi_i \colon U_i\to N  \) around \( f(a)\) such that the map
	\begin{equation}
		g=\phi_i^{-1}\circ f\circ\varphi_{\alpha} \colon U_{\alpha}\to U_i
	\end{equation}
	is \( C^p\). The hypothesis of inversion and continuity of the differential and the formula\footnote{See \ref{NORMooGEFJooALLfTa} for the notations.}
	\begin{equation}
		(d_Mg)_{x_0}=(d\phi_i^{-1})_{f(a)}\circ df_a\circ (d\varphi_{\alpha})_{x_0}
	\end{equation}
	shows that \((d_Mg)_{x_0} \colon T_{x_0}U_{\alpha}\to T_{g(x_0)}U_i  \) is invertible and bicontinuous. From proposition \ref{PROPooORWSooAZsGzz} we know that
	\begin{equation}
		dg_{x_0}=s^{-1}\circ (d_Mg)_{x_0}\circ s
	\end{equation}
	is invertible and bicontinuous. The local inversion theorem \ref{ThoXWpzqCn} says that there is a neighbourhood \( V_{\alpha}\) of \( x_0\) in \( U_{*a}\) and \( V_i\) of \( y_0=(\phi_i^{-1}\circ f\circ\varphi_{\alpha})(x_0)\) such that \(g \colon V_{\alpha}\to V_i  \) is a \( C^p\) bijection. By definition, this means that \( g\) is \( C^p\).
\end{proof}


Due to proposition \ref{PropUssGpGenere}, a local diffeomorphism can often be converted into a global diffeomorphism.


\begin{proposition}[\cite{BIBooJMRFooTAhhcg}]       \label{PROPooPEMLooPQcywG}
	Let \( f\colon M\to N\) be a diffeomorphism between the \( C^k\) manifolds \( M\) and \( N\). For every \( a\in M\), the map \( df_a\colon T_aM\to T_{f(a)}N\) is a vector space isomorphism and the inverse is given by
	\begin{equation}
		(df_a)^{-1}=(df^{-1})_{f(a)}.
	\end{equation}
\end{proposition}

\begin{proof}
	The linearity of \( df_a\) is the proposition \ref{PROPooNRLVooChhiIS}. Since \( f\) is a diffeomorphism we have the equality \( f^{-1}\circ f=\id_M\). Using the chain rule of lemma \ref{LEMooGRRAooXxDMuw} and the differential of the identity of lemma \ref{LEMooEGITooXbAPDe}, we get
	\begin{equation}
		(df^{-1})_{f(a)}\circ df_a=\id.
	\end{equation}
	The same with \( f\circ f^{-1}=\id\) provides
	\begin{equation}
		df_a\circ(df^{-1})_{f(a)}=\id.
	\end{equation}
	This proves that \( df_a\) is invertible and that its inverse is \( (df^{-1})_{f(a)}\).


\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Topology on a tangent space}
%---------------------------------------------------------------------------------------------------------------------------

\begin{propositionDef}[\cite{BIBooDLJSooYWJiIT}]        \label{PROPooHJOXooMGANfd}
	Let \( M\) be a \( C^k\) manifold. Let \( a\in M\) and \( \varphi\colon U\to M\) be a chart around \( a\). We define \( s=\varphi^{-1}(a)\). For \( v\in T_aM\) we define
	\begin{equation}
		\| v \|_{T_aM}=\| (d\varphi_s)^{-1}(v) \|_{\eR^n}.
	\end{equation}
	This is a norm on the vector space \( T_aM\).

	The topology on \( T_aM\) is the one induced by this norm\footnote{Keep in mind that, since \( T_aM\) is finite dimensional, all the norm are equivalent (theorem \ref{ThoNormesEquiv}), so that this norm is not special.}.
\end{propositionDef}

\begin{proof}
	Several points.
	\begin{subproof}
		\spitem[\( \| v \|\geq 0\)]
		From the very definition, yes.
		\spitem[\( \| v \|=0\) si et seulement si \( v=0\)]
		If \( \| v \|=0\), then \( \| (d\varphi_s)^{-1}(v) \|_{\eR^n}=0\). Since the norm on \( \eR^n\) is a norm, this implies \( (d\varphi_s)^{-1}(v)=0\). And since \( d\varphi_s\) is a linear bijection, we conclude \( v=0\).
		\spitem[\( \| \lambda v \|=| \lambda |\| v \|\)]
		Because \( d\varphi_s^{-1}\) is linear.
		\spitem[\( \| v+w \|\leq \| v \|+\| v \|\)]
		Because \( d\varphi_s^{-1}\) is linear and the corresponding property on \( \eR^n\).
	\end{subproof}
\end{proof}

Now we are allowed to write \( \| v \|\) when \( v\in T_aM\). But we have to keep in mind that it depends on the choice of a local chart.

%-------------------------------------------------------
\subsection{Smooth invariance of the domain}
%----------------------------------------------------


\begin{definition}[Regularity on non open domains\cite{BIBooZBZTooYmHemH}]	\label{DEFooLXVNooIpoIBp}
	Let \( M\) be a differential manifold and \( A\subset M\). We say that a map \(f \colon A\to \eR  \) is of class \( C^k\) if there exists an open \( S\) such that \( A\subset S\subset M\) and a map \(f_0 \colon S\to \eR  \) such that \( f_0=f\) on \( A\) and \( f_0\) is of class \( C^k\) on \( S\).
\end{definition}

\begin{theorem}[Smooth invariance of the domain\cite{BIBooNMDMooJyBJzw}]	\label{THOooGUELooSBQhRu}
	Let \( M\) and \( N\) be smooth manifolds of same dimension. Let \( U\subset M\) be open and \( S\subset N\). We consider a \( C^1\)-diffeomorphism\footnote{Definition \ref{DefAQIQooYqZdya}. This is a \( C^1\) map which is bijective and whose inverse is \( C^1\). Here the notions of continuity and differentiability is taken on \( S\) via the "extension" technique, definition \ref{DEFooLXVNooIpoIBp}.} \(f \colon U\to S  \). Then \( S\) is an open part of \( N\).
\end{theorem}

\begin{proof}
	We denote by \( \tau_M\) the topology\footnote{The set of open parts.} of \( M\) and by \( \tau_N\) the topology of $N$

	Let \( s\in S\). We will prove that there exists an open \( A\in \tau_N\) such that \( s\in A\subset S\). The theorem \ref{ThoPartieOUvpartouv} will conclude.

	Let \( p=f^{-1}(s)\). We know that \( f^{-1}\) is \( C^1\) at \( s\) in the sense of extensions. Thus there exists opens parts \( V\in\tau_N\) and \( W\in\tau_M\) containing \( s\) and a diffeomorphism \(g \colon V\to W  \) such that \( g|_{S\cap V}=f^{-1}\). Using the chain rule (lemma \ref{LEMooGRRAooXxDMuw}), for every \( q\in V\cap S\) we have
	\begin{equation}
		dg_{f(q)}\circ df_q=\id.
	\end{equation}
	In particular this is true for \( q=p\): we have \( dg_{f(p)}\circ df_p=\id\). We deduce that the map \(df_p \colon T_pM\to T_{f(p)}N  \) is injective. By proposition \ref{PROPooAAAXooKAMsfK} we have \( \dim(T_pM)=\dim(T_{f(p)}N)\) and \( df_p\) is a vector space isomorphism.

	The local inverse theorem \ref{THOooDWEXooMClWVi} says that \( f\) is a local \( C^1\)-diffeomorphism: there is \( \mO\in\tau_M\) containing \( p\) such that \( f(\mO)\in\tau_N\). More generally, if \( \mO'\in \tau_M\) is contained in \( \mO\), then \( f(\mO')\) is open in \( N\).

	Taking \( \mO'=U\cap\mO\), the part \( f(\mO')\) belongs to \( \tau_N\), contains \( s\) and is contained in \( S\).
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Vector field}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{lemma}       \label{LEMooXFNQooXwCMNB}
	Let \( M\) be a manifold and \( (U,\varphi)\) be a chart and \( \gamma\) be a path. We set \( a=\varphi^{-1}\big( \gamma(0) \big)\), \(v= (\varphi^{-1}\circ\gamma)'(0)\) and
	\begin{equation}
		\begin{aligned}
			\sigma\colon \eR & \to M                  \\
			t                & \mapsto \varphi(a+tv).
		\end{aligned}
	\end{equation}
	Then we have \( \nabla_{\gamma}=\nabla_{\sigma}\).
\end{lemma}

\begin{proof}
	Let \( \phi\in C^k(M, \eR)\).
	\begin{subequations}
		\begin{align}
			\nabla_{\sigma}(\phi) & =\Dsdd{ \phi\big( \sigma(t) \big) }{t}{0}                                                          \\
			                      & =\Dsdd{ (\phi\circ \varphi)\big( a+t(\varphi^{-1}\circ\gamma)'(0) \big) }{t}{0}                    \\
			                      & =\sum_k\partial_k(\phi\circ\varphi)(a)(\varphi^{-1}\circ\gamma)'(0)_k  \label{SUBEQooFDVFooFzACbX} \\
			                      & =\Dsdd{ (\phi\circ\varphi)\big( (\varphi^{-1}\circ\gamma)(t) \big) }{t}{0}                         \\
			                      & =\Dsdd{ (\phi\circ\varphi\circ\varphi^{-1}\circ\gamma)(t) }{t}{0}                                  \\
			                      & =\Dsdd{ (\phi\circ\gamma)(t) }{t}{0}                                                               \\
			                      & =\nabla_{\gamma}(\phi).
		\end{align}
	\end{subequations}
	For \eqref{SUBEQooFDVFooFzACbX}: the maps \( \phi\circ\varphi\colon U\to \eR\) and \( \varphi^{-1}\circ\gamma\colon \eR\to U\) are \( C^k\) maps, so that we can apply the formula \eqref{EQooZMAUooIusxgD}:
\end{proof}

\begin{lemma}       \label{LEMooGPCBooXMTddG}
	Let \( M\) be a manifold, \( (U,\varphi)\) be a chart, \( a\in U\) and \( v,w\in \eR^n\). We define \( \gamma_v(t)=\varphi(a+tv)\) and \( \gamma_w(t)=\varphi(a+tw)\). If \( v\neq w\) then
	\begin{equation}
		\nabla_{\gamma_v}\neq \nabla_{\gamma_w}.
	\end{equation}
\end{lemma}

\begin{proof}
	We suppose \( v\neq w\). If \( w\) is a multiple of \( v\), an adaptation of the «product» part of proposition \ref{PROPooEJBWooSbvypo} shows that \( \nabla_{\gamma_v}\neq \nabla_{\gamma_w}\).

	Of \( v\) and \( w\) are nor aligned, we consider a basis \( \{ e_1,\ldots, e_n \}\) of \( \eR^n\) such that \( e_1=v\) and \( e_2=w\) (theorem \ref{THOooOQLQooHqEeDK}). Now we consider the function
	\begin{equation}
		\begin{aligned}
			f\colon \eR^n & \to \eR          \\
			x             & \mapsto (x-a)_1.
		\end{aligned}
	\end{equation}
	We will show that the result of \( \nabla_{\gamma_v}\) and \( \nabla_{\gamma_w}\) on the function \( f\circ\varphi^{-1}\) are not equal. First we have
	\begin{subequations}
		\begin{align}
			\nabla_{\gamma_v}(f\circ\varphi^{-1}) & =\Dsdd{ (f\circ\varphi^{-1})\big( \gamma_v(t) \big) }{t}{0} \\
			                                      & =\Dsdd{ (f\circ\varphi^{-1}\circ\varphi)(a+tv) }{t}{0}      \\
			                                      & =\Dsdd{ f(a+tv) }{t}{0}                                     \\
			                                      & =\Dsdd{ (tv)_1 }{t}{0}                                      \\
			                                      & =\Dsdd{ t }{t}{0}                                           \\
			                                      & =1.
		\end{align}
	\end{subequations}
	In the same way we get
	\begin{equation}
		\nabla_{\gamma_w}(f\circ\varphi^{-1})=\Dsdd{ f(a+tw) }{t}{0}=\Dsdd{ (tw)_1 }{t}{0}=\Dsdd{ 0 }{t}{0}=0.
	\end{equation}
\end{proof}

\begin{proposition}[\cite{MonCerveau}]	\label{PROPooOSCIooFPRtRg}
	Let \(\varphi_{\alpha} \colon U_{\alpha}\to M  \) be a chart on the \( C^k\) manifold \( M\). We have
	\begin{equation}		\label{EQooHAZUooOBxGLT}
		\frac{d}{dt} \left[\varphi_{\alpha}(x+tv)  \right]_{t=0}=\sum_iv_i\partial_{\alpha,i}.
	\end{equation}
\end{proposition}

\begin{proof}
	We use proposition \ref{PROPooPXTVooKIzptQ}. Let \( r_k=\pr_k\circ\varphi_{\alpha}^{-1}\); we show that
	\begin{equation}		\label{EQooBTSVooLUZJyh}
		\frac{d}{dt} \left[ \varphi_{\alpha}(x+tv)  \right]_{t=0}r_k=\sum_iv_i\partial_i(r_k)
	\end{equation}
	for every \( k\). Thanks to lemma \ref{LEMooBFKIooSPRxZJ}, we immediately get \( v_k\) for the right hand side. We compute the left hand side:
	\begin{subequations}
		\begin{align}
			\frac{d}{dt} \left[ \varphi_{\alpha}(x+tv)  \right]_{t=0}r_k & =\frac{d}{dt} \left[ (\pr_k\circ\varphi_{\alpha}^{-1})\big( \varphi_{\alpha}(x+tv) \big)  \right]_{t=0} \\
			                                                             & =\frac{d}{dt} \left[ \pr_k(x+tv)  \right]_{t=0}                                                         \\
			                                                             & =\frac{d}{dt} \left[ x_k+tv_k  \right]_{t=0}                                                            \\
			                                                             & =v_k.
		\end{align}
	\end{subequations}
	Thus \eqref{EQooBTSVooLUZJyh} is checked and proposition \ref{PROPooPXTVooKIzptQ} concludes that \eqref{EQooHAZUooOBxGLT} is true.
\end{proof}


\begin{proposition}     \label{PROPooMEPPooRonxuh}
	Let \( M\) be a manifold, \( (U, \varphi)\) a chart. If \( s\in U\) the map\footnote{We use the notation \eqref{EQooJQVRooLziKoH}.}
	\begin{equation}        \label{EQooJMTJooZNzREy}
		\begin{aligned}
			\psi\colon \eR^n & \to T_{\varphi(s)}M                  \\
			v                & \mapsto \Dsdd{ \varphi(s+tv) }{t}{0}
		\end{aligned}
	\end{equation}
	is a vector space isomorphism.
\end{proposition}

\begin{proof}
	We need to prove that \( \psi\) is surjective, injective and linear.
	\begin{subproof}
		\spitem[Surjective] Lemma \ref{LEMooXFNQooXwCMNB}.
		\spitem[Injective] Lemme \ref{LEMooGPCBooXMTddG}.
		\spitem[Linear]
		Let \( v,w\in \eR^n\). If set \( \sigma(t)=s+t(v+w)\), we have
		\begin{subequations}
			\begin{align}
				\psi(v+w)\phi & =\Dsdd{ (\phi\circ \varphi)\big( s+t(v+w) \big) }{t}{0}                                                                \\
				              & =\Dsdd{ (\phi\circ \varphi)\circ \sigma(t) }{t}{0}                                                                     \\
				              & =\sum_k\partial_k(\phi\circ\varphi)\big( \sigma(0) \big)\sigma'(0)_k                                                   \\
				              & =\sum_k\partial_k(\phi\circ\varphi)\big( \sigma(0) \big)(v_k+w_k)                                                      \\
				              & =\sum_k\partial_k(\phi\circ\varphi)\big( \sigma(0) \big)v_k+\sum_k\partial_k(\phi\circ\varphi)\big( \sigma(0) \big)w_k \\
				              & =\Dsdd{ (\phi\circ\varphi)\big( \sigma(0)+tv \big) }{t}{0}+\Dsdd{ (\phi\circ\varphi)\big( \sigma(0)+tw \big) }{t}{0}   \\
				              & =\psi(v)\phi+\psi(w)\phi.
			\end{align}
		\end{subequations}
		In the same way, if \( \lambda\in \eR\) we set \( \sigma(t)=s+t\lambda v\) and we have
		\begin{subequations}
			\begin{align}
				\psi(\lambda v)\phi & =\Dsdd{ (\phi\circ\varphi)(s+t\lambda v) }{t}{0}        \\
				                    & =\Dsdd{ (\phi\circ\varphi)\big( \sigma(t) \big) }{t}{0} \\
				                    & =d(\phi\circ\varphi)_{\sigma(0)}\sigma'(0)              \\
				                    & =\lambda d(\phi\circ\varphi)_{\sigma(0)}(v)             \\
				                    & =\lambda\psi(v)\phi.
			\end{align}
		\end{subequations}
	\end{subproof}
\end{proof}


%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Tangent and cotangent bundle}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

If $M$ is a $n$ dimensional manifold, as set the tangent bundle\index{tangent!space} is the \emph{disjoint} union of tangent spaces
\begin{equation}
	TM=\bigcup_{x\in M}T_xM.
\end{equation}


\begin{lemma}[\cite{MonCerveau}]	\label{LEMooLZVTooSvHmjn}
	Let \( M\) be a manifold. We consider the definition charts \( \{ U_{\alpha}, \varphi_{\alpha} \}\) of \( M\), and the map
	\begin{equation}
		\begin{aligned}
			\psi_{\alpha}\colon U_{\alpha}\times \eR^n & \to TM                                         \\
			(x,v)                                      & \mapsto \Dsdd{ \varphi_{\alpha}(x+tv) }{t}{0}.
		\end{aligned}
	\end{equation}
	We have
	\begin{equation}
		\psi_{\alpha}(U_{\alpha}\times \eR^n)=\bigcup_{m\in\varphi_{\alpha}(U_{\alpha})}T_mM.
	\end{equation}
\end{lemma}

\begin{proof}
	The inclusion \( \psi_{\alpha}(U_{\alpha}\times \eR^n)\subset\bigcup_{m\in\varphi_{\alpha}(U_{\alpha})}T_mM\) comes from the fact that the formula \( \frac{d}{dt} \left[ \varphi_{\alpha}(x+tv)  \right]_{t=0}\) is a vector in \( T_{\varphi_{\alpha}(x)}M\) by proposition \ref{PROPooMEPPooRonxuh}.

	For the reverse inclusion, let \( m=\varphi_{\alpha}(x)\), and \( X\in T_mM\). Proposition \ref{PROPooMEPPooRonxuh} shows that there exists \( v\in \eR^n\) such that \( X=\frac{d}{dt} \left[ \varphi_{\alpha}(x+tv)  \right]_{t=0}=\psi_{\alpha}(x,v)\).
\end{proof}


\begin{theorem}[\cite{MonCerveau}]     \label{THOooTSQXooLvJMQb}
	Let \( M\) be a manifold. We consider the definition charts \( \{ U_{\alpha}, \varphi_{\alpha} \}\) of \( M\). Then the set \( TM\) becomes a manifold\footnote{For the vector bundle structure, see proposition \ref{PROPooIMOJooKzEDXA}.} with the maps \( V_{\alpha}=U_{\alpha}\times \eR^n\) and
	\begin{equation}
		\begin{aligned}
			\psi_{\alpha}\colon U_{\alpha}\times \eR^n & \to TM                                         \\
			(x,v)                                      & \mapsto \Dsdd{ \varphi_{\alpha}(x+tv) }{t}{0}.
		\end{aligned}
	\end{equation}
\end{theorem}

\begin{proof}
	We have to check the definition \ref{DEFooVMWRooGQYJwl}. In order to prove that \( TM\) is a topological manifold, we use theorem \ref{THOooFIHIooLiSUxH}.
	\begin{enumerate}
		\item
		      Every element of \( TM\) has the form \( \frac{d}{dt} \left[ \varphi_{\alpha}(x+tv)  \right]_{t=0}\) by proposition \ref{PROPooMEPPooRonxuh}.
		\item
		      The map \( \psi_{\alpha}\) is injective from the same proposition \ref{PROPooMEPPooRonxuh}.
		\item
		      We have to check that
		      \begin{equation}
			      \psi_{\alpha}^{-1}\Big( \psi_{\alpha}(U_{\alpha}\times \eR^n)\cap\psi_{\beta}(U_{\beta}\times \eR^n) \Big)
		      \end{equation}
		      is open. Using lemma \ref{LEMooLZVTooSvHmjn}, and writing \( M_{\alpha}=\varphi_{\alpha}(U_{\alpha})\),
		      \begin{subequations}
			      \begin{align}
				      \psi_{\alpha}(U_{\alpha}\times \eR^n)\cap\psi_{\beta}(U_{\beta}\times \eR^n) & =\bigcup_{m\in M_{\alpha}\cap M_{\beta}}T_mM                                           \\
				                                                                                   & =\psi_{\alpha}\Big( \varphi_{\alpha}^{-1}(M_{\alpha}\cap M_{\beta})\times \eR^n \Big).
			      \end{align}
		      \end{subequations}
		      Thus
		      \begin{equation}
			      \psi_{\alpha}^{-1}\Big( \psi_{\alpha}(U_{\alpha}\times \eR^n)\cap\psi_{\beta}(U_{\beta}\times \eR^n) \Big)=
			      \varphi_{\alpha}^{-1}(M_{\alpha}\cap M_{\beta})\times \eR^n
		      \end{equation}
		      is open.
		\item
		      Now we prove that \( \psi_{\beta}^{-1}\circ\psi_{\beta}\) is continuous. Let \( v=\sum_iv_ie_i\in \eR^n\). We have\footnote{Proposition \ref{PROPooOSCIooFPRtRg}.}
		      \begin{equation}
			      \psi_{\beta}(x,v)=\frac{d}{dt} \left[ \varphi_{\beta}(x+tv)  \right]_{t=0}=\sum_iv_i\partial_{\beta,i}=\sum_iv_i(d\varphi_{\beta})_xe_i.
		      \end{equation}
		      Let use check that
		      \begin{equation}
			      \sum_i(d\varphi_{\beta})_xe_i=	\psi_{\alpha}\Big( (\varphi_{\alpha}^{-1}\circ\varphi_{\beta})(x),\sum_iv_i d(\varphi_{\alpha}^{-1}\circ d\varphi_{\beta})_xe_i   \Big).
		      \end{equation}
		      This is a computation
		      \begin{subequations}
			      \begin{align}
				      \psi_{\alpha}\Big( (\varphi_{\alpha}^{-1}\circ\varphi_{\beta})(x), & (d\varphi_{\alpha}^{-1}\circ d\varphi_{\beta})_xe_i \Big)                                                                                                                          \\
				                                                                         & =\frac{d}{dt} \left[ \varphi_{\alpha}\Big(     (\varphi_{\alpha}^{-1}\circ\varphi_{\beta})(x)+t\sum_iv_i(d\varphi_{\alpha}^{-1}\circ d\varphi_{\beta})_xe_i   \Big)  \right]_{t=0} \\
				                                                                         & =(d\varphi_{\alpha})_{(\varphi_{\alpha}^{-1}\circ \varphi_{\beta})(x)}\Big( \sum_iv_i(d\varphi_{\alpha}^{-1}\circ d\varphi_{\beta})_xe_i \Big)                                     \\
				                                                                         & =\sum_iv_id(\varphi_{\alpha}\circ\varphi_{\alpha}^{-1}\circ\varphi_{\beta})_xe_i                                                                                                   \\
				                                                                         & =\sum_iv_i(d\varphi_{\beta})_xe_i.
			      \end{align}
		      \end{subequations}
		      This shows that
		      \begin{equation}		\label{EQooHAUMooRgHKlL}
			      (\psi_{\alpha}^{-1}\circ\psi_{\beta})(x,v)=\Big( (\varphi_{\alpha}^{-1}\circ\varphi_{\beta})(x),\sum_iv_i(d\varphi_{\alpha}^{-1}\circ d\varphi_{\beta})_xe_i \Big).
		      \end{equation}
		      Since the maps \( \varphi_{\alpha}^{-1}\circ \varphi_{\beta}\) are continuous (even smooth), we see that the maps \( \psi_{\alpha}^{-1}\circ\psi_{\beta}\) are continuous.
	\end{enumerate}
	At this point, we have proved that \( TM\) is a topological manifold. The definition \ref{DEFooVMWRooGQYJwl} still requires \( \psi_{\alpha}^{-1}\circ\psi_{\beta}\) to be smooth. The formula \eqref{EQooHAUMooRgHKlL} shows that.
\end{proof}


\begin{proposition}[\cite{MonCerveau}]	\label{PROPooMDSQooZxwwTd}
	Let \( M\) be a \( C^k\) manifold. We consider a chart \(\varphi_{\alpha} \colon U_{\alpha}\to M  \) and the corresponding chart\footnote{See theorem \ref{THOooTSQXooLvJMQb}.} \(\psi_{\alpha} \colon U_{\alpha}\times \eR^n\to TM  \). We have
	\begin{equation}
		\psi_{\alpha}(x,v)=\frac{d}{dt} \left[ \varphi_{\alpha}(x+tv)  \right]_{t=0}=\sum_iv_i\partial_{\alpha,i}.
	\end{equation}
	%TODOooVRVAooCVxySy. Prouver ça.
\end{proposition}
This is a consequence of \ref{PROPooOSCIooFPRtRg} and \eqref{EQooHBUBooSuKyLm}.


\begin{proposition}[\cite{MonCerveau}]	\label{PROPooZXFMooEYpudy}
	Let \( M\) be a \( C^k\) manifold, \( X\) be a \( C^k\) vector field. Let \(\varphi_{*a} \colon U_{\alpha}\to M  \) be a chart and let \(\psi_{\alpha} \colon U_{\alpha}\times \eR^n\to TM  \) be the corresponding chart of \( TM\).

	There exists a map \(s \colon U_{\alpha}\to \eR^n  \) of class \( C^k\) such that
	\begin{equation}
		(\psi_{\alpha}\circ X\circ\varphi_{\alpha})(x)=\big( x,s(x) \big)
	\end{equation}
	for every \( x\in U_{\alpha}\).
	%TODOooJPWPooFPkXGC. Prouver ça.
\end{proposition}


\begin{proposition}[\cite{MonCerveau}]		\label{PROPooXURIooYPytwa}
	Let \( M\) be a \( C^k\) manifold, and \( \varphi\colon U\to M\) be a local chart. A map \( X\colon M\to TM\) is a \( C^k\) vector field\footnote{The differential structure on \( TM\) is given by the theorem \ref{THOooTSQXooLvJMQb}.} on \( \varphi(U)\) if and only there exists \( C^k\) maps \(v_i \colon M\to \eR  \) such that
	\begin{equation}
		X_m=\sum_{i=1}^nv_i(m)\partial_i
	\end{equation}
	where the vectors \( \partial_{i}\) are defined in \ref{DEFooUWWWooXhHVXP}.
\end{proposition}

\begin{proof}
	Two parts.
	\begin{subproof}
		\spitem[\( \Rightarrow\)]
		%-----------------------------------------------------------
		Let \(X \colon M\to TM  \) be a \( C^k\) vector field. It means that the map \(f=\psi_{\alpha}\circ X\circ\varphi_{\alpha} \colon U_{\alpha}\to U_{\alpha}\times \eR^n  \) is \( C^k\). Thus from proposition \ref{PROPooZXFMooEYpudy} that there exists a \( C^k\) map \(s \colon U_{\alpha}\to \eR^n  \) such that \( f(x)=\big( x,s(x) \big)\). For every \( m\in \varphi_{\alpha}(U_{\alpha}) \) we have
		\begin{subequations}
			\begin{align}
				X_m & =(\psi_{\alpha}\circ f\circ \varphi_{\alpha}^{-1})(x)                                                                                                              \\
				    & =\psi_{\alpha}\big( \varphi_{\alpha}^{-1}(m),(s\circ\varphi_{\alpha}^{-1})(m) \big)                                                                                \\
				    & =\frac{d}{dt} \left[ \varphi_{\alpha}\Big( \varphi_{\alpha}^{-1}(m)+t(s\circ\varphi_{\alpha}^{-1})(m) \Big)  \right]_{t=0}                                         \\
				    & = \sum_i(s_i\circ\varphi_{\alpha}^{-1})(m)\partial_{m,i}                                                                   & \text{prop. \ref{PROPooMDSQooZxwwTd}}
			\end{align}
		\end{subequations}
		The map \( s\) being \( C^k\), by definition of differentiability on a manifold, the map \( s_i\circ\varphi_{\alpha}^{-1}\) is \( C^k\).

		\spitem[\( \Leftarrow\)]
		%-----------------------------------------------------------
		Let \(v_i \colon M\to \eR  \) be \( C^k\) maps such that \( X_m=\sum_iv_i(m)\partial_i\). We prove that the map \(\psi_{\alpha}^{-1}\circ X\circ \varphi_{\alpha} \colon U_{\alpha}\to U_{\alpha}\times \eR^n  \) is \( C^k\). Writing \( s=v\circ\varphi_{\alpha}\) we have
		\begin{subequations}
			\begin{align}
				(\psi_{\alpha}^{-1}\circ X\circ\varphi_{\alpha})(x) & =\psi_{\alpha}^{-1}\big( X_{\varphi_{\alpha}(x)} \big)                                  \\
				                                                    & =\psi_{\alpha}^{-1}\Big( \sum_i(v_i\circ \varphi_{\alpha})(x)\partial_{\alpha, i} \Big) \\
				                                                    & =\psi_{\alpha}^{-1}\big( \sum_is_i(x)\partial_i \big).
			\end{align}
		\end{subequations}
		From the hypothesis, \(v \colon U_{\alpha}\to \eR^n  \) is \( C^k\). Thus \( s=v\circ\varphi_{\alpha}\) is \( C^k\).
	\end{subproof}
\end{proof}


\begin{lemma}[\cite{MonCerveau}]        \label{LEMooZWFAooDlYaJm}
	Let \( M\) be a \( C^k\) manifold, and \( \varphi\colon U\to M\) be a local chart. A map \( X\colon M\to TM\) is a \( C^k\) vector field on \( \varphi(U)\) if and only it can be written under the form
	\begin{equation}
		X_m(f)=\sum_{i=1}^nv_i(m)\partial_i(f\circ\varphi)\big( \varphi^{-1}(m) \big)
	\end{equation}
	for some \( C^k\) maps \( v_i\colon M\to \eR\).
\end{lemma}

\begin{proof}
	Two parts.
	\begin{subproof}
		\spitem[\( \Rightarrow\)]
		%-----------------------------------------------------------
		The proposition \ref{PROPooXURIooYPytwa} says that there exists \( C^k\) maps \( v_i \colon M\to \eR   \) such that \( X_m=\sum_iv_i(m)\partial_i\). If we apply that to \(f \colon M\to \eR  \) we get
		\begin{subequations}
			\begin{align}
				X_m(f) & =\sum_iv_i(m)(\partial_if)(m)                                                                                              \\
				       & =\sum_iv_i(m)\partial_i(f\circ\varphi_{\alpha})\big( \varphi_{\alpha}^{-1}(m) \big) & \text{prop \ref{PROPooERIQooBWWbkX}}
			\end{align}
		\end{subequations}

		\spitem[\( \Leftarrow\)]
		%-----------------------------------------------------------
		We suppose that we have \( C^k\) maps \(v_k \colon M\to \eR  \) such that
		\begin{equation}
			X_m(f)=\sum_iv_i(m)\partial_i(f\circ\varphi_{\alpha})\big( \varphi_{\alpha}^{-1}(m) \big).
		\end{equation}
		We have to prove that \(X \colon M\to TM  \) is \( C^k\). From the equality \eqref{EQooMCBOooBBupHl}, we have
		\begin{equation}
			X_m(f)=\sum_iv_i(m)(\partial_if)(m),
		\end{equation}
		or \( X_m=\sum_iv_i(m)\partial_i\) and the proposition \ref{PROPooXURIooYPytwa} concludes.
	\end{subproof}
\end{proof}

\begin{lemma}       \label{LEMooIQZWooOSLNXB}
	If \( x\in M\) and \( v\in \eR^n\). The isomorphism \( \psi\) of proposition \ref{PROPooMEPPooRonxuh} satisfies
	\begin{equation}        \label{EQooBVOBooBTfYWC}
		\psi(v)f=\sum_kv_k\partial_k(f\circ\varphi)(s)
	\end{equation}
	where \( s=\varphi^{-1}(x)\).
\end{lemma}

\begin{proof}
	We use the linearity of proposition \ref{PROPooMEPPooRonxuh}:
	\begin{subequations}
		\begin{align}
			\psi(v)f & =\sum_kv_k\psi(e_k)f                                  \\
			         & =\sum_kv_k\Dsdd{ f\big( \varphi(s+te_k) \big) }{t}{0} \\
			         & =\sum_kv_k\Dsdd{ (f\circ\varphi)(s+te_k) }{t}{0}      \\
			         & =\sum_kv_k\partial_k(f\circ\varphi)(s).
		\end{align}
	\end{subequations}
\end{proof}


\begin{proposition}[\cite{MonCerveau}]	\label{PROPooYGHAooWOXbRu}
	Let \( M\) be a \( C^k\) manifold and \(X \colon M\to TM  \) be a vector field. If
	\begin{equation}
		m\mapsto X_m(r_i)
	\end{equation}
	is \( C^k\) for every \( i\), then \( X\) is \( C^k\).
\end{proposition}

\begin{proof}
	We know from proposition \ref{PROPooAAAXooKAMsfK} that \( X_m\) can be written under the form \( X_m=\sum_kv_k(m)\partial_k\). The proposition \ref{PROPooXURIooYPytwa} says that \( X\) will be \( C^k\) if \( m\mapsto v_k(m)\) is \( C^k\). Using lemma \ref{LEMooBFKIooSPRxZJ} we have
	\begin{equation}
		X_m(r_i)=\sum_kv_k(m)\partial_k(r_i)=\sum_kv_k(m)\delta_{ik}=v_i(m).
	\end{equation}
	Since \( m\mapsto X_m(r_i)\) is \( C^k\), we deduce that \( m\mapsto v_i(m)\) is \( C^k\).
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Vector field}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}[Vector field]        \label{DEFooAATTooLhNqDb}
	Let \( M\) be a \(  C^{\infty}\) manifold. A \defe{vector field}{vector field} is a map \( X\colon M\to TM\) such that \( X(p)\in T_pM\) for every \( p\in M\).

	We will often write \( X_p\) instead of \( X(p)\).
\end{definition}

\begin{lemma}       \label{LEMooLNIAooCmbLQp}
	Let \( X\) be a smooth vector field on \( M\). Let \( p\in M\) such that \( X_p\neq 0\). There exists a local chart \( \varphi\colon U\to M\) around \( p\) such that \( X=\partial_1\) in that chart. More precisely, for every \( q\in \varphi(U)\) and every smooth function \( f\) on \( M\) we have
	\begin{equation}
		X_q(f)=\partial_1(f\circ \varphi)\big( \varphi^{-1}(q) \big).
	\end{equation}
\end{lemma}


\begin{proposition}			\label{PROPooMDDPooXeQwrH}
	The projection
	\begin{equation}
		\begin{aligned}
			\pi \colon TM & \to M     \\
			T_pM          & \mapsto p
		\end{aligned}
	\end{equation}
	is a submersion.
	%TODOooJQWMooEhEmnk. Prouver ça.
\end{proposition}

The structure is easy to guess. If $\dpt{\varphi_{\alpha}}{\mU_{\alpha}}{M}$ is a coordinate system on $M$ (with $\mU_{\alpha}\subset\eR^n$), we define $\dpt{\psi_{\alpha}}{\mU_{\alpha}\times \eR^n}{TM}$ by
\[
	\psi( \underbrace{x_1,\ldots, x_n}_{\in\mU_{\alpha}},\underbrace{a_1,\ldots, a_n}_{\in\eR^n}  )
	=\sum_i a_i\left.\dsd{}{x_i}\right|_{\varphi(x_1,\ldots,x_n)}.
\]
The map $\psi_{\beta}^{-1}\circ\psi_{\beta}$ is differentiable because
\[
	(\psi_{\beta}^{-1}\circ\psi_{\beta})(x,a)=( y(x),\sum_i a_i\left.\dsd{y_j}{x_i}\right|_{y(x)}  )
\]
which is a composition of differentiable maps. The set $TM$ endowed with this structure is called the \defe{tangent bundle}{tangent!bundle}.


%-------------------------------------------------------
\subsection{Dual basis}
%----------------------------------------------------


\begin{definition}[dual basis]		\label{DEFooZNHIooKIpND}
	The vectors\footnote{Definition \ref{PROPooAAAXooKAMsfK}.} \( \{ \partial_{\alpha,i} \}_{i=1,\ldots,n}\) make a basis of \( T_pM\). We denote by \( \{ \partial^*_{\alpha, i} \}_{i=1,\ldots,n}\) the dual basis.
\end{definition}

\begin{lemma}[\cite{MonCerveau}]		\label{LEMooSZTOooBIzMCc}
	Let \( M\) be a \( C^k\) manifold. We consider two charts \(\varphi_{\alpha} \colon U_{\alpha}\to M  \) and \(\varphi_{\beta} \colon U_{\beta}\to M  \). For \( x\in \varphi_{\alpha}(U_{\alpha})\cap \varphi_{\beta}(U_{\beta})\), we have
	\begin{equation}		\label{EQooQNRRooKkCkLE}
		\partial^*_{\alpha,i}(\partial_{\beta,j})_x=(d(\varphi_{\alpha}^{-1}\circ \varphi_{\beta})_{\varphi_{\beta}^{-1}(x)})_{ij},
	\end{equation}
	and
	\begin{equation}		\label{EQooAGFKooWwWdAf}
		(\partial_{\alpha, 1}^*\wedge\ldots \wedge\partial_{\alpha,n}^*)(\partial_{\beta,1},\ldots,\partial_{\beta,n})=\det\big( d(\varphi_{\alpha}^{-1}\circ\varphi_{\beta})_{\varphi_{\beta}^{-1}(x)} \big).
	\end{equation}
\end{lemma}

\begin{proof}
	Let \( x\in \varphi_{\alpha}(U_{\alpha})\cap \varphi_{\beta}(U_\beta)=M_{\alpha\beta}\), \( a=\varphi_{\alpha}^{-1}(x)\) and \( b=\varphi_{\beta}^{-1}(x)\). If \( t\) is small enough to keep \( \varphi_{\beta}(b+te_j)\in M_{\alpha\beta}\) we have

	\begin{subequations}		\label{SUBEQSooYFBPooPFeuLy}
		\begin{align}
			\partial_{\beta,j} & =\frac{d}{dt} \left[ \varphi_{\beta}(b+te_j)  \right]_{t=0}                                                \\
			                   & =\frac{d}{dt} \left[ \varphi_{\alpha}\circ\varphi_{\alpha}^{-1}\circ\varphi_{\beta}(b+te_j)  \right]_{t=0} \\
			                   & =(d\varphi_{\alpha})_a\frac{d}{dt} \left[ \varphi_{\alpha\beta}(b+te_j)  \right]_{t=0}                     \\
			                   & =(d\varphi_{\alpha})_a\Big( (d\varphi_{\alpha\beta})_b(e_j) \Big).
		\end{align}
	\end{subequations}
	Dropping some index, we denote by \( (d\varphi_{\alpha\beta})_{ij}\) the matrix elements of the linear map \((d\varphi_{\alpha\beta})_b \colon \eR^n\to \eR^n  \), so that
	\begin{equation}
		(d\varphi_{\alpha\beta})e_j=\sum_k(d\varphi_{\alpha\beta})_{kj}e_k.
	\end{equation}
	Plugging in \eqref{SUBEQSooYFBPooPFeuLy} we find
	\begin{equation}
		\partial_{\beta,j}=\sum_k(d\varphi_{\alpha\beta})_{kj}\underbrace{(d\varphi_{\alpha})e_k}_{=\partial_{\alpha,k}}=\sum_k(d\varphi_{\alpha\beta})_{kj}\partial_{\alpha,k}.
	\end{equation}
	We can finish the computation:
	\begin{equation}
		\partial_{\alpha,i}^*(\partial_{\beta,j})=\sum_k(d\varphi_{\alpha\beta})_{kj}\underbrace{\partial_{\alpha,i}^*(\partial_{\alpha,k})}_{=\delta_{ik}}=(d\varphi_{\alpha\beta})_{ij}.
	\end{equation}
	This proves equation \eqref{EQooQNRRooKkCkLE}. Now the formula \eqref{EQooAGFKooWwWdAf} is given by proposition \ref{PROPooRRSZooJXOApq}.
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Field of basis}
%---------------------------------------------------------------------------------------------------------------------------


\begin{propositionDef}		\label{PROPooMLSCooEGemdf}
	Let \( M\) be a \( C^k\) manifold, and \(\varphi_{\alpha} \colon U_{\alpha}\to M  \) be a chart. For \( p\in M\) we define
	\begin{equation}
		(\partial_{\alpha, i})_p=\frac{d}{dt} \left[ \varphi_{\alpha}(t_0+te_i)  \right]_{t=0}
	\end{equation}
	where \( t_0=\varphi_{\alpha}^{-1}(p)\) and \( \{ e_i \}\) is the canonical basis of \( \eR^n\).

	The vector field \( p\mapsto (\partial_i)_{\alpha,p}\) is \( C^k\).

	Most the time we will simply we will write \( \partial_i\), dropping the indices \( \alpha\) and \( p\).
\end{propositionDef}

\begin{propositionDef}		\label{PROPooGSTWooPvvwIF}
	Let \( M\) be a \( C^k\) manifold, and \(\varphi_{\alpha} \colon U_{\alpha}\to M  \) be a chart. For each \( p\in M\) we consider the basis\footnote{See definition \ref{PROPooMLSCooEGemdf}.} \( \{ (\partial_i)_{\alpha,p} \}\) of \( T_pM\), and the dual basis \( \{ (\alpha_i)_{\alpha,p} \}\) of \( T^*_pM\).

	\begin{equation}
		\begin{aligned}
			\alpha_i\colon M & \to T^*M                      \\
			p                & \mapsto (\alpha_i)_{\alpha,p}
		\end{aligned}
	\end{equation}
	are \( C^k\).
\end{propositionDef}


\begin{lemma}       \label{LEMooVCSJooEuDZFz}
	Let \( M\) and \( N\) be smooth manifolds of dimension \( m\) and \( n\) with charts \( \varphi\colon U\to M\) and \( \psi\colon V\to N\) around \( p\in M\) and \( f(p)\in N\). We consider basis \( \{ e_i \}_{i=1,\ldots, m}\) of \( \eR^m\) and \( \{ e'_{\alpha} \}_{\alpha=1,\ldots, n}\) of \( \eR^n\).

	The matrix of \( df_p\colon T_pM\to T_{f(p)}N\) in the basis \( \{ d\varphi_{\varphi^{-1}(p)}(e_i) \}\) and \( \{ d\psi_{\psi^{-1}(f(p))}(e'_{\alpha}) \}\) is the same as the matrix of \( d(\psi^{-1}\circ f\circ\varphi)_{\varphi^{-1}(p)}\) as map from \( \eR^m\) to \( \eR^n\).
\end{lemma}

\begin{proof}
	Let subdivise.
	\begin{subproof}
		\spitem[Notations]
		As a preliminary remark, the fact that the proposed sets are basis is the proposition \ref{PROPooKMCGooDEuaWz}\ref{ITEMooSFUBooNXgGuu}. For the notations, we write
		\begin{subequations}
			\begin{align}
				\frac{ \partial  }{ \partial x_i }        & =d\varphi_{\varphi^{-1}(p)}(e_i),                \\
				\frac{ \partial  }{ \partial y_{\alpha} } & =d\psi_{\psi^{-1}\big( f(p) \big)}(e'_{\alpha}).
			\end{align}
		\end{subequations}
		\spitem[Component]
		Let \( v\in T_{f(p)}N\). We prove that
		\begin{equation}        \label{EQooISXNooJOzUmS}
			v_{\alpha}=\Big( (d\psi^{-1})_{f(p)}v \Big)_{\alpha}
		\end{equation}
		where in the left-hand side we are speaking of component with respect to the basis \( \{ \partial_{y_{\alpha}} \}\) while in the right-hand side, the ones with respect to the basis \( \{ e'_{\alpha} \}\).

		First we decompose \( v\):
		\begin{equation}
			v=\sum_{\alpha}v_{\alpha}\frac{ \partial  }{ \partial y_{\alpha} }=\sum_{\alpha}v_{\alpha}d\psi_{\psi^{-1}\big( f(p) \big)}e'_{\alpha},
		\end{equation}
		then we apply \( d\psi^{-1}_{f(p)}\) to that equation:
		\begin{equation}
			d\psi^{-1}_{f(p)}v=\sum_{\alpha}v_{\alpha}e'_{\alpha}.
		\end{equation}
		Taking the \( \alpha\)\th\ component on both side we have our result \eqref{EQooISXNooJOzUmS}.
		\spitem[Matrix]
		The matrix of a linear map is defined by the proposition \ref{PROPooGXDBooHfKRrv}. In our case,
		\begin{equation}
			(df_p)_{\alpha i}=\left( df_p\big( \frac{ \partial  }{ \partial x_i } \big) \right)_{\alpha} =\Big( df_p\circ d\varphi_{\varphi^{-1}(p)}e_i \Big)_{\alpha}.
		\end{equation}
		Using the formula \eqref{EQooISXNooJOzUmS},
		\begin{subequations}
			\begin{align}
				(df_p)_{\alpha i} & =\Big( df_p\circ d\varphi_{\varphi^{-1}(p)}e_i \Big)_{\alpha}                          \\
				                  & =\big( (d\psi^{-1})_{f(p)}\circ df_p\circ d\varphi_{\varphi^{-1}(p)}e_i \big)_{\alpha} \\
				                  & =\big( (d\psi^{-1})_{f(p)}\circ df_p\circ d\varphi_{\varphi^{-1}(p)} \big)_{\alpha i}  \\
			\end{align}
		\end{subequations}
	\end{subproof}
\end{proof}


\begin{lemma}       \label{LEMooPSWEooVKLWMQ}
	If \( X\) is a \( C^k\) vector field on the \( C^k\) manifold \( M\) and if \( f\) is a \( C^k\) function, then the map
	\begin{equation}
		\begin{aligned}
			Xf\colon M & \to \eR        \\
			x          & \mapsto X_x(f)
		\end{aligned}
	\end{equation}
	is \( C^{k-1}\).
	%Note : il faut faire LEMooZWFAooDlYaJm d'abord.
	%TODOooCVZFooNHYvmC. Il faut prouver ça.
\end{lemma}

\begin{proposition}		\label{PROPooVZNUooVoyFnx}
	Let \( \{ e_i \}\) be a \( C^k\) field of basis on an open set around \( x\in M\). Let \( X\) be a \( X^k\) vector field on \( M\). For each \( i\), the map
	\begin{equation}
		\begin{aligned}
			g\colon M & \to \eR        \\
			x         & \mapsto X(x)_i
		\end{aligned}
	\end{equation}
	is \( C^k\).
	%TODOooQESZooEAHbgn. Prouver ça. J'en mets plusieurs avec le même parce que je suis quasiment certain que quand on arrivera, ce sera parti.
\end{proposition}

\begin{proposition}		\label{PROPooLAQTooRHYmqy}
	Let \( M\) be a \( C^k\) manifold. Let \( \{ e_i \}\) be a \( C^k\) field of basis of \( TM\). The projection map
	\begin{equation}
		\begin{aligned}
			\pr_i\colon TM & \to \eR     \\
			v              & \mapsto v_i
		\end{aligned}
	\end{equation}
	is \( C^k\).
	%TODOooQESZooEAHbgn. Prouver ça. J'en mets plusieurs avec le même parce que je suis quasiment certain que quand on arrivera, ce sera parti.
\end{proposition}


\begin{proposition}		\label{PROPooYPLLooZaQEMx}
	Let \(f \colon M\to N  \) be a \( C^k\) map. The map
	\begin{equation}
		\begin{aligned}
			\det(ds)\colon M & \to \eR            \\
			x                & \mapsto \det(ds_x)
		\end{aligned}
	\end{equation}
	is \( C^{k-1}\)
	%TODOooQESZooEAHbgn. Prouver ça. J'en mets plusieurs avec le même parce que je suis quasiment certain que quand on arrivera, ce sera parti.
\end{proposition}


\begin{proposition}[\cite{MonCerveau}]		\label{PROPooNTSLooCXQQXy}
	Let \(f \colon M\to N  \) be a \( C^k\) map between \( C^k\) manifolds. If \( X\) is a \( C^k\) vector field on \( M\), then the map
	\begin{equation}
		\begin{aligned}
			f\colon M & \to TN            \\
			x         & \mapsto (df)_xX_x
		\end{aligned}
	\end{equation}
	is \( C^{k-1}\).
	%TODOooQESZooEAHbgn. Prouver ça. J'en mets plusieurs avec le même parce que je suis quasiment certain que quand on arrivera, ce sera parti.
\end{proposition}

%-------------------------------------------------------
\subsection{Commutator of vector fields}
%----------------------------------------------------


\begin{propositionDef}      \label{DEFooHOTOooRaPwyo}
	Let \( M\) be a \( C^k\) manifold with \( k\geq 2\). Let $X$, $Y\in\cvec(M)$.
	\begin{enumerate}
		\item       \label{ITEMooZKKUooQjYftU}
		      For every \( x\in M\), the operator \( [X,Y]_x\) defined by
		      \begin{equation}        \label{EQooDSKWooXdjPPP}
			      [X,Y]_xf=X_x(Yf)-Y_x(Xf)
		      \end{equation}
		      is an element of \( T_xM\).

		      Here, \( Yf\) and \( Xf\) are defined by virtue of lemma \ref{LEMooPSWEooVKLWMQ}.
		\item       \label{ITEMooPGPLooQrKxWY}
		      The map \( x\mapsto [X,Y]_x\) is a vector field of class \( C^{k-1}\).
	\end{enumerate}

	The so-defined vector field \( [X,Y]\) is the \defe{commutator}{commutator of vector fields} of \( X\) and \( Y\).
\end{propositionDef}

\begin{proof}
	Point by point.
	\begin{subproof}
		\spitem[\ref{ITEMooZKKUooQjYftU}]
		From lemma \ref{LEMooZWFAooDlYaJm}, we have \( C^k\) functions \( v_k\colon M\to \eR\) such that
		\begin{equation}
			X_x(f)=\sum_kv_k(x)\partial_k(f\circ \varphi)\big( \varphi^{-1}(x) \big),
		\end{equation}
		and the same for \( Y\) :
		\begin{equation}
			Y_y(f)=\sum_lw_l(y)\partial_l(f\circ\varphi)\big( \varphi^{-1}(y) \big).
		\end{equation}
		We need to compute \( X_x(Yf)\), that is
		\begin{equation}        \label{EQooAHMYooWRttQr}
			X_x(Yf)=\sum_kv_k(x)\partial_k(Yf\circ\varphi)\big( \varphi^{-1}(x) \big).
		\end{equation}
		The easy part of that is
		\begin{equation}
			(Yf\circ\varphi)(s)=(Yf)\big( \varphi(s) \big)=\sum_l(w_l\circ\varphi)(s)\partial_l(f\circ \varphi)(s).
		\end{equation}
		This is a product of two functions \( w_l\circ\varphi\colon U\to \eR\) and \( f\circ\varphi\colon U\to \eR\). For computing the partial derivative, we use the usual Leibniz rule :
		\begin{equation}
			\partial_k(Yf\circ\varphi)(s)=\sum_{l}\partial_k(w_l\circ\varphi)(s)\partial_l(f\circ\varphi)(s)+\sum_l(w_l\circ\varphi)(s)\partial_k\partial_l(f\circ\varphi)(s).
		\end{equation}
		We can put that in \eqref{EQooAHMYooWRttQr}, with the definition \( s=\varphi^{-1}(x)\in U\subset \eR^n\) :
		\begin{subequations}
			\begin{align}
				X_x(Yf) & =\sum_kv_k(x)\sum_l\partial_k(w_l\circ\varphi)(s)\partial_l(f\circ\varphi)(s)    \\
				        & \quad +\sum_{kl}v_k(x)(w_l\circ\varphi)(s)\partial_k\partial_l(f\circ\varphi)(s) \\
				        & =\sum_{kl}v_k(x)\partial_k(w_l\circ\varphi)(s)\partial_l(f\circ\varphi)(s)       \\
				        & \quad+\sum_{kl}v_k(x)w_l(x)\partial_k\partial_l(f\circ\varphi)(s).
			\end{align}
		\end{subequations}
		The expression of \( Y_x(Xf)\) is the same, permuting \( v\) and \( w\). The commutator has \( 4\) terms :
		\begin{equation}
			\begin{aligned}[]
				[X,Y]_xf & =\sum_{kl}v_k(x)\partial_k(w_l\circ\varphi)(s)\partial_l(f\circ\varphi)(s)       \\
				         & \quad+\sum_{kl}v_k(x)w_l(x)\partial_k\partial_l(f\circ\varphi)(s)                \\
				         & \quad -\sum_{kl}w_k(x)\partial_k(v_l\circ\varphi)(s)\partial_l(f\circ\varphi)(s) \\
				         & \quad -\sum_{kl}w_k(x)v_l(x)\partial_k\partial_l(f\circ\varphi)(s).
			\end{aligned}
		\end{equation}
		By virtue of theorem \ref{Schwarz}, the two terms with second derivatives cancel out because the maps are of class \( C^k\) with \( k\geq 2\). Only two terms remain :
		\begin{equation}
			[X,Y]_xf=\sum_l\big[ \sum_kv_k(x)\partial_k(w_l\circ\varphi)(s)-w_k(x)\partial_k(v_l\circ\varphi)(s) \big].
		\end{equation}
		We pose
		\begin{equation}
			\begin{aligned}
				u_l\colon M & \to \eR                                                                                                                                               \\
				x           & \mapsto  \sum_k\big[ v_k(x)\partial_k(w_l\circ\varphi)\big( \varphi^{-1}(x) \big)-w_k(x)\partial_k(v_l\circ\varphi)\big( \varphi^{-1}(x) \big) \big].
			\end{aligned}
		\end{equation}
		For each \( x\) we have
		\begin{equation}        \label{EQooVUOKooAyGoae}
			[X,Y]_x(f)=\sum_lu_l(x)\partial_l(f\circ\varphi)(s).
		\end{equation}
		By lemma \ref{LEMooSCVHooYPiGse}, this means that \( [X,Y]_x\in T_xM\).

		\spitem[\ref{ITEMooPGPLooQrKxWY}]

		Now the functions \( u_l\) are of of class \( C^{k-1}\) (theorem \ref{THOooPZTAooTASBhZ}) which satisfies, so that the lemma \ref{LEMooPSWEooVKLWMQ} makes \( [X,Y] \) a vector field of class \( C^{k-1}\).
	\end{subproof}
\end{proof}


\begin{lemma}
	Let \( M\) be a smooth manifold\footnote{When one deal with commutators, the natural setting is (at least) \(  C^{\infty}\) manifolds since the bracket diminishes by \( 1\) the regularity of the vector fields.}. Let \( X,Y\) be smooth vector fields given by \( X=\psi\circ v\) and \( Y=\psi\circ w\). Then we have
	\begin{equation}
		[\psi\circ v,\psi\circ w]=\psi\circ u
	\end{equation}
	with
	\begin{equation}
		\begin{aligned}
			u_l\colon \varphi(U) & \to \eR                    \\
			x                    & \mapsto X_x(w_l)-Y_x(v_l).
		\end{aligned}
	\end{equation}
	This equation can be shorthanded into
	\begin{equation}
		u=X(w)-Y(v).
	\end{equation}
\end{lemma}

\begin{proof}
	We start from the expression \ref{EQooVUOKooAyGoae} in which we substitute the values of \eqref{LEMooZWFAooDlYaJm} :
	\begin{equation}
		u_l(x)=\sum_k\underbrace{v_k(x)\partial_k(w_l\circ\varphi)(s)}_{=X_x(w_l)}-w_k(x)\partial_k(v_l\circ\varphi)(s)=X_x(w_l)-Y_x(v_l).
	\end{equation}
\end{proof}
