% This is part of (almost) Everything I know in mathematics
% Copyright (c) 2013-2014
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
					\section{Dimensions}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

%---------------------------------------------------------------------------------------------------------------------------
					\subsection{Finite and infinite projections}
%---------------------------------------------------------------------------------------------------------------------------

A projection in a factor is \defe{infinite}{infinite!projection}\index{projection!finite or infinite} if it is equivalent to a proper subprojection; it is \defe{finite}{finite!projection} is it is not infinite. The notion of finite and infinite projections descents to the equivalence classes. A factor is \defe{finite}{finite!factor} when the identity is finite.

\begin{proposition}
If $P$ and $Q$ are projections with $P\leq Q$ and $Q$ is finite, then $P$ is finite.
\end{proposition}

\begin{proof}
Assume that $P$ is infinite, that is there exists a projection $P'<P$ with $P\sim P'$. So we have $P'<P\leq Q$ and there exists a $v\in\hH$ such that $Qv=v$, $Pv=v$ and $P'v=0$. Thus we have
\[ 
	Q=P+(Q-P)\sim P'+(Q-P)<Q,
\]
the last inequality being assured by the vector $v$. What we proved is that $Q$ is equivalent to a subprojection of itself, which contradicts the fact that $Q$ is finite.
\end{proof}

\begin{corollary}
Let $\alpha$, $\beta\in\dim M$. If $\alpha$ is finite and $\beta$ infinite, then $\alpha\leq\beta$.
\end{corollary}

If $\alpha=[P]$ and $\beta=[Q]$ with $PQ=0$, we define $\alpha+\beta=[P+Q]$. We denote by $n\alpha$ the sum
\begin{equation}
	n\alpha=\underbrace{\alpha+\cdots+\alpha}_{\text{$n$ times}},
\end{equation}
$n\in\eN$. If $n\alpha$ exists for every positive integer $n$, we write
\[ 
  \infty\alpha=\bigvee_{n=1}^{\infty}n\alpha.
\]

\begin{proposition}
The sum $\alpha+\beta$ fulfils
\begin{enumerate}
\item If $\alpha+\beta$ exists, then it is independent of the representative $P$ and $Q$ in $\alpha$ and $\beta$,
\item It is commutative and associative: $\alpha+\beta=\beta+\alpha$ and $\alpha+(\beta+\gamma)=(\alpha+\beta)+\gamma$,
\item zero is the neutral: $\alpha+[0]=\alpha$.
\end{enumerate}
\end{proposition}

\begin{proof}
No proof.
\end{proof}

\begin{lemma}
If $\alpha$ and $\beta$ are finite, then $\alpha+\beta$ is finite when it exists.
\end{lemma}
\begin{proof}
No proof.
\end{proof}

\begin{lemma}
If $\alpha$ is finite and $\beta$ is infinite, then
\begin{enumerate}
\item $\infty\alpha$ exists,
\item $\infty\alpha=\beta$.
\end{enumerate}
In particular, all the infinite projections are equivalent each other.
\end{lemma}

\begin{proof}
Since $\beta$ is infinite and $\alpha$ is finite, the projection $\beta$ contains a subprojection equivalent to $\alpha$. What remains in $\beta$ is still an infinite projection, and thus still contains a subprojection equivalent to $\alpha$. Let $\alpha=[P]$ and $\beta=[Q]$. We have
\[ 
  Q=\big( \sum_nP_n \big)+R
\]
where for each $n$, the projection $P_n$ is equivalent to $P$, and $R$ is a finite projection which does not contain a subprojection equivalent to $P$. Thus $P$ contains a subprojection equivalent to $R$.

Notice that $\beta$ can only contain a countable number of copies of $\alpha$ because one only has a countable number of basis vectors in a separable Hilbert space.

Let us consider the projection
\begin{equation}
	\beta'=[Q-R]=[\sum P_n]=\infty\alpha.
\end{equation}
One can construct a partial isometry implementing an equivalence between $\beta$ and $\beta'$ using an Hilbert hotel argument.
\begin{probleme}
This proof has to be finished.
\end{probleme}
\end{proof}

\begin{lemma}	\label{LemVstarVPP}
If $P$ is a projection and if $V^*V=P$, then $V$ vanishes on the target space of $P^{\perp}$.
\end{lemma}

\begin{proof}
It is evident that $V^*$ does not vanish on the range of $V$ (apart on zero) because
\[ 
  \langle v, V^*Vv\rangle =\langle Vv, Vv\rangle \neq 0.
\]
Thus, in order $V^*V$ to vanish on the range of $P^{\perp}$, one requires $V$ to vanish on $\Image(P^{\perp})$.
\end{proof}

\begin{lemma}		\label{LemfinifactisemVUP}
Let $M$ be a finite factor, the every partial isometry $V$ reads
\begin{equation}
	V=UP
\end{equation}
where $U$ is unitary and $P$ is a projection.
\end{lemma}

\begin{proof}
Consider the equivalent projections $P=V^*V$ and $Q=VV^*$ and their complement $P^{\perp}$, $Q^{\perp}$. First, we remark that $P^{\perp}$ and $Q^{\perp}$ are equivalent. Indeed, if they are not equivalent let say that $Q^{\perp}$ is equivalent to a subprojection of $P^{\perp}$, in this case, the identity $\mtu=P+P^{\perp}=Q+Q^{\perp}$ provides an equivalence between $\mtu$ and a subprojection of $\mtu$, which is in contradiction with the assumption that $M$ is a finite factor.

Thus $P^{\perp}\sim Q^{\perp}$ and wet set $W^*W=P^{\perp}$ and $WW^*=Q^{\perp}$ and then $U=V+W$ is the answer because
\[ 
  (V+W)P=VP+WP,
\]
but $P$ is the projection on the target space of $V$, so $VP=V$ and, by lemma \ref{LemVstarVPP}, we have $WP=0$.
\end{proof}

Notice that the decomposition $V=UP$ is a special feature of the finite factor case. In the general infinite case, we have for example the operator which shifts the basis vectors
\[ 
  S=
\begin{pmatrix}
0	&0	&0	&0	&\ldots\\
1	&0	&0	&0	&\ldots\\
0	&1	&0	&0	&\ldots\\
0	&0	&1	&0	&\ldots\\
\vdots	&\vdots	&\vdots	&\vdots	&\ddots
\end{pmatrix}
\]
It has $S^*S=\mtu$ while $SS^*\neq\mtu$.

\begin{proposition}		\label{PropDecoTUTabsfinifacteur}
Every element $T$ of a finite factor reads
\begin{equation}	\label{EqDecoTUTabsfinifacteur}
	T=U| T |
\end{equation}
with $U$ unitary.
\end{proposition}

\begin{proof}
One guess the form of $U$ by the decomposition \eqref{EqDecoTUTabsfinifacteur}: $U=T(T^*T)^{-1/2}$. One checks that $U^*U=\mtu$. Since we are in a finite factor, the unit cannot be equivalent to something else than itself, so $UU^*=\mtu$ is forced, and $U$ is thus unitary.
\end{proof}

\begin{proposition}	
If $N$ is a finite factor, then so is $\eM_2(N)$.
\end{proposition}

\begin{proof}
Let us suppose that we have a partial isometry $V\in\eM_2(N)$ such that $VV^*=\mtu_2$. We have to prove that $V^*V=\mtu_2$; if not, the identity would be equivalent to a subprojection. In other words, we have to prove that $V$ is invertible. It will be done by constructing an invertible operator $W$ such that $V^*W$ is invertible. In that case, $V^*$ is invertible and so is $V$.

If we set $V=
\begin{pmatrix}
a&b\\
c&d
\end{pmatrix}$, with $a$, $b$, $c$, $d\in N$, the relation $V^*V=\mtu_2$ imposes among others relations
\begin{subequations}	\label{SubEassEqaaccunVV}
\begin{align}
a^*a+c^*c&=\id		\label{ssEqaaccunVV}\\
b^*a+d^*c&=0		\label{ssEqbadczVV}
\end{align}
\end{subequations}
Relation \eqref{ssEqaaccunVV} says that $| a |^2+| c |^2=1$, so that in the sense of the continuous functional calculus, we have $| a |=\sqrt{1-| c |^2}$. We deduce that $| a |$ is a limit of polynomials in $1-| c |^2$ and that $\big[ | a |,| c | \big]=0$.

Since $a$ and $c$ belong to a finite factor, proposition \ref{PropDecoTUTabsfinifacteur} provide unitary elements $u$ and $v$ of $N$ such that $a=u| a |$ and $c=v| c |$. Now we consider the unitary element
\[ 
  W=
\begin{pmatrix}
u&0\\
0&v
\end{pmatrix}
\begin{pmatrix}
| a |&-| c |\\
| c |&| a |
\end{pmatrix}
\]
Using relations \eqref{SubEassEqaaccunVV}, we find
\[ 
  V^*W=
\begin{pmatrix}
1	&	-a^*u| c |+c^*v| a |\\
0	&	x
\end{pmatrix},
\]
but $a^*u| c |=| a |u^*u| c |=| a | | c |=| c | |a |$, so that the upper-right element is actually zero. We are left with
\[ 
  V^*W=
\begin{pmatrix}
1	&0\\
0	&x
\end{pmatrix}
\]
in which we want to prove that $x$ is invertible. Using the fact that $W$ is unitary, we have $(V^*W)(V^*W)^*=V^*V=\mtu$, then
\[ 
  \begin{pmatrix}
1	&	0\\
0	&	x
\end{pmatrix}
  \begin{pmatrix}
1	&	0\\
0	&	x^*
\end{pmatrix}
  \begin{pmatrix}
1	&	0\\
0	&	xx^*
\end{pmatrix}
=
  \begin{pmatrix}
1	&	0\\
0	&	1
\end{pmatrix}.
\]
Thus we have $xx^*=\mtu$ in $N$, which in turn imposes $x^*u=\mtu$ because $N$ is a finite factor. We have finished to prove that $V^*W$ is invertible.
\end{proof}

% Si je déplace ce lemme, il faut déplacer la proposition qui suit en même temps parce qu'elle vient naturellement.
\begin{lemma}
If $P$ and $Q$ are projections with $PQ=0$, then $P$ is equivalent to a subprojection of $Q$, or $Q$ is equivalent to a subprojection of $P$.
\end{lemma}
\begin{proof}
No proof.
\end{proof}

\begin{proposition}			\label{PropnnminSTperpssR}
If $R$ is not a minimal projection, then there exist subprojections $S$, $T$ of $R$ such that $S\sim T$ and $S\perp T$.
\end{proposition}

\begin{proof}
Since $R$ is not minimal, we have a non vanishing projection $S<R$. Let consider $S_1=R-S$. One checks that $SS_1=0$. Now $S$ or $S_1$ is equivalent to a subprojection of the other. Let $S\sim T\leq S_1$. Now, we have $S\sim T$ and $ST=0$ which means $S\perp T$.
\end{proof}


Let $P$ and $Q$ be two projection in $M$ such that $PQ=0$. In $\eM_2(M)$, we have
\[ 
  \begin{pmatrix}
P+Q&0\\
0&0
\end{pmatrix}
\sim
  \begin{pmatrix}
P&0\\
0&R
\end{pmatrix}
\]
where $R$ is a subprojection of $P$ which is equivalent to $Q$. Define the partial isometry $V$ by $V^*V=Q$ and $VV^*=R$. We have
\[ 
 \begin{pmatrix}
  P	&	V^*	\\ 
  0	&	0	
\end{pmatrix}
\begin{pmatrix}
  P	&	0	\\ 
  V	&	0	
\end{pmatrix}
=
\begin{pmatrix}
  P+Q	&	0	\\ 
  0	&	0	
\end{pmatrix}, 
\]
and
\[ 
  \begin{pmatrix}
  P	&	0	\\ 
  V	&	0	
\end{pmatrix}
\begin{pmatrix}
  P^*	&	V^*	\\ 
  0	&	0	
\end{pmatrix}
=
\begin{pmatrix}
  P	&	PV^*	\\ 
  VP^*	&	R	
\end{pmatrix}
=
\begin{pmatrix}
  P	&	0	\\ 
  0	&	R	
\end{pmatrix}
\]
because $\Image(V^*)=\Image(Q)$ implies $PV^*=VP^*=VP=0$. Now, 
$
\begin{pmatrix}
  P	&	0	\\ 
  0	&	0	
\end{pmatrix}
$ is  a subprojection of 
$
\begin{pmatrix}
  P	&	0	\\ 
  0	&	P	
\end{pmatrix}
$
because $R$ is a subprojection of $P$. Thus we have
\begin{equation}
\begin{pmatrix}
  P+Q	&	0	\\ 
  0	&	0	
\end{pmatrix}
\sim
\begin{pmatrix}
  P	&	0	\\ 
  0	&	E	
\end{pmatrix}
\leq
\begin{pmatrix}
  P	&	0	\\ 
  0	&	P	
\end{pmatrix}
=\text{finite}.
\end{equation}
So we deduce that $P+Q$ is finite.

A factor is \defe{semifinite}{semifinite!factor}\index{factor!semifinite} if there are projections $P_{\alpha}$ such that $\bigvee P_{\alpha}=\id$. Notice that if $\{ P_1,\ldots, P_n \}$ is a finite set of finite projections, then $\bigvee P_i$ is a finite projection. A factor is \defe{purely infinite}{purely infinite}\index{factor!purely infinite} if $0$ is the only finite projection.

\begin{proposition}
If $P$ is any finite projection, one can find a sequence of equivalent projections $\{ P_i \}$ such that $\mtu=\sum P_i$.
\end{proposition}
\begin{proof}
No proof.
\end{proof}
A consequence of that proposition is that any factor is semifinite or purely infinite, while a finite factor is always semifinite.

\begin{remark}
A factor of type I is semifinite because a minimal projection is finite. Indeed, when $P$ is infinite, the projection $Q$ such that $Q\sim P$ and $Q\leq P$ contradicts minimality of $P$. 
\end{remark}

\begin{proposition}
A factor is semifinite if and only if it reads $(\text{finite})\bar\otimes (\text{type I})$.
\end{proposition}

\begin{proof}
If a factor reads $(\text{finite})\bar\otimes (\text{type I})$, the type I part is a $\oB(\hH)$ in which one can take as approximation of the identity the sequence of projections $P_i$ given by 
\begin{equation}
P_ie_j=
\begin{cases}
e_j	&\text{if $j\leq i$}\\
0	&\text{otherwise}\\
\end{cases}
\end{equation}
where $\{ e_i \}$ is an orthonormal basis of $\hH$.

Now if $M$ is semifinite, let $P_i$ be a sequence of finite projections with $P_iP_j=0$ and $P_i\sim P_j$ such that $VP_i=\id$. Then we have $\hH=\oplus_iP_i\hH$, but each of the $P_i$ is equivalent to $P_1\hH$, so that $\hH=\oplus_iP_i\hH=\oplus P_1\hH=P_1\hH\otimes l^2(\eN)$.

Under that isomorphism, an operator $T\in M$ acts on $P_1\hH$ by $P_1TP_1$, so that
\begin{equation}
M=P_1MP_1\bar\otimes \oB\big( l^2(\eN) \big).
\end{equation}

\end{proof}
Thus, in order to understand the semifinite factors, it is sufficient to understand the finite factors.

%---------------------------------------------------------------------------------------------------------------------------
					\subsection{Finite factor}
%-----------------------------------------------------------------------------------------------------------------------------

\begin{lemma}		\label{LemfassminPPperp}
Every factor without minimal projection contains a projection $P$ such that $P\sim P^{\perp}$.
\end{lemma}

\begin{proof}
Consider the set
\[ 
\begin{split}
  Z=\Big\{ 
(P,Q,V)\text{ where $P$ and $Q$ are projections,}&\text{with $P\perp Q$,}\\
						&\text{$V$ is a partial isometry,}\\
						 &\text{and $V^*V=P$, $VV^*=Q$}
 \Big\}.
\end{split}
\]
The set $Z$ is endowed with a partial order given by $(P_1,Q_1,V_1)\leq (P_2,Q_2,V_2)$ when $P_1\leq P_2$, $Q_1\leq Q_2$ and $V_2P_1=V_1$. The Zorn's lemma provides a maximal element that we denote by $(P,Q,V)$. Let us suppose that $P+Q<\mtu$ (strictly). Then we write $R=\mtu-P-Q$ and by proposition \ref{PropnnminSTperpssR} we have subprojection $S$ and $T$ of $R$ such that $S\sim T$ and $S\perp T$. 

We put $W^*W=S$ and $WW^*=T$, then $(P+S,Q+T,V+W)$ contradicts maximality of $(P,Q,V)$, and $P+Q=\id$ with $P\perp Q$ and $P\sim Q$.
\end{proof}

\begin{lemma}		\label{LemfinfacPPQQPsimQ}
Let $M$ be a finite factor. If $P\sim P^{\perp}$ and $Q\sim Q^{\perp}$, then $P\sim Q$.
\end{lemma}

This lemma means that there is only one way tu cut $\hH$ in two equal subspaces.

\begin{proof}
Let us suppose that $P$ is not equivalent to $Q$, thus it is equivalent to a subprojection of $Q$.

\begin{probleme}
What is the exact statement which says that a projection is equivalent to a subprojection of the other, or the contrary ?
\end{probleme}

Since $P\sim sub\, Q$, we have $P^{\perp}\sim sub\, Q^{\perp}$ and $P+P^{\perp}\sim sub(Q+Q^{\perp})$. That means that $\id$ is equivalent to a subprojection of itself, which is impossible because of the assumption of finite factor. We deduce that $P\sim Q$.
\end{proof}

%---------------------------------------------------------------------------------------------------------------------------
					\subsection{Rational and real dimensions}
%---------------------------------------------------------------------------------------------------------------------------
\label{SubSecRationalRealDim}

We consider a factor of finite type $M$ without minimal projection. Lemma \ref{LemfassminPPperp} ensures the existence of a projection $P$ such that $P\sim P^{\perp}$ while lemma \ref{LemfinfacPPQQPsimQ} says that every such projection lie in the class $[P]$. We define $\frac{ 1 }{2}\in\dim M$ by
\begin{equation}
\frac{ 1 }{2}=[P]\in\dim M
\end{equation}
where $P\sim P^{\perp}$. Now we look at the algebra $PMP$, which posses its own $\frac{ 1 }{2}$ that is called $\frac{1}{ 4 }$ in $M$. So we set the definition
\begin{equation}
	\frac{1}{ 4 }=[Q]\in\dim M
\end{equation}
where $Q\leq P$ and $Q\sim P-Q$. Notice that $P-Q=Q^{\perp}$ in $P\hH$. In the same way, we define $\frac{ 3 }{ 4 }$ by
\begin{equation}
	\frac{ 3 }{ 4 }=[P+R]\in\dim M
\end{equation}
with $R\leq R^{\perp}$ and $R\sim P^{\perp}-R$. Continuing the process, we can define
\[ 
	\frac{ r }{ 2^n }\text{ for } r\in\{ 0,\ldots, 2^n \},
\]
and we define $\tau\colon \dim M\to [0,1]$ by
\begin{equation}
	\tau(P)=\sup\Big\{ \frac{ r }{ 2^n }\tq \frac{ r }{ 2^n }\leq [P] \Big\}\in [0,1].
\end{equation}

\begin{theorem}		\label{ThobijzudimM}
The map $\tau\colon \dim M\to [0,1]$ is a bijection for every finite factor without minimal projection.
\end{theorem}

\begin{proof}
No proof.
\end{proof}

%---------------------------------------------------------------------------------------------------------------------------
					\subsection{Summary}
%---------------------------------------------------------------------------------------------------------------------------

When $M$ is a finite factor, it has two possibilities: it contains or not a minimal projection.

%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
					\subsubsection{Finite factor with minimal projection}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

We saw at page \pageref{PgtypeIonavu}, and more precisely on equation \eqref{EqMPHtypeIBh} that if $P'$ is the minimal projection of $M'$, then $M\simeq\oB(\hH)$, so that the possible dimensions are
\begin{equation}
	\dim M=\{ 0,1,\ldots,N \}
\end{equation}
where $N$ can eventually take the value $\infty$, as shows the example $M=\eC\id$.

%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
					\subsubsection{Finite factor without minimal projection}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

In the case of finite factor without minimal projection, we saw by theorem \ref{ThobijzudimM} that 
\begin{equation}
	\dim M=[0,1].
\end{equation}

%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
					\subsubsection{Semifinite factor}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

If the factor is not finite, there are two possibilities: it is semifinite or purely infinite. In the semifinite case

%---------------------------------------------------------------------------------------------------------------------------
					\subsection{Purely infinite factor}
%---------------------------------------------------------------------------------------------------------------------------

One still has to see what are the dimensions for a purely infinite factor.

\begin{lemma}		\label{LemORSneqzeroini}
Let $P$ be an infinite projection in a factor and $P=R\oplus S$ (orthogonal sum) with $R\sim P$ and $S\neq 0$. Then $[P]=\infty [S]$.
\end{lemma}

\begin{proof}
Let $R\sim P$ and $P=R+S$ with $S\neq 0$. Since $R\sim P$, we can decompose $R$ in the same way as $P$ is decomposed, namely
\[ 
	R=R_1+S_1
\]
with $R_1\sim R\sim P$ and $S_1\sim S$. Explicitly, if $V^*V=P$ and $VV^*=R$, we put $R_1=VRV^*$ and $S_1=VSV^*$. Proceeding, we decompose $R_1=R_2+S_2$, $R_2=R_3+S_3$, and so on. Since $R\perp S$, we have $S_1\perp R_1$, and $S_2$ being a subprojection of $R_1$ which is orthonormal to $S_1$, we have $S_1\perp S_2$.

What we get is finally is a set $\mS=\{ S,S_i \}_{i\in \eN}$ of projections two by two orthogonal and equivalent. Let $\mZ$ be the set of sets of projections two by two orthogonal and equivalent which contains $\mS$. This is the set of extensions of $\mS$. The Zorn's lemma provides a maximal element in $\mZ$ that we name $\mQ=\{ Q_n \}$. By very definition, $\mS\subseteq\mQ$.

We want to prove that $\sum_nQ_n=P$, so that $P\leq\infty[S]$ because $\infty[S]\leq\sum_nQ_n$. Let $E=P-\sum_nQ_n$. By maximality, it does not contain a subprojection equivalent to $S$, so we have $E\preceq S$. We are going to prove that $E+\sum_nQ_n\sim \sum Q_n$. The argument is once again an Hilbert hotel construction.

Let $Q_i=A_i+E_i$ with $A_i\sim A_j$ and $E_i\sim E$. That decomposition is nothing else that the fact that $E$ is equivalent to a subprojection of $Q_i$. Now consider the following equivalences:
\begin{align*}
	E&\sim E_1\\
	A_1&\sim A_1\\
	E_1&\sim E_2\\
	A_2&\sim A_2\\
	E_2&\sim E_3\\
	&\vdots
\end{align*}
On the left hand side we have $E+\sum_n Q_n$ while on the right hand side we have $\sum_nQ_n$. Thus we have $E+\sum_nQ_n\sim\sum_nQ_n$ and then $P\sim\sum_nQ_n$.
\end{proof}

\begin{corollary}
If $M$ is a purely infinite factor, then $\dim M=\{ 0,\infty \}$
\end{corollary}

\begin{proof}
In a purely infinite factor, zero is the only finite projection, thus any projection reads $P=R+S$ with $P\sim R$ and $S\neq 0$. The aim is to prove that $[P]=\id$, in such a way that there exists only one infinite.

We have $\id=Q+S$ for a certain $Q\sim \id$. The $S$ here can be chosen the same as the $S$ of $P$. Indeed $\id=P^{\perp}+P=P^{\perp}+R+S$. Using the equivalences $P^{\perp}\sim P^{\perp}$ and $P\sim R$, we see that $\id=P^{\perp}+P\sim P^{\perp}+R$, so that $\id=Q+S$ with $Q=P^{\perp}+R$. Using lemma \ref{LemORSneqzeroini}, we have $[P]=\infty[S]$, and then using the lemma again on $[P]$, we get $[P]=\infty[S]$, which proves that $[P]=[\id]$.
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
					\section{Tracial functional}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\label{SecTracevonNeuman}

References: \cite{TrioloSemifinite,DixmierTrace}. This section is related to section \ref{SecTraceCstar} about trace on $C^*$-algebra.

A linear functional $\tau\colon M\to \eC$ is
\begin{description}
	\item[a state] when $\tau(A^*A)\geq0$ and $\tau(1)=1$;
	\item[tracial]\index{tracial functional!on von Neumann algebra} when $\tau(A^*A)=\tau(AA^*)$;
	\item[faithful]\index{faithful!functional} when $\tau(A^*A)=0$ if and only if $A=0$;
	\item[normal]\index{normal!functional} when if $A=\sum_n A_n$ exists for a sequence $\{ A_n \}$ of positive operators, then $\tau(A)=\sum_n\tau(A_n)$;
	\item[semifinite]\index{semifinite!functional on von Neumann algebra} if for every non zero $A\in M^+$ majorizes some non zero $B\geq 0$ with $\tau(B)<\infty$.
\end{description}

\begin{lemma}
A linear tracial functional on a von~Neumann algebra is a trace.
\end{lemma}

\begin{proof}
Let $U$ be unitary, using the tracial property we find $\tau(U^*A^*AU)=\tau(AA^*)$, so that
\begin{equation}	\label{EqtauUBUtauBpos}
	\tau(U^*BU)=\tau(B)
\end{equation}
for every positive $B$. Since any element of $M$ reads as composition of four positive, the relation \eqref{EqtauUBUtauBpos} holds in fact for every $B$ in $M$. Since every element $C\in M$ can be written as $C=U^*B$, we have
\[ 
	\tau(CU)=\tau(U^*BU)=\tau(B)=\tau(UC),
\]
and we have $\tau(CU)=\tau(UC)$ for every $C$ and $U$ unitary. Now, every element is a combination of four unitary, so that $\tau(CD)=\tau(DC)$ for every $C$ and $D$, which means that $\tau$ is a trace.
\end{proof}

Notice that the existence of a faithful normal trace on $M$ implies that $M$ is finite because if $V^*V=1$,
\[ 
	\tau(1-VV^*)=1-\tau(VV^*)=1-\tau(V^*V)=1-\tau(1)=0,
\]
which, from faithfulness, implies that $VV^*=1$.

Let $\epsilon>0$, an \defe{$\epsilon$-trace}{$\epsilon$-trace}\index{trace!$\epsilon$-trace} is a normal state $\varphi\colon M\to \eC$ such that
\begin{equation}
	\varphi(A^*A)\leq (1+\epsilon)\varphi(AA^*).
\end{equation}

\begin{lemma}
A normal state on a finite factor is an $\epsilon$-state if and only if $P\sim Q$ implies $\varphi(P)\leq (1+\epsilon)\varphi(Q)$.
\end{lemma}

\begin{proof}
No proof.
\end{proof}

\begin{lemma}
If $\varphi$ is an $\epsilon$-trace, then we have
\begin{equation}
	\frac{1}{ (1+\epsilon) }\varphi(P)\leq\frac{ \dim(P) }{ \dim(\mtu) }\leq (1+\epsilon)\varphi(P)
\end{equation}
for every projection $P$.
\end{lemma}

\begin{proof}
Let us first suppose that 
\begin{equation}		\label{EqdimPsimunmtun}
	\dim (P)=\dim(\mtu)/n,
\end{equation}
 and decompose $\mtu=P_1+\cdots+P_n$ with $P_iP_j=0$ ($i\neq j$) and $P_i\sim P_j$ for every $i$. So we have $V_i^*V_i=P$ and $V_iV_i^*=P_i$. In that case
\begin{equation}
\begin{split}
	n\varphi(P)=\varphi(V_1^*V_1+\cdots+V_n^*V_n)&\leq(1+\epsilon)\varphi(V_1V_1^*+\cdots+V_nV_n^*)\\
							&=(1+\epsilon)\varphi(1)=1+\epsilon,
\end{split}
\end{equation}
thus
\begin{equation}
	\varphi(P)\leq\frac{ 1+\epsilon }{ n }=(1+\epsilon)\frac{ \dim(P) }{ \dim(\mtu) }.
\end{equation}
The other sense is obtained by the same computation:
\[ 
	1=\varphi(V_1V_1^*+\cdots+V_nV_n^*)\leq (1+\epsilon)\varphi(V_1^*V_1+\cdots+V_n^*V_n)=(1+\epsilon)n\varphi(P).
\]
The lemma is now proved with the assumption \eqref{EqdimPsimunmtun}. If that assumption does not hold, we can build projections $P_i$ with $P_iP_j=0$, $\dim(P_i)= \dim(\mtu)/ n_i $ and $P=\sum_iP_i$. Then we can use the fact that $\varphi$ is normal and carry on the same computation as before.
\end{proof}

\begin{corollary}
If $\varphi_1$ is an $\epsilon_1$-trace and $\varphi_2$ is an $\epsilon_2$-trace, then
\[ 
	\| \varphi_1-\varphi_2 \|\to 0
\]
when $\epsilon_1,\epsilon_2\to 0$.
\end{corollary}
\begin{proof}
No proof.
\end{proof}

The interest of this lemma resides in the fact that if $\varphi_k$ is an $\epsilon_k$-trace with $\epsilon_k\to 0$, we have a Cauchy sequence, so that $\lim_{k\to\infty}\varphi_k$ is an actual trace. We are thus not obliged to build traces, but $\epsilon$-trace are sufficient.

\begin{lemma}	\label{LemPMPnormalfaithstate}
Let $\varphi$ be a faithful normal state. If $\epsilon>0$, there exists a non vanishing projection $P\in M$ such that
\[ 
	\varphi(A^*A)\leq(1+\epsilon)\varphi(AA^*)
\]
if $A\in PMP$. In other words, $\varphi$ is an $\epsilon$-trace on $PMP$.
\end{lemma}

\begin{proof}
Let $Q=\sum_{\alpha}Q_{\alpha}$ and $Q'=\sum_{\alpha}Q'_{\alpha}$ where $\{ (Q_{\alpha},Q'_{\alpha}) \}$ is a maximal set of projections pairs such that
\begin{enumerate}
\item $Q_{\alpha}\perp Q_{\beta}$ and $Q'_{\alpha}\perp Q'_{\beta}$ if $\alpha\neq\beta$,
\item $Q_{\alpha}\sim Q_{\alpha}'$,
\item $\varphi(Q_{\alpha})<\varphi(Q'_{\alpha})$.
\end{enumerate}
From normality of $\varphi$, the third condition implies that $\varphi(Q)=\varphi(Q')$. Since $Q\neq\mtu$, we have $\varphi(Q')\leq 1$ and thus
\[ 
	\varphi(Q)<\varphi(Q')\leq 1.
\]
Let us now choose a pair $(R,R')$ such that $R\perp Q$, $R'\perp Q'$ and $R\sim R'$. By maximality, that pair cannot fulfil the third condition of $\{ Q_{\alpha},Q'_{\alpha} \}$:
\[ 
	\varphi(R)\geq \varphi(R').
\]
Now we consider the number
\begin{equation}
	m=\min\{ k\tq\, k\varphi(R)\geq\varphi(R')\text{ for every $(R,R')$ satisfying the two conditions} \}.
\end{equation}
We just saw that $1$ belongs to the set, so $m\leq 1$. Let us suppose that $m=0$. One typical projection orthogonal to $R$ is $\mtu-R$, but $\varphi(\mtu-R)\neq 0$ because $\varphi$ is faithful and $\mtu-R\neq\mtu$. So we conclude that $m$ cannot be zero and
\[ 
	m\in]0,1].
\]
Now, take $\epsilon>0$ and choose a pair $(R,R')$ which fulfils the two conditions and such that
\begin{equation}		\label{EqcondpaireRRprime}
	m\varphi(R)<(1+\epsilon)\varphi(R').
\end{equation}
Existence of such a pair is ensured by minimality of $m$.

We build the projections $S=\sum_{\alpha}S_{\alpha}$ and $S'=\sum_{\alpha}S'_{\alpha}$ where $\{ S_{\alpha},S'_{\alpha} \}$ is maximal for the properties
\begin{enumerate}
\item $S_{\alpha}\leq R$ and $S'_{\alpha}\leq R'$,
\item $S_{\alpha}\perp S_{\beta}$, $S'_{\alpha}\perp S'_{\beta}$ if $\alpha\neq\beta$,
\item $S_{\alpha}\sim S'_{\alpha}$,
\item $m\varphi(S_{\alpha})\geq (1+\epsilon)\varphi(S'_{\alpha})$.
\end{enumerate}
Using normality, the last condition sums to 
\begin{equation}
	m\varphi(S)\geq (1+\epsilon)\varphi(S').
\end{equation}
We also have $S\sim S'$ and $S\neq R$. Indeed, suppose that $S=R$. Then $S\sim R$, but $S\sim S'$, so $R\sim R'$. Since $S'_{\alpha}\leq R$ for every $\alpha$, we have $S'\leq R'$. We conclude that $S'=R'$ because $M$ is a finite factor: in this case, $S'\leq R'$ and $S'\sim R'$ imply $S'=R'$. Now the fourth condition over $S_{\alpha}$ becomes $m\varphi(R)\geq (1+\epsilon)\varphi(R')$ which contradicts the condition \eqref{EqcondpaireRRprime} that we made on the pair $(R,R')$. Thus we conclude that $S\neq R$.

Let take $P=R-S$ and choose projections $E$ and $E'$ such that $E\leq P$, $E'\leq P'$ with $E\sim E'$. In this case we have 
\[ 
	m\varphi(E)<(1+\epsilon)\varphi(E'),
\]
if not $(E,E')$ contradicts maximality of $\{ S_{\alpha},S'_{\alpha} \}$. On the other hand, minimality of $m$ provides $m\varphi(E)\geq \varphi(E')$, so that we are left with
\begin{equation}
	\varphi(E')\leq m\varphi(E)<(1+\epsilon)\varphi(E'),
\end{equation}
which shows that $\varphi$ is an $\epsilon$-trace and that $P'$ is the answer to the lemma.

\end{proof}

An example of faithful normal state is
\begin{equation}
	\varphi(T)=\sum_n2^{-n}\langle v_n, Tv_n\rangle 
\end{equation}
where $\{ v_i \}$ is an orthonormal basis of $\hH$.

\begin{proposition}
There is an $\epsilon$-trace on $M$.
\end{proposition}

\begin{proof}
We just saw that normal states do exist, so we apply lemma \ref{LemPMPnormalfaithstate} and we find a projection $P$ for which we suppose $\dim(P)=1/n$, and we choose $P_1,\ldots P_n$ such that $P_iP_j=0$ ($i\neq j$) and $P_i\sim P$. We define the partial isometries $V_i$ by
\begin{align*}
	V_i^*V_i&=P,&V_iV_i^*&=P_i.
\end{align*}
Now we define 
\[ 
	\psi(A)=\sum_i\varphi(V_i^*AV_i)
\]
where $\varphi$ is the normal faithful state on $PMP$. Thus we have
\[ 
	\psi(A)=\sum\varphi(V_i^*AV_i)=\sum\psi(V_i^*AV_i)=\sum\psi(AV_iV_i^*)=\sum\psi(AP_i),
\]
and we find
\begin{equation}
\begin{split}
	\psi(A^*A)	&=\sum_i\varphi(V_i^*A^*AV_i)\\
			&=\sum_{ij}\varphi(\underbrace{V_i^*A^*V_j}_{\in PMP}\underbrace{V_j^*AV_i}_{\in PMP})\\
			&\leq(1+\epsilon)\sum_{ij}\varphi(V_j^*AV_iV_i^*A^*V_j)\\
			&\leq (1+\epsilon)\psi(AA^*),
\end{split}
\end{equation}
which means that $\psi$ is a trace.
\end{proof}

\begin{proposition}		\label{PropExistenceTrace}\index{factor!finite}\index{trace!over finite factor}
Every finite factor accepts an unique faithful, normal and tracial state. Moreover, if $P$ and $Q$ are projections and $\tau$ is the trace, then
\begin{equation}
	P\sim Q\Leftrightarrow \tau(P)=\tau(Q).
\end{equation}
\end{proposition}

\begin{proposition}	\label{PropFactIIunttedim}						\index{factor!of type $II_1$}
If $M$ is a factor of type $II_1$, then
\begin{equation}
	\{ \tau(P)\tq P\in \oP(M) \}=[0,1].	
\end{equation}
where $\tau$ is the trace given by proposition \ref{PropExistenceTrace}.
\end{proposition}

\begin{proof}
No proof.
\end{proof}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
					\section{Modules over von~Neumann algebras}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\label{SecOverModVNalgDim}

Let $X$ be a topological space and denote by $\pi$ the group $\pi_1(X)$. We denote by $\tilde X$ the universal covering of $X$, and the group $\pi$ acts on $\tilde X$ by the monodromy action defined in subsection \ref{sssMonodromyact}. We denote by $C_p(X)$ the space of $p$-chains over $X$ and $C_p(\tilde X)$ the one of $\tilde X$ from which we build the complexes
\[ 
  \xymatrix{%
   \ldots \ar[r]^b	&	C_p(X)\ar[r]^{b}	&C_{p-1}(X)\ar[r]^{b}	&\ldots	
}
\]
and
\[ 
  \xymatrix{%
   \ldots \ar[r]^b	&	C_p(\tilde X)\ar[r]^{b}	&C_{p-1}(\tilde X)\ar[r]^{b}	&\ldots	
}
\]
with $b\circ b=0$. The chain space $C_p(\tilde X)$ is not only a group, but a module over $\eZ[\pi]$.

We are now going to look at the tensor product von~Neumann algebra
\begin{equation}
	M_p(\tilde X)=M(\pi)\otimes_{\eZ[\pi]}C_p(\tilde X).
\end{equation}
In the right hand side, $M(\pi)$ is the von~Neumann algebra described in subsection \ref{sssOnePartCaseMG}, which is generated by the operators $\mU_g\in\oB\big( l^2(\pi) \big)$ defined by $\mU_g(\varphi)(g)=\varphi(h^{-1}g)$, and the tensor product is the one defined in equation \eqref{EqdefAtensRB}.

We can then look at the complex of $M(\pi)$-modules
\[ 
  \xymatrix{%
   \ldots \ar[r]^b	&	M_{p+1}(\tilde X)\ar[r]^{b}	&M_p(\tilde X) \ar[r]^{b}	&M_{p-1}(\tilde X)\ar[r]^{b}	&\ldots	
}
\]
and look at the corresponding Betty numbers which are integers numbers associated with any topological space.


%---------------------------------------------------------------------------------------------------------------------------
					\subsection{Modular conjugation and factor of type \texorpdfstring{$II_1$}{II1}}
%---------------------------------------------------------------------------------------------------------------------------

The results presented here partially come from \cite{Wassermann}, section 9 and \cite{JonesSunder}, proposition 2.2.6.

A \defe{module}{module!over a von~Neumann algebra} over a von~Neumann algebra $M$ is an Hilbert space\footnote{Hilbert space are generally denoted by $\hH$, while modules are denoted by $\modE$ or $\modF$. Here, the notation will depend on what aspect we are focusing on.} $\modE$ for which there exists a weakly continuous map $\pi_r\colon M\to \oB(\modE)$ such that $\pi_r(T)=\big( \pi_r(T) \big)^*$ and $\pi_r(ST)=\pi_r(S)\pi_r(T)$. If $\modE$ and $\modF$ are two modules over $M$, a map $a\colon \modE\to \modF$ is \defe{linear}{linear map between modules} if 
\begin{equation}
	a(S\xi)=Sa(\xi)
\end{equation}
for every $S\in M$ and $\xi\in\modE$. We denote by\footnote{This is what \cite{JonesSunder} denote by $_M\mathcal{L}(\hH)$} $\oL_M(\modE,\modF)$\nomenclature[A]{$\oL_M(\modE,\modF)$}{Space of linear maps between the modules $\modE$ and $\modF$} the set of $M$-linear maps from $\modE$ to $\modF$. When $\modE=\modF$, we write $\oL_M(\modE)$. By definition of linearity, we have $\oL_M(\modE)=\pi(M)'$. The same notion exists for linearity at right, and in the general case, we denote by $\oL_{M,N}(\modE,\modF)$, the set of $M$-left-linear and $N$-right-linear maps from $\modE$ to $\modF$.



 We say that the modules $\modE$ and $\modF$ are \defe{isomorphic}{isomorphism!of modules} if there exists an unitary $M$-linear map between them.

When $M$ is a type $II_1$ factor, we denote $\hH_1=L^2(M)$ and $\hH_{\infty}=\hH_1\otimes l^2$.
\begin{proposition}			\label{PropTypeIIProjhHinfty}\index{factor!of type $II_1$}
Let $M$ be a type $II_1$-factor and $\modE$ be a separable $M$-module. There exists a projection $P\in \eM_{\infty}(M)$ such that $\modE\simeq \hH_{\infty}P$. All such projections are Murray-von Neumann equivalent.
\end{proposition}
\begin{proof}
No proof, explanations can be found in \cite{JonesSunder}, theorem 2.2.2.
\end{proof}

When $\modE$ is a separable $M$-module ($M$ is a type $II_1$ factor), we define
\begin{equation}
	\dim_M\modE=\tr p
\end{equation}
where $p\in\oP\big( \eM_{\infty}(M) \big)$ is the projection such that $\big( L^2(M)\otimes l^2 \big)p\simeq \modE$ and whose existence is given by proposition \ref{PropTypeIIProjhHinfty}.

Let $M$ be a factor of type $II_1$ with the unique trace $\tau$ given by proposition \ref{PropExistenceTrace}. We denote by $L^2(M,\tau)$ the Hilbert space of its GNS representation, and $\pi_{\tau}$ the representation. Since $\tau$ is unique, we will simply denote them by $L^2(M)$ and $\pi$. We denote by $\Omega\in L^2(M)$ a cyclic vector. If $\pi(T)=0$, we have
\[ 
	\tau(T^*T)=\| \pi(T)\Omega \|^2=0,
\]
so that $T=0$ and the representation is faithful. We can thus identify $T\in M$ with $\pi(T)\in \oB\big( L^2(M) \big)$ and we have $M\subset\oB\big( L^2(M) \big)$. The basics properties of the GNS construction say also that $\overline{ M\Omega }=L^2(M)$ and $\tau(T)=\langle T\Omega, \Omega\rangle $ for every $T$ in $M$. 

If $T\Omega=0$, then $0=\| T\Omega \|^2=\tau(T^*T)$, so that $T=0$. That means that $\Omega$ is separating for~$M$.

\begin{lemma}
If $M\subseteq\oB(\hH)$ is a von~Neumann algebra, a vector in $\hH$ is cyclic for $M$ if and only if it is separating for $M'$.
\end{lemma}
\begin{proof}
A proof is given in \cite{JonesSunder}.
\end{proof}

Now, for every $\xi\in L^2(M)$, we define the operators $\pi_l$ and $\pi_r$ by
\begin{subequations}
\begin{align}
	\pi_l(\xi)(T'\Omega)&= T'\xi\\
	\pi_r(\xi)(T\Omega) &= T\xi
\end{align}
\end{subequations}
for $T'\in M'$ and $T\in M$. The domains are $\dom\big( \pi_l(\xi) \big)=M'\Omega$ and $\dom\big( \pi_r(\xi) \big)=M\Omega$. These operations are well defined because $\Omega$ is cyclic and separating for $M$ and $M'$.

If $\pi_l(\xi)$ extends to a bounded operator on $L^2(M)$, one says that $\xi$ is \defe{left bounded}{left!bounded vector}\index{right!bounded vector}., and the (necessarily unique) extension is still denoted by $\pi_l(\xi)$. We do the same for $\pi_r$. Let now the map
\begin{equation}
\begin{aligned}
 J\colon M\Omega&\to M\Omega \\ 
   T\Omega&\mapsto T^*\Omega, 
\end{aligned}
\end{equation}
this is a conjugate linear isometry, so that it extends to an anti-unitary involution.
\begin{equation}
	J\colon L^2(M)\to L^2(M)
\end{equation}
That map $J$ is the \defe{modular conjugation}{modular!conjugation} operator for the factor $M$ of type $II_1$.

The algebra $JMJ$ acts on $L^2(M)$ as well as on $L^2(JMJ)$. If $\xi\in L^2(M)$, the action is
\begin{equation}		\label{EqActJMJLdM}
	(JSJ)\xi=\xi S^*.
\end{equation}
That one is inspired by the fact that $JSJT=J(ST^*)=TS^*$. Since $J^2=1$, the action of $JMJ$ on $L^2(JMJ)$ is given by
\begin{equation}		\label{EqActJMJLdJMJ}
	(JSJ)(JTJ)=J(ST)J.
\end{equation}

Let $M$ be a type $II_1$ factor. We denote $\hH_1(M)=L^2(M)$\nomenclature[C]{$\hH_1=L^2(M)$}{A completion of a von~Neumann algebra}, or simply by $\hH_1$ when no confusion is possible, and $\hH_{\infty}=L^2(M)\otimes l^2$\nomenclature[C]{$\hH_{\infty}$}{$\hH_1\otimes l^2$}. The algebra $M$ acts on $\hH_1$ by
\begin{equation}
	\pi_1(S)\xi=S\xi,
\end{equation}
and $M$ acts on $\hH_{\infty}$ by
\begin{equation}
	\pi_{\infty}(S)=\pi_1(s)\otimes\id_{l^2}.
\end{equation}
We also note $\eM_{\infty}(M)=M\otimes\oB(l^2)$, that has to be understood as infinite matrices with elements in $M$. It is a type $II_{\infty}$ factor, and the trace is a follows. If $p\in\eM_{\infty}(M)=(p_{ij})$, then
\begin{equation}					\label{EqTraceMinfinuM}
	\tr(p)=\sum_{i=1}^{\infty}\tr_M(p_{ii}).
\end{equation}
With that formula, when $q\in\oP(l^2)$ has rank $1$, then $\tr(1_m\otimes q)=1$. Let $q\in\eM_n(M)$ and consider the element of $\eM_{\infty}(M)$ given by the following:
\begin{equation}
	\begin{pmatrix}
  q	&	0	\\ 
  0	&	0	
\end{pmatrix}.
\end{equation}
It's trace, in $\eM_{\infty}(M)$, is $\sum_{i=1}^n\tr(q_{ii})$, but the trace of $q$ in $\eM_n(M)$ is $\frac{1}{ n }\sum_{i-1}^n\tr(q_{ii})$. The normalization is not the same in $\eM_n(M)$ and in $\eM_{\infty}(M)$.

We denote by $e_{11}$, the element of $\eM_n(M)$ given by
\begin{equation}
	e_{11}=
\begin{pmatrix}
  1	&		\\ 
  	&	0	
\end{pmatrix}.
\end{equation}
We have $\tr(e_{11})=1/n$, and $\pi_e(e_{11})\in\oP\Big( \pi_r\big( \eM_n(M) \big) \Big)$.

\begin{lemma}
	The $\oL_M\big( L^2(M) \big)$-modules $\oL_M\big(L^2(M)\big)$ and $L^2(M)$ are isomorphic.
\end{lemma}

\begin{proof}
	The result comes from the fact that an element of $\oL_M\big(L^2(M)\big)$ is uniquely defined by its value at $1\in M$.
\end{proof}
As a consequence of that lemma, we have
\begin{equation}
	\dim_{\oL_M\big( L^2(M) \big)}L^2(M)=1,
\end{equation}
because
\begin{equation}
	\Big( \oL_M\big( L^2(M) \big)\otimes l^2 \Big)p=L^2(M)
\end{equation}
when $p=\id\otimes e_{11}$, whose trace is\footnote{it is not $1/n$ or anything like that because of the remark we did bellow the definition \eqref{EqTraceMinfinuM}.} $1$.

\begin{lemma}		\label{LemLJMJequalLM}
	We have the isomorphism
	\begin{equation}
		L^2(JMJ)\simeq L^2(M)
	\end{equation}
as $JMJ$-module.
\end{lemma}

\begin{proof}
	Let us prove that the map which extend the following is an isomorphism:
	\begin{equation}
		\begin{aligned}
		 \psi\colon L^2(JMJ)&\to L^2(M) \\ 
		   JSJ&\mapsto S^* 
		\end{aligned}
	\end{equation}
	So we have to prove that for every $a\in JMJ$ and $\xi\in L^2(JMJ)$, we have $\psi(a\xi)=a\psi(\xi)$. Using the actions \eqref{EqActJMJLdM} and \eqref{EqActJMJLdJMJ}, if $a=JSJ$ and $\xi=JTJ$, we find
	\begin{equation}
		\psi(a\xi)=\psi(JSJJTJ)=\psi(JSTJ)=T^*S^*, 
	\end{equation}
	while
	\begin{equation}
		a\psi(\xi)=(JSJ)\psi(JTJ)=(JSJ)T^*=T^*S^*.
	\end{equation}
	That prove that $L^2(M)\simeq L^2(JMJ)$ as $JMJ$-modules.
\end{proof}

\begin{lemma}
	We have
	\begin{equation}		\label{EqoLLdpireununmodE}
		\oL_M\big( L^2(M) \big)=\oL_{M,\pi_r(e_{11})}(\modE_n)
	\end{equation}
	where $\modE_n=L^2(M)\oplus \cdots\oplus L^2(M)$ ($n$ terms).
\end{lemma}

\begin{proof}
An element in the right hand side of \eqref{EqoLLdpireununmodE} is a right-linear map with respect to $\pi_r(e_{11})$, i.e. a map $f\colon \modE\to \modE$,
\begin{equation}
	f\big( (\xi_1,\ldots,\xi_n)\pi_r(e_{11}) \big)=f(\xi_1,\ldots,\xi_n)\pi_r(e_{11}).
\end{equation}
Since the left hand side only depends on $\xi_1$, the right hand side  shows that $f(\xi_1,\cdots,\xi_n)$ only depends on $\xi_1$. Now, the right hand side takes its values in $L^2(M)$, so that the left hand side shows that $f$ takes its values in $L^2(M)$.
\end{proof}

The following is the proposition 2.2.6 in \cite{JonesSunder}.
\begin{proposition}	\label{PropDimIIun}
	Let $\hH$ be a separable Hilbert space and $M\subseteq\oB(\hH)$, a factor of type $II_1$. We have
	\begin{enumerate}

		\item\label{ItemiPropDimIIun} for every $d\in[0,1]$, there exists a $M$-module $\modE_d$ such that $\dim_M\modE_d=d$.
		
		\item\label{ItemiiPropDimIIun} There exists an unique $d\in[0,\infty]$ such that $\hH\simeq\modE_d$ as $M$-module.

		\item\label{ItemiiiPropDimIIun} The algebra $M'$ is a factor of type $II_1$ if and only if $\dim_M\hH<\infty$.

		\item\label{ItemivPropDimIIun} $\dim_M L^2(M)=1$.
 
		\item\label{ItemvPropDimIIun} If $\{ \modF_n \}_{n\in\eN}$ is a set of separable $M$-modules, then
			\begin{equation}
				\dim_M\big( \oplus_n\modF_n \big)=\sum_M\dim_M\modF_n.
			\end{equation}
		\item\label{ItemviPropDimIIun} If $\dim_M\hH<\infty$ and if $P'\in\oP(M')$, then 
			\begin{equation}
				\dim_{PMP}(P\hH)=\big( \tr_M(P) \big)^{-1}\dim_M\hH.				
			\end{equation}
	
		\item\label{ItemviiPropDimIIun} If $P$ is a projection in $M$, then 
			\begin{equation}
				\dim_{PMP}(P\hH)=\big( \tr_M(P) \big)^{-1}\dim_M\hH.
			\end{equation}

		\item\label{ItemviiiPropDimIIun}  We have
		\begin{equation}				\label{EqDimMMprimeprodun}
			\dim_{M'}\hH=(\dim_M\hH)^{-1}
		\end{equation}
		if $M'$ is a factor of type $II_1$
	\end{enumerate}
\end{proposition}

\begin{proof}

	For \ref{ItemiPropDimIIun}, let begin with $d=n\in \eN$, and define
	\begin{equation}
		\modE_n=\underbrace{  L^2(M)\oplus\ldots\oplus L^2(M)   }_{\text{$n$ times}}
	\end{equation}
	which can be seen as an element of $\eM_{1\times n}\big( L^2(M) \big)$. This is a $M$-$\eM_n(M)$-bimodule, for the matrix multiplication. What we have is to compute $\dim_{M}\hH_n=\tr p$ where $p\in\oP\big( \eM_{\infty}(M) \big)$ is the projection such that $\big( L^2(M)\otimes l^2 \big)P=\hH_n$. 
	
	Intuitively, $P$ is the projection onto the first $n$ component of the space of infinite vertical matrices. Indeed, the picture is that $\hH_n=\eM_{1\times n}\big( L^2(M) \big)$ while $\hH_{\infty}=\eM_{1\times \infty}\big( L^2(M) \big)$. We are searching for $p\in\oP(\eM_{\infty}(M))$ such that 
	\begin{equation}
		\big( L^2(M)\otimes l^2 \big)p=L^2(M)\oplus\ldots\oplus L^2(M).
	\end{equation}
	The answer is $p=\id_{M}\otimes \pr_n$ where $\pr_n$ stands for the projection onto the first $n$ components. Using formula \eqref{EqTraceMinfinuM}, we conclude that $\dim_M\modE_n=n$. 

	Let us now consider $d\in[0,\infty[$, and an integer $n\geq d$. Since $\eM_n(M)$ is a factor of type $II_1$, proposition \ref{PropFactIIunttedim} provides a projection $q\in\oP\big( \eM_m(M) \big)$ such that $\tr_{\eM_n(M)}(q)=d/n$. Now we look at
	\begin{equation}
		\modE_d=\modE_nq.
	\end{equation}
	In order to compute $\dim_M(\modE_d)$, we have to find $r\in\oP\big( \eM_{\infty}(M) \big)$ such that
	\begin{equation}
		\big( L^2(M)\otimes l^2 \big)r\simeq \big( L^2(M)\oplus\ldots\oplus L^2(M) \big)q.
	\end{equation}
	The answer is
	\begin{equation}
		r=
	\begin{pmatrix}
	  q	&	0	\\ 
	  0	&	0	
	\end{pmatrix}
	\end{equation}
	whose trace is 
	\begin{equation}
		\tr_{\eM_{\infty}(M)}(r)=\sum_{i=1}^{\infty}\tr_M(r_{ii})=\sum_{i=1}^n\tr_M(q_{ii})=n\tr_{\eM_n(M)}(q),
	\end{equation}
	because of the discussion bellow the definition \eqref{EqTraceMinfinuM}. This concludes the proof of \ref{ItemiPropDimIIun}.
	
	We pass to the proof of \ref{ItemviiiPropDimIIun}. Since $\dim_M\hH<\infty$, we know that $\hH$ is a factor of type $II_1$ by \ref{ItemiiiPropDimIIun}. We can thus suppose that $\hH=\modE_d$ for some $d$. One knows that $M'=JMJ$, so that $\dim_{M'}\modE_d=\dim_{JMJ}\modE_d$. 
	
	Let us first work with $d=1$. In order to compute $\dim_{JMJ}\big( L^2(M) \big)$, we are searching for $p\in\oP\big(\eM_{\infty}(JMJ))$ such that $\big( L^2(JMJ)\otimes l^2 \big)p\simeq L^2(M)$ as $JMJ$-modules. From lemma \ref{LemLJMJequalLM}, $P=e_{11}$ works.
	
	Let us now study the case $d=n\in\eN$.
	
\end{proof}

\begin{corollary}
	When $M$ is a factor of type $II_1$, two $M$-modules are isomorphic if and only if they have same dimension.
\end{corollary}
This is a direct consequence of point \ref{ItemiiPropDimIIun} in proposition \ref{PropDimIIun}.


%---------------------------------------------------------------------------------------------------------------------------
					\subsection{Dimension}
%---------------------------------------------------------------------------------------------------------------------------

We are going to associate any $M=M(\pi)$-module with a dimension in $[0,1]$ such that for every projection $P\in M$, the dimension of the submodule $M(\pi)P$ is equal to $\dim\big( M(\pi)P \big)=\tr(P)$. We will in fact give a dimension to every module over a von~Neumann algebra accepting a trace. For that, we use theory developed in section \ref{SecModUnitalAnneau}.

\begin{theorem}			\label{ThofgsurMFSubEEClSplits}
If $M$ is a finite von~Neumann algebra and if $E$ is a finitely generated module over $M$, and if $F$ is any submodule, then the quotient map $E\to E/\Cl_E(F)$ splits and furthermore the quotient space $E/\bar E$ is projective and finitely generated.
\end{theorem}

\begin{probleme}
Has one to add the assumption that $F$ is projective ?
\end{probleme}
\begin{proof}
Later.
\end{proof}

As consequence of the this theorem, $F\simeq \bar E\oplus(\text{finite projective module})$. In particular,
\begin{equation}
	F\simeq \Cl_F(0)\oplus  (\text{finitely generated projective module})
\end{equation}

\begin{theorem}		\label{ThoPropDimiM}
Let $M$ be a finite von~Neumann algebra with a normal faithful tracial state $\varphi$. There is an unique function 
\[ 
	\dim_{\varphi}\colon \{ \text{$M$-modules} \}\to [0,\infty]
\]
such that
\begin{enumerate}
\item $F_1\simeq F_2$ implies $\dim_{\varphi}F_1=\dim_{\varphi}F_2$,
\item (normalisation) if $F$ is a finitely generated projective module, then the value of $\dim_{\varphi}(F)$ coincides with the definition \eqref{DefDimFunctModule}, in particular when $E\simeq M^nP$ is finitely generated and projective, we have $\dim E=\sum_i\varphi(P_{ii})$,
\item (continuity) if $E$ is any submodule on a finitely generated module $F$, then $\dim_{\varphi}(E)=\dim_{\varphi}\big( \Cl_F(E) \big)$\footnote{From an analytic point of view, that condition is not usual, as can be seen on the example $\dim\eQ=0$ while $\dim\eR=1$.},
\item\label{ItemCofinalitySuiteExact} (cofinality) given an exact sequence
\[ 
	\xymatrix{%
   0\ar[r] 	&F_1\ar[r]	&F\ar[r]	&F_2 \ar[r]	&0,
}
\]
then $\dim_{\varphi}(F)=\dim_{\varphi}(F_1)+\dim_{\varphi}(F_2)$.
\end{enumerate}
\end{theorem}

\begin{proof}
later.
\end{proof}

Notice that, since $P=P^*P$ for every projection, we have $\dim E\geq 0$.

We will prove the following
\begin{proposition}			\label{PropDimClEgalDim}
If $E$ is a finitely generated projective module over $M$, we have
\begin{equation}
	\Dim(F)=\Dim\big( \Cl_E(F) \big)
\end{equation}
if $F$ is any submodule of $E$.
\end{proposition}

\begin{probleme}
One has to check that is it actually proved somewhere in the next pages.
\end{probleme}

We will not often explicitly write the trace $\varphi$ and simply write $\dim(E)$. However, we will sometimes precise the ring over which we consider the module and denote by $\dim_M(E)$\nomenclature[C]{$\dim_M(E)$}{The dimension of $E$ as module over $M$} the dimension of $E$ as module over $M$.

%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
					\subsubsection{Examples}		\label{subsubsecExemDimMMMod}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Let $M$ be a von~Neumann algebra with a normal faithful tracial state $\varphi$, and let us give some examples of modules over $M$.

First, $M$ itself is a free module of dimension $1$\footnote{In fact that dimension is $\tr(\mtu)$ which is usually normalised at $1$, see definition \eqref{EqPreDefDimModuleRA} and bellow.} over $M$. If $P$ is a projection, then $MP$ is a projective module\label{PgMPprojModule} and $\dim_{\varphi}(MP)=\varphi(P)$. The fact that $MP$ is a projective module comes from the direct sum decomposition $M=MP\oplus M(\mtu-P)$ and the third characterisation if projective module in proposition \ref{PropEquivProjModule}. Notice that $M$ is a free module over $M$ because $M=M\mtu$.

\begin{proposition}		\label{PropMTprojpourtoutT}
For every element $T\in M$, the set $MT$ is a projective $M$-module.
\end{proposition}

\begin{proof}
Let $P$ be the projection onto $\overline{ \Image(T) }$, so that $P=\lim_{n\to\infty}(TT^*)^{1/n}$ as already seen. We are going to prove that $MT\simeq MP$ as $M$-module. For we define $\Phi\colon MT\to MP$ by $\Phi(ST)=SP$. In order to see that this is a good definition, suppose $S_1T=S_2T$, then $(S_1-S_2)T=0$. But we have
\begin{align}
	ST&=0&\Rightarrow &&S|_{\Image(T)}&=0&\Rightarrow &&S|_{\overline{ \Image(T) }}&=0&\Rightarrow	&&S|_{\Image(P)}&=0,
\end{align}
so that $SP=0$. It shows that $\Phi$ is a well defined $M$-module isomorphism between $MT$ and $MP$.
\end{proof}

By polar decomposition, we have $MT=M| T |$, so we can suppose $T\geq 0$ without loss of generality. We have the exact sequence
\[ 
	\xymatrix{%
   0\ar[r] 	&MT\ar[r]^{\Phi}	&MP\ar[r]	&MP/MT \ar[r]	&0,	
}
\]
so that by property \ref{ItemCofinalitySuiteExact} of theorem \ref{ThoPropDimiM}, we have $\dim_{\varphi}(MT)=\dim_{\varphi}(MP)+\dim_{\varphi}(MP/MT)$. Since the modules $MP$ and $MT$ are isomorphic, that means that 
\[ 
	\dim_{\varphi}(MP/MT)=0.
\]

As another example, take projections $P_m$ with $\varphi(P_m)=2^{-m}$, and let $F$ be the infinite algebraic direct sum $MP_1\oplus MP_2\oplus\ldots$. By cofinality, it has at least the dimension of each of its submodule. In other words, we have
\[ 
	\dim F=\sup_n\dim(MP_1\oplus\ldots\oplus MP_n)=1.
\]

Since we can embed $F$ into $M$, we also get $\dim(M/F)=0$.

%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
					\subsubsection{Summary}
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

We want to define, for each module, a dimension such that
\begin{itemize}
\item if $E$ is a projective left module with $E\simeq M^nP$ (see proposition \ref{PropFGPRkP}) and $P=P^2\in\eM_n(M)$,
\[ 
	\dim(E)=\sum \varphi(P_{ii}),
\]
and does not depend on the choices.
\item If $E$ is not a finitely generated projective module, then
\begin{equation}		\label{DefDimAvecGrandD}
	\Dim(E)=\sup\big\{  \dim(F)\text{ with $F$ finite projective submodule of $E$} \big\}.
\end{equation}
\end{itemize}
