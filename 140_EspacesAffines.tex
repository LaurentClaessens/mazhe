% This is part of Mes notes de mathématique
% Copyright (c) 2011-2014,2016
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

Ce chapitre provient principalement de \cite{Combes}.

\begin{definition}
    Soit \( E\), un espace vectoriel. Un \defe{espace affine}{affine!espace}\index{espace!affine} modelé sur \( E\) est un ensemble \( \affE\) sur lequel le groupe\footnote{Voir exemple \ref{ExemMaKdwt}.} \( (E,+)\) agit à droite transitivement et librement.
\end{definition}

Étant donné que \( E\) est un groupe commutatif, l'action peut être vue indifféremment à gauche ou à droite. Si \( M\in\affE\) et si \( x\in E\) nous notons \( M+x\) au lieu de \( x\cdot M\) le résultat de l'action de \( x\) sur \( M\).

\begin{remark}  \label{RemAobrlX}
    Lorsque nous écrivons «\( M+x\)», le symbole plus n'est pas une loi de composition interne de \( \affE\), mais une action.
\end{remark}

Soient \( N,M\in\affE\). Par liberté et transitivité de l'action, il existe un unique \( x\in E\) tel que \( M+x=N\). Ce vecteur \( x\) sera noté \( \vect{ MN }\).

\begin{proposition}
    Si \( A,B,C\in\affE\) nous avons les égalités suivantes dans \( E\) :
    \begin{enumerate}
        \item
            \( AB+BC=AC\) (relations de Chasles)\index{relations!de Chasles}\index{Chasles},
        \item
            \( AA=0\),
        \item
            \( AB=-AB\).
    \end{enumerate}
\end{proposition}

Si \( E\) est un espace vectoriel, le groupe \( (E,+)\) agit sur \( E\) par l'action \( t_y(x)=y+x\). Utilisant cette action nous construisons l'\defe{espace affine canonique}{espace!affine!canonique}\index{canonique!espace affine} de \( E\). En particulier nous notons \( \affE_n(\eK)\) l'espace affine canonique de \( \eK^n\) vu comme espace vectoriel sur \( \eK\).

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Repères affines}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Soit \( E\) un \( \eK\)-espace vectoriel de dimension \( n\) et \( \affE\) un espace affine construit sur \( E\).
\begin{definition}      \label{DEFooQELZooEXvxgw}
    Un multiplet \( (A,e_1,\ldots, e_n)\) où \( A\) est un point de \( \affE\) et \( \{ e_i \}\) est une base de \( E\) est un \defe{repère cartésien}{repère!cartésien!espace affine} de \( \affE\).
\end{definition}
Un tel repère donne une bijection
\begin{equation}
    \begin{aligned}
        \phi\colon \eK^n&\to \affE \\
        (x_1,\ldots, x_n)&\mapsto A+\sum_ix_ie_i. 
    \end{aligned}
\end{equation}
Ces nombres \( x_i\) sont les \defe{coordonnées}{coordonnées!dans un espace affine} du point \( A+\sum_ix_ie_i\) dans le repère \( (A,e_i)\).

Soient \( (A,e_i)\) et \( (A',e'_i)\) deux repères cartésiens pour l'espace affine \( \affE\). Soit \( (a_{ij})\) la matrice de changement de base entre \( \{ e_i \}\) et \( \{ e'_i \}\) dans \( E\). Nous voudrions trouver les \( x_i\) en termes des \( x'_i\).

Pour cela nous considérons un point \( M\) dans \( \affE\) et nous l'écrivons dans les deux bases. Cela fournit l'égalité
\begin{equation}        \label{EqcYfuMg}
    A+\sum_ix_ie_i=A'+\sum_ix'_ie'_i.
\end{equation}
Nous considérons les coordonnées \( (a_i)\) de \( A'\) dans le repère \( (A,e_i)\), c'est à dire
\begin{equation}    \label{EqZNwPHE}
    A'=A+\sum_ia_ie_i.
\end{equation}
En substituant \( e'_i=\sum_ka_{jk}e_k\) et \eqref{EqZNwPHE} dans \eqref{EqcYfuMg} nous trouvons
\begin{equation}
    \sum_kx_ke_k=\sum_ka_ke_k+\sum_{jk}a_{jk}x'_je_k,
\end{equation}
et par conséquent
\begin{equation}
    x_k=a_k+\sum_ja_{jk}x'_j.
\end{equation}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Classification affine des conique}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Soit une conique \( f(x,y)=0\) avec
\begin{equation}
    f(x,y)=ax^2+2bxy+cy^2+2dx+2ey+f  
\end{equation}
dans le repère \( R=(A,e_i)\). La signature de la quadratique
\begin{equation}
    q(x,y)=ax^2+2bx+cy^2
\end{equation}
ne dépend pas de la base choisie et un changement de variables
\begin{subequations}
    \begin{numcases}{}
        \tilde x=\alpha x+\beta y\\
        \tilde y=\gamma x+\delta y
    \end{numcases}
\end{subequations}
peut nous amener dans trois cas :
\begin{equation}
    q(x,y)=\begin{cases}
        \tilde x^2+\tilde y^2    &   \text{genre ellipse}\\
        \tilde x^2-\tilde y^2    &    \text{genre hyperbole}\\
        \tilde x^2               &  \text{genre parabole}.   
    \end{cases}
\end{equation}
Dans le troisième cas, la matrice de \( q\) est de rang \( 1\).

Nous cherchons maintenant à savoir si un point \( I=(x_0,y_0)\) est un centre de symétrie de \( f(x,y)=0\). Pour cela nous choisissons le repère centré en \( I\), c'est à dire que nous posons 
\begin{subequations}
    \begin{numcases}{}
        x=x_0+\tilde x\\
        y=y_0+\tilde y.
    \end{numcases}
\end{subequations}
Un peu de calcul montre qu'alors la conique s'écrit
\begin{equation}
    f(x_0,y_0)+q(\tilde x,\tilde y)+(2ax_0+2by_0+2d)\tilde x+(2bx_0+2cy_0+2e)\tilde y=0.
\end{equation}
Le point \( I\) sera un centre de symétrique si les termes linéaires en \( \tilde x\) et \( \tilde y\) s'annulent, c'est à dire si
\begin{subequations}        \label{SyskhiOvW}
    \begin{numcases}{}
        ax_0+by_0+d=0\\
        bx_0+cy_0+e=0.
    \end{numcases}
\end{subequations}
Nous supposons que \( (d,e)\neq (0,0)\), sinon la conique de départ serait déjà centrée. Le déterminant du système \eqref{SyskhiOvW} est 
\begin{equation}
    \delta=ac-b^2.
\end{equation}
Si ce dernier est différent de zéro, le système possède une unique solution et la conique aura alors un unique centre de symétrie.

Si le déterminant du système est nul, il y a soit pas de centre de symétrie, soit une infinité. Dans le premier cas nous sommes en présence d'une parabole, et dans le second cas de deux droites parallèles.

\begin{example}
    Soit 
    \begin{equation}    \label{EqOgsEcz}
        f(x,y)=x^2+2xy-y^2-6x+2y-1=0
    \end{equation}
    donnée dans le repère affine \( R=(A,\{ e_i \})\). Nous commençons par étudier la signature de \( q(x,y)=x^2+2xy-y^2\) dont la matrice symétrique est
    \begin{equation}
        Q=\begin{pmatrix}
            1    &   1    \\ 
            1    &   -1    
        \end{pmatrix}.
    \end{equation}
    Son polynôme caractéristique est \( \lambda^2-2\) sont les racines sont \( \pm\sqrt{2}\). La signature est donc \( (1,-1)\) et nous sommes en présence d'une conique de genre hyperbole. Nous cherchons le centre en posant \( x=\tilde x+x_0\), \( y=\tilde y+y_0\). Le système à résoudre est
    \begin{subequations}
        \begin{numcases}{}
            x_0+y_0-3=0\\
            x_0-y_0+1=0,
        \end{numcases}
    \end{subequations}
    dont l'unique solution est \( (x_0,y_0)=(1,2)\). Nous considérons le repère centré en \( (x_0,y_0)\), c'est à dire le repère
    \begin{equation}
        R'=(I,\{ e_i \})
    \end{equation}
    avec \( I=A+x_0e_1+y_0e_2\) où \( A\) est l'origine du repère dans lequel l'équation \eqref{EqOgsEcz} était donnée.

    Par construction dans ce repère nous avons la conique
    \begin{equation}
        f(x_0,y_0)+q(\tilde x,\tilde y)=0,
    \end{equation}
    c'est à dire
    \begin{equation}
        \tilde x^2+2\tilde x\tilde y-\tilde y^2=0.
    \end{equation}
    Maintenant la nous avons une quadrique centrée nous voulons la mettre sous une forme plus canonique :
    \begin{equation}
        \left( \frac{1}{ \sqrt{2} }(\tilde x+\tilde y) \right)^2-\tilde y^2-1=0.
    \end{equation}
    Nous posons donc
    \begin{subequations}
        \begin{numcases}{}
            X=\frac{1}{ \sqrt{2} }(\tilde x+\tilde y)\\
            Y=\tilde y,
        \end{numcases}
    \end{subequations}
    et nous trouvons l'hyperbole
    \begin{equation}
        X^2-Y^2-1=0.
    \end{equation}
    Cela revient à faire le changement de base
    \begin{subequations}    \label{EqfiVwym}
        \begin{numcases}{}
            e'_1=\sqrt{2}e_1\\
            e'_2=-e_1+e_2.
        \end{numcases}
    \end{subequations}
    Pour rappel, les vecteurs de bases se transforment avec la matrice inverse des coefficients. Étant donné que
    \begin{equation}
        \begin{pmatrix}
            X    \\ 
            Y    
        \end{pmatrix}=\begin{pmatrix}
            1/\sqrt{2}    &   1/\sqrt{2}    \\ 
            0    &   1    
        \end{pmatrix}\begin{pmatrix}
            \tilde x    \\ 
            \tilde y    
        \end{pmatrix},
    \end{equation}
    nous avons
    \begin{equation}
        \begin{pmatrix}
            e'_1    \\ 
            e'_2    
        \end{pmatrix}=\begin{pmatrix}
            1/\sqrt{2}    &   1/\sqrt{2}    \\ 
            0    &   1    
        \end{pmatrix}^{-1}\begin{pmatrix}
            e_1    \\ 
            e_2    
        \end{pmatrix}.
    \end{equation}
    C'est de là que provient le changement \eqref{EqfiVwym}.
\end{example}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Applications affines}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{definition}      \label{DEFooUAWZooXcMKve}
    Soient \( \affE\) et \( \affE'\) deux espaces affines sur les espaces vectoriels \( E\) et \( E'\) (sur le même corps \( \eK\)). Une application \( f\colon \affE\to \affE'\) est dite \defe{affine}{affine!application} si il existe une application linéaire \( u\colon E\to E'\) telle que pour tout \( M\in\affE\) on ait
    \begin{equation}    \label{EqMqIoWX}
        f(M+x)=f(M)+u(x).
    \end{equation}
\end{definition}
\begin{remark}
    La condition \eqref{EqMqIoWX} pour tout \( M\in\affE\) est équivalente à demander 
    \begin{equation}
        f\circ t_x=t_{u(x)}\circ f
    \end{equation}
    pour tout \( x\in E\).
\end{remark}

\begin{proposition}
    Soit \( f\) une application affine.
    \begin{enumerate}
        \item
            Une application linéaire vérifiant la condition \eqref{EqMqIoWX} est unique. Nous la noterons \( u_f\).
        \item
            L'application \( u_f\) est injective si et seulement si \( f\) est injective.
        \item
            L'application \( u_f\) est surjective si et seulement si \( f\) est surjective.
    \end{enumerate}
    Si \( \affE\) et \( \affE'\) ont même dimension finie, alors en plus \( f\) est injective si et seulement si \( f\) est surjective.
\end{proposition}

\begin{remark}
    La fonction linéaire \( u_f\) qui vérifie \( f(M+x)=f(M)+u_f(x)\) ne dépend pas du point \( M\). En effet si
    \begin{subequations}
        \begin{align}
            f(M+x)&=f(M)+u(x)\\
            f(N+y)&=f(N)+v(y).
        \end{align}
    \end{subequations}
    En effet si \( N=M+a\) nous avons d'une part que
    \begin{equation}
        f(N+y)=f(M+y+a)=f(M)+u(y+a),
    \end{equation}
    et d'autre part
    \begin{equation}
        f(N+y)=f(M+a)+v(y)=f(M)+u(a)+v(y).
    \end{equation}
    Par conséquent \( u=v\).
\end{remark}

\begin{proposition}
    Si \( f\colon \affE\to \affE'\) et \( g\colon \affE\to \affE''\) sont des applications affines, alors \( g\circ f\colon \affE\to \affE''\) est affine et \( u_{g\circ f}=u_g\circ u_f\).
\end{proposition}

\begin{proof}
    Si \( M\in\affE\) et \( x\in E\) nous avons
    \begin{equation}
        \begin{aligned}[]
            (g\circ f)(M+x)&=g\big( f(M)+u_f(x) \big)\\
            &=f\big( f(M) \big)+u_g\big( u_f(x) \big)\\
            &=(g\circ f)(M)+(u_g\circ u_f)(x).
        \end{aligned}
    \end{equation}
\end{proof}

\begin{theorem}
    Soient \( \affE\) et \( \affE'\) deux espaces affines de dimensions finies \( p\) et \( q\) sur \( \eK\). Soient les repères cartésiens \( R=(O,\{ e_i \})\) et \( R'=(O',\{ e_i' \})\). Une application \( f\colon \affE\to \affE'\) est affine si et seulement si il existe une matrice \( a\in\eM_{p,q}(\eK)\) et \( b\in \eK^q\) tels que
    \begin{equation}    \label{EqCmNHjs}
        f(x)=b+ax.
    \end{equation}
\end{theorem}

\begin{remark}
    L'équation \eqref{EqCmNHjs} est écrite en utilisant un abus de notation entre le vecteur \( x\in \eK^p\) et le point de \( \affE\) qui est représenté par \( x\) dans le repère \( (A,\{ e_i \})\).    
\end{remark}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Isomorphismes}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{definition}
    Un \defe{isomorphisme}{isomorphisme!espace affine} entre les espaces affines \( \affE\) \( \affE'\) est une application affine \( f\colon \affE\to \affE'\) inversible dont l'inverse est affine.
\end{definition}

\begin{proposition} \label{PropxtFeDE}
    Une application affine bijective est un isomorphisme. Si \( f\) est un isomorphisme d'espaces affines, alors \( u_{f^{-1}}=(u_f)^{-1}\).
\end{proposition}

\begin{proposition}
    Un espace affine de dimension finie \( n\) sur un corps \( \eK\) est isomorphe à l'espace affine canonique \( \affE_n(\eK)\).
\end{proposition}

\begin{proof}
    Si nous considérons le repère \( R=(A,\{ e_i \})\) de l'espace affine \( \affE\) alors l'application
    \begin{equation}
        \begin{aligned}
            \varphi\colon \eK^n&\to \affE \\
            (x_1,\ldots,x_n)&\mapsto A+\sum_ix_ie_i 
        \end{aligned}
    \end{equation}
    est un isomorphisme.
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Sous espaces affines}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{definition}
    Soit \( \affE\) un espace affine sur l'espace vectoriel \( E\). Un \defe{sous-espace affine}{affine!sous-espace} de \( \affE\) est une orbite de l'action d'un sous-espace vectoriel de \( E\).
\end{definition}

Si \( \affF\) est un sous ensemble de \( \affE\), il sera un sous-espace affine de \( \affE\) si et seulement si l'ensemble
\begin{equation}
    F=\{ AB\tq A,B\in\affF \}
\end{equation}
est un sous-espace vectoriel de \( E\). Dans ce cas nous disons que \( F\) est la \defe{direction}{direction!sous-espace affine} de \( \affF\). Si \( A\in\affF\), alors l'orbite de \( A\) sous \( F\) est \( \affF\). La \defe{dimension}{dimension!sous espace affine} de \( \affF\) est la dimension de sa direction.

Si \( \affF\) et \( \affG\) sont des sous-espaces affines de \( \affE\) de directions \( F\) et \( G\), nous disons que \( \affF\) est \defe{parallèle}{parallèle!sous-espaces affines} à \( \affG\) si \( F\subset G\).

\begin{proposition}
    Soit \( \affF\) un sous-espace affine de dimension \( k\) dans l'espace affine \( \affE\) de dimension \( n\). Alors il existe une application affine \( f\colon \affE\to \eK^{n-k}\) telle que \( \affF=f^{-1}(0)\).
\end{proposition}

\begin{proof}
    Soit \( F\) la direction de \( \affF\) et \( A\in\affF\). Nous considérons une base \( \{ e_i \}\) adaptée à \( F\) au sens \( \{ e_1,\ldots, e_k \}\) est une base de \( F\). Nous considérons maintenant le repère cartésien \( (A,\{ e_i \})\) avec \( A\in\affF\) et nous construisons l'application affine
    \begin{equation}
        \begin{aligned}
            f\colon \affE&\to \eK^{n-k} \\
            A+\sum_{i=1}^nx_ie_i&\mapsto \begin{pmatrix}
                x_{k+1}    \\ 
                \vdots    \\ 
                x_n    
            \end{pmatrix}.
        \end{aligned}
    \end{equation}
    Par construction nous avons \( f(M)=0\) si et seulement si \( M\in\affF\).
\end{proof}

\begin{proposition}[\cite{Combes}]      \label{PropomhBwi}
    Soit \( \sigma\) une partie de l'espace affine \( \affE\).
    \begin{enumerate}
        \item
            L'intersection de tous les sous-espaces affines contenant \( \sigma\) est un sous-espace affine, noté \( \affF\).
        \item
            Si \( A\in \sigma\), alors la direction de \( \affF\) est le sous-espace vectoriel 
            \begin{equation}        \label{EqnRAUfg}
                F=\Span\{ \overrightarrow{ AM }\tq M\in \sigma \}.
            \end{equation}
    \end{enumerate}
\end{proposition}
Le sous-espace affine donné par la proposition \ref{PropomhBwi} est le sous-espace affine \defe{engendré}{sous-espace!affine engendré par une partie} par la partie~\( \sigma\), et il est noté \( \eae(\sigma)\). \index{engendré!sous-espace affine}

\begin{proposition}     \label{PROPooAKJBooMkmsiV}
    Soit \( \affE\) un espace affine de dimension \( n\) sur \( \eK\), soit \( f\colon \affE\to \eK^r\) une fonction affine. Pour tout \( a=(a_1,\ldots, a_r)\in \eK^r\), l'ensemble \( f^{-1}(a)\) est un sous-espace affine de dimension \( \dim\ker(u_f)\).
\end{proposition}

\begin{proof}
    Nous considérons le repère \( (A,\{ e_i \})\) de \( \affE\). Étant donné que \( f\) est affine nous avons
    \begin{equation}
        f\big( A+\sum_ix_ie_i \big)=f(A)+u_f\big( \sum_ix_ie_i \big).
    \end{equation}
    Nous avons donc \( f\big( A+\sum_ix_ie_i \big)=a\) lorsque
    \begin{equation}
        u_f(\sum_ix_ie_i)=a-f(A).
    \end{equation}
    Nous avons donc
    \begin{equation}
        f^{-1}(a)=A+(u_f)^{-1}\big( a-f(A) \big),
    \end{equation}
    dont la dimension est le rang de \( (u_f)^{-1}=u_{f^{-1}}\) (proposition \ref{PropxtFeDE}). Le rang de \( (u_f)^{-1}\) est le dimension du noyau de \( u_f\).
\end{proof}

\begin{proposition}     \label{PropPoNpPz}
    Soit \( A\) un ensemble convexe dans un espace vectoriel et \( v_1,\ldots, v_n\) des éléments de \( A\). Alors toute combinaison
    \begin{equation}
        a_1v_1+\ldots +a_nv_n
    \end{equation}
    telle que \( a_1+\ldots +a_n=1\) et \( a_i\in\mathopen[ 0 , 1 \mathclose]\) appartient à \( A\).
\end{proposition}

\begin{proof}
    Nous prouvons la proposition pour \( n=3\). Nous devons trouver des nombres \( t_1,t_2\in \mathopen[ 0 , 1 \mathclose]\) tels que
    \begin{equation}
        t_2\big( t_1v_1+(1-t_1)v_2 \big)+(1-t_2)v_3=av_1+bv_2+cv_3.
    \end{equation}
    La réponse est immédiatement donnée par
    \begin{subequations}
        \begin{align}
            t_2a=1-c\\
            t_1=a/t_2.
        \end{align}
    \end{subequations}
    Étant donné que \( c\in \mathopen[ 0 , 1 \mathclose]\) nous avons \( t_2\in\mathopen[ 0 , 1 \mathclose]\). En ce qui concerne \( t_1\) nous avons
    \begin{equation}
        t_1=\frac{ a }{ t_2 }\leq \frac{ 1-c }{ 1-c }=1.
    \end{equation}
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Barycentre}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Soit \( \affE\) un espace affine sur le \( \eK\)-espace vectoriel \( E\). Un couple \( (A,\lambda)\) avec \( A\in \affE\) et \( \lambda\in \eK\) est un \defe{point pondéré}{point!pondéré}.

\begin{lemmaDef}[\cite{sZiwBQ}]        \label{LemtEwnSH}
    Soit une famille de points pondérés \( \{ (A_i,\lambda_i) \}_{i=1\ldots r}\). Si \( \sum_i\lambda_i\neq 0\), alors il existe un unique \( G\in \affE\) tel que
    \begin{equation}
        \sum_{i=1}^r\lambda_i\overrightarrow{ GA_i }=0.
    \end{equation}
    Le point \( G\) donné par le lemme \ref{LemtEwnSH} est le \defe{barycentre}{barycentre!cas affine} des points pondérés \( (A_i,\lambda_i)\).
\end{lemmaDef}


Notons que l'on peut toujours supposer que \( \sum_i\lambda_i=1\) parce que le barycentre ne change pas lorsque tous les \( \lambda_i\) sont multipliés par un même nombre. 
\begin{definition}[Combinaison convexe]\label{DefIMZooLFdIUB}
    Des nombres \( \lambda_1\),\ldots, \( \lambda_n\) vérifiant \( \sum_i\lambda_i=1\) forment une \defe{combinaison convexe}{combinaison!convexe}.
\end{definition}

Le théorème suivant donné quelques caractérisations équivalentes du barycentre.
\begin{theorem}[\cite{sZiwBQ}]      \label{ThoIJVzxr}
    Soient \( \{ (A_i,\lambda_i) \}_{i=1,\ldots, r}\) une famille de points pondérés. Les conditions suivantes sur le point \( G\in \affE\) sont équivalentes.
    \begin{enumerate}
        \item
            Le point \( G\) est barycentre de la famille.
        \item
            Pour tout \( \alpha\in \eR^*\), \( \sum_i(\alpha\lambda_i)\overrightarrow{ GA_i }=0\).
        \item
            Il existe \( A\in\affE\) tel que \( \big( \sum_i\lambda_i \big)\overrightarrow{ AG }=\sum_i\lambda_i\overrightarrow{ AA_i }\).
        \item   \label{ItemEgOQBX}
            Pour tout \( B\in\affE\), nous avons \( \big( \sum_i\lambda_i \big)\overrightarrow{ BG }=\sum_i\lambda_i\overrightarrow{ BA_i }\).
    \end{enumerate}
\end{theorem}

\begin{definition}
    Si \( A,B\in \affE\), le \defe{segment}{segment!dans un espace affine} \( [AB]\) est l'ensemble des barycentres de \( A\) et \( B\) pondérés par des poids positifs (ouvert ou fermé suivant que l'on accepte que l'un ou l'autre des poids soit nul).
\end{definition}

Lorsque tous les \( \lambda_i\) sont égaux, nous parlons d'\defe{isobarycentre}{isobarycentre}. Autrement dit, l'isobarycentre des points \( A_i\) est le barycentre des points pondérés \( (A_i,1)\).

\begin{proposition}
    Une partie \( \affF\) des \( \affE\) est un sous-espace affine si et seulement si elle est stable par barycentrisation.
\end{proposition}

\begin{proof}
    Soit \( \affF\) une sous-espace affine de direction \( F\) et \( A_1,\ldots, A_n\) des points de \( \affF\). Nous devons voir que le barycentre des points \( A_i\) pondérés de n'importe quelles masses appartient à \( \affF\). Pour ce faire nous faisons appel à la caractérisation \ref{ItemEgOQBX} du théorème \ref{ThoIJVzxr} : pour tout \( B\in\affF\), 
    \begin{equation}
        \overrightarrow{ BG }=\sum_i\lambda_i\overrightarrow{ BA_i }.
    \end{equation}
    Vu que \( B\) et \( A_i\) sont dans \( \affF\), nous avons \( \overrightarrow{ BA_i\in F }\) et donc \( \overrightarrow{ BG }\in F\). Mais comme \( B\in\affF\), le point \( G\) est à son tour dans \( \affF\).

    Réciproquement, nous supposons que \( \affF\) est stable par barycentrisme. Nous voudrions montrer que l'ensemble
    \begin{equation}        \label{EqCmyWGi}
        F=\{ \overrightarrow{ AB }\tq A,B\in \affF \}
    \end{equation}
    est un sous-espace vectoriel. Soit \( A\in\affF\). Nous commençons par prouver que les vecteurs de la forme \( \overrightarrow{ AX }\) (\( X\in \affF\)) forment un espace vectoriel. Considérons \( \overrightarrow{ AX }+\overrightarrow{ AY }\) qui est un élément de \( E\); il existe donc \( V\in \affE\) tel que
    \begin{equation}
        \overrightarrow{ AV }=\overrightarrow{ AX }+\overrightarrow{ AY }.
    \end{equation}
    Par les relations de Chasles,
    \begin{equation}
        \overrightarrow{ AV }=\overrightarrow{ AV }+\overrightarrow{ VX }+\overrightarrow{ AV }+\overrightarrow{ VY },
    \end{equation}
    donc
    \begin{equation}
        0=\overrightarrow{ VX }-\overrightarrow{ VA }+\overrightarrow{ VY },
    \end{equation}
    ce qui prouve que \( V\) est un barycentre de \( X,A,Y\), et donc que \( V\in\affF\). De la même manière si \( W\in \affE\) est défini par \( \overrightarrow{ AW }=\mu \overrightarrow{ AX }\), alors
    \begin{equation}
        \overrightarrow{ AW }=\mu\overrightarrow{ AX }=\mu(\overrightarrow{ AW }+\overrightarrow{ WX }),
    \end{equation}
    ce qui signifie que
    \begin{equation}
        (1-\mu)\overrightarrow{ AW }+\mu\overrightarrow{ XW }=0
    \end{equation}
    et que \( W\) est un barycentre.

    Afin de montrer que \eqref{EqCmyWGi} est bien un espace vectoriel, nous devons considérer \( A,B,X,Y\in\affF\) et prouver que \( \overrightarrow{ AX }+\overrightarrow{ BY }\in F\). Nous avons
    \begin{subequations}
        \begin{align}
            \overrightarrow{ AX }+\overrightarrow{ BY }&=\overrightarrow{ AX }+\overrightarrow{ BA }+\overrightarrow{ AY }\\
            &=\overrightarrow{ AV }+\overrightarrow{ BA }   &\text{\( V\) est celui donné plus haut}\\
            &=\overrightarrow{ AV }-\overrightarrow{ AB }  \\
            &=\overrightarrow{ AV }+\overrightarrow{ AW }   &\text{\( W\) est donné par \( \mu=-1\).}\\
            &=\overrightarrow{ AV' }.
        \end{align}
    \end{subequations}
\end{proof}

\begin{proposition}[\cite{sZiwBQ}]      \label{PropBVbCOS}
    Soient \( A_0,\ldots, A_r\) des points de \( \affE\). L'ensemble des barycentres de ces points (avec des masses de somme \( 1\)) est le sous-espace affine engendré par les \( A_i\) que nous nommons \( \affF\).
\end{proposition}

\begin{proof}
    Soit \( G\) le barycentre associé aux poids \( \lambda_i\). Nous avons
    \begin{equation}
        G=A_0+\overrightarrow{ A_0G }=A_0+\sum_{i=1}^r\lambda_i\overrightarrow{ A_0A_i }.
    \end{equation}
    Notons que les vecteurs \( \overrightarrow{ A_0A_i }\) sont dans la direction du sous-espace affine engendré par les \( A_i\) par \eqref{EqnRAUfg}. Donc \( G\) est bien dans \( \affF\).

    Inversement si $X$ est dans \( \affF\), on a
    \begin{equation}
        X=A_0+\sum_i\lambda_i\overrightarrow{ A_0A_i }
    \end{equation}
    parce que \( \sum_i\lambda_i\overrightarrow{ A_0A_i }\) est un élément général de la direction de \( \affF\). Du coup
    \begin{equation}
        \overrightarrow{ A_0X }=\sum_i\lambda_i\overrightarrow{ A_0A_i },
    \end{equation}
    et en utilisant la relation de Chasles sur chacun des \( \overrightarrow{ A_0A_i }\),
    \begin{equation}
        \overrightarrow{ A_0X }=\sum_i\lambda_i\big( \overrightarrow{ A_0X }+\overrightarrow{ XA_i } \big).
    \end{equation}
    De là nous concluons que
    \begin{equation}
        \big( 1-\sum_i\lambda_i \big)\overrightarrow{ A_0X }+\sum_i\lambda_i\overrightarrow{ A_iX }=0,
    \end{equation}
    ce qui signifie précisément que \( X\) est un barycentre des \( A_i\).
\end{proof}

\begin{proposition}
    Soient \( r+1\) point \( A_0,\ldots, A_r\) dans \( \affE\). Le sous-espace affine engendré par les \( A_i\) est au plus de dimension \( r\).
\end{proposition}

\begin{proof}
    La direction de l'espace engendré \( \Aff\{ A_i \}\) est l'espace
    \begin{equation}
        \Span\{ \overrightarrow{ A_0A_i }_{i=1,\ldots, r} \}
    \end{equation}
    qui est engendré par \( r\) vecteurs et donc est au plus de dimension \( r\).
\end{proof}

En deux mots, la proposition suivante signifie que le barycentre des barycentres est le barycentre.
\begin{proposition}[Associativité des barycentres\cite{NOojwDf}]        \label{PropSFvjFZb}
    Soit \( I=\{ 0,1,\ldots, n \}\) et une partition \( I=J_0\cup\ldots\cup J_r\). Soient des points \( a_0,\ldots, a_n\in \affE\) et \( \lambda_0,\ldots, \lambda_m\) des nombres tels que \( \sum_i\lambda_i\neq 0\). Nous supposons que \( \mu_k=\sum_{i\in J_k}\lambda_i\neq 0\) pour tout \( k\), et enfin nous nommons \( b_k\) le barycentre de la famille \( \{ (a_i,\lambda_i),i\in J_k \}\).

    Alors le barycentre de la famille \( \{ (b_k,\mu_k) \}_{k=1,\ldots, n}\) est le barycentre de la famille \( \{ (a_i,\lambda_i) \}_{i\in I}\).
\end{proposition}

\begin{proof}
    Nous nommons \( b\) le barycentre des \( b_k\) pondérés par les \( \mu_k\), donc par définition
    \begin{subequations}
        \begin{align}
            0=\sum_{k=0}^r\mu_k\vect{ bb_k }\\
            &=\sum_{k}\sum_{i\in J_k}\lambda_i\vect{ bb_k }\\
            &=\sum_{k=0}^r\sum_{i\in J_k}\lambda_i(\vect{ ba_i }+\vect{ a_ib_k })\\
            &=\sum_{k=0}^r\sum_{i\in J_k}\lambda_i\vect{ ba_i }  +\sum_{k=0}^r\underbrace{\sum_{i\in J_k}\lambda_i\vect{ a_ib_k }}_{=0}\\
            &=\sum_{i\in I}\lambda_i\vect{ ba_i }.
        \end{align}
    \end{subequations}
    Donc \( b\) est bien barycentre des \( a_i\) avec les poids \( \lambda_i\).
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Enveloppe convexe}
%---------------------------------------------------------------------------------------------------------------------------

\begin{definition}      \label{DefNLYYooXUHFUY}
    Soit \( A\) une partie d'un espace vectoriel \( E\). L'\defe{enveloppe convexe}{enveloppe!convexe} de \( A\), notée \( \Conv(A)\)\nomenclature[G]{\( \Conv(A)\)}{enveloppe convexe} est l'intersection de tous les convexes contenant \( A\).
\end{definition}
L'enveloppe convexe est un convexe. En effet soit \( C\) un convexe contenant \( A\) et \( x,y\in\Conv(A)\); alors \( x\) et \( y \) sont dans \( C\) et par conséquent le segment \( [x,y]\) est inclus à \( C\). Ce segment étant inclus à tout convexe contenant \( A\), il est inclus à \( \Conv(A)\).

\begin{proposition}[\cite{IQeaKlP}] \label{PropSVvAQzi}
    Soit \( C\) un convexe dans l'espace affine \( \affE\) et une famille de points pondérés \( \{ (a_i,\lambda_i) \}_{i=1,\ldots, r}\) dont tous les poids sont positifs (et non tous nuls). Alors le barycentre est aussi dans \( C\).

    En d'autre termes, un convexe est stable par barycentrage à poids positifs\footnote{Sauf si on prend tous les poids nuls; mais contre ce genre d'idées, on ne peut rien faire.}.
\end{proposition}
\index{convexité!barycentre}

\begin{proof}
    Nous prouvons par récurrence. D'abord pour \( r=2\). Le barycentre des points pondérés \( (a_1,\lambda_1)\), \( (a_2,\lambda_2)\) est le point \( b\) tel que
    \begin{equation}        \label{EqFWEErRX}
        \lambda_1\vect{ ba_1 }+\lambda_2\vect{ ba_2 }=0.
    \end{equation}
    Par définition, ce qui est noté \( \vect{ ab }\) n'est rien d'autre que \( b-a\); en déballant \eqref{EqFWEErRX}, nous trouvons
    \begin{equation}
        \lambda_1(a_1-b)+\lambda_2(a_2-b)=0
    \end{equation}
    et donc
    \begin{equation}
        b=\frac{ \lambda_1 }{ \lambda_1+\lambda_2 }a_1+\frac{ \lambda_2 }{ \lambda_1+\lambda_2 }a_2,
    \end{equation}
    qui est bien un point du segment \( [a_1,a_2]\) parce que c'est une combinaison à coefficients positifs de somme \( 1\).

    Nous passons maintenant à la vraie récurrence avec un ensemble de points pondérés
    \begin{equation}
        A_r=\{ (a_1,\lambda_1),\ldots, (a_r,\lambda_r) \}
    \end{equation}
    de masse totale non nulle; et en vous laissant deviner ce que va désigner \( A_{r-1}\). Si une des masses est nulle (disons \( \lambda_r\)), alors le barycentre de \( A_r\) est le même que celui de \( A_{r-1}\) et l'hypothèse de récurrence nous enseigne que ledit barycentre est dans \( C\). Nous supposons donc que \( \lambda_i\neq 0\) pour tout \( i\). Dans ce cas le théorème d'associativité des barycentres \ref{PropSFvjFZb} dit que le barycentre de \( A_r\) est le barycentre entre le barycentre de \( A_{r-1}\) et \( (a_r,\lambda_r)\), qui sont deux points de \( C\) par hypothèse de récurrence. 
\end{proof}

Si \( E\) est un espace vectoriel et si \( x_i\in E\) et \( \lambda_i\in \eR\), alors le barycentre des couples \( (x_i,\lambda_i)\) est le point \( g\) tel que \( \sum_i\lambda_i\vect{ gx_i }\), c'est à dire \( \sum_i\lambda_i(x_i-g)=0\) ou encore
\begin{equation}
    \sum_i\lambda_ix_i=\sum_i\lambda_ig.
\end{equation}
Donc quitte à diviser tous les \( \lambda_i\) par la somme, nous pouvons supposer que la somme des poids est \( 1\). C'est pourquoi lorsque nous parlerons de barycentre dans un espace vectoriel sans contexte affin, nous allons toujours supposer \( \sum_i\lambda_i=0\) et avoir le barycentre
\begin{equation}
    g=\sum_i\lambda_ix_i.
\end{equation}

\begin{proposition} \label{PropYHMTmZX}
    Soit \( E\), un espace vectoriel et \( A\subset E\). L'enveloppe convexe \( \Conv(A)\) est l'ensemble des barycentres de familles finies de points affublés de masses positives.
\end{proposition}

\begin{proof}
    Nous notons \( \mB\) l'ensemble des dits barycentres. Par la proposition \ref{PropSVvAQzi}, ces barycentres sont dans l'enveloppe convexe et donc \( \mB\subset\Conv(A)\). A contrario, si nous prouvons que \( \mB\) était convexe, alors nous aurions \( \Conv(A)\subset\mB\) parce que l'enveloppe convexe est l'intersection des convexes contenant $A$.

    Soient \( a,b\in\mB\), c'est à dire que l'on a \( a_0,\ldots, a_n\) et \( b_0,\ldots, b_m\) dans \( A\) ainsi que les nombres strictement positifs \( \lambda_0,\ldots, \lambda_n\) et \( \mu_0,\ldots, \mu_m\) tels que
    \begin{subequations}
        \begin{align}
            a&=\sum_i\lambda_ia_i       & \sum_{i=1}^n\lambda_i&=1\\
            b&=\sum_j\mu_jb_j           &\sum_{j=1}^n\mu_j&=1
        \end{align}
    \end{subequations}
    Un point du segment \( \mathopen[ a , b \mathclose]\) est de la forme \( p=ta+(1-t)b\) avec \( t\in \mathopen[ 0 , 1 \mathclose]\). En développant,
    \begin{equation}
        p=\sum_{i=0}^n(t\lambda_i)a_i+\sum_{j=0}^m(1-t)\mu_jb_j.
    \end{equation}
    Cela est le barycentre de la famille \( \{ (a_i,\lambda_i),(b_j,\mu_j) \}\), parce que la somme des coefficients est bien \( 1\) :
    \begin{equation}
        \sum_i(t\lambda_i)+\sum_j(1-t)\mu_j=t+(1-t)=1.
    \end{equation}
\end{proof}


\begin{theorem}[Carathéodory\cite{KXjFWKA}] \label{ThoJLDjXLe}
    Dans un espace affine de dimension \( n\), l'enveloppe convexe\footnote{Définition \ref{DefNLYYooXUHFUY}.} de \( A\) est l'ensemble des barycentres à coefficients positifs ou nuls de familles de \( n+1\) points.
\end{theorem}
\index{barycentre!enveloppe convexe}
\index{dimension!utilisation}
\index{théorème!Carathéodory}

\begin{proof}
    Soit \( x\in\Conv(A)\); on sait par la proposition \ref{PropYHMTmZX} que \( x\) est barycentre de points de \( A\) avec des coefficients positifs :
    \begin{equation}    \label{EqWJDwOTH}
        x=\sum_{k=1}^p\lambda_kx_k
    \end{equation}
    avec \( \sum_k\lambda_k=1\). Nous supposons que \( p>n+1\) (sinon le théorème est réglé), et nous allons faire une récurrence à l'envers en montrant qu'on peut aussi écrire \( x\) sous forme d'un barycentre de strictement moins de \( p\) points.
    
    Étant donné que \( p-1>n\), la famille \( \{ x+i-x_1 \}_{i=2,\ldots, p}\) est liée et il existe donc \( \alpha_1,\ldots, \alpha_p\in \eR\) tels que \( \sum_{i=2}^p\alpha_i(x_i-x_1)=0\), c'est à dire telle que
    \begin{equation}
        \sum_{i=2}^p\alpha_ix_i=\sum_{i=2}^p\alpha_ix_1.
    \end{equation}
    Nous posons \( \alpha_1=-\sum_{i=2}^p\alpha_1\). Remarquons qu'alors \( \sum_{i=1}^p\alpha_ix_i=0\) parce que
    \begin{equation}
        \sum_{i=1}^p\alpha_ix_i=\alpha_1x_1+\sum_{i=2}^p\alpha_ix_i=\alpha_1x_1+\sum_{i=2}^p\alpha_ix_1=\sum_{i=1}^p\alpha_ix_1=0.
    \end{equation}
    Par conséquent ça ne coûte rien de récrire \eqref{EqWJDwOTH} sous la forme
    \begin{equation}
        x=\sum_{i=1}^p(\lambda_i+t\alpha_i)x_i.
    \end{equation}
    Les \( \alpha_i\) ne sont pas tous nuls, mais leur somme est nulle, donc il y en a au moins un négatif. Nous notons
    \begin{equation}
        \tau=\min\{ -\frac{ \lambda_i }{ \alpha_i }\tq \alpha_i<0 \},
    \end{equation}
    et \( J\) l'ensemble de \( i\) pour lesquels ce minimum est atteint. Nous considérons aussi le nombres \( \mu_i=\lambda_i+\tau\alpha_i\). Plusieurs remarques. 
    \begin{enumerate}
        \item
            Si \( j\in J\), alors \( \mu_j=0\)
        \item
            Si \( \alpha_i>0\) alors \( \mu_i\geq 0\), mais si \( \alpha_i<0\) alors
            \begin{equation}
                \lambda_i+\tau\alpha_i\geq \lambda_i+(-\frac{ \lambda_i }{ \alpha_i })\alpha_i=0m
            \end{equation}
            donc \( \mu_i\geq 0\) quand même.
        \item
            \( \sum_{i=1}^p\mu_i=1\), toujours parce que \( \sum_{i=1}^p\alpha_i=0\).
    \end{enumerate}
    Avec tout ça, nous avons
    \begin{equation}
        \sum_{i\notin J}\mu_ix_i=\sum_{i=1}^p\mu_ix_i=x.
    \end{equation}
    Et voila, nous avons écrit \( x\) comme un barycentre à coefficients positifs de moins de \( p\) éléments parce que \( J\) n'est pas vide.
\end{proof}

\begin{corollary}   \label{CorOFrXzIf}
    Dans un espace affine de dimension finie, l'enveloppe convexe d'un compact est compacte.
\end{corollary}

\begin{proof}
    Soit \( A\) une partie compacte de l'espace vectoriel \( E\), et \( \Conv(A)\) son enveloppe convexe. Nous allons montrer que toute suite dans \( \Conv(A)\) admet une sous-suite convergente en écrivant un point de \( \Conv(A)\) comme le théorème de Carathéodory \ref{ThoJLDjXLe} nous le suggère. Pour cela nous considérons le simplexe
    \begin{equation}
        \Lambda=\left\{  \lambda\in \eR^{n+1}\tq \sum_{k=1}^{n+1}\lambda_k=1\text{ et } \lambda_k\geq 0\forall k   \right\}.    
    \end{equation}
    Montrons en passant que \( \Lambda\) est compact. Si \( \lambda_k\in \Lambda\) est une suite, alors chacun des \( \lambda_k\) est un \( (n+1)\)-uple de nombres dans \( \mathopen[ 0 , 1 \mathclose]\) :
    \begin{equation}
        k\mapsto (\lambda_k)_i
    \end{equation}
    est une suite qui possède une sous-suite convergente. En passant \( n+1\) fois à une sous-suite, nous tombons sur une suite convergente vers \( \lambda\in\Lambda\), grâce à la convergence composante par composante. De plus pour chaque \( k\) nous avons \( \sum_{i=1}^{n+1}(\lambda_k)_i=1\), et en passant à la limite, la somme étant une application continue, \( \sum_{i}\lambda_i=1\).

    Considérons l'application
    \begin{equation}
        \begin{aligned}
            f\colon \Lambda\times A^{n+1}&\to \Conv(A) \\
            (\lambda,x)&\mapsto \sum_{k=1}^{n+1}\lambda_kx_k. 
        \end{aligned}
    \end{equation}
    C'est une application continue parce qu'elle est bilinéaire en dimension finie; son image est contenue dans \( \Conv(A)\) par la proposition \ref{PropSVvAQzi}, et elle est surjective par le théorème de Carathéodory \ref{ThoJLDjXLe}. Bref, \( \Conv(A)=f(\Lambda\times A^{n+1})\) est donc l'image d'un compact par une application continue; elle est donc compacte par le théorème \ref{ThoImCompCotComp}.
\end{proof}
Notons que sans le théorème de Carathéodory, peut être que le nombre de points utiles pour décomposer les différents \( a_k\) n'était pas borné; dans ce cas nous aurions du prendre une infinité de sous-suites et rien n'aurait été sûr.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Repères, coordonnées cartésiennes et barycentriques}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{definition}
    On dit que les points \( A_0,\ldots, A_r\in \affE\) sont \defe{affinement indépendants}{indépendance!affine} si le sous-espace affine engendré est de dimension \( r\).
\end{definition}

\begin{proposition}[\cite{sZiwBQ}]  \label{PropGAneHg}
    Pour \( r+1\) points \( A_0,\ldots, A_r\) dans \( \affE\), les propriétés suivantes sont équivalentes.
    \begin{enumerate}
        \item
            Les \( A_i\) sont affinement indépendants.
        \item
            Pour tout \( i=0,\ldots, r\), le point \( A_i\) n'est pas dans \( \Aff\{ A_0,\ldots, \hat A_i,\ldots, A_r \}\).
        \item\label{ItemrAzkIl}
            Les points \( A_0,\ldots, A_{r-1}\) sont affinement indépendants et \( A_r\notin\Aff\{ A_0,\ldots, A_{r+1} \}\).
        \item
            Il existe \( i\) tel que les vecteurs \( \overrightarrow{ A_kA_i }\) (\( k\in i\)) sont linéairement indépendants.
        \item\label{ItemFBfcuq}
            Pour tout \( i\in\{ 1,\ldots, r \}\), les vecteurs \( \overrightarrow{ A_kA_i }\) (\( k\neq i\)) sont linéairement indépendants.
    \end{enumerate}
\end{proposition}

Notons à propos de la condition \ref{ItemrAzkIl} que l'existence d'un \( i\) tel que \( A_i\notin\Aff\{ A_0,\ldots, \hat A_i,\ldots, A_r \}\) n'implique pas l'indépendance des \( r+1\) points. En effet dans \( \eR^2\) nous considérons les \( 4\) points \( A_0=(0,0)\), \( A_1=(1,0)\), \( A_2=(2,0)\) et \( A_3=(0,1)\). Évidemment le point \( A_3\) n'est pas dans l'espace engendré par les trois autres; il n'empêche que ces points ne sont pas affinement indépendants parce que la direction est de dimension \( 2\) au lieu de \( 3\).

\begin{definition}  \label{DefguuwEO}
    Soit \( \affE\) un espace affine de dimension \( n\) et \( \affF\) un sous-espace affine de dimension. Un \defe{repère affine}{repère!affine} de \( \affF\) est la donnée de \( k+1\) points affinement indépendants de \( \affF\).
\end{definition}
Si \( \{ A_0,\ldots, A_n \}\) est un repère affine, le point \( A_0\) est l'\defe{origine}{origine!repère affine}. C'est un choix complètement arbitraire; et c'est bien cet arbitraire qui nous amènera à considérer les coordonnées barycentriques au lieu des coordonnées cartésiennes.

Soit \( M\in \affE\); par définition nous avons
\begin{equation}
    M=A_0+\overrightarrow{ A_0M }.
\end{equation}
Mais nous savons que les vecteurs \( \overrightarrow{ A_0A_i }\) forment une base de \( E\), nous avons donc des nombres \( \lambda_i\) tels que
\begin{equation}
    \overrightarrow{ A_0M }=\sum_{i=1}^n\lambda_i\overrightarrow{ A_0A_i }.
\end{equation}
Les nombres \( \lambda_i\) ainsi construits sont les \defe{coordonnées cartésiennes}{coordonnées!cartésiennes!dans un espace affine} du point \( M\) dans le repère \( \{ A_0,\ldots, A_n \}\) d'origine \( A_0\).

À partir de ces coordonnées, le point \( M\in\affE\) se retrouve par la formule
\begin{equation}
    M=A_0+\sum_{i=1}^n\lambda_i\overrightarrow{ A_0A_i }.
\end{equation}

Les coordonnées barycentriques sont données par la proposition suivante.
\begin{proposition}[\cite{sZiwBQ}]
    Soient \( A_0,\ldots, A_r\) des points affinement indépendants dans \( \affE\) et \( \affF=\Aff\{ A_0,\ldots, A_r \}\). Tout point \( M\in\affF\) s'écrit de façon unique comme barycentre des \( A_i\) affectés de poids \( \lambda_i\) tels que \( \sum_{i=0}^r\lambda_i=1\).
\end{proposition}
Les nombres \( \lambda_i\) ainsi définis sont les \defe{coordonnées barycentriques}{coordonnées!barycentriques} de \( M\) dans le repère \( (A_0,\ldots, A_r)\) de \( \affF\).

\begin{proof}
    Nous avons vu plus haut (définition \ref{DefguuwEO}) que l'affine indépendance des points \( A_i\) assurait que \( (A_0,\ldots, A_r)\) était un repère de \( \affF\).

    En ce qui concerne l'existence de l'écriture de \( M\) comme barycentre, nous savons que les sous-espace affine sont exactement les ensembles de barycentres (proposition \ref{PropBVbCOS}), c'est à dire que si on a des points dans un sous-espace affine, alors les barycentres de ces points est encore dans le sous-espace affine.

    L'unicité est comme suit. Si \( M\) est barycentre des \( A_i\) avec poids \( \lambda_i\), nous écrivons la caractérisation \ref{ItemEgOQBX} du théorème \ref{ThoIJVzxr} avec \( B=A_0\) :
    \begin{equation}
        \overrightarrow{ A_0M }=\sum_{i=1}^r\lambda_i\overrightarrow{ A_0A_i }
    \end{equation}
    où la somme à droite s'étend a priori de \( 0\) à \( r\), mais comme \( \overrightarrow{ A_0A_0 }=0\), nous l'avons limitée à \( 1\). Si \( M\) s'écrit comme barycentre de deux façons différentes, nous aurions
    \begin{equation}
        \overrightarrow{ A_0M }=\sum_{i=1}^r\lambda_i\overrightarrow{ A_0A_i }=\sum_{i=1}^r\mu_i\overrightarrow{ A_0A_i }
    \end{equation}
    avec \( \sum_i\lambda_i=\sum_i\mu_i=1\). Étant donné que les points \( A_0,\ldots, A_r\) forment un repère, les vecteurs \( \overrightarrow{ A_0A_i }\) sont linéairement indépendants (point \ref{ItemFBfcuq} de la proposition \ref{PropGAneHg}) et donc \( \lambda_i=\mu_i\) pour \( i=1,\ldots, r\). La condition de somme des points égale à \( 1\) impose alors immédiatement \( \lambda_0=\mu_0\).
\end{proof}

\begin{example}
    Soient les points \( A=(3,1)\), \( B=(-1,2)\) et \( C=(0,-1)\) dans \( \eR^2\). Nous allons montrer qu'il forment un repère affine de \( \eR^2\). L'espace engendré par ces trois points est l'espace des
    \begin{equation}
        A+\alpha\overrightarrow{ AB }+\beta\overrightarrow{ AC },
    \end{equation}
    et la direction correspondante est l'espace vectoriel donné par \( \alpha\overrightarrow{ AB }+\beta\overrightarrow{ AC }\) qui est de dimension deux. Donc l'espace affine engendré par \( A\), \( B\) et \( C\) est de dimension \( 2\).
\end{example}

\begin{example}
    Dans le repère \( (A,B,C)\), quel est le point de coordonnées barycentriques \( (\frac{1}{ 6 },\frac{1}{ 3 },\frac{1}{ 2 })\) ? D'abord nous vérifions que
    \begin{equation}
        \frac{1}{ 6 }+\frac{1}{ 3 }+\frac{1}{ 2 }=1.
    \end{equation}
    Ensuite nous cherchons \( X\in \eR^2\) tel que
    \begin{equation}
        \frac{1}{ 6 }\overrightarrow{ AX }+\frac{1}{ 3 }\overrightarrow{ BX }+\frac{1}{ 2 }\overrightarrow{ CX }=0,
    \end{equation}
    c'est à dire
    \begin{equation}
        \frac{1}{ 6 }\begin{pmatrix}
            x-3    \\ 
            y-1    
        \end{pmatrix}+\frac{1}{ 3 }\begin{pmatrix}
            x+1    \\ 
            y-2    
        \end{pmatrix}+\frac{1}{ 2 }\begin{pmatrix}
            x    \\ 
            y+1    
        \end{pmatrix}=0.
    \end{equation}
    Nous trouvons immédiatement \( x=1/6\) et \( y=1/3\). Le point cherché est donc le point \( \begin{pmatrix}
        1/6    \\ 
        1/3    
    \end{pmatrix}\).
\end{example}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Équation de droite}
%---------------------------------------------------------------------------------------------------------------------------

Soit \( \affE\) un espace affine de dimension trois muni d'un repère barycentrique. Une droite est donnée par trois nombres : \( D=D(a,b,c)\) est l'ensemble des points dont les coordonnées barycentriques (normalisées) \( (x,y,z)\) vérifient \( ax+by+cz=0\). C'est un espace de dimension un parce qu'il y a aussi la condition \( x+y+z=1\).

La droite \( D(1,1,1,)\) n'existe pas parce que ce serait \( x+y+z=0\), qui est incompatible avec \( x+y+z=1\). 

Les droites \( D(a,b,c)\) et \( D(a',b',c')\) s'intersectent selon les solutions du système
\begin{subequations}
    \begin{numcases}{}
        x+y+z=1\\
        ax+by+cz=0\\
        a'x+b'y+c'z=0
    \end{numcases}
\end{subequations}
Donc deux droites affines ont un unique point d'intersection si et seulement si
\begin{equation}
    d=\begin{vmatrix}
        1    &   1    &   1    \\
        a    &   b    &   c    \\
        a'    &   b'    &   c'
    \end{vmatrix}\neq 0.
\end{equation}
Elles seront parallèles ou confondues si et seulement si \( d=0\).

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Structure du groupe des applications affines}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Soit \( v\in \eR^n\); nous notons \( \tau_v\colon \eR^n\to \eR^n\) la translation donnée par \( \tau_v(x)=x+v\). Le groupe de toutes les translation de \( \eR^n\) est noté \( T(n)\) et est isomorphe au groupe abélien \( (\eR^n,+)\).

En prenant \( M=0\) dans la définition \ref{DEFooUAWZooXcMKve} et en pensant à l'espace \( \eR^n\) comme espace affine, nous posons la définition suivante pour les applications de \( \eR^n\) dans \( \eR^n\) (et d'ailleurs pour n'importe quel espace vectoriel de dimension finie).

\begin{definition}      \label{DEFooJWWYooNqfoPJ}
    Une application \defe{affine}{application!affine} sur \( \eR^n\) est une application \( \eR^n\to \eR^n\) pouvant être écrite sous la forme \( \tau_c\circ \alpha\) où \( v\in \eR^n\) et où \( \alpha\) est une application linéaire.
\end{definition}

\begin{proposition}     \label{PROPooYRCJooIcmUVI}
    Soit une application affine \( f\colon \eR^n\to \eR^n\). L'ensemble des points fixes 
    \begin{equation}
        \Fix(f)=\{ x\in \eR^n\tq f(x)=x \}
    \end{equation}
    est soit vide soit un sous-espaces affine de \( \eR^n\).
\end{proposition}

\begin{proof}
    Soit \( f=\tau_v\circ \alpha\); nous avons \( x\in\Fix(f)\) si et seulement si
    \begin{equation}
        x=\tau_v\big( \alpha(x) \big)=\alpha(x)+v,
    \end{equation}
    autrement dit, en considérant l'application linéaire \( \beta=\id-\alpha\), si et seulement si \( \beta(x)=v\). Nous écrivons \( \Fix(f)=\beta^{-1}(v)\). Supposons que ce soit non vide et considérons \( x_0\in\beta^{-1}(v)\). Nous avons
    \begin{subequations}
        \begin{align}
            \beta^{-1}(v)&=\{ x\in \eR^n\tq \beta(x)=\beta(x_0) \}\\
            &=\{ x\tq \beta(x-x_0)=0 \}\\
            &=\{ x\tq x-x_0\in \ker(\beta) \}\\
            &=\ker(\beta)+x_0\\
            &=\tau_{x_0}\big( \ker(\beta) \big).
        \end{align}
    \end{subequations}
    Mais comme \( \ker(\beta)\) est un sous-espace vectoriel, \( \beta^{-1}(v)\) est le translaté d'un sous-espace vectoriel, c'est à dire un sous-espace affine.
\end{proof}

\begin{definition}
    Le groupe \( \Aff(\eR^n)\)\nomenclature[R]{\( \Aff(\eR^n)\)}{Le groupe des applications affines bijectives de \( \eR^n\).} est le groupe des applications affines bijectives de \( \eR^n\).
\end{definition}

\begin{remark}
    Le fait que ce soit un groupe est rapidement vu par le calcul suivant :
    \begin{equation}
        (\tau_v\circ\alpha)\circ(\tau_w\circ\beta)(x)=(\alpha\beta)(x)+\alpha(w)+v=\tau_{\alpha(w)+v}\circ(\alpha\beta).
    \end{equation}
\end{remark}

\begin{proposition}  \label{PROPooTPFZooKtFxhg}
    L'ensemble \( \Aff(\eR^n)\) est isomorphe au produit semi-direct\footnote{Définition \ref{DEFooKWEHooISNQzi}.}
    \begin{equation}
        \Aff(\eR^n)\simeq  T(n)\times_{\AD}\GL(n,\eR)
    \end{equation}
    où \( \AD\) est l'action adjointe, c'est à dire
    \begin{equation}
        \begin{aligned}
            \AD\colon \GL(n,\eR)&\to \Aut\big( T(n) \big) \\
            \tau_v&\mapsto \alpha\circ\tau_v\circ\alpha^{-1}. 
        \end{aligned}
    \end{equation}
\end{proposition}

\begin{proof}
    L'application que nous allons montrer être un isomorphisme est \( \psi\) qui à \( f=\tau_v\circ\alpha\) fait correspondre le couple \( (\tau_v,\alpha)\in T(n)\times \GL(n,\eR)\).
    \begin{subproof}
        \item[Égalité d'ensembles]
            Il faut que \( \Aff(\eR^n)\) soit en bijection avec \( T(n)\times \GL(n,\eR)\). En effet si \( f\in \Aff(\eR^n)\), la décomposition \(f=\tau_v\circ\alpha \) est unique. D'abord en appliquant à \( 0\), \( f(0)=\tau_v\big( \alpha(v) \big)=v\). Donc \( v\) est fixé par la valeur de \( f(0)\). Ensuite \( \alpha=f\circ\tau_v^{-1}\), donc \( \alpha \) fixé.
        \item[L'action adjointe fonctionne]
            Il faut vérifier que \( \alpha\circ\tau_v\circ\alpha^{-1}\) est bien dans \( T(n)\). Pour cela, en agissant sur \( x\in \eR^n\) nous trouvons
            \begin{equation}
                \alpha\tau_v\alpha^{-1}(x)=\alpha\big( \alpha^{-1}(x)+v \big)=x+\alpha(v)=\tau_{\alpha(v)}(x).
            \end{equation}
            Le fait que \( \AD(\alpha)\) soit un automorphisme est toujours correct.
        \item[Morphisme]
            Il faut vérifier que l'application \( \psi\) est un morphisme de groupe. D'abord la loi de groupe sur \( \Aff(\eR^n)\) est donnée par
            \begin{equation}
                (\tau_v\circ \alpha)\circ(\tau_w\circ\beta)=\tau_{v+\alpha(w)}\circ(\alpha\circ\beta).
            \end{equation}
            Ensuite le loi de groupe de le produit semi-direct est donnée par
            \begin{equation}
                (\tau_v,\alpha)\cdot(\tau_w,\beta)=\big( \tau_v\AD(\alpha)\tau_w,\alpha\beta \big)=\big( \tau_v\tau_{\alpha(w)},\alpha\beta \big)=\big( \tau_{\alpha(w)+v},\alpha\beta \big).
            \end{equation}
            Nous avons donc bien
            \begin{equation}
                \psi\big( (\tau_v,\beta)\cdot(\tau_w,\beta) \big)=\psi(\tau_v,\beta)\circ\psi(\tau_w,\beta).
            \end{equation}
    \end{subproof}
\end{proof}
