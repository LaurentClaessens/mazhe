% This is part of (almost) Everything I know in mathematics
% Copyright (c) 2013-2014
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
					\section{Modular theory}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

%---------------------------------------------------------------------------------------------------------------------------
					\subsection{Modular isometry}
%---------------------------------------------------------------------------------------------------------------------------

Let $M$ be a von~Neumann algebra provided with $\varphi$, a faithful normal state. We consider $L_{\varphi}^2(M)$\nomenclature{$L_{\varphi}^2(M)$}{A completion of the von~Neumann algebra $M$}, the completion of $M$ for the norm associated with the inner product
\begin{equation}
	\langle T_1, T_2\rangle =\varphi(T^*_1T_2).
\end{equation}
That product is conjugate-linear in his first argument and linear in the second. The algebra $M$ acts at left by multiplication on $L_{\varphi}^2(M)$, by extending
\begin{equation}
	T\cdot S = TS.
\end{equation}
The space $L_{\varphi}^2(M)$ has a distinguished vector: the one represented by $\mtu\in M$ that we call $v$. It is a cyclic vector for $M$, i.e. the space $Mv$ is dense in $ L_{\varphi}^2(M)$. It is also separating, because $Tv=0$ with $T\in M$ implies $T=0$.

Conversely, if $\hH$ is an Hilbert space and $v\in\hH$ is cyclic and separating for a von~Neumann algebra, then the expression
\begin{equation}
	\varphi(T)=\langle v, Tv\rangle 
\end{equation}
defines a faithful (because separating) normal state on the von~Neumann algebra. Thus, in fact $\hH\simeq  L_{\varphi}^2(M)$ via an unitary isomorphism compatible with $M$. 

A natural question arising is to know the commutant of $M$ acting by left multiplication on $ L_{\varphi}^2(M)$. Let us suppose that $\varphi$ is also a trace, so we drot the index and we write $ L^2(M)$ instead of $ L_{\varphi}^2(M)$. We define
\begin{equation}
\begin{aligned}
 J\colon  L^2(M)&\to  L^2(M) \\ 
   Tv&\mapsto T^*v. 
\end{aligned}
\end{equation}
That definition is correct because $\{ Tv\tq T\in M \}$ is dense in $L^2(M)$. Notice that $T_1v=T_2v$ implies $T_1=T_2$, so that, when $\xi\in L^2(M)$ can be represented as $Tv$, that $T\in M$ is unique. 

The following lemma provides the main properties of $J$.
\begin{lemma}			\label{LemPropJ}
	The map $J$ has the following properties.
	\begin{enumerate}
		\item $J$ is conjugate-linear.
		\item\label{ItemPropJii} It is an isometry in the sense of conjugate linear operators.
		\item $J^2=\mtu$.
		\item\label{ItemPropJiv} $JMJ\subseteq M'$.
		\item\label{ItemPropJv}  $\langle Sv, JTv\rangle = \langle JS^*v, T^*v\rangle  $ for every $S$ and $T$ in $M$.
	\end{enumerate}
\end{lemma}

\begin{proof}
	The proof of \ref{ItemPropJii} is a computation using the definition of $J$, the definition of the inner product and the fact that $\varphi$ is a state:
	\begin{equation}
		\langle JT_1v, JT_2v\rangle =\langle T_1^*v, T_2^*v\rangle\varphi(T_1T^*_2)=\overline{ \varphi(T_2T_1^*) }=\overline{ \varphi(T_1^*T_2) }=\overline{ \langle T_1v, T_2v\rangle  }.
	\end{equation}
	For \ref{ItemPropJiv}, remark that
	\begin{equation}
		(JTJ)(Sv)=JT(S^*v)+J(TS^*v)=ST^*v.
	\end{equation}
\end{proof}

\begin{definition}
	A \defe{modular isometry}{modular!isometry} for $M$ with respect to the cyclic vector $v$ is a map $J\colon L^2(M)\to L^2(M)$ which satisfies 
	\begin{enumerate}
		\item $Jv=v$.,
		\item $J$ is a conjugate linear isometry,
		\item $J^2=1$,
		\item $JMJ\subseteq M'$,
		\item $\langle JSv, Tv\rangle =\langle S^*v, JT^*v\rangle $ for every $S$, $T\in M'$.
	\end{enumerate}
	Notice the difference between the claim \ref{ItemPropJv} of lemma \ref{LemPropJ}.
\end{definition}

\begin{lemma}
	If $v$ is cyclic for $M$, then it is separating for $M'$, and if it is separating for $M$, then it is cyclic for $M'$.
\end{lemma}


\begin{proposition}
	If $J$ is a modular isometry, then $JMJ=M'$. In particular, $M$ and $M'$ are of same type.
\end{proposition}

\begin{proof}
	We have to prove that $T\in JMJ$ whenever $T\in M'$. Let $S$ and $T$ be in $M'$, and let us prove that $JSJ$ and $T$ commute. For that, we are going to prove that
	\begin{equation}
		\langle JSJTv, v\rangle =\langle TJSJv, v\rangle,
	\end{equation}
	which is sufficient because the product is nondegenerate. For all $S$ and $T$ in $M'$, one successively has
	\begin{equation}
	\begin{aligned}[]
		\langle JSJTv, v\rangle =\langle JSJTv, J^2v\rangle	&=\langle Jv, SJTv\rangle =\langle v, SJTv\rangle\\
									& =\langle S^*v, JTv\rangle =\langle JSv, T^*v\rangle=\langle TJSJv, v\rangle,
	\end{aligned}
\end{equation}
	where we used the extra property $Jv=v$ which defines a modular isometry.

	Now we repeat the same with $S_1=A^*S$ and $T_1=TB$ where $A\in JMJ\subseteq M'$ and $B\in JMJ$. The operators $S_1$ and $T_1$ belong to $M'$ because $S$ and $T$ belong to $M'$. We find
	\begin{equation}
		\langle JSJT(Bv), (JAv)\rangle =\langle TSJS(Bv), (JAv)\rangle.
	\end{equation}
	Using the fact that $v$ is cyclic, the vectors $Bv$ and $JAv$ separately span dense subspaces, so that, as operators, $TSJT=TJSJ$ because they are equal on a dense subspace.
\end{proof}


\begin{proposition}
	If $J$ is a modular isometry for $M$ (with respect to $v$), then it is a modular isometry for $M'$ (with respect to $v$) too.
\end{proposition}

\begin{proof}
	The fact that $JM'J=M$ is obtained by application of $J$ at left and right of both sides of $JMJ=M'$. For the last one, compute
	\begin{equation}
		\langle Sw, Tw\rangle =\langle w, S^*Tw\rangle =\langle w, TS^*w\rangle =\langle T^*w, S^*\rangle 
	\end{equation}
	for every $S\in M$ and $T\in M'$.
\end{proof}

\begin{proposition}
If $\varphi(T)=\langle v, Tv\rangle $ is a trace, then $JSv=S^*v$ for every $S\in M'$.
\end{proposition}

\begin{proof}
When $T$ runs over $M$, the element $Tv$ spans a dense space, and we have, for $T\in M$ and $S\in M'$:
\begin{equation}
	\langle JSv, Tv\rangle =\langle JTv, Sv\rangle =\langle T^*v, Sv\rangle =\langle v, TSv\rangle =\langle v, STv\rangle =\langle S^*v, Tv\rangle .
\end{equation}
So the inner product of $JSv$ and $S^*v$ on any $Tv$ are the same. That proves that $JSv=S^*v$.
\end{proof}

\begin{theorem}
For every von~Neumann algebra $M$ and every cyclic and separating vector $v$, there exists a modular isometry.
\end{theorem}

\begin{proof}
No proof.
\end{proof}

\begin{corollary}
The algebras $M$ and $M'$ are always algebraically isomorphic.
\end{corollary}

%---------------------------------------------------------------------------------------------------------------------------
					\subsection{Example}
%---------------------------------------------------------------------------------------------------------------------------

Let $M(G)$ where $G$ is a non unimodular locally compact group. Thus $M(G)=C_c(G)''$. A function $f\in C_c(G)$ defines an operator on $L^2(G)$ by
\begin{equation}
	(f\xi)(g)=\int_{G}f(h)\xi(h^{-1} g)\,d\mu(h)
\end{equation}
where $\mu$ is a left Haar measure. We consider the functional $\varphi$ on $M(G)$
\begin{equation}
	\varphi(f)=f(e).
\end{equation}
If $G$ was unimodular, this would be a tracial weight, but in the non unimodular case, $\varphi$ is not even a trace on $C_c(G)$. 

%---------------------------------------------------------------------------------------------------------------------------
					\subsection{Other example}
%---------------------------------------------------------------------------------------------------------------------------

Let $G$ be a discrete group with counting measure. Suppose that $G_0$ is an \defe{almost normal}{almost!normal subgroup}\index{normal!(almost) subgroup} of $G$, that means that each double coset $G_0gG_0$ is a finite union of left cosets\footnote{In the case of a normal subgroup, the double cosets are made of only one left coset.}. We define
\begin{equation}
	A=\eC[G,G_0]=\{ f\colon G_0\backslash G/G_0\to \eC\text{ such that $f$ is finitely supported} \},
\end{equation}
and we introduce the product
\begin{equation}
	(f_1\star f_2)(g)=\sum_{h\in G_0/G}f_1(gh^{-1})f_2(h),
\end{equation}
and the involution $f^*(g)=\overline{ f(g^{-1}) }$.  The map
\begin{equation}
\begin{aligned}
 \varphi\colon \eC[G,G_0]&\to \eC \\ 
   f&\mapsto f(e) 
\end{aligned}
\end{equation}
is not a trace in the general case. Since $\varphi(f^*f)\geq0$ and $\varphi(f^*f)=0$ implies $f=0$, we conclude that $\varphi$ is a state.

In the case where $G_0$ is a normal subgroup, however, it is a trace. We define
\begin{equation}
\begin{aligned}
 \sigma_z\colon \eC[G,G_0]&\to \eC[G,G_0] \\ 
   \big( \sigma_z(f) \big)(g)& = \Delta(g)^zf(g) 
\end{aligned}
\end{equation}
where $\Delta(g)=L(g)/R(g)$ where $L(g)$ is the number of left cosets in $G_0gG_0$ and $R(g)$ is the number of left cosets in $G_0gG_0$.

\begin{lemma}
	We have
	\begin{equation}
		\varphi(f_1f_2)=\varphi\big( f_2\sigma(f_1) \big)
	\end{equation}
	where $\sigma=\sigma_1$. The map $\sigma_z$ is, moreover, an automorphism.
\end{lemma}
That lemma says that the non triviality of $\sigma$ measures at what extend $\varphi$ is not a trace.

\begin{proof}
No proof.
\end{proof}
If $\varphi$ is a trace, then the class of identity in $\eC[G,G_0]$ is cyclic and one can make a GNS construction. Notice that $\sigma_z$ is not a $*$-automorphism because
\begin{equation}
	\sigma_z(f^*)=\sigma_{-\bar z}(f)^*.
\end{equation}
If $z$ is purely imaginary, $\sigma_z$ is a $*$-automorphism.

Let $\hH$ be the completion of $A$ with respect to the inner product defined by the state $\varphi$. The algebra $A$ acts on $\hH$ by bounded operators of left multiplication\footnote{Since $A$ is not a $C^*$-algebra, we cannot invoke a GNS construction here.}. Let $v\in\hH$ be defined by
\begin{equation}
	v(g)=
\begin{cases}
	1&\text{if $g\in G_0$}\\
	0&\text{else},
\end{cases}
\end{equation}
and let $\hH_0=A\cdot v\subseteq\hH$.


\begin{lemma}
	We have
	\begin{equation}
		\| \sigma_{1/2}(f)^*v \|=\| fv \|,
	\end{equation}
	in other words, $f\mapsto \sigma_{1/2}(f^*)$ is a conjugate linear isometry.
\end{lemma}

\begin{proof}
	First, notice that for every $h\in A$ and $z\in \eC$,
	\begin{equation}		\label{Eqsigmazvarhih}
		\varphi\big( \sigma_z(h) \big)=\varphi(h).
	\end{equation}
	We have 
	\begin{equation}
		\| \sigma_{1/2}(f^*)v \|^2=\varphi\big( \sigma_{1/2}(f^*)^*\sigma_{1/2}(f^*) \big)=\varphi\big( \sigma_{-1/2}(f)\sigma_{1/2}(f^*) \big).
	\end{equation}
	Now we apply the relation \eqref{Eqsigmazvarhih} with $z=-1/2$, and we find that the latter line is equal to
	\begin{equation}
		\varphi\big( \sigma_{-1}(f)\sigma_0(f^*) \big)=\varphi\big( \sigma_{-1}(f)f^* \big)=\varphi\Big( f^*\sigma_1\big( \sigma_{-1}(f) \big) \Big)=\varphi(f^*f)=\| fv \|^2.
	\end{equation}
\end{proof}

Let $M\subseteq\oB(\hH)$ be the von~Neumann algebra generated by $A$.
\begin{proposition}
	The formula
	\begin{equation}
		J(fv)=\sigma_{1/2}(f^*)v
	\end{equation}
	defines a modular isometry for $M$ with respect to $v$.
\end{proposition}

\begin{proof}
No proof.
\end{proof}

%---------------------------------------------------------------------------------------------------------------------------
					\subsection{Still an other example}
%---------------------------------------------------------------------------------------------------------------------------

Let $A=\eM_n(\eC)$ and
\begin{equation}
	\varphi\colon S\mapsto \tr(ST)
\end{equation}
where $T$ is invertible and chosen in such a way that $T\geq0$, $\tr(T)=1$, so that $\varphi$ is a positive faithful state. Let now $\hH$ be the GNS Hilbert space and consider the map
\begin{equation}
	\sigma_z=T^zST^{-z}.
\end{equation}
We have
\begin{equation}
	\varphi(S_1S_2)=\tr(S_1S_2T)=\tr(S_2TS_1)=\tr(S_2TS_1T^{-1}T)=\tr\big( S_2\sigma(S_1)T \big)=\varphi\big( S_2\sigma(S_1) \big),
\end{equation}
thus $\sigma_1$ has the same property as before to measure the lack of tracial property of $\varphi$.

Once again, we pick $v$, the vacuum of the GNS representation, i.e. the representative of the identity. The map
\begin{equation}
	J\colon Sv\mapsto \sigma_{1/2}(S^*)v
\end{equation}
is a modular isometry for $M$ with respect to $v$.


%---------------------------------------------------------------------------------------------------------------------------
					\subsection{Tomita's theorem}
%---------------------------------------------------------------------------------------------------------------------------

\begin{lemma}
	The map
	\begin{equation}	\label{EqApplQuiDoitEtreIsom}
		T\xi\mapsto T^*\xi
	\end{equation}
	is isometric if and only if $\xi$ is a trace vector.
\end{lemma}

\begin{proof}
	The fact for the map \eqref{EqApplQuiDoitEtreIsom} to be an isometry means that $\langle T\xi, T\xi\rangle =\langle T^*\xi, T^*\xi\rangle $. This is equivalent to
	\begin{equation}
		\langle \xi, T^*T\xi\rangle =\langle \xi, TT^*\xi\rangle ,
	\end{equation}
	which means that $\xi$ is a trace vector.
\end{proof}

\begin{theorem}
	If $v$ is a cyclic and separating vector for $M\subseteq\oB(\hH)$, and if
	\begin{equation}
		\varphi(T)=\langle v, Tv\rangle ,
	\end{equation}
	then there is a strongly dense $*$-subalgebra $A\subseteq M$ and a one parameter group of automorphisms $\sigma_z\colon A\to A$ ($z\in\eC$) such that
	\begin{enumerate}
	\item The map $z\mapsto \sigma_z(S)$ is holomorphic as map from $\eC$ into $\oB(\hH)$ in the sense that it accepts a power expansion $\sigma_z=T_0+zT_1+z^2T_2+\ldots$
	\item\label{ItemTomitaii} If $z\in i\eR$, then $\sigma_z$ extends to a strongly continuous one parameter group of automorphisms on $M$ which only depends on $\varphi$ when the other conditions are satisfied.
	\item The maps $\varphi$ and $\sigma$ are related by
	\begin{equation}
		\varphi(ST)=\varphi\big( T\sigma(S) \big)
	\end{equation}
	for every $S$, $T\in A$, where $\sigma=\sigma_1$.
	\end{enumerate}
	Moreover the formula
	\begin{equation}
		J\colon Sv\mapsto \sigma_{1/2}(S^*)v
	\end{equation}
	defines a modular isometry for $M$ with respect to $v$.
\end{theorem}
Notice that the point \ref{ItemTomitaii} does not depend on $A$.

\begin{proof}[Idea of the proof]
We ignore the analytical issues.  We define
\begin{equation}	
	\begin{aligned}
		\mS\colon \hH&\to \hH \\
		Tv&\mapsto T^*v. 
	\end{aligned}
\end{equation}
For a general $v$, this is not an isometry (this is even unbounded), but we can try to have in idea of what is $\mS^*$. Since $\mS$ is conjugate linear, the equation to solve is
\begin{equation}
	\langle \mS T_1v, T_2v\rangle =\langle \mS^*T_2v, T_1v\rangle .
\end{equation}
We have $\langle T_1^*v, T_2v\rangle =\langle \mS^*T_2v, T_1v\rangle $. Since the Hilbert space $\hH$ is build from a GNS construction, the inner product is in fact given in terms of $\varphi$:
\begin{equation}
	\langle T_1^*v, T_2v\rangle =\varphi(T_1T_2)=\varphi\big( T_2\sigma(T_1) \big)=\varphi\big( \sigma_{-1}(T_2)T_1 \big)=\langle \sigma_{-1}(T_2)^*v, T_1v\rangle =\langle \sigma(T_2^*)v, T_1c\rangle,
\end{equation}
so that
\begin{equation}
	\mS^*(Tv)=\sigma(T^*)v,
\end{equation}
which is an equation for $\mS^*$ in the same time as for $\sigma$. After computations, one shows that
\begin{equation}
	\mS^*\mS(Tv)=\sigma_{-1}(T)v.
\end{equation}
Conclusion: the automorphism $\sigma_{-1}$ (which is the inverse of $\sigma_1$) can be deduced from $\mS$. Moreover, one can prove that $\mS^*\mS$ is a linear (no more conjugate linear) positive, selfadjoint operator and
\begin{equation}		\label{eqMsstarMssigmaz}
	(\mS^*\mS)^zSv=\sigma_z(S).
\end{equation}
Thus, in fact, the whole set $\{ \sigma_z \}_{z\in\eC}$ can be recovered from $\mS$ and thus from $\varphi$.

Notice that equation \eqref{eqMsstarMssigmaz} makes no sense in the infinite dimensional case. More analytic work is needed to be right.

\end{proof}

Two one parameter families of automorphisms $\alpha_t,\beta_t\colon M\to M$ ($\in \eR$) are \defe{outer equivalent}{outer!equivalent automorphism} if there is a one parameter family of automorphisms $\gamma_t\colon \eM_2(M)\to \eM_2(M)$ such that
\begin{equation}
		\gamma_t
	\begin{pmatrix}
	  S	&	0	\\ 
	  0	&	T	
	\end{pmatrix}
	=
	\begin{pmatrix}
	  \alpha_t(S)	&	0	\\ 
	  0	&	\beta_t(T)	
	\end{pmatrix}.
\end{equation}
This is an equivalence relation.

Since $
\begin{pmatrix}
  0	&	\mtu	\\ 
  0	&	0	
\end{pmatrix}
$ is a partial isometry, the automorphism $\gamma_t$ has to send it to another partial isometry, i.e.
\begin{equation}
		\gamma_t
	\begin{pmatrix}
	  0	&	\mtu	\\ 
	  0	&		
	\end{pmatrix}
	=
	\begin{pmatrix}
	  0	&	\mU_t	\\ 
	  0	&	0	
	\end{pmatrix}
\end{equation}
where $\mU_t$ is unitary. I we apply $\gamma_t$ to the equality
\begin{equation}
	\begin{pmatrix}
	  0	&	0	\\ 
	  \mtu	&	0	
	\end{pmatrix}
	\begin{pmatrix}
	  S	&	0	\\ 
	  0	&	0	
	\end{pmatrix}
	\begin{pmatrix}
	  0	&	\mtu	\\ 
	  0	&	0	
	\end{pmatrix}
	=
	\begin{pmatrix}
	  0	&	0	\\ 
	  0	&	S	
	\end{pmatrix},
\end{equation}
we find
\begin{equation}
	\gamma_t
	\begin{pmatrix}
		0	&	0	\\ 
		\mtu	&	0	
	\end{pmatrix}
	=
	\begin{pmatrix}
		0	&	0	\\ 
		\mU_t^*	&	0	
	\end{pmatrix},
\end{equation}
so that
\begin{equation}
	\mU_t^*\alpha_t(S)\mU_t=\beta_t(S).
\end{equation}
The conclusion is that $\alpha_t$ and $\beta_t$ only differ by an inner automorphism.

When $M=\oB(\hH)$, all automorphisms are inner and all the one parameter families of automorphisms are equivalent to the identity.

If $\alpha$ and $\beta$ are outer equivalent, they define the same homomorphism
\begin{equation}
	\eR\to\Out(M)=\frac{ \Aut(M) }{ \Inn(M) }.
\end{equation}

We recall that if $M$ is a von~Neumann algebra of operators of the Hilbert space $\hH$, a vector $\xi$ is \defe{cyclic}{cyclic!vector} if $\hH=\overline{ M\xi }$ and it is \defe{separating}{separating vector} for $M$ is $T\xi=0$ if and only if $T=0$.

\begin{theorem}[Connes' theorem]
The modular group of different cyclic and separating vectors are all outer equivalent.
\end{theorem}

\begin{proof}
	Given two states $\varphi_1$ and $\varphi_2$, we define
	\begin{equation}	
		\begin{aligned}
			\varphi\colon \eM_2(M)&\to \eC \\
			\begin{pmatrix}
				T_{11}&	T_{12}	\\ 
				T_{21}	&	T_{22}	
			\end{pmatrix}
			&\mapsto \frac{ 1 }{2}\big( \varphi_1(T_{11})+\varphi_2(T_{22}) \big), 
		\end{aligned}
	\end{equation}
	which is a faithful normal state. Then apply Tomita's theorem.
\end{proof}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Modular group}
%---------------------------------------------------------------------------------------------------------------------------
This subsection is based on \cite{CirpianiDirichlet}.

If $\xi$ is cyclic and separating and if $T\mapsto T^*$ is an isometric involution on $M$, the antilinear map $T\xi\mapsto T^*\xi$ is densely defined on $M\xi\subset\hH$. We denote by
\begin{equation}
	S_{\xi}\colon \hH\to \hH
\end{equation}
the closure. Thus everywhere it makes sense we have $S_{\xi}(T\xi)=T^*\xi$. The operator $S_{\xi}$ has the polar decomposition
\begin{equation}
	S_{\xi}=J_{\xi}\Delta^{1/2}_{\xi}.
\end{equation}
The antilinear part $J_{\xi}$ is said the \defe{modular conjugation}{modular!conjugation} while the operator $\Delta^{1/2}_{\xi}$ is the \defe{modular operator}{modular!operator} associated with the pair $(M,\xi)$. We have $\Delta_{\xi}=S_{\xi}^*S_{\xi}$.

Now, instead of referring to the cyclic separating vector, we can consider a faithful normal state $\omega$ and think about its associated cyclic separating vector in the GNS cyclic representation $(\pi_{\omega},\hH_{\omega},\xi_{\omega})$. In this setting, the \defe{modular group of automorphism}{modular!group of automorphisms} of the pair $(M,\omega)$ is $\sigma^{\omega}$ defined by
\begin{equation}
	\sigma_t^{\omega}(T)=\pi_{\omega}^{-1}\big( \Delta_{\omega}^{it}\pi_{\omega}(T)\Delta_{\omega}^{-it} \big)
\end{equation}
for $T\in M$ and $t\in\eR$. Here $\Delta_{\omega}$ is the modular operator associated with the pair $\big( \pi_{\omega}(M),\xi_{\omega} \big)$.

\begin{theorem}
	The modular group $\sigma^{\omega}\colon \eR\to \Aut(M)$ associated with the pair $(M,\omega)$ satisfies the following conditions (the \defe{modular condition}{modular!condition}) :
	\begin{enumerate}
		\item
			$\omega$ is $\sigma^{\omega}$-invariant, that means that $\omega=\omega\circ\sigma_t^{\omega}$.
		\item
			for every $x,y\in M$, there exists a bounded function $F_{xy}$ on the strip
			\begin{equation}
				\bar D=\{ z\in\eC\tq 0\leq\imag(z)\leq 1 \}
			\end{equation}
			which is holomorphic on the interior of $\bar D$ and such that
			\begin{subequations}
				\begin{align}
					F_{xy}(t)=\omega\big( \sigma^{\omega}_t(x)y \big)\\
					F_{xy}(t+i)=\omega\big(y \sigma^{\omega}_t(x) \big).
				\end{align}
			\end{subequations}
			
	\end{enumerate}
	Moreover, the map $\sigma^{\omega}$ is defined in an unique way by these two properties.
\end{theorem}

Let $\hH$ be an Hilbert space and an acting von~Neumann algebra $M$ of compact operators on $\hH$. Let $\xi$ be a cyclic separating vector. We define
\begin{equation}
	\begin{aligned}
		j_{\xi}\colon M&\to M' \\
		x&\mapsto J_{\xi}xJ_{\xi} 
	\end{aligned}
\end{equation}
Tomita's theorem shows that this map is well defined and that it takes values in $M'$.

If $\xi$ is a trace vector (definition \ref{DefVecteurTrace}), the map $j_{\xi}$ is the involution:
\begin{equation}
	j_{\xi}(x)=x^*
\end{equation}

%---------------------------------------------------------------------------------------------------------------------------
\subsection{Standard positive cone}
%---------------------------------------------------------------------------------------------------------------------------

The \defe{standard positive cone}{positive!cone!standard} $\hH_{\xi}^+$ associated wit the pair $(M,\xi)$ is the set
\begin{equation}
	\overline{ \{ xj_{\xi}(x)\xi\in\hH\tq x\in M \} }.
\end{equation}
A \defe{standard form}{standard!form!of a von~Neumann algebra} of a von~Neumann algebra $M$ acting on $\hH$ is a self dual cone $\hH^+$ and an antilinear involution $J$ such that $(M,\hH,\hH^+,J)$ satisfies
\begin{enumerate}
	\item
		$JMJ=M'$;
	\item
		$JxJ=x^*$ for every $x\in M\cap M'$;
	\item
		$J\eta=\eta$ for every $\eta\in\hH^+$;
	\item
		$(xJxJ)\hH^+\subset\hH^+$ for every $x\in M$.
\end{enumerate}


\label{LaFin}
