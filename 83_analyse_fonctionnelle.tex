% This is part of Mes notes de mathématique
% Copyright (c) 2011-2016
%   Laurent Claessens
% See the file fdl-1.3.txt for copying conditions.

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Théorèmes de Hahn-Banach}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{theorem}[Hahn-Banach\cite{brezis,TQSWRiz}]
    Soit \( E\), un espace vectoriel réel et une application \( p\colon E\to \eR\) satisfaisant
    \begin{enumerate}
        \item
            \( p(\lambda x)=\lambda p(x)\) pour tout \( x\in E\) et pour tout \( \lambda>0\),
        \item
            \( p(x+y)\leq p(x)+p(y)\) pour tout \( x,y\in E\).
    \end{enumerate}
    Soit de plus \( G\subset E\) un sous-espace vectoriel muni d'une application \( g\colon G\to \eR\) vérifiant \( g(x)\leq p(x)\) pour tout \( x\in G\). Alors il existe \( f\in\aL(E,\eR)\) telle que \( f(x)=g(x)\) pour tout \( x\in G\) et \( f(x)\leq p(x)\) pour tout \( x\in E\).
\end{theorem}
\index{théorème!Hahn-Banach}

\begin{proof}
    Si \( h\) une application linéaire définie sur un sous-espace de \( E\), nous notons \( D_h\) ledit sous-espace. 
    
    \begin{subproof}
    \item[Un ensemble inductif]

        Nous considérons \( P\), l'ensemble des fonctions linéaires suivant 
        \begin{equation}
            P=\Big\{  h\colon D_h\to \eR\tq
            \begin{cases}
                G\subset D_h\\
                h(x)=g(x)&\forall x\in G\\
                h(x)\leq p(x)&\forall x\in D_h
            \end{cases}
        \Big\}
        \end{equation}
        Cet ensemble est non vide parce que \( g\) est dedans. Nous le munissons de la relation d'ordre \( h_1\leq h_2\) si et seulement si \( D_{h_1}\subset D_{h_2}\) et \( h_2\) prolonge \( h_1\). Nous montrons à présent que \( P\) est un ensemble inductif. Soit un sous-ensemble totalement ordonné \( Q\subset P\); nous définissons une fonction \( h\) de la façon suivante. D'abord \( D_h=\sup_{l\in Q}D_l\) et ensuite
        \begin{equation}
            \begin{aligned}
                h\colon D_h&\to \eR \\
                x&\mapsto l(x)&\text{si \( x\in D_l\)}
            \end{aligned}
        \end{equation}
        Cela est bien définit parce que si \( x\in D_l\cap D_{l'}\) alors, vu que \( Q\) on a obligatoirement \( D_l\subset D_{l'}\) et \( l'\) qui prolonge \( l\) (ou le contraire) parce que \( Q\) est totalement ordonné (i.e. \( l\leq l'\) ou \( l'\leq l\)). Donc \( h\) est un majorant de \( Q\) dans \( P\) parce que \( h\geq l\) pour tout \( l\in Q\). Cela montre que \( P\) est inductif (définition \ref{DefGHDfyyz}). Le lemme de Zorn \ref{LemUEGjJBc} nous dit alors que \( P\) possède un maximum \( f\) qui va être la réponse à notre théorème.

    \item[Le support de \( f\)]

        La fonction \( f\) est dans \( P\); donc \( f(x)\leq p(x)\) pour tout \( x\in D_h\) et \( f(x)=g(x)\) pour tout \( x\in G\). Pour terminer nous devons montrer que \( D_f=E\). Supposons donc que \( D_f\neq E\) et prenons \( x_0\notin D_f\). Nous allons contredire la maximalité de \( f\) en considérant la fonction \( h\) donnée par \( D_h=D_f+\eR x_0 \) et
        \begin{equation}
            h(x+tx_0)=f(x)+t\alpha
        \end{equation}
        où \( \alpha\) est une constante que nous allons fixer plus tard.

        Nous commençons par prouver que \( f\) est dans \( P\). Nous devons prouver que
        \begin{equation}    \label{EqOIXrlFe}
            h(x+tx_0)=f(x)+t\alpha\leq p(x+tx_0)
        \end{equation}
        Pour cela nous allons commencer par fixer \( \alpha\) pour avoir les relations suivantes :
        \begin{subequations}    \label{EqMDNkcQk}
            \begin{numcases}{}
                f(x)+\alpha\leq p(x+x_0)    \label{EqDYmRWEY}\\
                f(x)-\alpha\leq p(x-x_0)
            \end{numcases}
        \end{subequations}
        pour tout \( x\in D_f\). Ces relations sont équivalentes à demander \( \alpha \) tel que
        \begin{subequations}
            \begin{numcases}{}
                \alpha\leq p(x+x_0)-f(x)\\
                \alpha\geq f(x)-p(x-x_0)
            \end{numcases}
        \end{subequations}
        Nous nous demandons donc si il existe un \( \alpha\) qui satisfasse
        \begin{equation}
            \sup_{y\in D_f}\big( f(y)-p(y-x_0) \big)\leq \alpha\leq \inf_{z\in D_f}\big( p(z+x_0)-f(z) \big).
        \end{equation}
        Ou encore nous devons prouver que pour tout \( y,z\in D_f\),
        \begin{equation}
            p(z+x_0)-f(x)\geq f(y)-p(y-x_0)\geq 0.
        \end{equation}
        Par les propriétés de \( p\) et de \( f\),
        \begin{equation}
        p(z+x_0)+p(y-x_0)-f(z)-f(y)\geq p(z+y)-f(z+y)\geq 0.
        \end{equation}
        La dernière inégalité est le fait que \( f\in P\). Un choix de \( \alpha\) donnant les inéquations \eqref{EqMDNkcQk} est donc possible.
        
        À partir des inéquations \eqref{EqMDNkcQk} nous obtenons la relation \eqref{EqOIXrlFe} de la façon suivante. Si \( t>0\) nous multiplions l'équation \eqref{EqDYmRWEY} par \( t\) :
        \begin{equation}
            tf(x)+t\alpha\leq tp(x+x_0).
        \end{equation}
        Et nous écrivons cette relation avec \( x/t\) au lieu de \( x \) en tenant compte de la linéarité de \( f\) :
        \begin{equation}
            f(x)+t\alpha\leq  tp\big( \frac{ x }{ t }+x_0 \big)=p(x+tx_0).
        \end{equation}
        Avec \( t<0\), c'est similaire, en faisant attention au sens des inégalités.
        
        Nous avons donc construit \( h\colon D_h\to \eR\) avec \( h\in P\), \( D_f\subset D_h\) et \( h(x)=f(x)\) pour tout \( x\in D_f\). Cela pour dire que \( h>f\), ce qui contredit la maximalité de \( f\). Le domaine de \( f\) est donc \( E\) tout entier.

        La fonction \( f\) est donc une fonction qui remplit les conditions.

    \end{subproof}
\end{proof}

\begin{definition}  \label{DefPJokvAa}
    Un espace topologique est \defe{localement convexe}{convexité!locale} si tout point possède un système fondamental de voisinages formé de convexes.
\end{definition}
%TODO : il faudrait parler de système fondamental de voisinages.

\begin{definition}[Hyperplan qui sépare]
    Soit \( E\) un espace vectoriel topologique ainsi que \( A\), \( B\) des sous-ensembles de \( E\). Nous disons que l'hyperplan d'équation \( f=\alpha\) \defe{sépare au sens large}{hyperplan!séparer!au sens large} les parties \( A\) et \( B\) si \( f(x)\leq \alpha\) pour tout \( x\in A\) et \( f(x)\geq \alpha\) pour tout \( x\in B\).

    La séparation est \defe{au sens strict}{hyperplan!sépare!au sens strict} si il existe \( \epsilon>0\) tel que 
    \begin{subequations}
        \begin{align}
            f(x)\leq \alpha-\epsilon&&\text{pour tout \( x\in A\)}\\
            f(x)\geq \alpha+\epsilon&&\text{pour tout \( x\in B\)}.
        \end{align}
    \end{subequations}
\end{definition}

\begin{theorem}[Hahn-Banach, première forme géométrique\cite{TQSWRiz}]  \label{ThoSAJjdZc}
    Soit \( E\) un espace vectoriel topologique et \( A\), \( B\) deux convexes non vides disjoints de \( E\). Si \( A\) est ouvert, il existe un hyperplan fermé qui sépare \( A\) et \( B\) au sens large.
\end{theorem}

\begin{theorem}[Hahn-Banach, seconde forme géométrique] \label{ThoACuKgtW}
    Soit un espace vectoriel topologique localement convexe\footnote{Définition \ref{DefPJokvAa}.} ainsi que des convexes non vides disjoints \( A\) et \( B\) tels que \( A\) soit compact et \( B\) soit fermé. Alors il existe un hyperplan fermé qui sépare strictement \( A\) et \( B\).
\end{theorem}

\begin{proof}
    Vu que \( B\) est fermé, \( A\) est dans l'ouvert \( E\setminus B\). Donc si \( a\in A\), il existe un voisinage ouvert convexe de \( a\) inclus à \( A\). Soit \( U_a\) un voisinage ouvert et convexe de \( 0\) tel que \( (a+U_a)\cap B=\emptyset\).

    Vu que la fonction \( (x,y)\mapsto x+y\) est continue, nous pouvons trouver un ouvert convexe \( V_a\) tel que \( V_a+V_a\subset U_a\). L'ensemble \( a+V_a\) est alors un voisinage ouvert de \( a\) et bien entendu \( \bigcup_a(a+V_a)\) recouvre \( A\) qui est compact. Nous en extrayons un sous-recouvrement fini, c'est à dire que nous considérons \( a_1,\ldots, a_n\in A\) tels que
    \begin{equation}
        A\subset \bigcup_{i=1}^n(a_i+V_{a_i}).
    \end{equation}
    Nous posons alors 
    \begin{equation}
        V=\bigcap_{i=1}^nV_{a_i}.
    \end{equation}
    Cet ensemble est non vide parce et il contient un voisinage de zéro parce que c'est une intersection finie de voisinages de zéro. Soit \( x\in A+V\). Il existe \( i\) tel que 
    \begin{equation}
        x\in a_i+U_{a_i}+V\subset a_i+V_{a_i}+V_{a_i}\subset a_i+U_{a_i}\subset E\setminus B.
    \end{equation}
    Donc \( (A+V)\cap B=\emptyset\). L'ensemble \( A+V\) est alors un ouvert convexe disjoint de \( B\). Par la première forme géométrique du théorème de Hahn-Banach \ref{ThoSAJjdZc} nous avons un hyperplan qui sépare \( A+V\) de \( B\) au sens large : il existe \( f\in E'\setminus\{ 0 \}\) tel que \( f(a)+f(v)\leq f(b)\) pour tout \( a\in A\), \( v\in V\) et \( b\in B\). 
    
    Il suffit donc de trouver un \( v\in V\) tel que \( f(v)\neq 0\) pour avoir la séparation au sens strict. Cela est facile : \( V\) étant un voisinage de zéro et \( f\) étant linéaire, si elle était nulle sur \( V\), elle serait nulle sur \( E\).
\end{proof}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Théorème de Tietze}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\begin{definition}
Si \( E\) et \( F\) sont des espaces normés, une application \( f\colon E\to F\) est \defe{presque surjective}{presque!surjective} si il existe \( \alpha\in\mathopen] 0 , 1 \mathclose[\) et \( C>0\) tels que pour tout \( y\in \overline{ B_F(0,1) }\), il existe \( x\in\overline{ B_E(0,C) }\) tel que \( \| y-f(x) \|\leq \alpha\).
\end{definition}

\begin{lemma}[\cite{KXjFWKA}]   \label{LemBQLooRXhJzK}
    Soient \( E\) et \( F\) des espaces de Banach et \( f\in\cL(E,F)\)\footnote{L'ensemble des applications linéaires continues}. Si \( f\) est presque surjective, alors
    \begin{enumerate}
        \item   \label{ItemTSOooYkxvBui}
            \( f\) est surjective
        \item\label{ItemTSOooYkxvBuii}
            pour tout \( y\in \overline{ B_F(0,1) }\), il existe \( x\in\overline{ B_E(0,\frac{ C }{ 1-\alpha }) }\) tel que \( y=f(x)\).
    \end{enumerate}
\end{lemma}
Le point \ref{ItemTSOooYkxvBuii} est une précision du point \ref{ItemTSOooYkxvBui} : il dit quelle est la taille de la boule de \( E\) nécessaire à obtenir la boule unité dans \( F\).

\begin{proof}
    Soit \( y\in \overline{ B_F(0,1) }\). Nous allons construire \( x\in B\big( 0,\frac{ C }{ 1-\alpha } \big)\) qui donne \( f(x)=y\). Ce \( x\) sera la limite d'une série que nous allons construire par récurrence. Pour \( n=1\) nous utilisons la presque surjectivité pour considérer \( x_1\in\overline{ B_E(0,C) } \) tel que \( \| y-f(x_1) \|\leq \alpha\). Ensuite nous considérons la récurrence
    \begin{equation}
        x_n\in \overline{ B_E(0,C) }
    \end{equation}
    tel que
    \begin{equation}
        \big\| y-\sum_{i=1}^n\alpha^{i-1}f(x_i) \big\|\leq \alpha^n
    \end{equation}
    Pour montrer que cela existe nous supposons que la série est déjà construire jusqu'à \( n>1\) :
    \begin{equation}
        \frac{1}{ \alpha^n }\Big( y-\sum_{i=1}^n\alpha^{i-1}f(x_i) \Big)\in \overline{ B_F(0,1) }
    \end{equation}
    À partir de là, par presque surjectivité il existe un \( x_{n+1}\in \overline{ B_E(0,C) }\) tel que
    \begin{equation}
        \big\| \frac{ y-\sum_{i=1}^n\alpha^{i-1}f(x_i) }{ \alpha^n }-f(x_{n+1}) \big\|\leq \alpha.
    \end{equation}
    En multipliant par \( \alpha^{n}\), le terme \( \alpha^nf(x_{n+1})\) s'intègre bien dans la somme :
    \begin{equation}
        \big\| y=\sum_{i=1}^{n+1}\alpha^{i-1}f(x_i) \big\|\leq \alpha^{n+1}.
    \end{equation}
    Nous nous intéressons à une éventuelle limite à la somme des \( \alpha^{n-1}x_n\). D'abord nous avons la majoration \( \| \alpha^{n-1}x_n \|\leq \alpha^{n-1}C\), et vu que par la définition de la presque surjectivité \( 0<\alpha<1\), la série
    \begin{equation}
        \sum_{n=1}^{\infty}\alpha^{n-1}x_n
    \end{equation}
    converge absolument\footnote{Définition \ref{DefVFUIXwU}.} parce que la suite des normes est une suite géométrique de raison \( \alpha\). Vu que \( E\) est de Banach, la convergence absolue implique la convergence simple (la suite des sommes partielles est de Cauchy et Banach est complet). Nous posons
    \begin{equation}
        x=\sum_{n=1}^{\infty}\alpha^{n-1}x_n\in E,
    \end{equation}
    et en termes de normes, ça vérifie
    \begin{equation}
        \| x \|\leq\sum_{n=1}^{\infty}\alpha^{n-1}\| x_n \|\leq C\sum_{n=1}^{\infty}\alpha^{n-1}=\frac{ C }{ 1-\alpha }.
    \end{equation}
    Donc c'est bon pour avoir \( x\in B\big( 0,\frac{ C }{ 1-\alpha } \big)\). Nous devons encore vérifier que \( y=f(x)\). Pour cela nous remarquons que
    \begin{equation}
        \| y-f\Big( \sum_{n=1}^N\alpha^{n-1}x_n \Big) \|\leq \alpha^N.
    \end{equation}
    Nous pouvons prendre la limite \( N\to \infty\) et permuter \( f\) avec la limite (par continuité de \( f\)). Vu que \( 0<\alpha<1\) nous avons
    \begin{equation}
        \| y-f(x) \|=0.
    \end{equation}
\end{proof}

\begin{theorem}[Tietze\cite{KXjFWKA,ytMOpe}]   \label{ThoFFQooGvcLzJ}
    Soit un espace métrique \( (X,d)\) et un fermé \( Y\subset X\). Soit \( g_0\in C^0(Y,\eR)\). Alors \( g_0\) admet un prolongement continu sur \( X\).
\end{theorem}

\begin{proof}
    Soit l'opération de restriction
    \begin{equation}
        \begin{aligned}
            T\colon (C^0_b(X,\eR),\| . \|_{\infty})&\to (C^0_b(Y,\eR),\| . \|_{\infty}) \\
            f&\mapsto f|_Y. 
        \end{aligned}
    \end{equation}
    L'application \( T\) est évidemment linéaire. Elle est de plus borné pour la norme opérateur usuelle donnée par la proposition \ref{PropNormeAppLineaire} parce que \( \| T(f) \|\leq \| f \|<\infty\). L'application \( T\) est alors continue par la proposition \ref{PropmEJjLE}.

    \begin{subproof}
    \item[Presque surjection]

    Soit \( g\in C^0_b(Y,\eR)\) avec \( \| g \|_{\infty}\leq 1\). Nous posons
    \begin{subequations}
        \begin{align}
            Y^+=\{ x\in Y\tq \frac{1}{ 3 }\leq g(x)\leq 1 \}\\
            Y^-=\{ x\in Y\tq -1\leq g(x)\leq -\frac{1}{ 3 } \}.
        \end{align}
    \end{subequations}
    Nous considérons alors
    \begin{equation}
        \begin{aligned}
            f\colon X&\to \eR \\
            x&\mapsto \frac{1}{ 3 }\frac{ d(x,Y^-)-d(x,Y^+) }{ d(x,Y^-)+d(x,Y^+) } 
        \end{aligned}
    \end{equation}
    Vu qu'en valeur absolue le dénominateur est plus grand que le numérateur nous avons \( \| f \|_{\infty}\leq \frac{1}{ 3 }\). Notons que
    \begin{itemize}
        \item Si \( x\in Y^+\) alors \( f(x)=\frac{1}{ 3 }\) et \( g(x)\in\mathopen[ \frac{1}{ 3 } , 1 \mathclose]\);
        \item Si \( x\in Y^-\) alors \( f(x)=-\frac{1}{ 3 }\) et \( g(x)\in\mathopen[-1,-\frac{1}{ 3 } \mathclose]\);
        \item Si \( x\) n'est ni dans \( Y^+\) ni dans \( Y^-\) alors nous avons\footnote{Nous rappelons que \( \| g \|=1\), donc \( g(x)\) est forcément ente \( -1\) et \( 1\).} \( g(x)\in\mathopen[ -\frac{1}{ 3 } , \frac{1}{ 3 } \mathclose]\) et donc \( \big| f(x)-g(x) \big|\leq \big| f(x) \big|+\big| g(x) \big|\leq \frac{ 2 }{ 3 }\).
    \end{itemize}
    Dans les deux cas nous avons \( \big| f(x)-g(x) \big|\in\mathopen[ 0 , \frac{ 2 }{ 3 } \mathclose]\) pour tout \( x\in X\). Cela prouve que
    \begin{equation}
        \| T(f)-g \|_{Y,\infty}\leq \frac{ 2 }{ 3 }.
    \end{equation}
    En résumé nous avons pris \( g\) dans la boule \( \overline{ B(0,1) }\) de \( \big( C^0_b(Y,\eR), \| . \|_{\infty} \big)\) et nous avons construit une fonction \( f\) dans la boule \( \overline{ B(0,\frac{1}{ 3 }) }\) de \( \big( C^0_b(X,\eR),\| . \|_{\infty} \big)\) telle que \( \| T(f)-g \|_{\infty}\leq \frac{ 2 }{ 3 }\). L'application \( T\) est donc une presque surjection avec \( \alpha=\frac{1}{ 3 }\) et \( C=\frac{ 2 }{ 3 }\).

\item[Prolongement dans les boules unité fermées]

    La proposition \ref{PropSYMEZGU} nous assure que les espaces \( C^0_b(X,\eR)\) et \( C_b^0(Y,\eR)\) sont de Banach (complets), et le lemme \ref{LemBQLooRXhJzK} nous dit alors que \( T\) est surjective et que pour tout \( g\in\overline{ B(0,1) }\), il existe 
    \begin{equation}
        f\in\overline{ B\left( 0,\frac{ 1/3 }{ 1-\frac{ 2 }{ 3 } } \right) }=\overline{ B(0,1) }.
    \end{equation}
    telle que \( g=T(f)\).


\item[Prolongement pour les boules ouvertes]

    Jusqu'à présent nous avons montré qu'une fonction \( g\in\overline{ B(0,1) }\) admet une prolongement continu dans \( \overline{ B(0,1) }\). Nous allons montrer que si \( g\) est dans la boule ouverte \( B(0,1)\) de \( \big( C^0_b(Y,\eR),\| . \|_{\infty} \big)\) alors \( g\) admet un prolongement dans la boule ouverte \( B(0,1)\) de \( \big( C_b^0(X,\eR),\| . \|_{\infty} \big)\).

    Soit \( g\in B_{C^0_b(Y)}(0,1) \) et son prolongement \( h\in \overline{ B_{C_b^0(X)}(0,1) }\). Si \( \| h \|_{\infty}<1\) alors le résultat est vrai. Sinon nous considérons l'ensemble
    \begin{equation}
        Z=\{ x\in X\tq | h(x) |=1 \}.
    \end{equation}
    Nous avons \( Y\cap Z=\emptyset\) parce que nous avons \( h=g\) sur \( Y\) et nous avons choisi \( \| g \|_{\infty}<\infty\). Par ailleurs \( Y\) est fermé par hypothèse et \( Z\) est fermé parce que \( h\) est continue; par conséquent \( Y\cap Z\) est fermé, donc\footnote{Si vous avez l'intention de dire que \( \overline{ Y\cap Z }=\bar Y\cap\bar Z=Y\cap Z=\emptyset\), allez d'abord voir l'exemple \ref{ExBFLooUNyvbw}. Ici c'est correct parce que \( Y\) et \( Z\) sont fermés.}
    \begin{equation}
        \bar Y\cap\bar Z=Y\cap Z=\emptyset.
    \end{equation}
    Nous posons
    \begin{equation}
        \begin{aligned}
            u\colon X&\to \eR^+ \\
            x&\mapsto \frac{ d(x,Z) }{ d(x,Y)+d(x,Z) } 
        \end{aligned}
    \end{equation}
    Le dénominateur n'est pas nul parce qu'il faudrait \( d(x,Y)=d(x,Z)=0\), ce qui demanderait \( x\in \bar Y\cap\bar Z\), ce qui n'est pas possible. Nous posons \( f=uh\). Si \( x\in Y\) alors \( u(x)=1\), donc \( f\) est encore un prolongement de \( g\). De plus \( f\) est encore continue, et donc encore un bon candidat. Enfin si \( x\) est hors de \( Y\) alors \( d(x,Y)>0\) (strictement parce que \( Y\) est fermé) et donc \( 0<u(x)<1\), ce qui donne \( | f(x) |<| h(x) |\leq 1\). Donc \( \| f \|_{\infty}<1\).

    Nous avons donc trouvé qu'une fonction dans la boule ouverte \( B_{C^0_b(Y)}(0,1)\) se prolonge en une fonction dans la boule ouverte \( B_{C^0_b(X)}(0,1)\).

\item[Le cas non borné]

Soit enfin \( g_0\in C^0(Y,\eR)\). Nous allons nous ramener au cas de la boule unité ouverte en utilisant un homéomorphisme \( \phi\colon \eR\to \mathopen] -1 , 1 \mathclose[\). L'application \( g=\phi\circ g_0\) est dans la boule unité ouvert de \( C^0(Y,\eR)\) et donc admet un prolongement \( f\) dans la boule unité ouverte de \( C^0(X)\). L'application \( f_0=\phi^{-1}\circ f\) est un prolongement continu de \( g_0\).

    \end{subproof}
\end{proof}

Un homéomorphisme \( \phi\colon \eR\to \mathopen] -1 , 1 \mathclose[\) est donné par exemple par la fonction \( \phi(t)=\frac{ 2 }{ \pi }\arctan(t)\) dont le graphique est donné ci-dessous :
\begin{center}
    \input{pictures_tex/Fig_FXVooJYAfif.pstricks}
\end{center}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ 
\section{Espace de Schwartz}
%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Pour un multiindice \( \alpha=(\alpha_1,\ldots, \alpha_d)\in \eN^d\), nous notons
\begin{equation}
    \partial^{\alpha}\varphi=\partial_{x_1}^{\alpha_1}\ldots\partial_{x_d}^{\alpha_d}\varphi
\end{equation}
pour peu que la fonction \( \varphi\) soit \( | \alpha |=\alpha_1+\cdots +\alpha_d\) fois dérivable.

\begin{definition}  \label{DefHHyQooK}
    Soit \( \Omega\subset\eR^d\). L'\defe{espace de Schwartz}{espace!de Schwartz} \( \swS(\Omega)\) est le sous-ensemble de \(  C^{\infty}(\Omega)\) des fonctions dont toutes les dérivées décroissent plus vite que tout polynôme :
    \begin{equation}
        \swS(\Omega)=\big\{   \varphi\in C^{\infty}(\Omega)\tq\forall \alpha,\beta\in \eN^d, p_{\alpha,\beta}(\varphi)<\infty   \big\}
    \end{equation}
    où nous avons considéré
    \begin{equation}    \label{EqOWdChCu}
        p_{\alpha,\beta}(\varphi)=\sup_{x\in \Omega}| x^{\beta}(\partial^{\alpha}\varphi)(x) |=\| x^{\beta}\partial^{\alpha}\varphi \|_{\infty}.
    \end{equation}
\end{definition}

Pour simplifier les notations (surtout du côté de Fourier), nous allons parfois écrire \( M_i\varphi\)\nomenclature[Y]{\( M_i\varphi\)}{La fonction \( x\mapsto x_i\varphi(x)\)} pour la fonction \( x\mapsto x_i\varphi(x)\).

\begin{example}
    La fonction \(  e^{-x^2}\) est une fonction à décroissance rapide sur \( \eR\).
\end{example}

\begin{definition}
    Une fonction \( f\colon \eR^d\to \eC\) est dite à \defe{décroissance rapide}{fonction!à décroissance rapide} si elle décroît plus vite que n'importe quel polynôme. Plus précisément, si pour tout polynôme \( Q\), il existe un \( r>0\) tel que \(  | f(x) |<\frac{1}{ | Q(x) | } \) pour tout \( \| x \|\geq r\).
\end{definition}

\begin{proposition} \label{PropCSmzwGv}
    Une fonction Schwartz est à décroissance rapide.
\end{proposition}

\begin{proof}
    Nous commençons par considérer un polynôme \( P\) donné par
    \begin{equation}
        P(x)=\sum_kc_kx^{\beta_k}
    \end{equation}
    où les \( \beta_k\) sont des multiindices, les \( c_k\) sont des constantes et la somme est finie. Nous avons la majoration
    \begin{equation}
        \sup_{x\in \eR^d}| \varphi(x)P(x) |\leq\sum_k\sup_x\big| c_k\varphi(x) x^{\beta_k} \big|\leq\sum_k| c_k |p_{0,\beta_k}(\varphi)<\infty.
    \end{equation}
    Nous allons noter \( M_P\) la constante \( \sum_k| c_k |p_{0,\beta_k}(\varphi)\), de sorte que pour tout \( x\in \eR^d\) nous ayons \( | \varphi(x)P(x) |\leq M_P\) et donc
    \begin{equation}
        | \varphi(x) |\leq \frac{ M_P }{ | P(x) | }=\frac{1}{ | \frac{1}{ M_P }P(x) | }.
    \end{equation}
    Notons que cette inégalité est a fortiori correcte pour les \( x\) sur lesquels \( P\) s'annule.

    Soit maintenant un polynôme \( Q\). Nous considérons le polynôme \( P(x)=\| x \|Q(x)\). Étant de plus haut degré, pour toute constante \( C\) il existe un rayon \( r_C\) tel que \( | P(x) |\geq C| Q(x) |\) pour tout \( | x |\geq r_C\). En particulier pour \( | x |\geq r_{M_P}\) nous avons
    \begin{equation}
        | P(x) |\geq M_P| Q(x) |
    \end{equation}
    et donc, pour ces \( x\), 
    \begin{equation}
        | \varphi(x) |\leq \frac{1}{ | \frac{1}{ M_P }P(x) | }\leq \frac{1}{ | Q(x) | }.
    \end{equation}
    La première inégalité est valable pour tout \( x\), et la seconde pour \( \| x \|\geq r_{M_P}\).
\end{proof}

\begin{corollary}[\cite{MonCerveau}]        \label{CORooZFPSooHCFUSH}
    Soit \( \varphi\) une fonction Schwartz sur \( \eR^m\times \eR^n\). Alors la fonction
    \begin{equation}
        y\mapsto \sup_{x\in \eR^n}| \varphi(x,y) |
    \end{equation}
    est intégrable.
\end{corollary}

\begin{proof}
    Soit un polynôme \( Q\) en la variable \( y\). Par la proposition \ref{PropCSmzwGv}, il existe \( r>0\) tel que
    \begin{equation}
        | \varphi(x,t) |<\frac{1}{ Q(y) }
    \end{equation}
    pour tout \( \| (x,y) \|>r\). A fortiori l'inégalité tient pour tout \( | y |>r\). Donc
    \begin{equation}
        \int_{\eR^m}\sup_{x\in \eR^n}| \varphi(x,y) |dy=\int_{\| y \|\leq r}\sup_{x}| \varphi(x,y) |dy+\int_{ \| y \|>r  }\sup_{x}| \varphi(x,y) |dy.
    \end{equation}
    La première intégrale est bornée par \( \Vol\big( B(0,r) \big)\| f \|_{\infty}\) tandis que la seconde est bornée par l'intégrale de \( \frac{1}{ Q(y) }\). En prenant \( Q\) de degré suffisamment élevé en toutes les composantes de \( y\) nous avons intégrabilité.
\end{proof}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Topologie}
%---------------------------------------------------------------------------------------------------------------------------

\begin{lemmaDef}        \label{LEMDEFooZEFVooMMmiBr}
    Les \( p_{\alpha,\beta}\) donnés par l'équation \eqref{EqOWdChCu} ci-dessus sont des semi-normes\footnote{Définition \ref{DefPNXlwmi}.}. La topologie considérée sur \( \swS(\eR^d)\) est celle des semi-normes \( p_{\alpha,\beta}\).
\end{lemmaDef}
%TODO : une preuve pour égayer la galerie.


\begin{lemma}[\cite{OEVAuEz}]   \label{LemRJhCbkO}
    La topologie sur \( \swS(\eR^d)\) est donnée aussi par les semi-normes
    \begin{equation}
        q_{n,m}=\max_{| \alpha |\leq n}\sup_{x\in \eR^d}\big( 1+\| x \| \big)^m\big| \partial^{\alpha}\varphi(x) \big|.
    \end{equation}
    Autrement dit, une suite \( \varphi_n\stackrel{\swS(\eR^d)}{\to}0\) si et seulement si \( q_{n,m(\varphi)}\to 0\) pour tout \( n\) et \( m\).
\end{lemma}
Le fait que les \( q_{n,m}(\varphi)\) restent bornés est la proposition \ref{PropCSmzwGv}. Cependant ce lemme est plus précis parce qu'en disant seulement que \( \varphi\) est majoré par des polynôme, nous ne disons pas que les polynômes correspondants aux \( \varphi_n\) tendent vers zéro si \( \varphi_n\stackrel{\swS}{\to}0\). Et d'ailleurs on ne sait pas très bien ce que signifierait \( P_n\to 0\) pour une suite de polynômes.

\begin{proposition}     \label{PropGNXBeME}
    Pour \( p\in\mathopen[ 1 , \infty \mathclose]\), l'espace \( \swS(\eR^d)\) s'injecte continument dans \( L^p(\eR^d)\). 
\end{proposition}

\begin{proof}
    L'injection dont nous parlons est l'identité ou plus précisément l'identité suivie de la prise de classe. Il faut vérifier que cela est correct et continu, c'est à dire d'abord qu'une fonction à décroissance rapide est bien dans \( L^p\) et ensuite que si \( f_n\stackrel{\swS}{\to}0\), alors \( f_n\stackrel{L^p}{\to}0\).
    
    Commençons par \( p=\infty\). Alors \( \| f_n \|_{\infty}=p_{0,0}(f_n)\to 0\) parce que si \( f_n\stackrel{\swS}{\to}0\), alors en particulier \( p_{0,0}(f_n)\to 0\).

    Au tour de \( p<\infty\) maintenant. Nous savons qu'en dimension \( d\), la fonction
    \begin{equation}
        x\mapsto \frac{1}{ (1+\| x \|)^s }
    \end{equation}
    est intégrable dès que \( s>d\).
    %TODO : il faudrait une petite preuve de ça.
    Pour toute valeur de \( m\) nous avons
    \begin{equation}
        \| \varphi \|_p^p=\int_{\eR^d}| \varphi(x) |^pdx=\int_{\eR^d}\frac{ \big|    (1+\| x \|)^m\varphi(x)   \big|^p }{ \big( 1+\| x \| \big)^{mp} }\leq\int_{\eR^d}\frac{q_{0,m}(\varphi)^p}{ \big( 1+\| x \| \big)^{mp} }.
    \end{equation}
    En choisissant \( m\) de telle sorte que \( mp>d\), nous avons convergence de l'intégrale et donc \( \| \varphi \|_p<\infty\). Nous retenons que
    \begin{equation}    \label{EqVWfEFMk}
        \| \varphi \|_p^p\leq Cq_{0,m}(\varphi)^p
    \end{equation}
    pour une certaine constance \( C\) et un bon choix de \( m\).

    Ceci prouve que \( \swS(\eR^d)\subset L^p(\eR^d)\). Nous devons encore vérifier que l'inclusion est continue. Si \( \varphi_n\stackrel{\swS}{\to}0\), alors en particulier nous avons \( q_{0,m}(\varphi_n)\to 0\) par le lemme \ref{LemRJhCbkO}. Par conséquent la majoration \eqref{EqVWfEFMk} nous dit que \( \| \varphi_n \|_p\to 0\) également.

\end{proof}
En résumé, si \( \varphi_n\stackrel{\swS(\eR^d)}{\to}\varphi\) alors \( \varphi_n\stackrel{L^p}{\to}\varphi\).

\begin{theorem}[\cite{MesIntProbb}]      \label{ThoRWEoqY}
    Soit \( \mu\) une mesure sur les boréliens de \( \eR^n\) finie sur les compacts. Alors \( \swD(\eR^n)\) est dense dans \( L^1(\eR^n,\Borelien(\eR^n),\mu)\).
\end{theorem}
\index{densité!de \( \swD(\eR^n)\) dans \( L^1(\eR^n)\)}

\begin{proposition}[\cite{ooIKXSooRlKVJR}]      \label{PROPooJNQZooIRbJei}
    La partie \( \swD(\eR^d)\) est dense dans \( \swS(\eR^d)\).
\end{proposition}

\begin{proof}
    Soit \( f\in \swS(\eR^d)\), et \( \phi\), une fonction de \( \swD(\eR^d)\) telle que \( \phi(x)=1\) pour \(| x |\leq 1 \) (l'existence de telles fonctions est discutée en \ref{subsecOSYAooXXCVjv}). Soit aussi \( \phi_k(x)=\phi(x/k)\). Nous posons
    \begin{equation}
        f_k(x)=\phi_k(x)f(x),
    \end{equation}
    et nous allons prouver que pour tout multiindices \( \alpha\) et \( \gamma\),
    \begin{equation}
        p_{\alpha,\gamma}(f_k-f)=\| x^{\gamma}\partial^{\alpha}(f_k-f)  \|_{\infty}\to 0.       
    \end{equation}
    Pour cela nous allons noter \(  \beta\leq \alpha  \) lorsque \( \beta\) est un multiindice contenu dans \( \alpha\). En utilisant la dérivée du produit nous avons
    \begin{subequations}
        \begin{align}
            (\partial^{\alpha}f_k)(x)&=\sum_{\beta\leq \alpha}(\partial^{\alpha-\beta}\phi_k)(x)\partial^{\beta}f(x)\\
            &=\sum_{\beta\leq \alpha}k^{-| \alpha-\beta |}(\partial^{\alpha-\beta}\phi)(x/k)(\partial^{\beta}f)(x)\\
            &=\sum_{\beta< \alpha}k^{-| \alpha-\beta |}(\partial^{\alpha-\beta}\phi)(x/k)(\partial^{\beta}f)(x) + \phi(x/k)(\partial^{\alpha}f)(x).
        \end{align}
    \end{subequations}
    Nous devons donc étudier et majorer
    \begin{equation}
        \begin{aligned}[]
        \sup_{x\in \eR^d}| x^{\gamma}\partial^{\alpha}(f_k-f) |&\leq \sup\big| x^{\gamma}  \sum_{\beta< \alpha}k^{-| \alpha-\beta |}(\partial^{\alpha-\beta}\phi)(x/k)(\partial^{\beta}f)(x)  \big|\\
        &\quad+\sup \big| x^{\gamma}\big( \phi(x/k)-1 \big)(\partial^{\alpha}f)(x) \big|\\
        \end{aligned}
    \end{equation}
    En ce qui concerne le second terme, soit \( \epsilon>0\), vu que \( f\) est Schwartz, il existe \( R\) tel que
    \begin{equation}
        | x^{\gamma}(\partial^{\alpha}f)(x) |<\epsilon
    \end{equation}
    dès que \( \| x \|>R\). En prenant \( k>R\), 
    \begin{equation}
        | x^{\gamma}(\partial^{\alpha}f)(x) |\begin{cases}
            =0    &   \text{si \( \| x \|<R\)}\\
            \leq \epsilon    &    \text{si \( \| x \|>R\).}
        \end{cases}
    \end{equation}
    En ce qui concerne le premier terme,
    \begin{subequations}
        \begin{align}
            \sup_{x\in \eR^d}\big| x^{\gamma}&\sum_{\beta<\alpha}k^{-|\alpha-\beta |}(\partial^{\alpha-\beta}\phi)(x/k)(\partial^{\beta}f)(x) \Big|\\
            &\leq \frac{1}{ k }\sup_{x}\big| \sum_{\beta<\alpha}(\partial^{\alpha-\beta}\phi)(x/k)(x^{\gamma}\partial^{\beta}f)(x) \big|\\
            &= \frac{1}{ k }\sup_{x}\big| \sum_{\beta<\alpha}(\partial^{\alpha-\beta}\phi)(x/k)  p_{\beta,\gamma}(f)   \big|
        \end{align}
    \end{subequations}
    La somme ne contient qu'un nombre fini de \( \beta\) différents, donc nous pouvons considérer un nombre \( K\) qui majore tous les \( p_{\beta,\gamma}(f)\) en même temps. La partie avec \( \phi\) peut être majorée par \( \| \partial^{\alpha-\beta}\phi \|_{\infty}\) (qui est fini) dont nous pouvons prendre le maximum sur \(\beta<\alpha\). Toute l'expression dans la somme est donc majorée par un nombre qui ne dépend ni de \( x\) ni de \( \beta\). Vu que la somme est finie, elle est majorée par ce nombre multiplié par le nombre de termes dans la somme et au final
    \begin{equation}
        \sup_{x\in \eR^d}\big| x^{\gamma}\sum_{\beta<\alpha}k^{-|\alpha-\beta |}(\partial^{\alpha-\beta}\phi)(x/k)(\partial^{\beta}f)(x) \Big|\leq \frac{ K' }{ k }.
    \end{equation}
    La limite \( k\to \infty\) ne fait alors plus de doutes.
\end{proof}

\begin{remark}
    Vu la topologie de \( \swS(\eR^d)\) (définition \ref{LEMDEFooZEFVooMMmiBr}), la convergence \( f_k\stackrel{\swS(\eR^d)}{\longrightarrow}f\) peut être exprimée par le fait que pour tout \( k,l\),
    \begin{equation}
        t^kf_n^{(l)}\stackrel{unif}{\longrightarrow}t^kf^{(l)}.
    \end{equation}
    C'est à dire convergence uniforme de toutes les dérivées multipliées par n'importe quel polynôme.
\end{remark}

%--------------------------------------------------------------------------------------------------------------------------- 
\subsection{Produit de convolution}
%---------------------------------------------------------------------------------------------------------------------------

\begin{proposition}[Stabilité de Schwartz par convolution\footnote{Définition \ref{THOooMLNMooQfksn}.} \cite{CXCQJIt}]     \label{PROPooUNFYooYdbSbJ}
    Si \( \varphi\in L^1(\eR^d)\) et \( \psi\in\swS(\eR^d)\), alors \( \varphi * \psi\in \swS(\eR^d)\).
\end{proposition}

\begin{proof}
    Nous devons prouver que
    \begin{equation}
        p_{\alpha,\beta}(\varphi*\psi)=\sup_{x\in \eR^d}| x^{\beta}(\partial^{\alpha}(\varphi*\psi))(x) |
    \end{equation}
    est borné pour tout multiindices \( \alpha\) et \( \beta\). En appliquant \( | \alpha |\) fois la proposition \ref{PropHNbdMQe}, nous mettons toutes les dérivées sur \( \psi\) : \( \partial^{\alpha}(\varphi*\psi)=(\varphi*\partial^{\alpha}\psi)\). Cela étant fait, nous majorons
    \begin{subequations}
        \begin{align}
            \big| x^{\beta}(\varphi*\partial^{\alpha}\psi)(x) \big|&\leq| x^{\beta} |\int_{\eR^d} |\varphi(y)|\underbrace{\big| (\partial^{\alpha}\psi)(x-y)\big|}_{\leq\| \partial^{\alpha}\psi \|_{\infty}} dy \big|\\
            &\leq | x^{\beta} |  \| \partial^{\alpha}\psi \|_{\infty}\int_{\eR^d}| \varphi(y) |dy\\
            &\leq p_{\alpha,\beta}(\psi)\| \varphi \|_{_{L^1}}.
        \end{align}
    \end{subequations}
    Par conséquent, \( p_{\alpha,\beta}(\varphi*\psi)\leq \| \varphi \|_{L^1}p_{\alpha,\beta}(\psi)<\infty\).
\end{proof}
